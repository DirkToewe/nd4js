/* ND.JS v1.3.0
 *
 * ND.JS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * ND.JS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.
 */
 (function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["nd"] = factory();
	else
		root["nd"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/help.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/@babel/runtime/helpers/arrayLikeToArray.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/arrayLikeToArray.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/arrayWithHoles.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/arrayWithHoles.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/arrayWithHoles.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":
/*!******************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ \"./node_modules/@babel/runtime/helpers/arrayLikeToArray.js\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/assertThisInitialized.js ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/assertThisInitialized.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/classCallCheck.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/classCallCheck.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/classCallCheck.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/construct.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/construct.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ \"./node_modules/@babel/runtime/helpers/setPrototypeOf.js\");\n\nvar isNativeReflectConstruct = __webpack_require__(/*! ./isNativeReflectConstruct */ \"./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/construct.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/createClass.js":
/*!************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/createClass.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/createClass.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/defineProperty.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/defineProperty.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/defineProperty.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/getPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/getPrototypeOf.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/inherits.js":
/*!*********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/inherits.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ \"./node_modules/@babel/runtime/helpers/setPrototypeOf.js\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/inherits.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/isNativeFunction.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/isNativeFunction.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nmodule.exports = _isNativeFunction;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/isNativeFunction.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nmodule.exports = _isNativeReflectConstruct;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/iterableToArray.js":
/*!****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/iterableToArray.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/iterableToArray.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/nonIterableRest.js":
/*!****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/nonIterableRest.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/nonIterableRest.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/nonIterableSpread.js":
/*!******************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/nonIterableSpread.js ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/nonIterableSpread.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var _typeof = __webpack_require__(/*! ../helpers/typeof */ \"./node_modules/@babel/runtime/helpers/typeof.js\");\n\nvar assertThisInitialized = __webpack_require__(/*! ./assertThisInitialized */ \"./node_modules/@babel/runtime/helpers/assertThisInitialized.js\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/setPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/setPrototypeOf.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/slicedToArray.js":
/*!**************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/slicedToArray.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var arrayWithHoles = __webpack_require__(/*! ./arrayWithHoles */ \"./node_modules/@babel/runtime/helpers/arrayWithHoles.js\");\n\nvar iterableToArrayLimit = __webpack_require__(/*! ./iterableToArrayLimit */ \"./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = __webpack_require__(/*! ./unsupportedIterableToArray */ \"./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js\");\n\nvar nonIterableRest = __webpack_require__(/*! ./nonIterableRest */ \"./node_modules/@babel/runtime/helpers/nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/slicedToArray.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/toConsumableArray.js":
/*!******************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/toConsumableArray.js ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var arrayWithoutHoles = __webpack_require__(/*! ./arrayWithoutHoles */ \"./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js\");\n\nvar iterableToArray = __webpack_require__(/*! ./iterableToArray */ \"./node_modules/@babel/runtime/helpers/iterableToArray.js\");\n\nvar unsupportedIterableToArray = __webpack_require__(/*! ./unsupportedIterableToArray */ \"./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js\");\n\nvar nonIterableSpread = __webpack_require__(/*! ./nonIterableSpread */ \"./node_modules/@babel/runtime/helpers/nonIterableSpread.js\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/toConsumableArray.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/typeof.js":
/*!*******************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/typeof.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/typeof.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js ***!
  \***************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var arrayLikeToArray = __webpack_require__(/*! ./arrayLikeToArray */ \"./node_modules/@babel/runtime/helpers/arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/wrapNativeSuper.js":
/*!****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/wrapNativeSuper.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var getPrototypeOf = __webpack_require__(/*! ./getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n\nvar setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ \"./node_modules/@babel/runtime/helpers/setPrototypeOf.js\");\n\nvar isNativeFunction = __webpack_require__(/*! ./isNativeFunction */ \"./node_modules/@babel/runtime/helpers/isNativeFunction.js\");\n\nvar construct = __webpack_require__(/*! ./construct */ \"./node_modules/@babel/runtime/helpers/construct.js\");\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nmodule.exports = _wrapNativeSuper;\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/helpers/wrapNativeSuper.js?");

/***/ }),

/***/ "./node_modules/@babel/runtime/regenerator/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/regenerator/index.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("module.exports = __webpack_require__(/*! regenerator-runtime */ \"./node_modules/regenerator-runtime/runtime.js\");\n\n\n//# sourceURL=webpack://nd/./node_modules/@babel/runtime/regenerator/index.js?");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n//# sourceURL=webpack://nd/./node_modules/process/browser.js?");

/***/ }),

/***/ "./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n   true ? module.exports : undefined\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n\n\n//# sourceURL=webpack://nd/./node_modules/regenerator-runtime/runtime.js?");

/***/ }),

/***/ "./node_modules/util/node_modules/inherits/inherits_browser.js":
/*!*********************************************************************!*\
  !*** ./node_modules/util/node_modules/inherits/inherits_browser.js ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n\n//# sourceURL=webpack://nd/./node_modules/util/node_modules/inherits/inherits_browser.js?");

/***/ }),

/***/ "./node_modules/util/support/isBufferBrowser.js":
/*!******************************************************!*\
  !*** ./node_modules/util/support/isBufferBrowser.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n\n//# sourceURL=webpack://nd/./node_modules/util/support/isBufferBrowser.js?");

/***/ }),

/***/ "./node_modules/util/util.js":
/*!***********************************!*\
  !*** ./node_modules/util/util.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(process) {// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = __webpack_require__(/*! ./support/isBuffer */ \"./node_modules/util/support/isBufferBrowser.js\");\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = __webpack_require__(/*! inherits */ \"./node_modules/util/node_modules/inherits/inherits_browser.js\");\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../process/browser.js */ \"./node_modules/process/browser.js\")))\n\n//# sourceURL=webpack://nd/./node_modules/util/util.js?");

/***/ }),

/***/ "./src/_test_data_generators.js":
/*!**************************************!*\
  !*** ./src/_test_data_generators.js ***!
  \**************************************/
/*! exports provided: _rand_int, _shuffle, _shuffled, _rand_rows0, _rand_cols0, _rand_rankdef */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rand_int\", function() { return _rand_int; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_shuffle\", function() { return _shuffle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_shuffled\", function() { return _shuffled; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rand_rows0\", function() { return _rand_rows0; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rand_cols0\", function() { return _rand_cols0; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rand_rankdef\", function() { return _rand_rankdef; });\n/* harmony import */ var _tabulate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tabulate */ \"./src/tabulate.js\");\n/* harmony import */ var _la_matmul__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./la/matmul */ \"./src/la/matmul.js\");\n/* harmony import */ var _la_rand_ortho__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./la/rand_ortho */ \"./src/la/rand_ortho.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction _rand_int(from, until) {\n  if (0 !== from % 1) throw new Error('Assertion failed.');\n  if (0 !== until % 1) throw new Error('Assertion failed.');\n  if (!(from < until)) throw new Error('Assertion failed.');\n  return Math.floor(Math.random() * (until - from)) + from;\n} ///** Generates a series of shapes that are broadcast compatible except for their tails.\n// */\n//export function _rand_shapes( ...tails ) // <- TODO\n//{\n//  throw new Error('Not yet implemented.');\n//}\n\nvar SHUFFLE_WARN = true;\nfunction _shuffle(array, from, until) {\n  if (SHUFFLE_WARN) {\n    SHUFFLE_WARN = false;\n    console.warn(new Error('_shuffle deprecated, use nd.rand.AleaRNG instead.'));\n  }\n\n  if (array.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (null == from) from = 0;\n  if (null == until) until = array.length;\n  if (0 !== from % 1) throw new Error('Assertion failed.');\n  if (0 !== until % 1) throw new Error('Assertion failed.');\n  if (!(from <= until)) throw new Error('Assertion failed.'); // https://en.wikipedia.org/wiki/Fisher-Yates_shuffle\n\n  for (var i = from; i < until - 1; i++) {\n    var j = _rand_int(i, until),\n        aj = array[j];\n\n    array[j] = array[i];\n    array[i] = aj;\n  }\n}\nfunction _shuffled(array, from, until) {\n  array = array.slice();\n\n  _shuffle(array, from, until);\n\n  return array;\n}\nfunction _rand_rows0() {\n  for (var _len = arguments.length, shape = new Array(_len), _key = 0; _key < _len; _key++) {\n    shape[_key] = arguments[_key];\n  }\n\n  if (!(2 <= shape.length)) throw new Error('Assertion failed.');\n  var AA = Object(_tabulate__WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"])(shape, 'float64', function () {\n    return Math.random() * 8 - 4;\n  });\n  var N = shape.pop(),\n      M = shape.pop();\n  var A = AA.data;\n  var rows = new Int32Array(M);\n\n  for (var A_off = A.length; (A_off -= M * N) >= 0;) {\n    for (var i = M; i-- > 0;) {\n      rows[i] = i;\n    }\n\n    var rank = _rand_int(0, M);\n\n    for (var m = M; m > rank;) {\n      var k = _rand_int(0, m--),\n          _i = rows[k];\n\n      rows[k] = rows[m];\n\n      for (var j = N; j-- > 0;) {\n        A[A_off + N * _i + j] = 0;\n      }\n    }\n  }\n\n  Object.freeze(A.buffer);\n  Object.freeze(AA);\n  return AA;\n}\nfunction _rand_cols0() {\n  for (var _len2 = arguments.length, shape = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    shape[_key2] = arguments[_key2];\n  }\n\n  if (!(2 <= shape.length)) throw new Error('Assertion failed.');\n  var AA = Object(_tabulate__WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"])(shape, 'float64', function () {\n    return Math.random() * 8 - 4;\n  });\n  var N = shape.pop(),\n      M = shape.pop();\n  var A = AA.data;\n  var cols = new Int32Array(N);\n\n  for (var A_off = A.length; (A_off -= M * N) >= 0;) {\n    for (var i = N; i-- > 0;) {\n      cols[i] = i;\n    }\n\n    var rank = _rand_int(0, N);\n\n    for (var n = N; n > rank;) {\n      var k = _rand_int(0, n--),\n          j = cols[k];\n\n      cols[k] = cols[n];\n\n      for (var _i2 = M; _i2-- > 0;) {\n        A[A_off + N * _i2 + j] = 0;\n      }\n    }\n  }\n\n  Object.freeze(A.buffer);\n  Object.freeze(AA);\n  return AA;\n}\nvar RAND_RANKDEF_WARN = true;\nfunction _rand_rankdef() {\n  if (RAND_RANKDEF_WARN) {\n    RAND_RANKDEF_WARN = false;\n    console.warn(new Error('_rand_rankdef deprecated, use nd.rand.AleaRNG instead.'));\n  }\n\n  for (var _len3 = arguments.length, shape = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n    shape[_key3] = arguments[_key3];\n  }\n\n  if (!(2 <= shape.length)) throw new Error('Assertion failed.');\n  var N = shape.pop(),\n      M = shape.pop(),\n      L = Math.min(M, N); // use random, mostly rank-deficient SVD to generate test matrix A\n\n  var ranks = Object(_tabulate__WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"])(shape, 'int32', function () {\n    return _rand_int(0, L + 1);\n  }),\n      // <- ranks\n  U = _la_rand_ortho__WEBPACK_IMPORTED_MODULE_2__[\"rand_ortho\"].apply(void 0, ['float64'].concat(shape, [M, L])),\n      V = _la_rand_ortho__WEBPACK_IMPORTED_MODULE_2__[\"rand_ortho\"].apply(void 0, ['float64'].concat(shape, [L, N])),\n      S = Object(_tabulate__WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"])([].concat(shape, [L, L]), 'float64', function () {\n    for (var _len4 = arguments.length, idx = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      idx[_key4] = arguments[_key4];\n    }\n\n    var j = idx.pop(),\n        i = idx.pop(),\n        rank = ranks.apply(void 0, idx);\n    if (i !== j || rank <= i) return 0;\n    return Math.random() * 8 + 0.1;\n  }),\n      A = Object(_la_matmul__WEBPACK_IMPORTED_MODULE_1__[\"matmul\"])(U, S, V); // add random scaling\n\n  for (var S_off = S.data.length; (S_off -= L * L) >= 0;) {\n    var scale = Math.random() * 1e9 + 1;\n\n    for (var i = L; i-- > 0;) {\n      S.data[S_off + L * i + i] *= scale;\n    }\n  }\n\n  Object.freeze(ranks.data.buffer);\n  Object.freeze(A.data.buffer);\n  return [A, ranks];\n}\n\n//# sourceURL=webpack://nd/./src/_test_data_generators.js?");

/***/ }),

/***/ "./src/arrays/heap_sort_gen.js":
/*!*************************************!*\
  !*** ./src/arrays/heap_sort_gen.js ***!
  \*************************************/
/*! exports provided: heap_sort_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"heap_sort_gen\", function() { return heap_sort_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(heap_sort_gen);\n\nfunction heap_sort_gen(items) {\n  var compare_fn,\n      i,\n      len,\n      less,\n      swap,\n      parent,\n      child,\n      siftDown,\n      j,\n      _args = arguments;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function heap_sort_gen$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          compare_fn = _args.length > 1 && _args[1] !== undefined ? _args[1] : function (x, y) {\n            return (x > y) - (x < y);\n          };\n\n          if (!(items.length % 1 !== 0)) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 3:\n          if (items.length >= 0) {\n            _context.next = 5;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 5:\n          if (compare_fn instanceof Function) {\n            _context.next = 7;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 7:\n          i = 0;\n          len = items.length;\n          less = function less(i, j) {\n            return compare_fn(items[i], items[j]) < 0;\n          }, swap = function swap(i, j) {\n            var x = items[i];\n            items[i] = items[j];\n            items[j] = x;\n          };\n          parent = function parent(child) {\n            return len - 1 - (len - 2 - child >> 1);\n          }, child = function child(parent) {\n            return len - 2 - (len - 1 - parent << 1);\n          };\n\n          siftDown = function siftDown(p) {\n            var c = child(p);\n\n            if (c > i) {\n              if (!less(c, c - 1)) --c;\n\n              if (less(c, p)) {\n                swap(c, p);\n                siftDown(c);\n              }\n            } else if (c === i && less(c, p)) swap(c, p);\n          }; // HEAPIFY\n\n\n          for (j = parent(0); j < len; j++) {\n            siftDown(j);\n          } // EXTRACT MINIMA FROM HEAP\n\n\n        case 13:\n          if (!(i < len)) {\n            _context.next = 20;\n            break;\n          }\n\n          swap(i, len - 1);\n          _context.next = 17;\n          return items[i++];\n\n        case 17:\n          siftDown(len - 1); // <- reinstate heap property\n\n          _context.next = 13;\n          break;\n\n        case 20:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\n//# sourceURL=webpack://nd/./src/arrays/heap_sort_gen.js?");

/***/ }),

/***/ "./src/arrays/is_array.js":
/*!********************************!*\
  !*** ./src/arrays/is_array.js ***!
  \********************************/
/*! exports provided: is_array */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"is_array\", function() { return is_array; });\n/* harmony import */ var _dt_complex_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dt/complex_array */ \"./src/dt/complex_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nvar TYPESET = new Set([Array, Float32Array, Float64Array, Int8Array, Int16Array, Int32Array, Uint8Array, Uint16Array, Uint32Array, Uint8ClampedArray, _dt_complex_array__WEBPACK_IMPORTED_MODULE_0__[\"Complex128Array\"]].map(function (clazz) {\n  return clazz.prototype;\n}));\nvar is_array = function is_array(obj) {\n  return TYPESET.has(Object.getPrototypeOf(obj));\n};\n\n//# sourceURL=webpack://nd/./src/arrays/is_array.js?");

/***/ }),

/***/ "./src/concat.js":
/*!***********************!*\
  !*** ./src/concat.js ***!
  \***********************/
/*! exports provided: concat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"concat\", function() { return concat; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction concat(axis, dtype, ndarrays) {\n  if (null == ndarrays) {\n    if (null == dtype) {\n      ndarrays = axis;\n      axis = undefined;\n    } else {\n      ndarrays = dtype;\n      dtype = undefined;\n\n      if ('string' === typeof axis) {\n        dtype = axis;\n        axis = undefined;\n      }\n    }\n  }\n\n  ndarrays = Array.from(ndarrays, function (arr) {\n    return Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(dtype, arr);\n  });\n  if (null == axis) axis = 0;\n  if (null == dtype) dtype = _dt__WEBPACK_IMPORTED_MODULE_2__[\"super_dtype\"].apply(void 0, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(ndarrays.map(function (a) {\n    return a.dtype;\n  })));\n  if (0 > axis) axis += ndarrays[0].shape.length;\n  if (0 > axis || axis >= ndarrays[0].shape.length) throw new Error('Axis out of bounds.');\n  var newShape = Int32Array.from(ndarrays[0].shape);\n\n  var _loop = function _loop(i) {\n    var shape = ndarrays[i].shape;\n    if (newShape.length != shape.length) throw new Error('All shapes must have the same length.');\n    if (!newShape.every(function (len, d) {\n      return newShape[d] === shape[d] || axis === d;\n    })) throw new Error('Shape along all axes but the concatentation axis must match.');\n    newShape[axis] += shape[axis];\n  };\n\n  for (var i = ndarrays.length; --i > 0;) {\n    _loop(i);\n  }\n\n  var rest = newShape.slice(axis + 1).reduce(function (a, b) {\n    return a * b;\n  }, 1),\n      indices = Int32Array.from(ndarrays, function (ndarr) {\n    return ndarr.data.length;\n  }),\n      newData = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][dtype](newShape.reduce(function (a, b) {\n    return a * b;\n  }, 1));\n  var newIdx = newData.length;\n\n  function fill(d) {\n    if (d === axis) for (var _i = ndarrays.length; _i-- > 0;) {\n      for (var j = ndarrays[_i].shape[d] * rest; j-- > 0;) {\n        newData[--newIdx] = ndarrays[_i].data[--indices[_i]];\n      }\n    } else for (var _i2 = newShape[d]; _i2-- > 0;) {\n      fill(d + 1);\n    }\n  }\n\n  fill(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](newShape, newData);\n}\n\n//# sourceURL=webpack://nd/./src/concat.js?");

/***/ }),

/***/ "./src/dt/complex.js":
/*!***************************!*\
  !*** ./src/dt/complex.js ***!
  \***************************/
/*! exports provided: Complex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Complex\", function() { return Complex; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../math */ \"./src/math.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar Complex = /*#__PURE__*/function () {\n  function Complex(re, im) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, Complex);\n\n    if (null == re) re = 0.0;\n    if (null == im) im = 0.0;\n\n    if (re.re != null || re.im != null) {\n      im = re.im || 0;\n      re = re.re || 0;\n    }\n\n    this.re = re * 1;\n    this.im = im * 1; // TODO: remove these assertions\n\n    if (isNaN(re)) throw new Error('Real value is NaN.');\n    if (isNaN(im)) throw new Error('Imaginary value is NaN.');\n    Object.freeze(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(Complex, [{\n    key: \"add\",\n    value: function add(re, im) {\n      if (null == re) re = 0.0;\n      if (null == im) im = 0.0;\n\n      if (re.re != null || re.im != null) {\n        im = re.im || 0;\n        re = re.re || 0;\n      }\n\n      return new Complex(this.re + re, this.im + im);\n    }\n  }, {\n    key: \"sub\",\n    value: function sub(re, im) {\n      if (null == re) re = 0.0;\n      if (null == im) im = 0.0;\n\n      if (re.re != null || re.im != null) {\n        im = re.im || 0;\n        re = re.re || 0;\n      }\n\n      return new Complex(this.re - re, this.im - im);\n    }\n  }, {\n    key: \"mul\",\n    value: function mul(re, im) {\n      if (null == re) re = 0.0;\n      if (null == im) im = 0.0;\n\n      if (re.re != null || re.im != null) {\n        im = re.im || 0;\n        re = re.re || 0;\n      }\n\n      return new Complex(this.re * re - this.im * im, this.re * im + this.im * re);\n    }\n  }, {\n    key: \"div\",\n    value: function div(re, im) {\n      if (null == re) re = 0.0;\n      if (null == im) im = 0.0;\n\n      if (re.re != null || re.im != null) {\n        im = re.im || 0;\n        re = re.re || 0;\n      }\n\n      if (im == 0) return new Complex(this.re / re, this.im / re); //    return new Complex(\n      //      (this.re*re + this.im*im) / (re*re + im*im),\n      //      (this.im*re - this.re*im) / (re*re + im*im)\n      //    );\n\n      if (Math.abs(re) >= Math.abs(im)) {\n        var R = im / re;\n        return new Complex((this.re + this.im * R) / (re + im * R), (this.im - this.re * R) / (re + im * R));\n      } else {\n        var _R = re / im;\n\n        return new Complex((this.re * _R + this.im) / (re * _R + im), (this.im * _R - this.re) / (re * _R + im));\n      }\n    }\n  }, {\n    key: \"equals\",\n    value: function equals(re, im) {\n      if (null == re) re = 0.0;\n      if (null == im) im = 0.0;\n\n      if (re.re != null || re.im != null) {\n        im = re.im || 0;\n        re = re.re || 0;\n      }\n\n      return this.re == re && this.im == im;\n    }\n  }, {\n    key: \"abs\",\n    value: function abs() {\n      return Math.hypot(this.re, this.im);\n    }\n  }, {\n    key: \"arg\",\n    value: function arg() {\n      return Math.atan2(this.im, this.re);\n    }\n  }, {\n    key: \"conj\",\n    value: function conj() {\n      return new Complex(this.re, -this.im);\n    }\n  }, {\n    key: \"toFixed\",\n    value: function toFixed(digits) {\n      return new Complex(this.re.toFixed(digits), this.im.toFixed(digits));\n    }\n  }, {\n    key: \"sqrt\",\n    value: function sqrt() {\n      // https://en.wikipedia.org/wiki/Square_root#Algebraic_formula\n      var abs = this.abs();\n      return new Complex(_math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].sqrt(_math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].mul(_math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].add(abs, this.re), 0.5)), _math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].sqrt(_math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].mul(_math__WEBPACK_IMPORTED_MODULE_2__[\"default\"].sub(abs, this.re), 0.5)));\n    } // https://nodejs.org/api/util.html#util_util_inspect_custom\n\n  }, {\n    key: Symbol[\"for\"]('nodejs.util.inspect.custom'),\n    value: function value() {\n      return this.toString();\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      if (this.im == 0) return this.re.toString();\n      if (this.re == 0) return \"\".concat(this.im, \"j\");\n      if (this.im < 0) return \"\".concat(this.re, \" - \").concat(-this.im, \"j\");\n      return \"\".concat(this.re, \" + \").concat(this.im, \"j\");\n    }\n  }, {\n    key: \"valueOf\",\n    value: function valueOf() {\n      if (this.im == 0) return this.re;\n      return this;\n    }\n  }]);\n\n  return Complex;\n}();\n\n//# sourceURL=webpack://nd/./src/dt/complex.js?");

/***/ }),

/***/ "./src/dt/complex_array.js":
/*!*********************************!*\
  !*** ./src/dt/complex_array.js ***!
  \*********************************/
/*! exports provided: Complex128Array */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Complex128Array\", function() { return Complex128Array; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ \"./node_modules/@babel/runtime/helpers/typeof.js\");\n/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _complex__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./complex */ \"./src/dt/complex.js\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! util */ \"./node_modules/util/util.js\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_6__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nfunction createComplexArrayType(FloatArray) {\n  var HANDLER = {\n    get: function get(complexArray, property) {\n      if (_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_4___default()(property) !== 'symbol' && property % 1 === 0) return complexArray.get(property);\n      return complexArray[property];\n    },\n    set: function set(complexArray, property, value) {\n      if (_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_4___default()(property) !== 'symbol' && property % 1 === 0) {\n        complexArray.set(property, value);\n        return true; // <- FIXME bounds check?\n      }\n\n      complexArray[property] = value;\n      return true;\n    }\n  };\n\n  var ComplexArray = /*#__PURE__*/function () {\n    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(ComplexArray, null, [{\n      key: \"BYTES_PER_ELEMENT\",\n      get: function get() {\n        return FloatArray.BYTES_PER_ELEMENT * 2;\n      }\n    }, {\n      key: \"name\",\n      get: function get() {\n        return \"Complex\".concat(ComplexArray.BYTES_PER_ELEMENT * 8, \"Array\");\n      }\n    }]);\n\n    function ComplexArray(buffer, byteOffset, length) {\n      _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this, ComplexArray);\n\n      if (buffer % 1 === 0) {\n        length = buffer;\n        this._array = new FloatArray(length * 2);\n      } else {\n        if (null != length) length *= 2;\n        this._array = new FloatArray(buffer, byteOffset, length);\n      }\n\n      Object.seal(this);\n      return new Proxy(this, HANDLER);\n    }\n\n    _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(ComplexArray, [{\n      key: Symbol.iterator,\n      value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function value() {\n        var i;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function value$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                i = 0;\n\n              case 1:\n                if (!(i < this.length)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 4;\n                return this[i];\n\n              case 4:\n                i++;\n                _context.next = 1;\n                break;\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, value, this);\n      })\n    }, {\n      key: \"keys\",\n      value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function keys() {\n        var i;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function keys$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                i = 0;\n\n              case 1:\n                if (!(i < this.length)) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                _context2.next = 4;\n                return i;\n\n              case 4:\n                i++;\n                _context2.next = 1;\n                break;\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, keys, this);\n      })\n    }, {\n      key: \"values\",\n      value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function values() {\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function values$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.delegateYield(this[Symbol.iterator](), \"t0\", 1);\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, values, this);\n      })\n    }, {\n      key: \"entries\",\n      value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function entries() {\n        var i;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function entries$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                i = 0;\n\n              case 1:\n                if (!(i < this.length)) {\n                  _context4.next = 7;\n                  break;\n                }\n\n                _context4.next = 4;\n                return [i, this[i]];\n\n              case 4:\n                i++;\n                _context4.next = 1;\n                break;\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, entries, this);\n      })\n    }, {\n      key: \"forEach\",\n      value: function forEach(callback, thisArg) {\n        for (var i = 0; i < source.length; i++) {\n          callback.call(thisArg, source[i], i);\n        }\n      }\n    }, {\n      key: \"map\",\n      value: function map(mapFn, thisArg) {\n        return ComplexArray.from(this, mapFn, thisArg);\n      }\n    }, {\n      key: \"reduce\",\n      value: function reduce(reduceFn, initialValue) {\n        var i = 0;\n\n        if (null == initialValue) {\n          if (this.length == 0) throw new TypeError('TypeError: Reduce of empty array with no initial value.');\n          initialValue = this[i++];\n        }\n\n        for (; i < this.length; i++) {\n          initialValue = reduceFn(initialValue, this[i], i, this);\n        }\n\n        return initialValue;\n      }\n    }, {\n      key: \"slice\",\n      value: function slice(begin, end) {\n        if (null != begin) begin *= 2;\n        if (null != end) end *= 2;\n        return new ComplexArray(this._array.slice(begin, end).buffer);\n      }\n    }, {\n      key: \"subarray\",\n      value: function subarray(begin, end) {\n        if (null != begin) begin *= 2;\n        if (null != end) end *= 2;\n\n        var sub = this._array.subarray(begin, end);\n\n        return new ComplexArray(sub.buffer, sub.byteOffset, sub.length / 2);\n      }\n    }, {\n      key: \"join\",\n      value: function join(separator) {\n        if (null == separator) separator = ', ';\n        var result = '';\n\n        for (var i = 0; i < this.length; i++) {\n          if (i > 0) result += separator;\n          result += this[i].toString();\n        }\n\n        return result;\n      }\n    }, {\n      key: \"fill\",\n      value: function fill(value, start, end) {\n        if (!(value instanceof _complex__WEBPACK_IMPORTED_MODULE_5__[\"Complex\"])) value = new _complex__WEBPACK_IMPORTED_MODULE_5__[\"Complex\"](value);\n        if (null == start) start = 0;\n        if (null == end) end = this.length;\n        if (0 > end) end += this.length;\n        if (0 > start) start += this.length;\n\n        for (var i = this._array.length; (i -= 2) >= 0;) {\n          this._array[i + 1] = value.im;\n          this._array[i + 0] = value.re;\n        }\n\n        return this;\n      }\n    }, {\n      key: \"get\",\n      value: function get(index) {\n        return new _complex__WEBPACK_IMPORTED_MODULE_5__[\"Complex\"](this._array[2 * index + 0], this._array[2 * index + 1]);\n      }\n    }, {\n      key: \"set\",\n      value: function set(index, value) {\n        index *= 2;\n\n        if (typeof value === 'number' || !isNaN(value)) {\n          this._array[index + 0] = value;\n          this._array[index + 1] = isNaN(value) ? NaN : 0;\n          return;\n        }\n\n        if (!('re' in value) || !('im' in value)) value = new _complex__WEBPACK_IMPORTED_MODULE_5__[\"Complex\"](value);\n        this._array[index + 0] = value.re;\n        this._array[index + 1] = value.im;\n      }\n    }, {\n      key: Symbol[\"for\"]('nodejs.util.inspect.custom'),\n      value: function value(options) {\n        return 'Complex128Array ' + util.inspect(Array.from(this), options);\n      }\n    }, {\n      key: \"toString\",\n      value: function toString(max_len) {\n        return this.join(',');\n      }\n    }, {\n      key: \"buffer\",\n      get: function get() {\n        return this._array.buffer;\n      }\n    }, {\n      key: \"byteOffset\",\n      get: function get() {\n        return this._array.byteOffset;\n      }\n    }, {\n      key: \"byteLength\",\n      get: function get() {\n        return this._array.byteLength;\n      }\n    }, {\n      key: \"length\",\n      get: function get() {\n        return this._array.length >>> 1;\n      }\n    }, {\n      key: Symbol.toStringTag,\n      get: function get() {\n        throw new Error('not yet implemented.');\n      }\n    }], [{\n      key: \"from\",\n      value: function from(source, mapFn, thisArg) {\n        if (!source.hasOwnProperty('length')) source = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(source); // fast-copy complex arrays\n\n        if (null == mapFn) {\n          if (source instanceof ComplexArray) return new ComplexArray(FloatArray.from(source._array).buffer, 0, source.length);\n\n          if (source instanceof Int32Array || source instanceof Float32Array || source instanceof Float64Array) {\n            var array = new FloatArray(source.length * 2);\n\n            for (var i = source.length; i-- > 0;) {\n              array[i << 1] = source[i];\n            }\n\n            return new ComplexArray(array.buffer, 0, source.length);\n          }\n        }\n\n        var result = new ComplexArray(source.length);\n\n        mapFn = mapFn || function (x) {\n          return x;\n        };\n\n        for (var _i = 0; _i < source.length; _i++) {\n          result[_i] = mapFn.call(thisArg, source[_i], _i);\n        }\n\n        return result;\n      }\n    }, {\n      key: \"of\",\n      value: function of() {\n        var result = new ComplexArray(arguments.length);\n\n        for (var i = 0; i < arguments.length; i++) {\n          result[i] = i < 0 || arguments.length <= i ? undefined : arguments[i];\n        }\n\n        return result;\n      }\n    }]);\n\n    return ComplexArray;\n  }();\n\n  ;\n  return ComplexArray;\n}\n\nvar Complex128Array = createComplexArrayType(Float64Array);\n\n//# sourceURL=webpack://nd/./src/dt/complex_array.js?");

/***/ }),

/***/ "./src/dt/float64_utils.js":
/*!*********************************!*\
  !*** ./src/dt/float64_utils.js ***!
  \*********************************/
/*! exports provided: nextUp, nextDown, midl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"nextUp\", function() { return nextUp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"nextDown\", function() { return nextDown; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"midl\", function() { return midl; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _io__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../io */ \"./src/io/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nvar val = Float64Array.of(NaN),\n    bits = new Int32Array(val.buffer);\n/*DEBUG*/\n\nif (bits.length !== 2) throw new Error('Assertion failed.');\nfunction nextUp(x) {\n  x *= 1;\n  if (0 === x) return +Number.MIN_VALUE;\n  if (!(x < +Infinity)) // <- handles NaN and Infinity\n    return x;\n  val[0] = x;\n  var i = 1 - _io__WEBPACK_IMPORTED_MODULE_1__[\"IS_LITTLE_ENDIAN\"],\n      j = 1 * _io__WEBPACK_IMPORTED_MODULE_1__[\"IS_LITTLE_ENDIAN\"];\n\n  if (x > 0) {\n    bits[j] += -1 === bits[i];\n    bits[i] += 1;\n  } else {\n    bits[j] -= 0 === bits[i];\n    bits[i] -= 1;\n  }\n\n  return val[0];\n}\n;\nfunction nextDown(x) {\n  x *= 1;\n  if (0 === x) return -Number.MIN_VALUE;\n  if (!(x > -Infinity)) // <- handles NaN and Infinity\n    return x;\n  val[0] = x;\n  var i = 1 - _io__WEBPACK_IMPORTED_MODULE_1__[\"IS_LITTLE_ENDIAN\"],\n      j = 1 * _io__WEBPACK_IMPORTED_MODULE_1__[\"IS_LITTLE_ENDIAN\"];\n\n  if (x > 0) {\n    bits[j] -= 0 === bits[i];\n    bits[i] -= 1;\n  } else {\n    bits[j] += -1 === bits[i];\n    bits[i] += 1;\n  }\n\n  return val[0];\n}\nfunction midl(x, y) {\n  x *= 1;\n  y *= 1;\n  if (isNaN(x)) throw new Error('mid(x,y): x must be number.');\n  if (isNaN(y)) throw new Error('mid(x,y): x must be number.');\n\n  if (Math.sign(x) * y < 0) // <- check for opposite signs\n    {\n      var mid = (x + y) / 2; // <- avoids underflow if e.g x=+MAX_VALUE, y=-MAX_VALUE\n\n      if (!(mid < Math.max(x, y))) throw new Error('Assertion failed.');\n      if (!(mid > Math.min(x, y))) throw new Error('Assertion failed.');\n      return mid;\n    } else {\n    var _ref = Math.abs(x) <= Math.abs(y) ? [x, y] : [y, x],\n        _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 2),\n        a = _ref2[0],\n        b = _ref2[1]; // Returns the mid point between two floats (x,y) or x if there is no mid point\n\n\n    var _mid = a + (b - a) * 0.5; // <- avoids underflow if e.g x=y=MAX_VALUE\n\n\n    if (!(_mid <= Math.max(x, y))) throw new Error('Assertion failed.');\n    if (!(_mid >= Math.min(x, y))) throw new Error('Assertion failed.');\n    if (_mid === y) return x;\n    return _mid;\n  }\n}\n\n//# sourceURL=webpack://nd/./src/dt/float64_utils.js?");

/***/ }),

/***/ "./src/dt/index.js":
/*!*************************!*\
  !*** ./src/dt/index.js ***!
  \*************************/
/*! exports provided: Complex, Complex128Array, ARRAY_TYPES, eps, cast_scalar, _check_dtype, dtypeof, super_dtype, is_subdtype */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ARRAY_TYPES\", function() { return ARRAY_TYPES; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eps\", function() { return eps; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cast_scalar\", function() { return cast_scalar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_check_dtype\", function() { return _check_dtype; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dtypeof\", function() { return dtypeof; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"super_dtype\", function() { return super_dtype; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"is_subdtype\", function() { return is_subdtype; });\n/* harmony import */ var _complex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./complex */ \"./src/dt/complex.js\");\n/* harmony import */ var _complex_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./complex_array */ \"./src/dt/complex_array.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Complex\", function() { return _complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Complex128Array\", function() { return _complex_array__WEBPACK_IMPORTED_MODULE_1__[\"Complex128Array\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nvar ARRAY_TYPES = {\n  'int32': Int32Array,\n  'float32': Float32Array,\n  'float64': Float64Array,\n  'complex128': _complex_array__WEBPACK_IMPORTED_MODULE_1__[\"Complex128Array\"],\n  'object': Array\n};\nfunction eps(dtype) {\n  _check_dtype(dtype);\n\n  switch (dtype) {\n    case 'complex128':\n      return new _complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"](Number.EPSILON);\n\n    case 'float32':\n      return 1.1920928955078125e-7;\n\n    default:\n      return Number.EPSILON;\n  }\n}\nfunction cast_scalar(x, dtype) {\n  if (dtype === 'int32') return x & 0xFFFFFFFF;\n  if (dtype === 'float32') return Math.fround(x);\n  if (dtype === 'complex128') return x instanceof _complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x : new _complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"](x);\n  return x * 1;\n}\nfunction _check_dtype(dtype) {\n  if (!ARRAY_TYPES.hasOwnProperty(dtype)) throw new Error(\"Invalid dtype '\" + dtype + \"'. Must be one of {'\" + Object.getOwnPropertyNames(ARRAY_TYPES).join(\"', '\") + \"'}.\");\n}\nfunction dtypeof(value) {\n  if (value % 1 === 0) {\n    if (value <= ~(1 << 31) && value >= 1 << 31) return 'int32';\n    return 'object';\n  }\n\n  if (value * 1 == value) return 'float64';\n  if (value instanceof _complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return 'complex128';\n  return 'object';\n}\nvar super_dtype = function super_dtype() {\n  for (var _len = arguments.length, dtypes = new Array(_len), _key = 0; _key < _len; _key++) {\n    dtypes[_key] = arguments[_key];\n  }\n\n  return dtypes.reduce(function (dtype1, dtype2) {\n    _check_dtype(dtype1);\n\n    _check_dtype(dtype2);\n\n    if (dtype1 === 'object' || dtype2 === 'object') return 'object';\n    if (dtype1 === 'complex128' || dtype2 === 'complex128') return 'complex128';\n    if (dtype1 === 'float64' || dtype2 === 'float64') return 'float64';\n    if (dtype1 === 'float32' || dtype2 === 'float32') return 'float32';\n    return 'int32';\n  });\n};\nfunction is_subdtype(sub_dtype, sup_dtype) {\n  _check_dtype(sub_dtype);\n\n  _check_dtype(sup_dtype);\n\n  var rank = {\n    'int32': 0,\n    'float32': 1,\n    'float64': 2,\n    'complex128': 3,\n    'object': 4\n  };\n  return rank[sub_dtype] <= rank[sup_dtype];\n}\n\n//# sourceURL=webpack://nd/./src/dt/index.js?");

/***/ }),

/***/ "./src/dt/mutable_complex.js":
/*!***********************************!*\
  !*** ./src/dt/mutable_complex.js ***!
  \***********************************/
/*! exports provided: MutableComplex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MutableComplex\", function() { return MutableComplex; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nvar MutableComplex = /*#__PURE__*/function () {\n  function MutableComplex(re, im) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, MutableComplex);\n\n    this.re = re * 1.0;\n    this.im = im * 1.0;\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(MutableComplex, [{\n    key: \"abs\",\n    value: function abs() {\n      return Math.hypot(this.re, this.im);\n    }\n  }, {\n    key: '/=',\n    value: function _(re, im) {\n      if (im === 0) {\n        this.re /= re;\n        this.im /= re;\n      } else {\n        var this_re = this.re;\n\n        if (Math.abs(re) >= Math.abs(im)) {\n          var R = im / re;\n          this.re = (this_re + this.im * R) / (re + im * R);\n          this.im = (this.im - this_re * R) / (re + im * R);\n        } else {\n          var _R = re / im;\n\n          this.re = (this_re * _R + this.im) / (re * _R + im);\n          this.im = (this.im * _R - this_re) / (re * _R + im);\n        }\n      }\n    }\n  }, {\n    key: '= c0*c1',\n    value: function c0C1(re0, im0, re1, im1) {\n      this.re = re0 * re1 - im0 * im1;\n      this.im = re0 * im1 + im0 * re1;\n    }\n  }, {\n    key: '-= c0*c1',\n    value: function c0C1(re0, im0, re1, im1) {\n      this.re -= re0 * re1 - im0 * im1;\n      this.im -= re0 * im1 + im0 * re1;\n    } //\n    //  ['/= c0']( re, im )\n    //  {\n    //    throw new Error('Not yet implemented!');\n    //  }\n    //  add( re, im ) {\n    //    if( null == re ) re = 0.0;\n    //    if( null == im ) im = 0.0;\n    //    if( re.re != null ||\n    //        re.im != null ) {\n    //      im = re.im || 0;\n    //      re = re.re || 0;\n    //    }\n    //    return new Complex(\n    //      this.re + re,\n    //      this.im + im\n    //    );\n    //  }\n    //\n    //  sub( re, im ) {\n    //    if( null == re ) re = 0.0;\n    //    if( null == im ) im = 0.0;\n    //    if( re.re != null ||\n    //        re.im != null ) {\n    //      im = re.im || 0;\n    //      re = re.re || 0;\n    //    }\n    //    return new Complex(\n    //      this.re - re,\n    //      this.im - im\n    //    );\n    //  }\n    //\n    //  mul( re, im ) {\n    //    if( null == re ) re = 0.0;\n    //    if( null == im ) im = 0.0;\n    //    if( re.re != null ||\n    //        re.im != null ) {\n    //      im = re.im || 0;\n    //      re = re.re || 0;\n    //    }\n    //    return new Complex(\n    //      this.re*re - this.im*im,\n    //      this.re*im + this.im*re\n    //    );\n    //  }\n    //\n    //  div( re, im ) {\n    //    if( null == re ) re = 0.0;\n    //    if( null == im ) im = 0.0;\n    //    if( re.re != null ||\n    //        re.im != null ) {\n    //      im = re.im || 0;\n    //      re = re.re || 0;\n    //    }\n    //    if( im == 0 ) return new Complex(this.re/re, this.im/re);\n    //\n    ////    return new Complex(\n    ////      (this.re*re + this.im*im) / (re*re + im*im),\n    ////      (this.im*re - this.re*im) / (re*re + im*im)\n    ////    );\n    //\n    //    if( Math.abs(re) >= Math.abs(im) )\n    //    {\n    //      const R = im / re;\n    //      return new Complex(\n    //        (this.re + this.im*R) / (re + im*R),\n    //        (this.im - this.re*R) / (re + im*R)\n    //      );\n    //    } else {\n    //      const R = re / im;\n    //      return new Complex(\n    //        (this.re*R + this.im) / (re*R + im),\n    //        (this.im*R - this.re) / (re*R + im)\n    //      );        \n    //    }\n    //  }\n    //\n    //  equals( re, im ) {\n    //    if( null == re ) re = 0.0;\n    //    if( null == im ) im = 0.0;\n    //    if( re.re != null ||\n    //        re.im != null ) {\n    //      im = re.im || 0;\n    //      re = re.re || 0;\n    //    }\n    //    return this.re == re\n    //        && this.im == im;\n    //  }\n    //\n    //  abs() {\n    //    return Math.hypot(this.re, this.im);\n    //  }\n    //\n    //  arg() {\n    //    return Math.atan2(this.im, this.re);\n    //  }\n    //\n    //  conj() {\n    //    return new Complex(this.re, -this.im );\n    //  }\n    //\n    //  toFixed(digits) {\n    //    return new Complex(\n    //      this.re.toFixed(digits),\n    //      this.im.toFixed(digits)\n    //    );\n    //  }\n    //\n    //  sqrt() {\n    //    // https://en.wikipedia.org/wiki/Square_root#Algebraic_formula\n    //    const abs = this.abs();\n    //    return new Complex(\n    //      math.sqrt( math.mul( math.add(abs,this.re), 0.5 ) ),\n    //      math.sqrt( math.mul( math.sub(abs,this.re), 0.5 ) )\n    //    );\n    //  }\n    // https://nodejs.org/api/util.html#util_util_inspect_custom\n\n  }, {\n    key: Symbol[\"for\"]('nodejs.util.inspect.custom'),\n    value: function value() {\n      return this.toString();\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      if (this.im == 0) return this.re.toString();\n      if (this.re == 0) return \"\".concat(this.im, \"j\");\n      if (this.im < 0) return \"\".concat(this.re, \" - \").concat(-this.im, \"j\");\n      return \"\".concat(this.re, \" + \").concat(this.im, \"j\");\n    }\n  }]);\n\n  return MutableComplex;\n}();\n\n//# sourceURL=webpack://nd/./src/dt/mutable_complex.js?");

/***/ }),

/***/ "./src/geom/index.js":
/*!***************************!*\
  !*** ./src/geom/index.js ***!
  \***************************/
/*! exports provided: regular_simplex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _simplex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./simplex */ \"./src/geom/simplex.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"regular_simplex\", function() { return _simplex__WEBPACK_IMPORTED_MODULE_0__[\"regular_simplex\"]; });\n\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n//# sourceURL=webpack://nd/./src/geom/index.js?");

/***/ }),

/***/ "./src/geom/simplex.js":
/*!*****************************!*\
  !*** ./src/geom/simplex.js ***!
  \*****************************/
/*! exports provided: regular_simplex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"regular_simplex\", function() { return regular_simplex; });\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction regular_simplex(dtype, N) {\n  if (null == N) {\n    N = dtype;\n    dtype = 'float64';\n  } else {\n    if (!(dtype in _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"])) throw new Error(\"regular_simplex(dtype,N): dtype '\".concat(dtype, \"' not supported.\"));\n    if (dtype.startsWith('int')) throw new Error(\"regular_simplex(dtype,N): dtype must not be integral.\");\n  }\n\n  if (N % 1 !== 0) throw new Error('regular_simplex(N): N must be a valid integer.');\n  if (!(0 < N)) throw new Error('regular_simplex(N): N must be greater than 0.');\n  N |= 0;\n  var V = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype]((N + 1) * N),\n      shape = Int32Array.of(N + 1, N); // The idea of the algorithm is to \"recursively\" build an i-simplex from an (i-1)\n  // simplex. To do that we find the center of the (i-1)-simplex and move from there\n  // along a new coordinate axis (x[i-1]-axis).\n\n  for (var i = 1; i < N + 1; i++) {\n    for (var j = 0; j < i - 1; j++) {\n      V[N * i + j] = V[N * (i - 1) + j];\n    }\n\n    V[N * i + (i - 2)] /= i; // <- there is (i-1) points at x[i-2]=0 and 1 point at x[i-2]=V[N*i+(i-2)], i.e. the midpoint is at 1/i along the x[i-2]-axis\n\n    V[N * i + (i - 1)] = Math.sqrt((i + 1) / (2 * i)); // <- height of the i-simplex, see: https://math.stackexchange.com/questions/1697870/height-of-n-simplex\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"](shape, V);\n}\n\n//# sourceURL=webpack://nd/./src/geom/simplex.js?");

/***/ }),

/***/ "./src/help.js":
/*!*********************!*\
  !*** ./src/help.js ***!
  \*********************/
/*! exports provided: math, concat, array, asarray, NDArray, rand_normal, stack, tabulate, zip_elems, dt, geom, integrate, io, iter, la, opt, rand, spatial, help, help_str */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"help\", function() { return help; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"help_str\", function() { return help_str; });\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! . */ \"./src/index.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"math\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"math\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"concat\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"concat\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"array\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"array\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"asarray\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"asarray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NDArray\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rand_normal\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"rand_normal\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"stack\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"stack\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tabulate\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"zip_elems\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"zip_elems\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"dt\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"dt\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"geom\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"geom\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"integrate\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"integrate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"io\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"io\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"iter\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"iter\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"la\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"la\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"opt\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"opt\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rand\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"rand\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"spatial\", function() { return ___WEBPACK_IMPORTED_MODULE_0__[\"spatial\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n___WEBPACK_IMPORTED_MODULE_0__[\"help_str\"] = function (func_or_obj) {\n  return func_or_obj.__doc__ || 'No documentation available.';\n};\n\n___WEBPACK_IMPORTED_MODULE_0__[\"help\"] = function (func_or_obj) {\n  return console.log(___WEBPACK_IMPORTED_MODULE_0__[\"help_str\"](func_or_obj));\n};\n\n\nvar help = ___WEBPACK_IMPORTED_MODULE_0__[\"help\"];\nvar help_str = ___WEBPACK_IMPORTED_MODULE_0__[\"help_str\"];\n___WEBPACK_IMPORTED_MODULE_0__[\"dt\"].Complex.__doc__ = \"Rudimentary implementation of the Complex number type, used\\nmainly for the calculation of eigenvalues. Other than that,\\ncomplex dtype is not yet supported in NDJS.\\n\"; //\n// FACTORY METHODS\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].constructor.__doc__ = \"Creates a new NDArray with given shape and data array. This\\nconstructor may not create any protection copies of the given\\ndata but use it directly instead. This method is intended\\nfor internal use mostly. More user-friendly and convenient\\nfactory methods are available like nd.array, nd.tabulate or\\nNDArray.from.\\n\\nWARNING: This method freezes the buffer that's underlying the shape it's given.\\n\\nParameters\\n----------\\nshape: Int32Array\\n  The shape of new NDArray. May be used directly (no protection\\n  copy may be perfomed). The buffer behind this Int32Array will be frozen.\\ndata: dtype[]\\n  The flat data array to be used in this NDArray. May be used\\n  directly (no protection copy may be performed).\\n\\nReturns\\n-------\\nndarray: NDArray\\n  A new NDArray.\\n\\nExamples\\n--------\\n>>> a = new NDArray([2,3,2], [111,112,121,122,131,132,211,212,221,222,231,232])\\n>>> console.log( a.toString() )\\n  [[[111,112],\\n    [121,122],\\n    [131,132]],\\n   [[211,212],\\n    [221,222],\\n    [231,232]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"zip_elems\"].__doc__ = \"Creates a new NDArray from one or more NDArrays, using a function to\\nmerge the values of the NDArray(s) to the values of the new NDArray.\\n\\nThis can be used to perform unary (sin, cos, exp, ...) and binary\\n(+, -, *, ...) operations.\\n\\nThis method supports NumPy-style broadcasting of the NDArray arguments.\\n\\nParameters\\n----------\\nndarray: NDArray or NDArray[]\\n  The NDArray or list of NDArrays from which the new NDArray is built.\\ndtype: String\\n  [OPTIONAL] The data type of the new NDArray.\\nmapper: (...values, ...indices) => dtype\\n  A function used to determine the entry values of the new NDArray from\\n  the entry values of the old NDArray(s). May be omitted if only a single\\n  NDArray is given by ndarray, in which case the entry values are copied.\\n\\nReturns\\n-------\\nndarray: NDArray\\n  The newly created NDArray, where:\\n  ndarray(i0,i1,...,i[n]) = mapper(ndarray[0](i0,i1,...,i[n]), ndarray[1](i0,i1,...,i[n]), ..., ndarray[m](i0,i1,...,i[n]), i0,i1,...,i[n]).\\n\\nExamples\\n--------\\n>>> let a = nd.array([1,2,3,4])\\n>>> let b = nd.zip_elems(a, x => x*x)\\n>>> console.log( b.toString() )\\n  [1, 4, 9, 16]\\n\\n\\n>>> let c = nd.array([[1],[2]])\\n>>> let d = nd.array([1,2,3,4])\\n>>> let e = zip_elems([c,d], (x,y) => 10*x+y )\\n>>> console.log( e.toString() )\\n  [[11,12,13,14],\\n   [21,22,23,24]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"array\"].__doc__ = \"Tries to heuristically create an NDArray from the input. This\\nmethod is usually used to create NDArrays nested arrays, which\\nallows for a creation of NDArray which is well readable by\\nhumans.\\n\\n  * If the input is an object containing a 'shape' and 'data'\\n    property, a new NDArray is created using said shape and data\\n    directly (creating a protection copy of data).\\n  * If the input is a (possibly nested) JavaScript array-like, it\\n    is converted to an NDArray, copying the array data in the\\n    process. The nesting defines the shape of the resulting\\n    NDArray. \\n  * Otherwise the data is interpreted as a scalar value and\\n    is put into an NDArray of shape [].\\n\\nParameters\\n----------\\ndtype: String\\n  [Optional] The dtype of the returned NDArray.\\ncontent: { length: int[], data: dtype[] } or dtype or dtype[] or dtype[][] or ...\\n  The content of the returned NDArray.\\n\\nReturns\\n-------\\nndarray: NDArray\\n  An NDArray representation of the content.\\n\\nExamples\\n--------\\n>>> let content = { shape: [2,3], data: [1,2,3,4,5,6] }\\n>>> let a = nd.array(content)\\n>>> console.log( a.toString() )\\n  [[1,2,3],\\n   [4,5,6]]\\n>>> content.data[3] = 7\\n>>> console.log( a.toString() )\\n  [[1,2,3],\\n   [7,5,6]]\\n\\n\\n>>> let content = { shape: [2,3], data: [1,2,3,4,5,6] }\\n>>> let a = nd.array('int32',content)\\n>>> console.log( a.toString() )\\n  [[1,2,3],\\n   [4,5,6]]\\n>>> content.data[3] = 7\\n>>> console.log( a.toString() )\\n  [[1,2,3],\\n   [4,5,6]]\\n\\n\\n>>> let a = nd.array([\\n...   [1,2,3,4],\\n...   [5,6,7,8]\\n... ])\\n>>> console.log( a.toString() )\\n  [[1,2,3,4],\\n   [5,6,7,8]]\\n\\n\\n>>> console.log( nd.array(12) )\\n  { [NDArray: self] shape: [], data: Int32Array[12] }\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"asarray\"].__doc__ = \"Similar to `nd.array(content)` except that input is not copied if\\nit already is an `NDArray`.\\n\\nParameters\\n----------\\ncontent: { length: int[], data: dtype[] } or dtype or dtype[] or dtype[][] or ...\\n  The content of the returned NDArray.\\n\\nReturns\\n-------\\nndarray: NDArray\\n  `ndarray = content instanceof NDArray ? content : nd.array(content);`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"tabulate\"].__doc__ = \"Creates a new NDArray of the given shape, calling a function for\\neach entry index and using the returned value as entry value of\\nthe new NDArray.\\n\\nParameters\\n----------\\nshape: int[]\\n  The shape of the new NDArray.\\ndtype: String\\n  [OPTIONAL] The data type of the newly created NDArray.\\nidx2val: (...int) => dtype\\n  The function returning the entry value for a given entry index as input.\\n\\nReturns\\n-------\\nndarray: NDArray\\n  The newly tabulated NDArray, where:\\n  ndarray(i0,i1,...,i[n]) = idx2val(i0,i1,...i[n])\\n\\nExamples\\n--------\\n>>> let a = nd.tabulate([3,2], (i,j) => 10*(i+1) + (j+1) )\\n>>> console.log( a.toString() )\\n  [[11,12],\\n   [21,22],\\n   [31,32]]\\n\"; //\n// GENERAL\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].__doc__ = \"An n-dimensional, axis-aligned grid of entries, very similar\\nto NumPy ndarrays in Python.\\n\\nAttributes\\n----------\\nshape: int[]\\n  The shape of the NDArray.\\ndata : dtype[]\\n  The flat data array backing this NDArray. May be either\\n  a standard JavaScript Array, or one of JavaScripts primitive\\n  array types. See nd.dtypes for a list of supported data types.\\nndim: int\\n  The number of dimensions in this NDArray, i.e. the number of\\n  indices used to address the entries. Equivalent to shape.length.\\n  \\ndtype: String\\n  The data type of this NDArray. Specifies which type of values\\n  may be stored in the NDArray. See nd.dtypes for the available\\n  data types and their respective (primitive) array types.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.call.__doc__ = \"Returns the value of the entry specified by the given index.\\n\\nParameters\\n----------\\nthis: NDArray\\n  The array whose entry is being read.\\nindices: ...int\\n  The multi-index of the entry whose value is to be returned.\\n\\nReturns\\n-------\\nvalue: dtype\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2,3],[4,5,6]])\\n>>> console.log( a(0,0), a(0,1), a(0,2), a(1,0), a(1,1), a(1,2) )\\n  1 2 3 4 5 6\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.apply.__doc__ = ___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.call.__doc__;\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.set.__doc__ = \"Sets the value of the specified entry to the given value.\\n\\nParameters\\n----------\\nindices: int[]\\n  The multi index of the entry that is to be changed.\\nvalue: dtype\\n  The new value for the entry at indices.\\n\\nExamples\\n--------\\n>>> let a = nd.array([ [0,0,0], [0,0,0], [0,0,0] )\\n>>> a.set([0,0], 1)\\n>>> a.set([0,1], 2)\\n>>> a.set([1,1], 3)\\n>>> a.set([2,2], 4)\\n>>> console.log( a.toString() )\\n  [[1,2,0],\\n   [0,3,0],\\n   [0,0,4]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.modify.__doc__ = \"Modifies an array entriy by applying the given functions to it.\\nThis method call is equivalent to:\\n`ndarray.set( indices, modifier(ndarray(...indices), ...indices) )`\\n\\nParameters\\n----------\\nindices: int[]\\n  The multi index of the entry that is to modified.\\nmodifier: (dtype, ...int) => dtype\\n  The function that is applied to the NDArray entry.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.toString.__doc__ = \"Returns a readable string representation of this NDArray.\\n\\nParameters\\n----------\\nmax_len: int\\n  [OPTIONAL] The maximum number of elements along each to be represented\\n  in the String. If there is more elements along an axis than that, an\\n  ellipsis (...) is inserted instead of the central elements.\\n\\nReturns\\n-------\\nrepr: String\\n  A readable string representation of this nd.Arrray.\\n\\nExamples\\n--------\\n>>> let a = nd.tabulate([6,6], (i,j) => 10*(i+1) + (j+1) )\\n>>> console.log( a.toString() )\\n  [[11,12,13,14,15,16],\\n   [21,22,23,24,25,26],\\n   [31,32,33,34,35,36],\\n   [41,42,43,44,45,46],\\n   [51,52,53,54,55,56],\\n   [61,62,63,64,65,66]]\\n\\n>>> console.log( a.toString(4) )\\n  [[11, 12, ...2 more..., 15, 16],\\n   [21, 22, ...2 more..., 25, 26],\\n    ...2 more...,\\n   [51, 52, ...2 more..., 55, 56],\\n   [61, 62, ...2 more..., 65, 66]]\\n\"; //\n// ITERATIONS\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype[Symbol.iterator].__doc__ = \"Returns an iterator that iterates through the slices of this NDArray along\\nthe first axis. Equivalent to:\\n\\nfunction*() {\\n  for( let i=0; i < this.shape[0]; i++ )\\n    yield this.slice(i)\\n}\\n\\nReturns\\n-------\\niter: Iterator\\n  An iterator that yields the slices of this NDArray along its first axis.\\n\\nExamples\\n--------\\n>>> a = nd.array([[1,2],[3,4],[5,6]])\\n>>> for( let row of a )\\n...   console.log( row.toString() )\\n  [1,2]\\n  [3,4]\\n  [5,6]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.forEach.__doc__ = \"Calls the given callback for each slice of this NDArray along the\\nfirst axis. Equivalent to:\\n\\nfor( let i=0; i < this.shape[0]; i++ )\\n  consumer( this.slice(i), i )\\n\\nParameters\\n----------\\nconsumer: (slice: NDArray, index: int) => ()\\n  The callback to be called for each slice of this NDArray along the first axis.\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2,3],[4,5,6]])\\n>>> a.forEach( (row,i) => console.log(`${i} -> ${row}`) )\\n  0 -> [1,2,3]\\n  1 -> [4,5,6]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.elems.__doc__ = \"Returns an iterator of all multiindex-value pairs of entries in\\nthis NDArray.\\n\\nReturns\\n-------\\niter: *[[...int], dtype]\\n  An iterator of multiindex-value pairs, one for each entry in this\\n  NDArray.\\n\\nExamples\\n--------\\n>>> a = nd.array([[1,2,3],[4,5,6]])\\n>>> for( let [[i,j],a_ij] of a.entries() )\\n...   console.log(`a[${i},${j}] = ${val}`)\\n  a[0,0] = 1\\n  a[0,1] = 2\\n  a[0,2] = 3\\n  a[1,0] = 4\\n  a[1,1] = 5\\n  a[1,2] = 6\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.forElems.__doc__ = \"Calls the given callback for each entry in this NDArray.\\n\\nParameters\\n----------\\nconsumer: (val: dtype, indices: ...int) => ()\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2,3],[4,5,6]])\\n>>> a.forEntries( (a_ij,i,j) => console.log(`a[${i},${j}] = ${a_ij}`) )\\n  a[0,0] = 1\\n  a[0,1] = 2\\n  a[0,2] = 3\\n  a[1,0] = 4\\n  a[1,1] = 5\\n  a[1,2] = 6\\n\"; //\n// TRANSFORMATION\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.valueOf.__doc__ = \"\\nIf this NDArray is scalar (shape == []), the only entry's value is returned,\\notherwise this NDArray itself is returned.\\n\\nThis method rarely has to be called explicitly but is used by JavaScript\\nwhenever it deems it appropriate.\\n\\nReturns\\n-------\\nvalue: dtype or NDArray\\n  Returns the only entry if this NDArray is scalar. Returns this otherwise.\\n\\nExample\\n-------\\n>>> a = nd.array(12)\\n>>> console.log( a+1 )\\n  13\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.mapElems.__doc__ = \"Creates a new NDArray by applying the given mapping function to each entry\\nof this array and writing the results back into a new array.\\n\\nEquivalent to NDArray.from(this, dtype, mapper).\\n\\nParameters\\n----------\\ndtype: String\\n  [OPTIONAL] The data type of the newly created NDArray.\\nmapper: (value, ...indices) => dtype\\n  The function used to map the old NDArray's entries to the values of the\\n  new NDArray.\\n\\nReturns\\n-------\\nmapped: NDArray\\n  The newly created NDArray, where:\\n  mapped(i0,i1,...,i[n]) = mapper(this(i0,i1,...,i[n]), i0,i1,...,i[n]).\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2],[3,4]])\\n>>> let b = a.mapElems( x => x*x )\\n>>> console.log( b.toString() )\\n  [[1, 4],\\n   [9,16]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.transpose.__doc__ = \"Reorders the axes of this NDArray. By default the last two axes are\\nswapped.\\n\\nParameters\\n----------\\naxes: ...int\\n  The order in which the axes of the this NDArray appear in the\\n  transposed array. If indices are missing from `axes`, they are\\n  appended to `axes` in order.\\n\\nReturns\\n-------\\ntransposed: NDArray\\n  A transposed copy A of this NDArray, where:\\n  `A[i[0], i[1], ...]  =  this[i[axes[0]], i[axes[1], ...]`\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2,3]])\\n>>> console.log( a.transpose() )\\n  [[1],\\n   [2],\\n   [3]]\\n\\n>>> let a = nd.array([ [[1,2,3], [4,5,6]], [[7,8,9], [10,11,12]] ])\\n>>> console.log( a.transpose(2).toString() )\\n  [[[ 1,  4],\\n    [ 7, 10]],\\n   [[ 2,  5],\\n    [ 8, 11]],\\n   [[ 3,  6],\\n    [ 9, 12]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.reshape.__doc__ = \"Returns view of this NDArray with a different shape. This is similar\\nto NumPy's reshape with a 'C'-order.\\n\\nParameters\\n----------\\nshape: ...int\\n  The shape of the view. May contain a single -1 entry, in which case\\n  the respective axis' size is inferred.\\n\\nReturns\\n-------\\nreshaped: NDArray\\n  A reshaped view of this NDArray.\\n\\nExamples\\n--------\\n>>> let a = nd.array([1,2,3,4,5,6,7,8,9])\\n>>> let b = a.reshape(3,-1)\\n>>> console.log( b.toString() )\\n  [[1,2,3],\\n   [4,5,6],\\n   [7,8,9]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.reduceElems.__doc__ = \"Uses the given binary operator to reduce the entries of of this NDArray\\nalong the specified axes. If no axes are specified all entries are reduce\\nto a single value and said value is returned instead of an NDArray.\\n\\nParameters\\n----------\\naxes: int or int[]\\n  [OPTIONAL] The axes along which the array is to be reduced. If not defined\\n  the NDArray is reduced along all axes and a scalar value is returned instead\\n  of an NDArray.\\ndtype: String\\n  The data type of the reduced NDArray. Has to be a super-dtype of the original\\n  NDArray.\\nreducer: (dtype,dtype) => dtype\\n  The function used to reduce the entries along the axes.\\n\\nReturns\\n-------\\nreduced: NDArray or dtype\\n  The reduced NDArray if axes were specified or the reduced value id no\\n  axes were specified.\\n\\nExamples\\n--------\\n>>> let a = nd.array([\\n...   [1,2,3],\\n...   [4,5,6]\\n... ])\\n>>> console.log( a.reduce( (x,y) => x+y ) )\\n  21\\n\\n\\n>>> console.log( a.reduce( [0,1], (x,y) => x+y ) )\\n  { [NDArray: self] shape: [], data: [21] }\\n\\n>>> console.log( a.reduce( 0, (x,y) => x+y ).toString() )\\n  [5,7,9]\\n\\n>>> console.log( a.reduce( [1], (x,y) => x+y ).toString() )\\n  [6,15]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"].prototype.sliceElems.__doc__ = \"Extracts a sub-region specified by combination of indices, ranges, newaxis symbols.\\n\\nParameters\\n----------\\nslices: int or nd.newaxis or nd.ellipsis or [start,stop,step]\\n  The slices to be taken along each axis, e.g 3 would only take the fourth entries\\n  along an axis, [,,] would take all elements along and axis, [1,,] would take all\\n  but the first entries along an axis, [,,3] would take ever third element along\\n  an axis, [,-1,] would take all but the last entries along an axis, nd.newaxis\\n  would insert a new axis of size 1.\\n\\n  nd.ellipsis can be used to fill up with [,,] for the remaining axes.\\n\\nReturns\\n-------\\nsliced: NDArray\\n  A sliced subregion of this NDArray.\\n\\nExamples\\n--------\\n>>> let a = nd.array([\\n...   [11,12,13,14],\\n...   [21,22,23,24],\\n...   [31,32,33,34]\\n... ])\\n>>> console.log( a.sliceElems('...', -2).toString() )\\n  [13, 23, 33]\\n\\n>>> console.log( a.sliceElems([,,2]).toString() )\\n  [[11,12,13,14],\\n   [31,32,33,34]]\\n\\n>>> console.log( a.sliceElems(2,[1,3,]).toString() )\\n  [32,33]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"stack\"].__doc__ = \"Arranges a list of NDArrays into a new NDArray. The NDArrays are stacked\\nalong a newly axis, inserted at the specified index. All stacked NDArrays\\nmust have the same shape.\\n\\nParameters\\n----------\\naxis: int\\n  [OPTIONAL] The index at which the new index is to be inserted. Default value: 0.\\ndtype: String\\n  [OPTIONAL] The type of the stacked NDArray. Should be a super-dtype of all NDArrays'\\n  dtypes.\\nndarrays: NDArray[]\\n  The NDArrays that are to be stacked. All NDArrays must have the same shape.\\n\\nReturns\\n-------\\nstacked: NDArray\\n\\nExamples\\n--------\\n>>> let a = nd.array([1,2,3])\\n>>> let b = nd.array([4,5,6])\\n>>> console.log( nd.stack([a,b]).toString )\\n  [[1,2,3],\\n   [4,5,6]]\\n\\n>>> console.log( nd.stack(1,'float64',[a,b]).toString )\\n  [[1.0, 4.0],\\n   [2.0, 5.0],\\n   [3.0, 6.0]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"concat\"].__doc__ = \"Arranges a list of NDArrays into a new NDArray. The NDArrays are concatenated\\nalong an existing specified axis. Aside from said axis, the shape of all NDArrays\\nmust be the same.\\n\\nParameters\\n----------\\naxis: int\\n  [OPTIONAL] The axis along which the NDArrays are concatenated. Default value: 0.\\ndtype: String\\n  [OPTIONAL] The type of the concatenated NDArray. Should be a super-dtype of all NDArrays'\\n  dtypes.\\nndarrays: NDArray[]\\n  The NDArrays that are to be concatenated. All NDArrays must have the same shape.\\n\\nReturns\\n-------\\nconcatenated: NDArray\\n\\n\\nExamples\\n--------\\n>>> let a = nd.array([[1,2],[3,4]])\\n>>> let b = nd.array([[5,6],[7,8]])\\n>>> console.log( nd.concat([a,b]).toString() )\\n  [[1,2],\\n   [3,4],\\n   [5,6],\\n   [7,8]]\\n   \\n>>> console.log( nd.concat(1,[a,b]).toString() )\\n  [[1,2,5,6],\\n   [3,4,7,8]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"help\"].__doc__ = \"Outputs a documentation string for the given method ND.JS method to the console. This method\\nis intended to be used in interactive mode to explore and learn the ND.JS API.\\n\\nThis method is only available in the non-minfied version of ND.JS.\\n\\nParameters\\n----------\\nfun: Function\\n  The function or package ND.JS API method for which the documentation is to be retrieved.\\n\\nExamples\\n--------\\n>>> nd.help(nd.la)\\n  The Linear Algebra subpackage of ND.JS. Contains methods for the handling and decomposition\\n  of matrices as well as solvers for linear equations and linear least square systems.\\n\\n  As convention the last two axes of an `NDArray` are considered as the matrix dimensions.\\n  Higher dimensional arrays are considered \\\"arrays of matrices\\\" and the broadcasting rules\\n  apply for the leading dimenions, i.e. for all dimensions of the shape except the last two.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"help_str\"].__doc__ = \"Returns a documentation string for the given method ND.JS method to the console. This method\\nis used by `create_doc_jsdom()` to create the documentation and by `nd.help()` to\\nprint help to the console.\\n\\nThis method is only available in the non-minfied version of ND.JS.\\n\\nParameters\\n----------\\nfun: Function\\n  The function or package ND.JS API method for which the documentation is to be retrieved.\\n\\nReturns\\n-------\\nhelp: String\\n  A documentation String for the given method or package.\\n\\nExamples\\n--------\\n>>> console.log( nd.help(nd.la) )\\n  \\\"The Linear Algebra subpackage of ND.JS. Contains methods for the handling and decomposition\\n   of matrices as well as solvers for linear equations and linear least square systems.\\n\\n   As convention the last two axes of an `NDArray` are considered as the matrix dimensions.\\n   Higher dimensional arrays are considered \\\"arrays of matrices\\\" and the broadcasting rules\\n   apply for the leading dimenions, i.e. for all dimensions of the shape except the last two.\\\"\\n\"; //\n// OPTIMIZATION\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].min_lbfgs_gen.__doc__ = \"Iteratively minimizes a function using the L-BFGS method. An indefinite number of solutions is\\nreturned unless the line search does not make any further progress, in which case a\\n`LineSearchNoProgressError` is thrown. The user must check for a proper stopping condition\\nher-/himself.\\n\\nParameters\\n----------\\nfg: (x: NDArray[N]) => [f: NDArray[], g: NDArray[N]]\\n  A method return both the function value and gradients of the optimized function for\\n  the given input `x`. \\nx0: NDArray[N]\\n  The starting point for the minimization.\\noptions: {\\n  historySize=8: int\\n    The number of past value-gradient pairs that are memoized in order to approximate the Hessian.\\n  lineSearch=nd.opt.line_search.strong_wolfe()\\n    The line search method used to advance the solution along the current search direction.\\n    Must at least satisfy the Wolfe Condition.\\n  negDir0 = g=>g: (g: NDArray[N]) => (negDir: NDArray[N])\\n    Returns the gradient-descent-like initial search direction. Can be used to control the initial\\n    search step.\\n}\\n\\nReturns\\n-------\\napproximations: Iterator<[x: NDArray[N], f: NDArray[] g: NDArray[N]]>\\n  An iterator over the approximations/iterations made by the L-BFGS method. Will return an indefinite\\n  amount of approximations unless a `LineSearchNoProgressError` is thrown.\\n\\nThrows\\n------\\nnoProgress: nd.opt.LineSearchNoProgressError\\n  If the optimization is not making any more progress. This is usally happens when the optimizer\\n  is already very close to the minimum.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Limited-memory_BFGS\\n.. [2] https://en.wikipedia.org/wiki/Wolfe_conditions\\n\\nExample\\n-------\\n>>> const fg = ([x,y]) => [\\n...   nd.array(  (x-1)**2 + 100*(y-x*x)**2 ),\\n...   nd.array([ (x-1) *2 - 400*(y-x*x) *x,\\n...                         200*(y-x*x) ])\\n... ];\\n... let x,f,g, nIter = -1;\\n... try {\\n...   for( [x,f,g] of nd.opt.min_lbfgs_gen(fg, /*x0=*/[0,0], {negDir: g => g.mapElems(x => x*0.1)}) )\\n...   {\\n...     const gNorm = g.reduceElems(nd.math.hypot);\\n...     if( ++nIter > 1e3 )\\n...       throw new Error('Too many iterations.');\\n...     if( gNorm <= 1e-8 )\\n...       break;\\n...   }\\n... }\\n... catch(err) {\\n...   if( ! (err instanceof nd.opt.LineSearchNoProgressError) )\\n...     throw err;\\n...   console.log('No progress.');\\n... }\\n... console.log('Solution:', x);\\n  Solution: [ 0.9999999998879853, 0.9999999997700713 ]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].min_lbfgsb_gen.__doc__ = \"Iteratively minimizes a function using the L-BFGS-B method which supports bound-constraits.\\nAn indefinite number of solutions is returned unless the line search does not make any further\\nprogress, in which case a `LineSearchNoProgressError` is thrown. The user must check for a\\nproper stopping condition her-/himself.\\n\\nParameters\\n----------\\nfg: (x: NDArray[N]) => [f: NDArray[], g: NDArray[N]]\\n  A method return both the function value and gradients of the optimized function for\\n  the given input `x`. \\nx0: NDArray[N]\\n  The starting point for the minimization.\\nbounds: NDArray[N,2]\\n  The lower and upper bounds for each dimension. Set to -Infinity and +Infinity respectively\\n  to disable a the bounds in some directions.\\noptions: {\\n  historySize=8: int\\n    The number of past value-gradient pairs that are memoized in order to approximate the Hessian.\\n  lineSearch=nd.opt.line_search.strong_wolfe()\\n    The line search method used to advance the solution along the current search direction.\\n    Must at least satisfy the Wolfe Condition.\\n}\\n\\nReturns\\n-------\\napproximations: Iterator<[x: NDArray[N], f: NDArray[] g: NDArray[N]]>\\n  An iterator over the approximations/iterations made by the L-BFGS method. Will return an indefinite\\n  amount of approximations unless a `LineSearchNoProgressError` is thrown.\\n\\nThrows\\n------\\nnoProgress: nd.opt.LineSearchNoProgressError\\n  If the optimization is not making any more progress. This is usally happens when the optimizer\\n  is already very close to the minimum.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Limited-memory_BFGS\\n.. [2] https://en.wikipedia.org/wiki/Wolfe_conditions\\n\\nExample\\n-------\\n>>> const fg = ([x,y]) => [\\n...   nd.array(  (x-1)**2 + 100*(y-x*x)**2 ),\\n...   nd.array([ (x-1) *2 - 400*(y-x*x) *x,\\n...                         200*(y-x*x) ])\\n... ];\\n... const bounds = [\\n...   [-Infinity, 0       ],\\n...   [-8,       +Infinity]\\n... ];\\n... let x,f,g, nIter = -1;\\n... try {\\n...   for( [x,f,g] of nd.opt.min_lbfgsb_gen(fg, /*x0=*/[-1,+1], bounds) )\\n...   {\\n...     const gNorm = g.reduceElems(nd.math.hypot);\\n...     if( ++nIter > 1e3 )\\n...       throw new Error('Too many iterations.');\\n...     if( gNorm <= 1e-8 )\\n...       break;\\n...   }\\n... }\\n... catch(err) {\\n...   if( ! (err instanceof nd.opt.LineSearchNoProgressError) )\\n...     throw err;\\n...   console.log('No progress.');\\n... }\\n... console.log('Solution:', x);\\n  Solution: [ 0, 0 ]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].root1d_bisect.__doc__ = \"Finds a single root of a continuous univariate function using the bisection method.\\n\\nParameters\\n----------\\nF: float => float\\n  Continuous function for which a root is to be found.\\nx1: float\\n  One side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\nx2: float\\n  Other side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\n\\nReturns\\n-------\\nx0: float\\n  A root of F, i.e. F(x0) \\u2248 0.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Bisection_method\\n\\nExample\\n-------\\n>>> const sqrt9 = nd.opt.root1d_bisect(x => x*x-9, 0, 9);\\n... console.log('sqrt(9) =', sqrt9);\\n  sqrt(9) = 3\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].root1d_brent.__doc__ = \"Finds a single root of a continuous univariate function using Brent's method.\\n\\nParameters\\n----------\\nF: float => float\\n  Continuous function for which a root is to be found.\\nx1: float\\n  One side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\nx2: float\\n  Other side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\n\\nReturns\\n-------\\nx0: float\\n  A root of F, i.e. F(x0) \\u2248 0.\\n\\nReferences\\n----------\\n .. [1] https://en.wikipedia.org/wiki/Brent's_method\\n\\nExample\\n-------\\n>>> const sqrt9 = nd.opt.root1d_bisect(x => x*x-9, 0, 9);\\n... console.log('sqrt(9) =', sqrt9);\\n  sqrt(9) = 3\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].root1d_illinois.__doc__ = \"Finds a single root of a continuous univariate function using the bisection Ford's (Illinois-type) method.\\n\\nParameters\\n----------\\nF: float => float\\n  Continuous function for which a root is to be found.\\nx1: float\\n  One side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\nx2: float\\n  Other side of the range containing a root. F(x1) and F(x2) must have opposite signs (or be zero).\\n\\nReturns\\n-------\\nx0: float\\n  A root of F, i.e. F(x0) \\u2248 0.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/False_position_method\\n.. [2] \\\"Improved Algorithms Of Illinois-Type For The Numerical Solution Of Nonlinear Equations\\\"\\n\\nExample\\n-------\\n>>> const sqrt9 = nd.opt.root1d_bisect(x => x*x-9, 0, 9);\\n... console.log('sqrt(9) =', sqrt9);\\n  sqrt(9) = 3\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].min1d_gss.__doc__ = \"Finds a single minimum of a continuous univariate function using Golden Section Search.\\n\\nParameters\\n----------\\nF: float => float\\n  Continuous function for which a minimum is to be found.\\nx1: float\\n  One side of the range containing a root. Must be left of the minimum.\\nx2: float\\n  Other side of the range containing a root. Must be right of the minimum.\\n\\nReturns\\n-------\\nxMin: float\\n  A local minimum of F.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Golden-section_search\\n\\nExample\\n-------\\n>>> const sqrt9 = nd.opt.min1d_gss(x => Math.abs(x*x-9), -9, +9);\\n... console.log('sqrt(9) =', sqrt9);\\n  sqrt(9) = 3\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].fit_lin.__doc__ = \"Fits a parameter-linear linear function using Linear Regression or Ridge Regression.\\n\\nParameters\\n----------\\nx: float[n_samples(,n_inputs)]\\n  Function inputs of the sample points that the function is fit through.\\ny: float[n_samples]\\n  Function outputs of the sample points that the function is fit through.\\nregularization: float\\n  [optional] A regularization factor that penalizes the norm of\\n  the function coefficients. The larger the regularization, the\\n  smaller the coefficients tend to be, i.e. the function becomes\\n  smoother and more approximative than interpolative.\\nfuncs: (float[n_inputs] => float)[n_coeffs]\\n  Components of the function that is to be fit through (x,y).\\n  Each component has it's own linear parameter/coefficient, i.e.\\n  `fit(x) = c[0]*funcs[0](x) + c[1]*funcs[1](x) + ...`.\\n\\nReturns\\n-------\\nfit {coeffs: float[n]}: float[n_coeffs]\\n  A function that fits the points given by x and y. The coefficients\\n  and the function components can be retrieved as `fit.coeffs` and\\n  `fit.funcs` properties of the function.\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Linear_regression\\n\\nExample\\n-------\\n>>> const [a,b,c,d] = [3,1,2,4];\\n... \\n... // Underlying function\\n... const fun = ([x,y]) => a + b*x + c*x*y + d * Math.sin(y);\\n... \\n... // Generate sample points to fit to\\n... let X = [],\\n...     Y = [];\\n... for( let xi = -2; xi <= +2; xi += 0.5 ) {\\n... for( let yi = -2; yi <= +2; yi += 0.5 ) {\\n...   X.push(     [xi,yi]  );\\n...   Y.push( fun([xi,yi]) );\\n... }}\\n...\\n... // Fitted function\\n... const fit = nd.opt.fit_lin(\\n...   X,Y,\\n...   [([x,y]) => Math.sin(y),\\n...    ([x,y]) => x*y,\\n...    ([x,y]) => x,\\n...    ([x,y]) => 1]\\n... );\\n... \\n... console.log(\\n...   'Fitted coefficients: [d,c,b,a] =',\\n...   [...fit.coeffs.map(x => x.toFixed(12))]\\n... );\\n... \\n... console.log( 'fun([-1,-1]) =',  fun([-1,-1]) );\\n... console.log( 'fit([-1,-1]) =',  fit([-1,-1]) );\\n  Fitted coefficients: [d,c,b,a] = [ 4, 2, 1, 3 ]\\n  fun([-1,-1]) = 0.634116060768414\\n  fit([-1,-1]) = 0.6341160607684131\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].fit_dogleg_gen.__doc__ = \"Nonlinear least squares fit of a function to the given sample points using\\nthe (single) Dogleg trust region method.\\n\\nParameters\\n----------\\nx: float[n_samples,n_inputs]\\n  Function inputs of the sample points that the function is fit through.\\ny: float[n_samples]\\n  Function outputs of the sample points that the function is fit through.\\nfg: (params: float[n_params]) => (x: float[n_inputs]) => [f: float, g: float[n_params]]\\n  Function whose parameters is fitted. Returns the function value and its\\n  gradients with respect to its parameters.\\np0: float[n_params]\\n  Starting values for the parameters for fitting.\\nopt : {\\n  r0: float\\n    [optional] Starting value for trust region radius.\\n  rMin: float\\n    [optional] Lower trust region radius bounds.\\n  rMax: float\\n    [optional] Upper trust region radius bounds.\\n  rTol: float\\n    [optional] Relative tolerance by which the iteration adheres to the trust region radius.\\n  shrinkLower: float \\u2208 (0,shrinkUpper]\\n    [optional] During a single iteration, the trust region radius may at most decrease by this factor.\\n  shrinkUpper: float \\u2208 [shrinkLower,1)\\n    [optional] During a single iteration, the trust region radius may at least decrease by this factor.\\n  grow: float\\n    [optional] During a single iteration, the trust region radius may increase by this factor.\\n  expectGainMin: float\\n    [optional] The iteration is expected to provide at least `expectGainMin` of the predicted improvement.\\n    Otherwise the trust region is shrunk.\\n  expectGainMax: float\\n    [optional] The iteration is expected to provide at most `expectGainMax` of the predicted improvement.\\n    Otherwise the trust region is increased.\\n}\\n\\nReturns\\n-------\\nIterator<[\\n  p: float[n_params]\\n    Current parameter values of the iteration.\\n  mse: float\\n    Mean squared error.\\n  mse_grad: float[n_params]\\n    Gradient of the mean squared error with respect to the parameters.\\n  res: float[]\\n    Residuals of the fit.\\n  res_jac: float[]\\n    Jaciobian of the residuals with respect to the parameters.\\n]>\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Powell%27s_dog_leg_method\\n\\nExample\\n-------\\n>>> // Determine half-life of beer using dataset from:\\n... // \\\"Multivariate Analyses of Beer Foam Stand\\\" by James J. Hackbart\\n... const time = nd.array([[ 0,    15,    30,    45,    60,   90,   120,   150,   180,   210,   240,   270,   300   ]]).T,\\n...     height = nd.array( [17.40, 15.10, 13.10, 11.60, 10.60, 8.70,  7.40,  6.35,  5.40,  4.50,  3.80,  3.30,  2.90] );\\n... \\n... // Exponential decay function.\\n... const fG = ([H0, c]) => ([t]) => [\\n...    H0 * 2**(-t*c),\\n...   [     2**(-t*c),                    // <- d(fG) / d(H0)\\n...    H0 * 2**(-t*c) * Math.log(2) * -t] // <- d(fG) / d(c)\\n... ];\\n... \\n... for( const [[H0, c], mse, mse_grad] of nd.opt.fit_dogleg_gen(time, height, fG, /*p0=*/[1,1]) )\\n...   if( nd.la.norm(mse_grad) <= 1e-5 ) {\\n...     console.log({H0, half_life: 1/c});\\n...     break;\\n...   }\\n  { H0: 16.386111804437096, half_life: 108.02447353397987 }\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].fit_lm_gen.__doc__ = \"Nonlinear least squares fit of a function to the given sample points using\\nthe Levenberg-Marquardt trust region method.\\n\\nParameters\\n----------\\nx: float[n_samples,n_inputs]\\n  Function inputs of the sample points that the function is fit through.\\ny: float[n_samples]\\n  Function outputs of the sample points that the function is fit through.\\nfg: (params: float[n_params]) => (x: float[n_inputs]) => [f: float, g: float[n_params]]\\n  Function whose parameters is fitted. Returns the function value and its\\n  gradients with respect to its parameters.\\np0: float[n_params]\\n  Starting values for the parameters for fitting.\\nopt : {\\n  r0: float\\n    [optional] Starting value for trust region radius.\\n  rMin: float\\n    [optional] Lower trust region radius bounds.\\n  rMax: float\\n    [optional] Upper trust region radius bounds.\\n  rTol: float\\n    [optional] Relative tolerance by which the iteration adheres to the trust region radius.\\n  lmLower: float \\u2208 (0,1)\\n    [optional] A small number that avoids that the Levenberg-Marquardt parameter becomes\\n    too small too quickly during iteration.\\n  shrinkLower: float \\u2208 (0,shrinkUpper]\\n    [optional] During a single iteration, the trust region radius may at most decrease by this factor.\\n  shrinkUpper: float \\u2208 [shrinkLower,1)\\n    [optional] During a single iteration, the trust region radius may at least decrease by this factor.\\n  grow: float\\n    [optional] During a single iteration, the trust region radius may increase by this factor.\\n  expectGainMin: float\\n    [optional] The iteration is expected to provide at least `expectGainMin` of the predicted improvement.\\n    Otherwise the trust region is shrunk.\\n  expectGainMax: float\\n    [optional] The iteration is expected to provide at most `expectGainMax` of the predicted improvement.\\n    Otherwise the trust region is increased.\\n}\\n\\nReturns\\n-------\\nIterator<[\\n  p: float[n_params]\\n    Current parameter values of the iteration.\\n  mse: float\\n    Mean squared error.\\n  mse_grad: float[n_params]\\n    Gradient of the mean squared error with respect to the parameters.\\n  res: float[]\\n    Residuals of the fit.\\n  res_jac: float[]\\n    Jaciobian of the residuals with respect to the parameters.\\n]>\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm\\n\\nExample\\n-------\\n>>> // Determine half-life of beer using dataset from:\\n... // \\\"Multivariate Analyses of Beer Foam Stand\\\" by James J. Hackbart\\n... const time = nd.array([[ 0,    15,    30,    45,    60,   90,   120,   150,   180,   210,   240,   270,   300   ]]).T,\\n...     height = nd.array( [17.40, 15.10, 13.10, 11.60, 10.60, 8.70,  7.40,  6.35,  5.40,  4.50,  3.80,  3.30,  2.90] );\\n... \\n... // Exponential decay function.\\n... const fG = ([H0, c]) => ([t]) => [\\n...    H0 * 2**(-t*c),\\n...   [     2**(-t*c),                    // <- d(fG) / d(H0)\\n...    H0 * 2**(-t*c) * Math.log(2) * -t] // <- d(fG) / d(c)\\n... ];\\n... \\n... for( const [[H0, c], mse, mse_grad] of nd.opt.fit_lm_gen(time, height, fG, /*p0=*/[1,1]) )\\n...   if( nd.la.norm(mse_grad) <= 1e-6 ) {\\n...     console.log({H0, half_life: 1/c});\\n...     break;\\n...   }\\n  { H0: 16.386111806695105, half_life: 108.02447348677644 }\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].odr_lm_gen.__doc__ = \"Orthogonal least squares regression fit of a function to the given sample\\npoints using the Levenberg-Marquardt trust region method. This method minimizes\\nthe following least-squares problem:\\n\\n  minimize F(p,x) = \\u2211\\u1D62 (f(x[i,:]) - y[i,:])\\xB2   +   \\u2211\\u1D62\\u2C7C dx[i,j]\\xB2\\n\\nParameters\\n----------\\nx: float[n_samples(,n_inputs)]\\n  Function inputs of the sample points that the function is fit through.\\ny: float[n_samples(,n_outputs)]\\n  Function outputs of the sample points that the function is fit through.\\nfgg: (p: float[n_params]) => (x: float[n_inputs]) => [f: float, dfdp: float[(n_outputs,)n_params], dfdx: float[(n_outputs)(,n_inputs)]]\\n  Function whose parameters is fitted. Returns the function value and its\\n  gradients with respect to its parameters and its gradients with respect\\n  to its function input `x`.\\np0: float[n_params]\\n  Starting values for the parameters for fitting.\\nopt : {\\n  dx0: float[n_samples(,n_inputs)]\\n    [optional] Starting value for the function inputs delta for fitting.\\n  r0: float\\n    [optional] Starting value for trust region radius.\\n  rMin: float\\n    [optional] Lower trust region radius bounds.\\n  rMax: float\\n    [optional] Upper trust region radius bounds.\\n  rTol: float\\n    [optional] Relative tolerance by which the iteration adheres to the trust region radius.\\n  lmLower: float \\u2208 (0,1)\\n    [optional] A small number that avoids that the Levenberg-Marquardt parameter becomes\\n    too small too quickly during iteration.\\n  shrinkLower: float \\u2208 (0,shrinkUpper]\\n    [optional] During a single iteration, the trust region radius may at most decrease by this factor.\\n  shrinkUpper: float \\u2208 [shrinkLower,1)\\n    [optional] During a single iteration, the trust region radius may at least decrease by this factor.\\n  grow: float\\n    [optional] During a single iteration, the trust region radius may increase by this factor.\\n  expectGainMin: float\\n    [optional] The iteration is expected to provide at least `expectGainMin` of the predicted improvement.\\n    Otherwise the trust region is shrunk.\\n  expectGainMax: float\\n    [optional] The iteration is expected to provide at most `expectGainMax` of the predicted improvement.\\n    Otherwise the trust region is increased.\\n}\\n\\nReturns\\n-------\\nIterator<[\\n  p: float[n_params]\\n    Current parameter values of the iteration.\\n  dx: float[n_samples(,n_inputs)]\\n    Current function inputs delta, a.k.a. residuals in the function inputs.\\n  mse: float\\n    Mean squared error.\\n  dmse_dp: float[n_params]\\n    Gradient of the mean squared error with respect to the parameters.\\n  dmse_ddx: float[n_samples(,n_inputs)]\\n    Gradient of the mean squared error with respect to the function inputs delta `dx`.\\n  dy: float[n_samples(,n_outputs)]\\n    Residuals in the function ouputs.\\n]>\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm\\n.. [2] https://en.wikipedia.org/wiki/Total_least_squares\\n\\nExample\\n-------\\n>>> // generate some data with the underlying function: y = 7 - 3*x0 + x1\\n... let x = Array.from({length: 8}, (_,i) =>\\n...         Array.from({length: 8}, (_,j) => [i-4,j-4] )).flat();\\n... let y = x.map( ([x0,x1]) => 7 - 3*x0 + x1 );\\n...\\n... // add some uniform noise both in x and y\\n... x = x.map( xi => xi.map(x => x + Math.random()*0.2-0.1) );\\n... y = y.map(              y => y + Math.random()*0.2-0.1  );\\n...\\n... // model function whose parameter are to be fitted\\n... const fgg = ([p0,p1,p2]) => ([x0,x1]) => {\\n...   const f   =  p0 + p1*x0 + p2*x1,\\n...        dfdp = [ 1,     x0,     x1 ],\\n...        dfdx = [     p1   ,  p1    ];\\n...     return [f, dfdp, dfdx];\\n... }\\n...\\n... let p, dx, mse, dmse_dp, dmse_ddx;\\n... try {\\n...   for( [p, dx, mse, dmse_dp, dmse_ddx] of nd.opt.odr_lm_gen(x,y, fgg, [0,0,0]) )\\n...   {\\n...     if(  nd.la.norm(dmse_dp ) <= 1e-6\\n...       && nd.la.norm(dmse_ddx) <= 1e-6 )\\n...       break;\\n...   }\\n... }\\n... catch(err) {\\n...   if( !(err instanceof nd.opt.OptimizationNoProgressError) )\\n...     throw err;\\n... }\\n...\\n... console.log('P = ' + p);\\n  P = [ 7.021041391243395, -2.9909472084570687, 1.0073465017684218 ]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"opt\"].odr_dogleg_gen.__doc__ = \"Orthogonal least squares regression fit of a function to the given sample\\npoints using the Dogleg trust region method. This method minimizes\\nthe following least-squares problem:\\n\\n  minimize F(p,x) = \\u2211\\u1D62 (f(x[i,:]) - y[i,:])\\xB2   +   \\u2211\\u1D62\\u2C7C dx[i,j]\\xB2\\n\\nParameters\\n----------\\nx: float[n_samples(,n_inputs)]\\n  Function inputs of the sample points that the function is fit through.\\ny: float[n_samples(,n_outputs)]\\n  Function outputs of the sample points that the function is fit through.\\nfgg: (p: float[n_params]) => (x: float[n_inputs]) => [f: float, dfdp: float[(n_outputs,)n_params], dfdx: float[(n_outputs)(,n_inputs)]]\\n  Function whose parameters is fitted. Returns the function value and its\\n  gradients with respect to its parameters and its gradients with respect\\n  to its function input `x`.\\np0: float[n_params]\\n  Starting values for the parameters for fitting.\\nopt : {\\n  dx0: float[n_samples(,n_inputs)]\\n    [optional] Starting value for the function inputs delta for fitting.\\n  r0: float\\n    [optional] Starting value for trust region radius.\\n  rMin: float\\n    [optional] Lower trust region radius bounds.\\n  rNewton: float\\n    [optional] If the Gauss-Newton is inside the trust region, the trust radius is set to\\n    `rNewton` times the distance to the Gauss-Newton point.\\n  shrinkLower: float \\u2208 (0,shrinkUpper]\\n    [optional] During a single iteration, the trust region radius may at most decrease by this factor.\\n  shrinkUpper: float \\u2208 [shrinkLower,1)\\n    [optional] During a single iteration, the trust region radius may at least decrease by this factor.\\n  grow: float\\n    [optional] During a single iteration, the trust region radius may increase by this factor.\\n  expectGainMin: float\\n    [optional] The iteration is expected to provide at least `expectGainMin` of the predicted improvement.\\n    Otherwise the trust region is shrunk.\\n  expectGainMax: float\\n    [optional] The iteration is expected to provide at most `expectGainMax` of the predicted improvement.\\n    Otherwise the trust region is increased.\\n  stuckLimit: int\\n    [optional] The maximum number of consecutive function calls allowed without any minimization progress.\\n}\\n\\nReturns\\n-------\\nIterator<[\\n  p: float[n_params]\\n    Current parameter values of the iteration.\\n  dx: float[n_samples(,n_inputs)]\\n    Current function inputs delta, a.k.a. residuals in the function inputs.\\n  mse: float\\n    Mean squared error.\\n  dmse_dp: float[n_params]\\n    Gradient of the mean squared error with respect to the parameters.\\n  dmse_ddx: float[n_samples(,n_inputs)]\\n    Gradient of the mean squared error with respect to the function inputs delta `dx`.\\n  dy: float[n_samples(,n_outputs)]\\n    Residuals in the function ouputs.\\n]>\\n\\nReferences\\n----------\\n.. [1] https://en.wikipedia.org/wiki/Powell%27s_dog_leg_method\\n.. [2] https://en.wikipedia.org/wiki/Total_least_squares\\n\\nExample\\n-------\\n>>> // generate some data with the underlying function: y = 7 - 3*x0 + x1\\n... let x = Array.from({length: 8}, (_,i) =>\\n...         Array.from({length: 8}, (_,j) => [i-4,j-4] )).flat();\\n... let y = x.map( ([x0,x1]) => 7 - 3*x0 + x1 );\\n...\\n... // add some uniform noise both in x and y\\n... x = x.map( xi => xi.map(x => x + Math.random()*0.2-0.1) );\\n... y = y.map(              y => y + Math.random()*0.2-0.1  );\\n...\\n... // model function whose parameter are to be fitted\\n... const fgg = ([p0,p1,p2]) => ([x0,x1]) => {\\n...   const f   =  p0 + p1*x0 + p2*x1,\\n...        dfdp = [ 1,     x0,     x1 ],\\n...        dfdx = [     p1   ,  p1    ];\\n...     return [f, dfdp, dfdx];\\n... }\\n...\\n... let p, dx, mse, dmse_dp, dmse_ddx;\\n... try {\\n...   for( [p, dx, mse, dmse_dp, dmse_ddx] of nd.opt.odr_dogleg_gen(x,y, fgg, [0,0,0]) )\\n...   {\\n...     if(  nd.la.norm(dmse_dp ) <= 1e-6\\n...       && nd.la.norm(dmse_ddx) <= 1e-6 )\\n...       break;\\n...   }\\n... }\\n... catch(err) {\\n...   if( !(err instanceof nd.opt.OptimizationNoProgressError) )\\n...     throw err;\\n... }\\n...\\n... console.log('P = ' + p);\\n  P = [ 6.967630316177548, -2.9919053487374145, 1.0098254712960533 ]\\n\"; //\n// I/O\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"io\"].istr_parse.__doc__ = \"Parses an inlineable string representation (ISTR) of an `NDArray`. ISTR is intended\\nfor inlining large `NDArray`s into JavaScript code or JSON files. The string representation\\nconsists of a data type string, followed by a JSON array for the shape and finally a Base64\\nencoded, little-endian representation of the `NDArray`'s data/content. Except for within\\nthe type string or in between the digits of a shape integer, ISTR is whitespace-agnostic.\\n\\nParameters\\n----------\\nchars: Iterable<char>\\n  The character sequence that is to be parsed.\\n\\nReturns\\n-------\\nndarray: NDArray\\n  The `NDArray` parsed from `chars`.\\n\\nExamples\\n--------\\n>>> const a = nd.io.istr_parse(`int32[7,6]\\n...   CwAAAAwAAAANAAAADgAAAA8AAAAQAAAAFQAAABYAAAAXAAAAGAAAABkAAAAaAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAKQAAACoAAAArAAAALAAAAC0AAAAuAAAA\\n...   MwAAADQAAAA1AAAANgAAADcAAAA4AAAAPQAAAD4AAAA/AAAAQAAAAEEAAABCAAAARwAAAEgAAABJAAAASgAAAEsAAABMAAAA`\\n... );\\n>>> console.log( a.toString() )\\n  [[ 11, 12, 13, 14, 15, 16 ],\\n   [ 21, 22, 23, 24, 25, 26 ],\\n   [ 31, 32, 33, 34, 35, 36 ],\\n   [ 41, 42, 43, 44, 45, 46 ],\\n   [ 51, 52, 53, 54, 55, 56 ],\\n   [ 61, 62, 63, 64, 65, 66 ],\\n   [ 71, 72, 73, 74, 75, 76 ]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"io\"].istr_stringify.__doc__ = \"Converts an `NDArray` into an inlineable string representation (ISTR). ISTR is intended\\nfor inlining large `NDArray`s into JavaScript code or JSON files. The string representation\\nconsists of a data type string, followed by a JSON array for the shape and finally a Base64\\nencoded, little-endian representation of the `NDArray`'s data/content. Except for within\\nthe type string or in between the digits of a shape integer, ISTR is whitespace-agnostic.\\n\\nParameters\\n----------\\nndarray: NDArray\\n  The array that is to be converted to an inlineable string representation.\\noptions: {linewidth=128}\\n  [optional] The maximum number of Base64 characters per line before a newline\\n  character is inserted.\\n\\nReturns\\n-------\\nistr: string\\n  An inlineable string representation of `ndarray`.\\n\\nExamples\\n--------\\n>>> const a = nd.tabulate([7,6], 'int32', (i,j) => 10*i+j+11)\\n>>> console.log('`' + nd.io.istr_stringify(a) + '`')\\n  `int32[7,6]\\n  CwAAAAwAAAANAAAADgAAAA8AAAAQAAAAFQAAABYAAAAXAAAAGAAAABkAAAAaAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAKQAAACoAAAArAAAALAAAAC0AAAAuAAAA\\n  MwAAADQAAAA1AAAANgAAADcAAAA4AAAAPQAAAD4AAAA/AAAAQAAAAEEAAABCAAAARwAAAEgAAABJAAAASgAAAEsAAABMAAAA`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"io\"].npy_serialize.__doc__ = \"Serializes an `NDArray` into an `Uint8Array` using version 1.0 of the NumPy NPY-format.\\nNPY is popular matrix exchange format that is implemented in several programming languages.\\nIt is well-suited for network streaming or file system storage.\\n\\nIn order to reduce memory overhead, consider using `nd.io.npy_serialize_gen()` which returns\\nan `Iterable<uint8>` instead of an `Uint8Array`.\\n\\nParameters\\n----------\\nndarray: NDArray\\n  The array that is to be serialized.\\n\\nReturns\\n-------\\nbytes: Uint8Array\\n  The bytes of the NPY representation of `ndarray`.\\n\"; //\n// LINEAR ALGEBRA\n//\n\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].__doc__ = \"The Linear Algebra subpackage of ND.JS. Contains methods for the handling and decomposition\\nof matrices as well as solvers for linear equations and linear least square systems.\\n\\nAs convention the last two axes of an `NDArray` are considered as the matrix dimensions.\\nHigher dimensional arrays are considered \\\"arrays of matrices\\\" and the broadcasting rules\\napply for the leading dimenions, i.e. for all dimensions of the shape except the last two.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].eye.__doc__ = \"Returns an NDArray of identity matrices, where the last two axes are the matrix dimensions.\\n\\nParameters\\n----------\\nshape: ...int\\n  The shape of the resulting array. If only one value N is given, an N*N identity\\n  matrix is returned.\\n\\nReturns\\n-------\\nI: NDArray\\n  The array of identity matrices, where the last two axes are the matrix dimensions.\\n\\nExamples\\n--------\\n>>> const I = nd.la.eye(2);\\n>>> console.log( I.toString() );\\n  [[1,0],\\n   [0,1]]\\n\\n>>> const J = nd.la.eye(2,3,4);\\n>>> console.log( J.toString() );\\n  [[[ 1, 0, 0, 0],\\n    [ 0, 1, 0, 0],\\n    [ 0, 0, 1, 0]],\\n   [[ 1, 0, 0, 0],\\n    [ 0, 1, 0, 0],\\n    [ 0, 0, 1, 0]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].tril.__doc__ = \"Returns a copy of an array with all entries outside of the lower triangular part set to 0.\\nThe last two axes are considered the matrix dimensions.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The array of matrices whose lower triangular parts are to be returned.\\noffset: int\\n  [Optional] The offset from the main diagonal of entries included in the  result.\\n  If `offset = +1` the entries above/right of the main diagonal are not set to zero.\\n  If `offset = -2` the entries on the main diagonal and one below/left of if are set to zero.\\n  The default value is 0.\\n\\nReturns\\n-------\\nL: NDArray[...,N,M]\\n  The lower triangular part of A, where `L(i,j) == i >= j-offset ? A(i,j) : 0`.\\n\\nExamples\\n--------\\n>>> const A = nd.tabulate([2,3,3], (k,i,j) => 100*(k+1) + 10*(i+1) + (j+i) );\\n>>> console.log( A.toString() );\\n  [[[ 110, 111, 112 ],\\n    [ 121, 122, 123 ],\\n    [ 132, 133, 134 ]],\\n   [[ 210, 211, 212 ],\\n    [ 221, 222, 223 ],\\n    [ 232, 233, 234 ]]]\\n\\n>>> const L1 = nd.la.tril(A);\\n>>> console.log( L1.toString() );\\n  [[[ 110,   0,   0 ],\\n    [ 121, 122,   0 ],\\n    [ 132, 133, 134 ]],\\n   [[ 210,   0,   0 ],\\n    [ 221, 222,   0 ],\\n    [ 232, 233, 234 ]]]\\n>>> const L2 = nd.la.tril(A,-1);\\n>>> console.log( L2.toString() );\\n  [[[   0,   0,  0 ],\\n    [ 121,   0,  0 ],\\n    [ 132, 133,  0 ]],\\n   [[   0,   0,  0 ],\\n    [ 221,   0,  0 ],\\n    [ 232, 233,  0 ]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].triu.__doc__ = \"Returns a copy of an array with all entries outside of the upper triangular part set to 0.\\nThe last two axes are considered the matrix dimensions.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The array of matrices whose upper triangular parts are to be returned.\\noffset: int\\n  [Optional] The offset from the main diagonal of entries included in the result.\\n  If `offset = +1` the main diagonal is set to zero.\\n  If `offset = -2` the entries on the main diagonal and one below/left of if are not set to zero.\\n  The default value is 0.\\n\\nReturns\\n-------\\nU: NDArray[...,N,M]\\n  The upper triangular part of A, where `L(i,j) == i <= j-offset ? A(i,j) : 0`.\\n\\nExamples\\n--------\\n>>> const A = nd.tabulate([2,3,3], (k,i,j) => 100*(k+1) + 10*(i+1) + (j+i) );\\n>>> console.log( A.toString() );\\n  [[[ 110, 111, 112 ],\\n    [ 121, 122, 123 ],\\n    [ 132, 133, 134 ]],\\n   [[ 210, 211, 212 ],\\n    [ 221, 222, 223 ],\\n    [ 232, 233, 234 ]]]\\n\\n>>> const L1 = nd.la.triu(A);\\n>>> console.log( L1.toString() );\\n[[[ 110, 111, 112 ],\\n  [   0, 122, 123 ],\\n  [   0,   0, 134 ]],\\n [[ 210, 211, 212 ],\\n  [   0, 222, 223 ],\\n  [   0,   0, 234 ]]]\\n>>> const L2 = nd.la.triu(A,+1);\\n>>> console.log( L2.toString() );\\n[[[ 0, 111, 112 ],\\n  [ 0,   0, 123 ],\\n  [ 0,   0,   0 ]],\\n [[ 0, 211, 212 ],\\n  [ 0,   0, 223 ],\\n  [ 0,   0,   0 ]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].diag_mat.__doc__ = \"Creates a (main) diagonal matrix with the given diagonal values.\\n\\nParameters\\n----------\\ndiag: NDArray[...,N]\\n  The diagonal values.\\n\\nReturns\\n-------\\nD: NDArray[...,N,N]\\n  Such that `D(i,j) == i==j ? diag(i) : 0`.\\n\\nExamples\\n--------\\n>>> const D = nd.la.diag_mat([[1,2,3],[4,5,6]]);\\n>>> console.log( D.toString() );\\n  [[[ 1, 0, 0 ],\\n    [ 0, 2, 0 ],\\n    [ 0, 0, 3 ]],\\n   [[ 4, 0, 0 ],\\n    [ 0, 5, 0 ],\\n    [ 0, 0, 6 ]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].matmul.__doc__ = \"Computes the matrix product of a series of matrices. The order\\nof multiplications is optimized to minimize the number of floating\\npoint operations required. The last two axes are considered to be\\nthe matrix dimensions. For the leading axes, broadcasting rules apply.\\nAlong with `nd.la.matmul2`, this is one of the only two methods\\nthat currently allows complex inputs.\\n\\nParameters\\n----------\\nmatrices: ...NDArray\\n  The matrices that are to be multiplied.\\n\\nReturns\\n-------\\nproduct: NDArray\\n  Where `product = matrices[0] @ matrices[1] @ ... @ matrices[n-1]`.\\n\\nExamples\\n--------\\n>>> const v = nd.tabulate([1e6,1], () => 1);\\n>>> console.log( v.toString() );\\n  [[ 1 ],\\n   [ 1 ],\\n   [ 1 ],\\n   [ 1 ],\\n   [ 1 ],\\n   ...999990 more...,\\n   [ 1 ],\\n   [ 1 ],\\n   [ 1 ],\\n   [ 1 ],\\n   [ 1 ]]\\n>>> const u = nd.la.matmul(v,v.T,v,v.T,v);\\n>>> console.log( u.toString() );\\n  [[1000000000000],\\n   [1000000000000],\\n   [1000000000000],\\n   [1000000000000],\\n   [1000000000000],\\n   ...999990 more...,\\n   [1000000000000],\\n   [1000000000000],\\n   [1000000000000],\\n   [1000000000000],\\n   [1000000000000]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].matmul2.__doc__ = \"Computes the matrix product of exactly two matrices. The last two axes\\nare considered to be the matrix dimensions. For the leading axes,\\nbroadcasting rules apply. Along with `nd.la.matmul`, this is one\\nof the only two methods that currently allows complex inputs.\\n\\nParameters\\n----------\\na: NDArray[...,N,K]\\n  The left factor matrices.\\nb: NDArray[...,K,M]\\n  The right factor matrices.\\n\\nReturns\\n-------\\nproduct: NDArray[...,N,M]\\n  Where `product = a @ b`.\\n\\nExamples\\n--------\\n>>> const A = [\\n...   [2, 0],\\n...   [0,-1]\\n... ];\\n>>> const x = nd.array([\\n...   [[1,2]],\\n...   [[3,4]],\\n...   [[5,6]]\\n... ]).T;\\n>>> console.log( x.toString() );\\n  [ [[1],\\n     [2]],\\n\\n    [[3],\\n     [4]],\\n\\n    [[5],\\n     [6]] ]\\n>>> const y = nd.la.matmul2(A,x);\\n>>> console.log( y.toString() );\\n  [ [[ 2 ],\\n     [-2 ]],\\n  \\n    [[ 6 ],\\n     [-4 ]],\\n  \\n    [[10 ],\\n     [-6 ]] ]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].cholesky_decomp.__doc__ = \"Computes the Cholesky Decomposition of an `NDArray` of symmetric, positive\\ndefinite (square) matrices. The implementation assumes the matrices to be symmetric\\nand only looks at the lower triangular values. The last two axes of the `NDArray`\\nare considered to be the matrix dimensions.\\n\\nParameters\\n----------\\nS: NDArray[...,N,N]\\n  An `NDArray` of symmetric, positive definite (square) matrices. In other words\\n  S is symmetric and has only positive eigenvalues. \\n\\nReturns\\n-------\\nL: NDArray[...,N,N]\\n  A lower triangular matrix, such that `S = L @ L.T`.\\n\\nExamples\\n--------\\n>>> const S = [\\n...   [ 25, -50],\\n...   [-50, 101]\\n... ];\\n>>> const L = nd.la.cholesky_decomp(S);\\n>>> console.log( nd.la.matmul2(L,L.T).toString() );\\n  [[ 25, -50],\\n   [-50, 101]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].cholesky_solve.__doc__ = \"Given a cholesky decomposition and the right hand side of a linear equation system,\\nthis method computes the result of said system.\\n\\nParameters\\n----------\\nL: NDArray[...,N,N]\\n  An array of lower triangular (square) matrices. L is assumed to be lower triangular\\n  without looking at the upper triangular values.\\ny: NDArray[...,N,M]\\n  The right hand side of the linear equations system.\\n\\nReturns\\n-------\\nx: NDArray[...,N,M]\\n  Such that `L @ L.T @ x == y`.\\n\\nExamples\\n--------\\n>>> const S = [\\n...   [ 25, -50],\\n...   [-50, 101]\\n... ];\\n>>> const y = [\\n...   [[1],\\n...    [2]],\\n...   [[3],\\n...    [4]]\\n... ];\\n>>> const L = nd.la.cholesky_decomp(S);\\n>>> const x = nd.la.cholesky_solve(L,y);\\n>>> console.log( nd.la.matmul2(S,x) );\\n [[[1.0],\\n   [2.0]],\\n  [[3.0],\\n   [4.0]]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].ldl_decomp.__doc__ = \"Computes the LDL\\u1D40 Decomposition of an `NDArray` of a symmetric, indefinite (square) matrix.\\nThe implementation assumes the matrices to be symmetric and only looks at the lower triangular\\nvalues. The last two axes of the `NDArray` are considered to be the matrix dimensions.\\nUnless the input is entirely either positive or negative definite, the result may be inaccurate\\nfor badly conditioned matrices.\\n\\nParameters\\n----------\\nS: NDArray[...,N,N]\\n  An `NDArray` of symmetric (square) matrices.\\n\\nReturns\\n-------\\nLD: NDArray[...,N,N]\\n  A lower triangular matrix, such that `S = L @ D @ L.T`, where `L = tril(LD,-1) + nd.eye(N)`\\n  and `D = diag(LD)`.\\n\\nExamples\\n--------\\n>>> const S = [\\n...   [ 25, -50],\\n...   [-50, 101]\\n... ];\\n... const LD = nd.la.ldl_decomp(S),\\n...       L  = LD.mapElems( (ld, i,j) => ld*(i > j) + (i===j) ),\\n...       D  = LD.mapElems( (ld, i,j) => ld*(i===j) );\\n... console.log( nd.la.matmul(L,D,L.T).toString() );\\n  [[ 25, -50],\\n   [-50, 101]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].pldlp_decomp.__doc__ = \"Computes the PLDL\\u1D40P\\u1D40 Decomposition (a.k.a. Bunch-Kaufmann) of an `NDArray` of a symmetric\\nindefinite (square) matrix. The implementation assumes the matrices to be symmetric and only\\nlooks at the lower triangular values. The last two axes of the `NDArray` are considered\\nto be the matrix dimensions.\\n\\nParameters\\n----------\\nS: NDArray[...,N,N]\\n  An `NDArray` of symmetric indefinite (square) matrices.\\n\\nReturns\\n-------\\nLD: NDArray[...,N,N]\\nQ:    int32[...,N]\\n  The result of the Bunch-Kaufmann decomposition, such that `S[P[i],P[j <= i]] = (L @ D @ L\\u1D40)[i,j] `,\\n  where `L = pldlp_l(LD,Q)` is a lower triangular matrix, `D = pldlp_d(LD,Q)` is a block diagonal\\n  matrix with with 2x2 and 1x1 blocks, and `P = pldlp_p(LD,Q)` are the permutation indices.\\n  \\n\\nExamples\\n--------\\n>>> const S = [\\n...   [ 25, -50],\\n...   [-50, 101]\\n... ];\\n... const [LD,Q]= nd.la.pldlp_decomp(S),\\n...        L    = nd.la.pldlp_l(LD,Q),\\n...         D   = nd.la.pldlp_d(LD,Q),\\n...           P = nd.la.pldlp_p(LD,Q),\\n...        LDL  = nd.la.matmul(L,D,L.T),\\n...       PLDL  = nd.la.unpermute_rows( LDL,P),\\n...       PLDLP = nd.la.unpermute_cols(PLDL,P);\\n... console.log('PLDL\\u1D40P\\u1D40 =\\\\n' + PLDLP);\\n  [[ 25, -50],\\n   [-50, 101]]\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].tril_solve.__doc__ = \"Given the lower triangular (square) matrix and the right hand side of a linear\\nequation system, this method computes the result.\\n\\nParameters\\n----------\\nL: NDArray[...,N,N]\\n  The lower triangular matrix of the linear equations system. L is assumed to\\n  be lower triangular without ever looking at the values in the upper triangular\\n  region.\\ny: NDArray[...,N,M]\\n  The right hand side matrix of the linear equation system.\\n\\nReturns\\n-------\\nx: NDArray[...,N,M]\\n  Such that `L @ x = y`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].triu_solve.__doc__ = \"Given the upper triangular (square) matrix and the right hand side of a linear\\nequation system, this method computes the result.\\n\\nParameters\\n----------\\nU: NDArray[...,N,N]\\n  The upper triangular matrix of the linear equations system. U is assumed to\\n  be upper triangular without ever looking at the values in the lower triangular\\n  region.\\ny: NDArray[...,N,M]\\n  The right hand side matrix of the linear equation system.\\n\\nReturns\\n-------\\nx: NDArray[...,N,M]\\n  Such that `U @ x = y`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].lu_decomp.__doc__ = \"Given an `NDArray` of square matrices, this method Computes the\\nLU(P) decomposition with Column Pivotization.\\n\\nParameters\\n----------\\nA: NDArray[...,N,N]\\n\\nReturns\\n-------\\nLU: NDArray[...,N,N]\\n  A matrix containing both the lower and upper triangular part of the\\n  LU decomposition. The diagonal of ther lower triangular matrix L\\n  is not contained in LU. It only containes ones and is implied.\\nP : NDArray[...,N]\\n  The order in which the row indices of A appear in the LU decomposition, i.e.:\\n  `A(P[i],j) == (L @ U)[i,j]`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].lu_solve.__doc__ = \"Given the LU(P) decomposition and the right hand side of a\\nLinear Equations System, this method computes the result of\\nsaid system.\\n\\nParameters\\n----------\\nLU: NDArray[...,N,N]\\nP : NDArray[...,N]\\ny : NDArray[...,N,M]\\n\\nReturns\\n-------\\nx : NDArray[...,N,M]\\n  The solution of the Linear Equation System, such that:\\n  `y[P[i],:] == (L @ U @ x)[i,:] `\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].qr_decomp_full.__doc__ = \"Computes the (full) QR Decomposition of a matrix. The QR\\nDecomposition can be used to solve both Linear Equations\\nand Linear Least Square problems with high numeric accuracy.\\nUnder normal circumstances, the incomplete QR Decomposition\\n(`nd.la.qr_decomp`) is to be preferred over this method\\nas it may be significantly more memory efficient.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The matrix for which the QR Decomposition is computed.\\n\\nReturns\\n-------\\nQ: NDArray[...,N,N]\\n  An orthogonal square matrix, i.e. `Q @ Q.T == Q.T @ Q == nd.la.eye(N)`.\\nR: NDArray[...,N,M]\\n  An upper triangular matrix, such that: `A = Q @ R`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].hessenberg_decomp.__doc__ = \"Computes the (Upper) Hessenberg Decomposition of a matrix. It\\nis worth mentioning that the Hessenberg Decomposition of a\\nsymmetric matrix is tridiagonal.\\n\\nParameters\\n----------\\nA: NDArray[...,N,N]\\n  The matrix for which the Hessemberg Decomposition is computed.\\n\\nReturns\\n-------\\nU: NDArray[...,N,N]\\n  An orthogonal matrix, i.e. `U @ U.T == U.T @ U == nd.la.eye(N)`.\\nH: NDArray[...,N,N]\\n  An upper Hessemberg matrix, i.e. `nd.la.tril(H,-2) == 0`, such that `U @ H @ U.T == A`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].eigen.__doc__ = \"Returns the eigenpairs of a real square matrix.\\n\\nParameters\\n----------\\nA: NDArray[...,N,N]\\n  The non-symmetric real squre matrix for which the eigenvalues are computed.\\n\\nReturns\\n-------\\n\\u039B: NDArray[...,N]\\n  A matrix containing all eigenvalues.\\nV: NDArray[...,N,N]\\n  A matrix containing the eigenvectors corresponding to \\u039B as columns, i.e.:\\n  `\\u039B[i]*V[j,i] == (A @ V)[j,i]`.\\n  The columns are normalized using the 2-norm. \\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].schur_decomp.__doc__ = \"Computes the (real) Schur Decomposition of a matrix. The\\nSchur Decomposition is used to compute the Eigenvalues and\\nEigenvectors.\\n\\nParameters\\n----------\\nA: NDArray[...,N,N]\\n\\nReturns\\n-------\\nQ: NDArray[...,N,N]\\n  An orthogonal square matrix.\\nT: NDArray[...,N,N]\\n  An upper quasi-triangular matrix, such that `Q @ T @ Q.T == A`.\\n  The diagonal of T consists of 2x2 blocks that represent complex\\n  eigenpairs and 1x1 matrix that represent a real eigenvalue.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].qr_decomp.__doc__ = \"Computes the (economic) QR Decomposition of a matrix. The\\nQR Decomposition can be used to solve both Linear Equations\\nand Linear Least Square problems with high numeric accuracy.\\nUnder normal circumstances, this method is to\\nbe preferred over the full QR Decomposition (`nd.la.qr_decomp_full`)\\nas it may be significantly more memory efficient.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The matrix for which the QR Decomposition is computed.\\n\\nReturns\\n-------\\nQ: NDArray[...,N,min(N,M)]\\n  An orthogonal rectangular matrix, i.e. `Q.T @ Q == nd.la.eye(min(N,M))`.\\nR: NDArray[...,min(N,M),M]\\n  An upper triangular matrix, such that: `A = Q @ R`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].rrqr_decomp.__doc__ = \"Computes the economic Rank-Revealing QR Decomposition of a matrix.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The matrix for which the QR Decomposition is computed.\\n\\nReturns\\n-------\\nQ: NDArray[...,N,min(N,M)]\\n  An orthogonal rectangular matrix, i.e. `Q.T @ Q == nd.la.eye(min(N,M))`.\\nR: NDArray[...,min(N,M),M]\\n  An upper triangular matrix, where `R[i,i] >= R[j,j]` if and only if `i <= j`.\\nP: NDArray[...,M]\\n  The permuted column indices, such that:\\n  `(Q @ R)[:,j] == A[:,P[j]]`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].qr_lstsq.__doc__ = \"Given the QR Decompostion and the right hand side of a full-rank\\nlinear equation system, this method solves it. If the Linear\\nEquation System is under-determined, the Linear Least Square\\nsolution is computed. This method is no suited for rank-deficient\\nor under-determined systems, in which case `rrqr_lstsq` or\\n`svd_lstsq` can be used instead.\\n\\nParameters\\n----------\\nQ: NDArray[...,N,K]\\n  The orthognal rectangular matrix of the QR Decomposition.\\nR: NDArray[...,K,M]\\n  The upper triangular matrix of the QR Decomposition.\\ny: NDArray[...,N,L]\\n  The right hand side of the Linear Equation System.\\n\\nReturns\\n-------\\nx: NDArray[...,N,L]\\n  Such that `\\u2016(Q @ R @ x) - y\\u2016\\u2082` is minimal.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].bidiag_decomp.__doc__ = \"Computes the Upper Bidiagonal Decomposition of a matrix. Bidiagonal\\nDecomposition is a common preprocessing step for the Singular Value\\nDecomposition.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The matrix for which the Upper Bidiagonal Decomposition is\\n  computed.\\n\\nReturns\\n-------\\nU: NDArray[..., N, min(N,M)]\\n  An orthognal rectangular matrix.\\nB: NDArray[..., min(N,M), N >= M ? M : N+1 ]\\n  An upper bidiagonal rectangular matrix.\\nV: NDArray[..., N >= M ? M : N+1, M]\\n  An orthogonal rectangular matrix. Such that `A = U @ B @ V @`\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].solve.__doc__ = \"Solves a full-rank Linear Equations System (LES). The method tries to\\ndetect rank-deficient systems and throw a `SingularMatrixSolveError`,\\nwhich contains some least squares solution to the rank-deficient\\nsystem as property `x`.\\n\\nParameters\\n----------\\nA: NDArray[...,N,K]\\n  The matrix of the LES.\\ny: NDArray[...,K,M]\\n  The right hand side of the LES.\\n\\nReturns\\n-------\\nx: NDArray[...,N,M]\\n  The solution of `(A @ x) = y`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].srrqr_decomp_full.__doc__ = \"Computes the full strong Rank-Revealing QR Decomposition of a matrix.\\n\\nParameters\\n----------\\nA: NDArray[...,M,N]\\n  The matrix for which the QR Decomposition is computed.\\nopt: {\\n  dtol: float >= 1,\\n    Threshold for the column swaps. Columns are swapped for as long as the\\n    determinant of the upper left quadrant of the (partially triangularized)\\n    matrix increases by at least a factor of `dtol`. The larger `dtol`, the\\n    faster the decomposition is. The closer to 1 `dtol` is, the more accurate\\n    the rank determination.\\n  ztol: float >= 0\\n    Tolerance for the rank determination. If the lower right quadrant of the\\n    (partially triangularized) matrix is less than or equal to ztol, it is\\n    considered to be zero.\\n}\\n\\nReturns\\n-------\\nQ: NDArray[...,M,M]\\n  An orthogonal rectangular matrix, i.e. `Q.T @ Q == nd.la.eye(min(N,M))`.\\nR: NDArray[...,M,N]\\n  An upper triangular matrix, where `R[i,i] >= R[j,j]` if and only if `i <= j`.\\nP: NDArray[...,N]\\n  The permuted column indices, such that:\\n  `(Q @ R)[:,j] == A[:,P[j]]`\\nranks: NDArray[...]\\n  The rank or batch of ranks of the individual matrices.\\n\\nReferences\\n----------\\n.. [1] \\\"Efficient Algorithms for Computing a Strong Rank-Revealing QR Factorization\\\",\\n        Ming Gu and Stanley C. Eisenstat\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].svd_decomp.__doc__ = \"Computes the Singular Value Decomposition (SVD) of a matrix.\\n\\nParameters\\n----------\\nA: NDArray[...,N,M]\\n  The matrix for which the SVD is computed.\\n\\nReturns\\n-------\\nU : NDArray[...,N,min(N,M)]\\n  An orthogonal, rectangular matrix.\\nsv: NDArray[..., min(N,M) ]\\n  The singular values of A sorted in descending order.\\nV : NDArray[...,min(N,M),M]\\n  An orthogonal, rectangular matrix, such that `A == U @ diag(sv) @ V`.\\n\";\n___WEBPACK_IMPORTED_MODULE_0__[\"la\"].urv_decomp_full.__doc__ = \"Computes the (full) URV decomposition of a matrix. The URV decomposition\\nis also known as complete orthogonal decomposition. Amongs other things,\\nthe URV decomposition can be used (as a faster alternative to the SVD)\\nfor finding the minimum-norm solution to under-determined least-squares\\nproblems.\\n\\nParameters\\n----------\\nA: NDArray[...,M,N]\\n  The matrix (or batch of matrices) that is to be URV decomposed.\\n\\nReturns\\n-------\\nU: NDArray[...,M,M]\\n  An orthogonal, square matrix.\\nR: NDArray[...,M,N]\\n  An upper triangular, square matrix.\\nV: NDArray[...,N,N]\\n  An orthogonal, square matrix, such that `A = U @ R @ V`\\n\";\n\n//# sourceURL=webpack://nd/./src/help.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: math, concat, array, asarray, NDArray, rand_normal, stack, tabulate, zip_elems, dt, geom, integrate, io, iter, la, opt, rand, spatial */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dt */ \"./src/dt/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"dt\", function() { return _dt__WEBPACK_IMPORTED_MODULE_0__; });\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./math */ \"./src/math.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"math\", function() { return _math__WEBPACK_IMPORTED_MODULE_1__[\"math\"]; });\n\n/* harmony import */ var _concat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./concat */ \"./src/concat.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"concat\", function() { return _concat__WEBPACK_IMPORTED_MODULE_2__[\"concat\"]; });\n\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./nd_array */ \"./src/nd_array.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"array\", function() { return _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"asarray\", function() { return _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NDArray\", function() { return _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"]; });\n\n/* harmony import */ var _rand_normal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./rand_normal */ \"./src/rand_normal.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rand_normal\", function() { return _rand_normal__WEBPACK_IMPORTED_MODULE_4__[\"rand_normal\"]; });\n\n/* harmony import */ var _stack__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./stack */ \"./src/stack.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"stack\", function() { return _stack__WEBPACK_IMPORTED_MODULE_5__[\"stack\"]; });\n\n/* harmony import */ var _tabulate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./tabulate */ \"./src/tabulate.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tabulate\", function() { return _tabulate__WEBPACK_IMPORTED_MODULE_6__[\"tabulate\"]; });\n\n/* harmony import */ var _zip_elems__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./zip_elems */ \"./src/zip_elems.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"zip_elems\", function() { return _zip_elems__WEBPACK_IMPORTED_MODULE_7__[\"zip_elems\"]; });\n\n/* harmony import */ var _geom__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./geom */ \"./src/geom/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"geom\", function() { return _geom__WEBPACK_IMPORTED_MODULE_8__; });\n/* harmony import */ var _integrate__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./integrate */ \"./src/integrate/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"integrate\", function() { return _integrate__WEBPACK_IMPORTED_MODULE_9__; });\n/* harmony import */ var _io__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./io */ \"./src/io/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"io\", function() { return _io__WEBPACK_IMPORTED_MODULE_10__; });\n/* harmony import */ var _iter__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./iter */ \"./src/iter/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"iter\", function() { return _iter__WEBPACK_IMPORTED_MODULE_11__; });\n/* harmony import */ var _la__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./la */ \"./src/la/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"la\", function() { return _la__WEBPACK_IMPORTED_MODULE_12__; });\n/* harmony import */ var _opt__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./opt */ \"./src/opt/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"opt\", function() { return _opt__WEBPACK_IMPORTED_MODULE_13__; });\n/* harmony import */ var _rand__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./rand */ \"./src/rand/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"rand\", function() { return _rand__WEBPACK_IMPORTED_MODULE_14__; });\n/* harmony import */ var _spatial__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./spatial */ \"./src/spatial/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"spatial\", function() { return _spatial__WEBPACK_IMPORTED_MODULE_15__; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=webpack://nd/./src/index.js?");

/***/ }),

/***/ "./src/integrate/index.js":
/*!********************************!*\
  !*** ./src/integrate/index.js ***!
  \********************************/
/*! exports provided: odeint_rk4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _odeint_rk4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./odeint_rk4 */ \"./src/integrate/odeint_rk4.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"odeint_rk4\", function() { return _odeint_rk4__WEBPACK_IMPORTED_MODULE_0__[\"odeint_rk4\"]; });\n\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n//# sourceURL=webpack://nd/./src/integrate/index.js?");

/***/ }),

/***/ "./src/integrate/odeint_rk4.js":
/*!*************************************!*\
  !*** ./src/integrate/odeint_rk4.js ***!
  \*************************************/
/*! exports provided: odeint_rk4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"odeint_rk4\", function() { return odeint_rk4; });\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _zip_elems__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../zip_elems */ \"./src/zip_elems.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction odeint_rk4(dy, y0, t0, dt) {\n  y0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_0__[\"asarray\"])(y0); // https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods\n\n  var k1 = dy(y0, t0).mapElems(function (dy) {\n    return dy * dt;\n  }),\n      k2 = dy(Object(_zip_elems__WEBPACK_IMPORTED_MODULE_1__[\"zip_elems\"])([y0, k1], function (y0, k1) {\n    return y0 + k1 / 2;\n  }), t0 + dt / 2).mapElems(function (dy) {\n    return dy * dt;\n  }),\n      k3 = dy(Object(_zip_elems__WEBPACK_IMPORTED_MODULE_1__[\"zip_elems\"])([y0, k2], function (y0, k2) {\n    return y0 + k2 / 2;\n  }), t0 + dt / 2).mapElems(function (dy) {\n    return dy * dt;\n  }),\n      k4 = dy(Object(_zip_elems__WEBPACK_IMPORTED_MODULE_1__[\"zip_elems\"])([y0, k3], function (y0, k3) {\n    return y0 + k3;\n  }), t0 + dt).mapElems(function (dy) {\n    return dy * dt;\n  });\n  return Object(_zip_elems__WEBPACK_IMPORTED_MODULE_1__[\"zip_elems\"])([y0, k1, k2, k3, k4], function (y0, k1, k2, k3, k4) {\n    return y0 + (k1 + 2 * (k2 + k3) + k4) / 6;\n  });\n}\n\n//# sourceURL=webpack://nd/./src/integrate/odeint_rk4.js?");

/***/ }),

/***/ "./src/io/b64.js":
/*!***********************!*\
  !*** ./src/io/b64.js ***!
  \***********************/
/*! exports provided: b64_decode, b64_decode_gen, b64_encode, b64_encode_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b64_decode\", function() { return b64_decode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b64_decode_gen\", function() { return b64_decode_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b64_encode\", function() { return b64_encode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b64_encode_gen\", function() { return b64_encode_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(b64_decode_gen),\n    _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(b64_encode_gen);\n\nvar BYTE_TO_CHAR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n    WHITESPACES = '\\f\\n\\r\\t\\v ',\n    CHAR_TO_BYTE = Int32Array.from({\n  length: 256\n}, function () {\n  return -2;\n});\nif (BYTE_TO_CHAR.length !== 64) throw new Error('Assertion failed.');\n\nfor (var i = BYTE_TO_CHAR.length; i-- > 0;) {\n  CHAR_TO_BYTE[BYTE_TO_CHAR.charCodeAt(i)] = i;\n}\n\nfor (var _i = WHITESPACES.length; _i-- > 0;) {\n  CHAR_TO_BYTE[WHITESPACES.charCodeAt(_i)] = -1;\n}\n\nfunction b64_decode(b64_chars) {\n  return Uint8Array.from(b64_decode_gen(b64_chars));\n}\nfunction b64_decode_gen(b64_chars) {\n  var done, next6, warn, bit0to5, bit6to11, bit12to17, bit18to23;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function b64_decode_gen$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          warn = function _warn() {\n            console.warn(\"_b64_decode(b64_chars): Base64 sequence ended unexpectedly.\");\n          };\n\n          next6 = function _next() {\n            while (true) {\n              var value = void 0;\n\n              var _b64_chars$next = b64_chars.next();\n\n              value = _b64_chars$next.value;\n              done = _b64_chars$next.done;\n              done = done || '=' === value;\n              if (done) return NaN;\n              if ('string' !== typeof value || value.length !== 1) throw new Error(\"_b64_decode(b64_chars): Invalid token in character sequence: \".concat(value, \".\"));\n              value = CHAR_TO_BYTE[value.charCodeAt(0)]; // skip whitespaces\n\n              if (value === -1) continue;\n              if (!(value >= 0)) // <- handles undefined\n                throw new Error(\"_b64_decode(b64_chars): Invalid base64 character '\".concat(value, \"'.\"));\n              return value;\n            }\n          };\n\n          b64_chars = b64_chars[Symbol.iterator]();\n\n        case 3:\n          if (false) {}\n\n          bit0to5 = next6();\n\n          if (!done) {\n            _context.next = 7;\n            break;\n          }\n\n          return _context.abrupt(\"return\");\n\n        case 7:\n          bit6to11 = next6();\n\n          if (!done) {\n            _context.next = 10;\n            break;\n          }\n\n          return _context.abrupt(\"return\", warn());\n\n        case 10:\n          _context.next = 12;\n          return bit0to5 << 2 | bit6to11 >> 4;\n\n        case 12:\n          bit12to17 = next6();\n\n          if (!done) {\n            _context.next = 15;\n            break;\n          }\n\n          return _context.abrupt(\"return\");\n\n        case 15:\n          _context.next = 17;\n          return (bit6to11 & 15) << 4 | bit12to17 >> 2;\n\n        case 17:\n          bit18to23 = next6();\n\n          if (!done) {\n            _context.next = 20;\n            break;\n          }\n\n          return _context.abrupt(\"return\");\n\n        case 20:\n          _context.next = 22;\n          return (bit12to17 & 3) << 6 | bit18to23 & 63;\n\n        case 22:\n          _context.next = 3;\n          break;\n\n        case 24:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\nfunction b64_encode(bytes) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var result = '';\n\n  var _iterator = _createForOfIteratorHelper(b64_encode_gen(bytes, options)),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var c = _step.value;\n      result += c;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return result;\n}\nfunction b64_encode_gen(bytes) {\n  var _ref,\n      _ref$pad,\n      pad,\n      _ref$linewidth,\n      linewidth,\n      rawBytes,\n      sixPacks,\n      i,\n      _iterator3,\n      _step3,\n      six,\n      _args4 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function b64_encode_gen$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _ref = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : {}, _ref$pad = _ref.pad, pad = _ref$pad === void 0 ? true : _ref$pad, _ref$linewidth = _ref.linewidth, linewidth = _ref$linewidth === void 0 ? 128 : _ref$linewidth;\n\n          if (0 < linewidth) {\n            _context4.next = 3;\n            break;\n          }\n\n          throw new Error(\"_b64_encode(bytes,{linewidth}): Invalid linewidth: \".concat(linewidth, \".\"));\n\n        case 3:\n          rawBytes = bytes[Symbol.iterator]();\n          bytes = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n            var _iterator2, _step2, _byte;\n\n            return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _iterator2 = _createForOfIteratorHelper(rawBytes);\n                    _context2.prev = 1;\n\n                    _iterator2.s();\n\n                  case 3:\n                    if ((_step2 = _iterator2.n()).done) {\n                      _context2.next = 12;\n                      break;\n                    }\n\n                    _byte = _step2.value;\n                    _byte *= 1;\n\n                    if (0 <= _byte && _byte < 256) {\n                      _context2.next = 8;\n                      break;\n                    }\n\n                    throw new Error(\"_b64_encode(bytes): Invalid token in byte sequence: \".concat(_byte));\n\n                  case 8:\n                    _context2.next = 10;\n                    return _byte;\n\n                  case 10:\n                    _context2.next = 3;\n                    break;\n\n                  case 12:\n                    _context2.next = 17;\n                    break;\n\n                  case 14:\n                    _context2.prev = 14;\n                    _context2.t0 = _context2[\"catch\"](1);\n\n                    _iterator2.e(_context2.t0);\n\n                  case 17:\n                    _context2.prev = 17;\n\n                    _iterator2.f();\n\n                    return _context2.finish(17);\n\n                  case 20:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee, null, [[1, 14, 17, 20]]);\n          })();\n          sixPacks = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2() {\n            var value, done, six, _bytes$next, _bytes$next2, _bytes$next3;\n\n            return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    if (false) {}\n\n                    six = void 0;\n                    _bytes$next = bytes.next();\n                    value = _bytes$next.value;\n                    done = _bytes$next.done;\n\n                    if (!done) {\n                      _context3.next = 7;\n                      break;\n                    }\n\n                    return _context3.abrupt(\"return\");\n\n                  case 7:\n                    _context3.next = 9;\n                    return value >> 2;\n\n                  case 9:\n                    six = (value & 3) << 4;\n                    _bytes$next2 = bytes.next();\n                    value = _bytes$next2.value;\n                    done = _bytes$next2.done;\n\n                    if (!done) {\n                      _context3.next = 17;\n                      break;\n                    }\n\n                    _context3.next = 16;\n                    return six;\n\n                  case 16:\n                    return _context3.abrupt(\"return\");\n\n                  case 17:\n                    _context3.next = 19;\n                    return value >> 4 | six;\n\n                  case 19:\n                    six = (value & 15) << 2;\n                    _bytes$next3 = bytes.next();\n                    value = _bytes$next3.value;\n                    done = _bytes$next3.done;\n\n                    if (!done) {\n                      _context3.next = 27;\n                      break;\n                    }\n\n                    _context3.next = 26;\n                    return six;\n\n                  case 26:\n                    return _context3.abrupt(\"return\");\n\n                  case 27:\n                    _context3.next = 29;\n                    return value >> 6 | six;\n\n                  case 29:\n                    _context3.next = 31;\n                    return value & 63;\n\n                  case 31:\n                    _context3.next = 0;\n                    break;\n\n                  case 33:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee2);\n          })();\n          i = 0;\n          _iterator3 = _createForOfIteratorHelper(sixPacks);\n          _context4.prev = 8;\n\n          _iterator3.s();\n\n        case 10:\n          if ((_step3 = _iterator3.n()).done) {\n            _context4.next = 23;\n            break;\n          }\n\n          six = _step3.value;\n\n          if (!('number' !== typeof six)) {\n            _context4.next = 14;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 14:\n          if (0 <= six && six < 64) {\n            _context4.next = 16;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 16:\n          _context4.next = 18;\n          return BYTE_TO_CHAR[six];\n\n        case 18:\n          if (!(0 === ++i % linewidth)) {\n            _context4.next = 21;\n            break;\n          }\n\n          _context4.next = 21;\n          return '\\n';\n\n        case 21:\n          _context4.next = 10;\n          break;\n\n        case 23:\n          _context4.next = 28;\n          break;\n\n        case 25:\n          _context4.prev = 25;\n          _context4.t0 = _context4[\"catch\"](8);\n\n          _iterator3.e(_context4.t0);\n\n        case 28:\n          _context4.prev = 28;\n\n          _iterator3.f();\n\n          return _context4.finish(28);\n\n        case 31:\n          if (!pad) {\n            _context4.next = 37;\n            break;\n          }\n\n        case 32:\n          if (!(0 !== i++ % 4)) {\n            _context4.next = 37;\n            break;\n          }\n\n          _context4.next = 35;\n          return '=';\n\n        case 35:\n          _context4.next = 32;\n          break;\n\n        case 37:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked2, null, [[8, 25, 28, 31]]);\n}\n\n//# sourceURL=webpack://nd/./src/io/b64.js?");

/***/ }),

/***/ "./src/io/index.js":
/*!*************************!*\
  !*** ./src/io/index.js ***!
  \*************************/
/*! exports provided: IS_LITTLE_ENDIAN, WHITESPACES, b64_decode, b64_decode_gen, b64_encode, b64_encode_gen, istr_parse, istr_stringify, istr_stringify_gen, npy_serialize, npy_serialize_gen, npy_deserialize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"IS_LITTLE_ENDIAN\", function() { return IS_LITTLE_ENDIAN; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WHITESPACES\", function() { return WHITESPACES; });\n/* harmony import */ var _b64__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./b64 */ \"./src/io/b64.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"b64_decode\", function() { return _b64__WEBPACK_IMPORTED_MODULE_0__[\"b64_decode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"b64_decode_gen\", function() { return _b64__WEBPACK_IMPORTED_MODULE_0__[\"b64_decode_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"b64_encode\", function() { return _b64__WEBPACK_IMPORTED_MODULE_0__[\"b64_encode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"b64_encode_gen\", function() { return _b64__WEBPACK_IMPORTED_MODULE_0__[\"b64_encode_gen\"]; });\n\n/* harmony import */ var _istr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./istr */ \"./src/io/istr.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"istr_parse\", function() { return _istr__WEBPACK_IMPORTED_MODULE_1__[\"istr_parse\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"istr_stringify\", function() { return _istr__WEBPACK_IMPORTED_MODULE_1__[\"istr_stringify\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"istr_stringify_gen\", function() { return _istr__WEBPACK_IMPORTED_MODULE_1__[\"istr_stringify_gen\"]; });\n\n/* harmony import */ var _npy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./npy */ \"./src/io/npy.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"npy_serialize\", function() { return _npy__WEBPACK_IMPORTED_MODULE_2__[\"npy_serialize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"npy_serialize_gen\", function() { return _npy__WEBPACK_IMPORTED_MODULE_2__[\"npy_serialize_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"npy_deserialize\", function() { return _npy__WEBPACK_IMPORTED_MODULE_2__[\"npy_deserialize\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\nvar IS_LITTLE_ENDIAN = new Int16Array(Uint8Array.of(1, 0).buffer)[0] === 1;\nvar WHITESPACES = '\\f\\n\\r\\t\\v ';\n\n\n\n\n//# sourceURL=webpack://nd/./src/io/index.js?");

/***/ }),

/***/ "./src/io/istr.js":
/*!************************!*\
  !*** ./src/io/istr.js ***!
  \************************/
/*! exports provided: istr_parse, istr_stringify, istr_stringify_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"istr_parse\", function() { return istr_parse; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"istr_stringify\", function() { return istr_stringify; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"istr_stringify_gen\", function() { return istr_stringify_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _b64__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./b64 */ \"./src/io/b64.js\");\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! . */ \"./src/io/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(istr_stringify_gen);\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\nfunction istr_parse(b64_chars) {\n  b64_chars = b64_chars[Symbol.iterator]();\n  var dtype = [];\n\n  for (;;) {\n    var _b64_chars$next = b64_chars.next(),\n        value = _b64_chars$next.value,\n        done = _b64_chars$next.done;\n\n    if (done) throw new Error('b64_parse(b64_chars): Invalid b64_chars.');\n    if (value === '[') break;\n    dtype.push(value);\n  }\n\n  dtype = dtype.join('').trim();\n  if (dtype === '') throw new Error('b64_parse(b64_chars): dtype=object not (yet) supported.');\n\n  Object(_dt__WEBPACK_IMPORTED_MODULE_1__[\"_check_dtype\"])(dtype);\n\n  var shape = [];\n\n  for (var s = [];;) {\n    var _b64_chars$next2 = b64_chars.next(),\n        _value = _b64_chars$next2.value,\n        _done = _b64_chars$next2.done;\n\n    if (_done) throw new Error('b64_parse(b64_chars): Invalid b64_chars.');\n    if (_value === ']' && s.length === 0) break;\n\n    if (_value === ']' || _value === ',') {\n      var d = s.join('');\n      if (isNaN(d)) throw new Error(\"b64_parse(b64_chars): Invalid shape entry: \\\"\".concat(d, \"\\\".\"));\n      shape.push(1 * d);\n      if (_value === ']') break;\n      s = [];\n      continue;\n    }\n\n    s.push(_value);\n  }\n\n  shape = Int32Array.from(shape);\n  b64_chars = Object(_b64__WEBPACK_IMPORTED_MODULE_2__[\"b64_decode_gen\"])(b64_chars);\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype],\n      data = new Uint8Array(shape.reduce(function (m, n) {\n    return m * n;\n  }, DTypeArray.BYTES_PER_ELEMENT)),\n      word = new Uint8Array(DTypeArray.BYTES_PER_ELEMENT);\n\n  for (var i = 0; i < data.length;) {\n    for (var j = 0; j < word.length; j++) {\n      var _b64_chars$next3 = b64_chars.next(),\n          _value2 = _b64_chars$next3.value,\n          _done2 = _b64_chars$next3.done;\n\n      if (_done2) throw new Error('b64_parse(b64_chars): b64_chars too short.');\n      word[j] = _value2;\n    }\n\n    if (!___WEBPACK_IMPORTED_MODULE_3__[\"IS_LITTLE_ENDIAN\"]) word.reverse();\n\n    for (var _j = 0; _j < word.length; _j++, i++) {\n      data[i] = word[_j];\n    }\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](shape, new DTypeArray(data.buffer));\n}\nfunction istr_stringify(ndarray) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var result = '';\n\n  var _iterator = _createForOfIteratorHelper(istr_stringify_gen(ndarray, options)),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var c = _step.value;\n      result += c;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return result;\n}\nfunction istr_stringify_gen(ndarray) {\n  var options,\n      data,\n      _args = arguments;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function istr_stringify_gen$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n          ndarray = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(ndarray);\n          data = ndarray.data;\n\n          if (!(ndarray.dtype === 'object')) {\n            _context.next = 5;\n            break;\n          }\n\n          throw new Error(\"b64_format(A): A.dtype='\".concat(ndarray.dtype, \"' not supported.\"));\n\n        case 5:\n          if (___WEBPACK_IMPORTED_MODULE_3__[\"IS_LITTLE_ENDIAN\"]) {\n            _context.next = 7;\n            break;\n          }\n\n          throw new Error('Big endianness not (yet) supported.');\n\n        case 7:\n          return _context.delegateYield(\"\".concat(ndarray.dtype, \"[\").concat(ndarray.shape.join(','), \"]\\n\"), \"t0\", 8);\n\n        case 8:\n          return _context.delegateYield(Object(_b64__WEBPACK_IMPORTED_MODULE_2__[\"b64_encode_gen\"])(new Uint8Array(data.buffer, data.byteOffset, data.byteLength), options), \"t1\", 9);\n\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\n//# sourceURL=webpack://nd/./src/io/istr.js?");

/***/ }),

/***/ "./src/io/npy.js":
/*!***********************!*\
  !*** ./src/io/npy.js ***!
  \***********************/
/*! exports provided: npy_serialize, npy_serialize_gen, npy_deserialize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"npy_serialize\", function() { return npy_serialize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"npy_serialize_gen\", function() { return npy_serialize_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"npy_deserialize\", function() { return npy_deserialize; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _pyon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./pyon */ \"./src/io/pyon.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! . */ \"./src/io/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(npy_serialize_gen);\n\n\n\n\n\nvar MAGIC_STRING = \"\\x93NUMPY\";\nfunction npy_serialize(A) {\n  return Uint8Array.from(npy_serialize_gen(A));\n}\nfunction npy_serialize_gen(A) {\n  var dt, header, i, headerLen, _i, _i2;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function npy_serialize_gen$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(A);\n\n          dt = function () {\n            switch (A.dtype) {\n              default:\n                throw new Error(\"nd_to_npy: A.dtype=\".concat(A.dtype, \" not yet supported.\"));\n\n              case 'int32':\n                return 'i4';\n\n              case 'float32':\n                return 'f4';\n\n              case 'float64':\n                return 'f8';\n\n              case 'complex128':\n                return 'c16';\n            }\n          }();\n\n          if (___WEBPACK_IMPORTED_MODULE_5__[\"IS_LITTLE_ENDIAN\"]) dt = '<' + dt;else dt = '>' + dt;\n          header = \"{\\\"descr\\\": \\\"\".concat(dt, \"\\\", \\\"fortran_order\\\": False, \\\"shape\\\": (\").concat(A.shape).concat(A.ndim > 0 ? ',' : '', \")}\"); // MAGIC STRING\n\n          i = 0;\n\n        case 5:\n          if (!(i < MAGIC_STRING.length)) {\n            _context.next = 11;\n            break;\n          }\n\n          _context.next = 8;\n          return MAGIC_STRING.codePointAt(i);\n\n        case 8:\n          i++;\n          _context.next = 5;\n          break;\n\n        case 11:\n          _context.next = 13;\n          return 1;\n\n        case 13:\n          _context.next = 15;\n          return 0;\n\n        case 15:\n          headerLen = header.length + 11 + 63 >>> 6 << 6;\n\n          if (!(headerLen > 0xFFFF)) {\n            _context.next = 18;\n            break;\n          }\n\n          throw new Error('nd_to_npy: Header too large.');\n\n        case 18:\n          _context.next = 20;\n          return headerLen - 10 >>> 0 & 255;\n\n        case 20:\n          _context.next = 22;\n          return headerLen - 10 >>> 8 & 255;\n\n        case 22:\n          if (!(headerLen % 64 !== 0)) {\n            _context.next = 24;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 24:\n          _i = 0;\n\n        case 25:\n          if (!(_i < header.length)) {\n            _context.next = 31;\n            break;\n          }\n\n          _context.next = 28;\n          return header.codePointAt(_i);\n\n        case 28:\n          _i++;\n          _context.next = 25;\n          break;\n\n        case 31:\n          _i2 = header.length + 11;\n\n        case 32:\n          if (!(_i2 < headerLen)) {\n            _context.next = 38;\n            break;\n          }\n\n          _context.next = 35;\n          return ' '.codePointAt(0);\n\n        case 35:\n          _i2++;\n          _context.next = 32;\n          break;\n\n        case 38:\n          _context.next = 40;\n          return '\\n'.codePointAt(0);\n\n        case 40:\n          return _context.delegateYield(new Uint8Array(A.data.buffer, A.data.byteOffset, A.data.byteLength), \"t0\", 41);\n\n        case 41:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\nfunction npy_deserialize(npy_bytes) {\n  var _result;\n\n  var nRead = 0;\n\n  var next = function () {\n    var iter = npy_bytes[Symbol.iterator]();\n    return function () {\n      var _iter$next = iter.next(),\n          value = _iter$next.value,\n          done = _iter$next.done;\n\n      ++nRead;\n      if (done) throw new Error('npy_to_nd: byte sequence ended unexpectedly.');\n      return value;\n    };\n  }();\n\n  npy_bytes = undefined;\n  var magic_str = '';\n\n  while (magic_str.length < 6) {\n    magic_str += String.fromCodePoint(next());\n  }\n\n  if (magic_str !== MAGIC_STRING) throw new Error(\"npy_to_nd: byte sequence does not start with '\\x93NUMPY'.\");\n  var version = \"\".concat(next(), \".\").concat(next());\n\n  switch (version) {\n    default:\n      throw new Error(\"npy_bytes: npy-file version \".concat(version, \" not supported.\"));\n\n    case '1.0':\n    case '2.0':\n  }\n\n  var header = function () {\n    var headerLen = next() * (1 << 0) + next() * (1 << 8);\n\n    if (version === '2.0') {\n      headerLen += next() * (1 << 16) + next() * (1 << 24);\n    }\n\n    if (headerLen < 0) throw new Error('Assertion failed.');\n    return Object(_pyon__WEBPACK_IMPORTED_MODULE_2__[\"pyon_parse\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee() {\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(headerLen-- > 0)) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 3;\n              return String.fromCodePoint(next());\n\n            case 3:\n              _context2.next = 0;\n              break;\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee);\n    })());\n  }();\n\n  var LE = function () {\n    switch (header.descr[0]) {\n      default:\n        throw new Error(\"npy_to_nd: dtype '\".concat(header.descr, \"' not yet supported.\"));\n\n      case '<':\n        return true;\n\n      case '>':\n        return false;\n    }\n  }();\n\n  var dtype = function () {\n    switch (header.descr.slice(1)) {\n      default:\n        throw new Error(\"npy_to_nd: dtype '\".concat(header.descr, \"' not yet supported.\"));\n\n      case 'i4':\n        return 'int32';\n\n      case 'f4':\n        return 'float32';\n\n      case 'f8':\n        return 'float64';\n\n      case 'c16':\n        return 'complex128';\n    }\n  }();\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][dtype];\n  var data = Uint8Array.from({\n    length: header.shape.reduce(function (m, n) {\n      return m * n;\n    }, DTypeArray.BYTES_PER_ELEMENT)\n  }, next);\n\n  if (LE !== ___WEBPACK_IMPORTED_MODULE_5__[\"IS_LITTLE_ENDIAN\"]) {\n    var wordLen = DTypeArray.BYTES_PER_ELEMENT >>> dtype.startsWith('complex');\n\n    for (var off = 0; off < data.length; off += wordLen) {\n      for (var i = off, j = off + wordLen; i < --j; i++) {\n        var data_i = data[i];\n        data[i] = data[j];\n        data[j] = data_i;\n      }\n    }\n  }\n\n  var shape = Int32Array.from(header.shape);\n  if (header.fortran_order) shape.reverse();\n  var result = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](shape, new DTypeArray(data.buffer));\n  if (header.fortran_order && result.ndim > 1) result = (_result = result).transpose.apply(_result, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee2() {\n    var _i3;\n\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee2$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _i3 = result.ndim;\n\n          case 1:\n            if (!(_i3-- > 0)) {\n              _context3.next = 6;\n              break;\n            }\n\n            _context3.next = 4;\n            return _i3;\n\n          case 4:\n            _context3.next = 1;\n            break;\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee2);\n  })()));\n  return result;\n}\n\n//# sourceURL=webpack://nd/./src/io/npy.js?");

/***/ }),

/***/ "./src/io/pyon.js":
/*!************************!*\
  !*** ./src/io/pyon.js ***!
  \************************/
/*! exports provided: pyon_parse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pyon_parse\", function() { return pyon_parse; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction pyon_parse(char_seq) {\n  // next: returns the next character\n  // skip: returns the next non-whitespace character\n  var _ref = function () {\n    var end = false,\n        counter = 0;\n\n    var iter = char_seq[Symbol.iterator](),\n        next = function next() {\n      var _iter$next = iter.next(),\n          value = _iter$next.value,\n          done = _iter$next.done;\n\n      ++counter;\n\n      if (done) {\n        if (end) throw new Error('pyon_parse: Character sequence ended unexpectedly.');\n        end = true;\n        return null;\n      }\n\n      return value;\n    },\n        skip = function skip() {\n      for (var _char;;) {\n        switch (_char = next()) {\n          default:\n            return _char;\n\n          case '\\f':\n          case '\\n':\n          case '\\r':\n          case '\\t':\n          case '\\v':\n          case ' ':\n        }\n      }\n    },\n        err = function err(encountered, expected) {\n      var prefix = expected == null ? 'Invalid character' : \"Expected \".concat(expected, \", but \");\n      throw new Error(\"pyon_parse: \".concat(prefix, \" '\").concat(encountered, \"' encountered as \").concat(counter, \"-th character.\"));\n    };\n\n    return [next, skip, err];\n  }(),\n      _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 3),\n      next = _ref2[0],\n      skip = _ref2[1],\n      err = _ref2[2];\n\n  function any() {\n    switch (_char2) {\n      default:\n        err(_char2);\n\n      case '{':\n        return dict();\n\n      case '\"':\n      case \"'\":\n        return str();\n\n      case '(':\n      case '[':\n        return list();\n\n      case 'T':\n        return True();\n\n      case 'F':\n        return False();\n\n      case 'N':\n        return None();\n\n      case '0':\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '.':\n      case '8':\n      case '+':\n      case '9':\n      case '-':\n        return num();\n    }\n  }\n\n  function num() {\n    var num = '';\n\n    loop: for (;; _char2 = next()) {\n      switch (_char2) {\n        case '\\f':\n        case '\\n':\n        case '\\r':\n        case '\\t':\n        case '\\v':\n        case ' ':\n          _char2 = skip();\n\n        default:\n          break loop;\n\n        case '0':\n        case '1':\n        case '2':\n        case '3':\n        case 'a':\n        case 'A':\n        case '4':\n        case 'b':\n        case 'B':\n        case '5':\n        case 'c':\n        case 'C':\n        case '6':\n        case 'd':\n        case 'D':\n        case '7':\n        case 'e':\n        case 'E':\n        case '.':\n        case '8':\n        case 'f':\n        case 'F':\n        case '+':\n        case '9':\n        case 'e':\n        case 'E':\n        case '-':\n          num += _char2;\n      }\n    }\n\n    num = num.trim() * 1;\n    if (isNaN(num)) err(num);\n    return num;\n  }\n\n  function dict() {\n    var result = {};\n    if ('{' !== _char2) throw new Error('Assertion failed.');\n\n    for (;;) {\n      if ('}' === (_char2 = skip())) {\n        _char2 = skip();\n        return result;\n      }\n\n      var key = any();\n      if (':' !== _char2) err(_char2, end);\n      _char2 = skip();\n      result[key] = any();\n\n      switch (_char2) {\n        default:\n          err(_char2, \",' or '}\");\n\n        case ',':\n          continue;\n\n        case '}':\n          _char2 = skip();\n          return result;\n      }\n    }\n  }\n\n  function list() {\n    var end = function () {\n      switch (_char2) {\n        case '(':\n          return ')';\n\n        case '[':\n          return ']';\n\n        default:\n          throw new Error('Assertion failed.');\n      }\n    }();\n\n    var result = [];\n\n    for (;;) {\n      switch (_char2 = skip()) {\n        case end:\n          _char2 = skip();\n          return result;\n\n        default:\n      }\n\n      result.push(any());\n\n      switch (_char2) {\n        default:\n          err(_char2, \",' or '\".concat(end));\n\n        case ',':\n          continue;\n\n        case end:\n          _char2 = skip();\n          return result;\n      }\n    }\n  }\n\n  function True() {\n    if ('T' !== _char2) throw new Error('Assertion failed.');\n\n    var _iterator = _createForOfIteratorHelper('rue'),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var c = _step.value;\n        _char2 = next();\n        if (c !== _char2) err(_char2, c);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    _char2 = skip();\n    return true;\n  }\n\n  function False() {\n    if ('F' !== _char2) throw new Error('Assertion failed.');\n\n    var _iterator2 = _createForOfIteratorHelper('alse'),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var c = _step2.value;\n        _char2 = next();\n        if (c !== _char2) err(_char2, c);\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    _char2 = skip();\n    return false;\n  }\n\n  function str() {\n    var END = _char2;\n\n    switch (END) {\n      default:\n        throw new Error('Assertion failed.');\n\n      case \"'\":\n      case '\"':\n    }\n\n    var result = '';\n\n    for (;;) {\n      switch (_char2 = next()) {\n        case END:\n          _char2 = skip();\n          return result;\n\n        case '\\\\':\n          switch (_char2 = next()) {\n            case 'u':\n              var codePoint = 0;\n\n              for (var i = 0; i < 4; i++) {\n                codePoint <<= 8;\n\n                switch (_char2 = next()) {\n                  default:\n                    err(_char2, 'Hexadecimal digit');\n\n                  case 'f':\n                  case 'F':\n                    ++codePoint;\n\n                  case 'e':\n                  case 'E':\n                    ++codePoint;\n\n                  case 'd':\n                  case 'D':\n                    ++codePoint;\n\n                  case 'c':\n                  case 'C':\n                    ++codePoint;\n\n                  case 'b':\n                  case 'B':\n                    ++codePoint;\n\n                  case 'a':\n                  case 'A':\n                    ++codePoint;\n\n                  case '9':\n                    ++codePoint;\n\n                  case '8':\n                    ++codePoint;\n\n                  case '7':\n                    ++codePoint;\n\n                  case '6':\n                    ++codePoint;\n\n                  case '5':\n                    ++codePoint;\n\n                  case '4':\n                    ++codePoint;\n\n                  case '3':\n                    ++codePoint;\n\n                  case '2':\n                    ++codePoint;\n\n                  case '1':\n                    ++codePoint;\n\n                  case '0':\n                    ++codePoint;\n                }\n              }\n\n              result += String.fromCodePoint(codePoint);\n              continue;\n\n            case 'b':\n              result += '\\b';\n              continue;\n\n            case 'f':\n              result += '\\f';\n              continue;\n\n            case 'n':\n              result += '\\n';\n              continue;\n\n            case 'r':\n              result += '\\r';\n              continue;\n\n            case 't':\n              result += '\\t';\n              continue;\n\n            case '\"':\n            case \"'\":\n            case \"\\\\\": // FALL THROUGH\n\n          }\n\n        default:\n          result += _char2;\n      }\n    }\n  }\n\n  function None() {\n    if ('N' !== _char2) throw new Error('Assertion failed.');\n\n    var _iterator3 = _createForOfIteratorHelper('one'),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var c = _step3.value;\n        _char2 = next();\n        if (c !== _char2) err(_char2, c);\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n\n    _char2 = skip();\n    return null;\n  }\n\n  var _char2 = skip();\n\n  return any();\n}\n\n//# sourceURL=webpack://nd/./src/io/pyon.js?");

/***/ }),

/***/ "./src/iter/index.js":
/*!***************************!*\
  !*** ./src/iter/index.js ***!
  \***************************/
/*! exports provided: argmin, argmax, min, max, linspace, range, cartesian_prod, enumerate, zip, repeat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"linspace\", function() { return linspace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"range\", function() { return range; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cartesian_prod\", function() { return cartesian_prod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"enumerate\", function() { return enumerate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"zip\", function() { return zip; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"repeat\", function() { return repeat; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _min_max__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./min_max */ \"./src/iter/min_max.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"argmin\", function() { return _min_max__WEBPACK_IMPORTED_MODULE_2__[\"argmin\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"argmax\", function() { return _min_max__WEBPACK_IMPORTED_MODULE_2__[\"argmax\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"min\", function() { return _min_max__WEBPACK_IMPORTED_MODULE_2__[\"min\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"max\", function() { return _min_max__WEBPACK_IMPORTED_MODULE_2__[\"max\"]; });\n\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(linspace),\n    _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(range),\n    _marked4 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(cartesian_prod),\n    _marked5 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(enumerate),\n    _marked6 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(zip),\n    _marked7 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(repeat);\n\n\nfunction linspace(start, end, num) {\n  var i, s;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function linspace$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          if (num % 1 === 0) {\n            _context.next = 2;\n            break;\n          }\n\n          throw new Error('linspace(start,end,num): num must be an integer greater than 1.');\n\n        case 2:\n          if (num > 1) {\n            _context.next = 4;\n            break;\n          }\n\n          throw new Error('linspace(start,end,num): num must be an integer.greater than 1.');\n\n        case 4:\n          if (isFinite(start)) {\n            _context.next = 6;\n            break;\n          }\n\n          throw new Error('linspace(start,end,num): start must be a finite number.');\n\n        case 6:\n          if (isFinite(end)) {\n            _context.next = 8;\n            break;\n          }\n\n          throw new Error('linspace(start,end,num): end must be a finite number.');\n\n        case 8:\n          i = 0;\n\n        case 9:\n          if (!(i < num)) {\n            _context.next = 16;\n            break;\n          }\n\n          s = i / (num - 1);\n          _context.next = 13;\n          return start * (1 - s) + s * end;\n\n        case 13:\n          i++;\n          _context.next = 9;\n          break;\n\n        case 16:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\nfunction range(start, stop) {\n  var step,\n      i,\n      _i,\n      _args2 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function range$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          step = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 1;\n\n          if (!(start % 1 !== 0)) {\n            _context2.next = 3;\n            break;\n          }\n\n          throw new Error('range(start, stop, step=1): start not a valid integer.');\n\n        case 3:\n          if (!(stop % 1 !== 0)) {\n            _context2.next = 5;\n            break;\n          }\n\n          throw new Error('range(start, stop, step=1): stop not a valid integer.');\n\n        case 5:\n          if (!(step % 1 !== 0)) {\n            _context2.next = 7;\n            break;\n          }\n\n          throw new Error('range(start, stop, step=1): step not a valid integer.');\n\n        case 7:\n          if (!(step === 0)) {\n            _context2.next = 9;\n            break;\n          }\n\n          throw new Error('range(start, stop, step=1): step must not be 0.');\n\n        case 9:\n          if (!(0 < step)) {\n            _context2.next = 19;\n            break;\n          }\n\n          i = start;\n\n        case 11:\n          if (!(i < stop)) {\n            _context2.next = 17;\n            break;\n          }\n\n          _context2.next = 14;\n          return i;\n\n        case 14:\n          i += step;\n          _context2.next = 11;\n          break;\n\n        case 17:\n          _context2.next = 26;\n          break;\n\n        case 19:\n          _i = start;\n\n        case 20:\n          if (!(_i > stop)) {\n            _context2.next = 26;\n            break;\n          }\n\n          _context2.next = 23;\n          return _i;\n\n        case 23:\n          _i += step;\n          _context2.next = 20;\n          break;\n\n        case 26:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\nfunction cartesian_prod() {\n  var _marked3,\n      _len,\n      seqs,\n      _key,\n      result,\n      iter,\n      _args4 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function cartesian_prod$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          iter = function _iter(i) {\n            var _iterator, _step, x;\n\n            return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function iter$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    if (!(i < seqs.length)) {\n                      _context3.next = 20;\n                      break;\n                    }\n\n                    _iterator = _createForOfIteratorHelper(seqs[i]);\n                    _context3.prev = 2;\n\n                    _iterator.s();\n\n                  case 4:\n                    if ((_step = _iterator.n()).done) {\n                      _context3.next = 10;\n                      break;\n                    }\n\n                    x = _step.value;\n                    result[i] = x;\n                    return _context3.delegateYield(iter(i + 1), \"t0\", 8);\n\n                  case 8:\n                    _context3.next = 4;\n                    break;\n\n                  case 10:\n                    _context3.next = 15;\n                    break;\n\n                  case 12:\n                    _context3.prev = 12;\n                    _context3.t1 = _context3[\"catch\"](2);\n\n                    _iterator.e(_context3.t1);\n\n                  case 15:\n                    _context3.prev = 15;\n\n                    _iterator.f();\n\n                    return _context3.finish(15);\n\n                  case 18:\n                    _context3.next = 22;\n                    break;\n\n                  case 20:\n                    _context3.next = 22;\n                    return result.slice();\n\n                  case 22:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _marked3, null, [[2, 12, 15, 18]]);\n          };\n\n          _marked3 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(iter);\n\n          for (_len = _args4.length, seqs = new Array(_len), _key = 0; _key < _len; _key++) {\n            seqs[_key] = _args4[_key];\n          }\n\n          seqs = seqs.map(function (seq) {\n            return seq instanceof Array || seq instanceof Float32Array || seq instanceof Float64Array || seq instanceof Int8Array || seq instanceof Int16Array || seq instanceof Int32Array || seq instanceof Uint8Array || seq instanceof Uint16Array || seq instanceof Uint32Array ? seq.slice() : _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(seq);\n          });\n          result = new Array(seqs.length);\n          return _context4.delegateYield(iter(0), \"t0\", 6);\n\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4);\n}\nfunction enumerate(seq) {\n  var i, _iterator2, _step2, x;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function enumerate$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          i = 0;\n          _iterator2 = _createForOfIteratorHelper(seq);\n          _context5.prev = 2;\n\n          _iterator2.s();\n\n        case 4:\n          if ((_step2 = _iterator2.n()).done) {\n            _context5.next = 10;\n            break;\n          }\n\n          x = _step2.value;\n          _context5.next = 8;\n          return [i++, x];\n\n        case 8:\n          _context5.next = 4;\n          break;\n\n        case 10:\n          _context5.next = 15;\n          break;\n\n        case 12:\n          _context5.prev = 12;\n          _context5.t0 = _context5[\"catch\"](2);\n\n          _iterator2.e(_context5.t0);\n\n        case 15:\n          _context5.prev = 15;\n\n          _iterator2.f();\n\n          return _context5.finish(15);\n\n        case 18:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, _marked5, null, [[2, 12, 15, 18]]);\n}\nfunction zip() {\n  var _len2,\n      seqs,\n      _key2,\n      N,\n      i,\n      next,\n      _i2,\n      item,\n      _args6 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function zip$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          for (_len2 = _args6.length, seqs = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            seqs[_key2] = _args6[_key2];\n          }\n\n          if (0 < seqs.length) {\n            _context6.next = 3;\n            break;\n          }\n\n          throw new Error('zip(...seqs): seqs.length must be at least 1.');\n\n        case 3:\n          N = seqs.length;\n\n          for (i = N; i-- > 0;) {\n            seqs[i] = seqs[i][Symbol.iterator]();\n          }\n\n        case 5:\n          next = [];\n          _i2 = 0;\n\n        case 7:\n          if (!(_i2 < N)) {\n            _context6.next = 15;\n            break;\n          }\n\n          item = seqs[_i2].next();\n\n          if (!item.done) {\n            _context6.next = 11;\n            break;\n          }\n\n          return _context6.abrupt(\"return\");\n\n        case 11:\n          next.push(item.value);\n\n        case 12:\n          _i2++;\n          _context6.next = 7;\n          break;\n\n        case 15:\n          _context6.next = 17;\n          return next;\n\n        case 17:\n          _context6.next = 5;\n          break;\n\n        case 19:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked6);\n}\nfunction repeat(n, seq) {\n  var i;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function repeat$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          if (undefined === seq) {\n            seq = n;\n            n = Infinity;\n          }\n\n          if (!(n !== Infinity)) {\n            _context7.next = 6;\n            break;\n          }\n\n          if (!(n % 1 !== 0)) {\n            _context7.next = 4;\n            break;\n          }\n\n          throw new Error('repeat(n,seq): n must be a non-negative int or Infinity.');\n\n        case 4:\n          if (n >= 0) {\n            _context7.next = 6;\n            break;\n          }\n\n          throw new Error('repeat(n,seq): n must be a non-negative int or Infinity.');\n\n        case 6:\n          seq = seq instanceof Array || seq instanceof Float32Array || seq instanceof Float64Array || seq instanceof Int8Array || seq instanceof Int16Array || seq instanceof Int32Array || seq instanceof Uint8Array || seq instanceof Uint16Array || seq instanceof Uint32Array ? seq.slice() : _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(seq);\n          i = n;\n\n        case 8:\n          if (!(i-- > 0)) {\n            _context7.next = 12;\n            break;\n          }\n\n          return _context7.delegateYield(seq, \"t0\", 10);\n\n        case 10:\n          _context7.next = 8;\n          break;\n\n        case 12:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, _marked7);\n}\n\n//# sourceURL=webpack://nd/./src/iter/index.js?");

/***/ }),

/***/ "./src/iter/min_max.js":
/*!*****************************!*\
  !*** ./src/iter/min_max.js ***!
  \*****************************/
/*! exports provided: argmin, argmax, min, max */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"argmin\", function() { return argmin; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"argmax\", function() { return argmax; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"min\", function() { return min; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max\", function() { return max; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\nfunction argmin(seq) {\n  var compare_fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x, y) {\n    return (x > y) - (x < y);\n  };\n  if (!(compare_fn instanceof Function)) throw new Error('argmin(seq,compare_fn): compare_fn must be a function.');\n  if (Symbol.iterator in seq) seq = seq[Symbol.iterator]();else console.warn('argmin(seq,compare_fn): seq[Symbol.iterator] does not exist.');\n\n  var val = function () {\n    var first = seq.next();\n    if (first.done) throw new Error('argmin(seq,compare_fn): seq must be an iterable containing at least one item.');\n    return first.value;\n  }();\n\n  var idx = 0;\n\n  for (var i = 1;; i++) {\n    var next = seq.next();\n    if (next.done) return idx;\n\n    if (compare_fn(val, next.value) > 0) {\n      idx = i;\n      val = next.value;\n    }\n  }\n}\nfunction argmax(seq) {\n  var compare_fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x, y) {\n    return (x > y) - (x < y);\n  };\n  if (!(compare_fn instanceof Function)) throw new Error('argmax(seq,compare_fn): compare_fn must be a function.');\n  return argmin(seq, function (x, y) {\n    return -compare_fn(x, y);\n  });\n}\nfunction min(seq) {\n  var compare_fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x, y) {\n    return (x > y) - (x < y);\n  };\n  if (!(compare_fn instanceof Function)) throw new Error('argmin(seq,compare_fn): compare_fn must be a function.');\n  if (Symbol.iterator in seq) seq = seq[Symbol.iterator]();else console.warn('argmin(seq,compare_fn): seq[Symbol.iterator] does not exist.');\n\n  var val = function () {\n    var first = seq.next();\n    if (first.done) throw new Error('argmin(seq,compare_fn): seq must be an iterable containing at least one item.');\n    return first.value;\n  }();\n\n  for (;;) {\n    var next = seq.next();\n    if (next.done) return val;\n    if (compare_fn(val, next.value) > 0) val = next.value;\n  }\n}\nfunction max(seq) {\n  var compare_fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x, y) {\n    return (x > y) - (x < y);\n  };\n  if (!(compare_fn instanceof Function)) throw new Error('argmax(seq,compare_fn): compare_fn must be a function.');\n  return min(seq, function (x, y) {\n    return -compare_fn(x, y);\n  });\n}\n\n//# sourceURL=webpack://nd/./src/iter/min_max.js?");

/***/ }),

/***/ "./src/kahan_sum.js":
/*!**************************!*\
  !*** ./src/kahan_sum.js ***!
  \**************************/
/*! exports provided: KahanSum */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KahanSum\", function() { return KahanSum; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nvar KahanSum = /*#__PURE__*/function () {\n  function KahanSum() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, KahanSum);\n\n    this.sum = this.rst = 0; // <- rest\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(KahanSum, [{\n    key: \"set\",\n    value: function set(sum) {\n      var rst = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      if (isNaN(sum *= 1)) throw new Error('Assertion failed.');\n      if (isNaN(rst *= 1)) throw new Error('Assertion failed.');\n      this.sum = sum;\n      this.rst = rst;\n    }\n  }, {\n    key: \"add\",\n    value: function add(val) {\n      var cor = val - this.rst,\n          sum = this.sum + cor;\n      this.rst = sum - this.sum - cor;\n      this.sum = sum;\n    }\n  }]);\n\n  return KahanSum;\n}();\n\n//# sourceURL=webpack://nd/./src/kahan_sum.js?");

/***/ }),

/***/ "./src/la/_giv_rot.js":
/*!****************************!*\
  !*** ./src/la/_giv_rot.js ***!
  \****************************/
/*! exports provided: _giv_rot_qr, _giv_rot_rows, _giv_rot_cols */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_giv_rot_qr\", function() { return _giv_rot_qr; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_giv_rot_rows\", function() { return _giv_rot_rows; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_giv_rot_cols\", function() { return _giv_rot_cols; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** Computes cos and sin of a Givens rotation as used by QR.\n */\n\nfunction _giv_rot_qr(A_ii, A_ji) {\n  var max = Math.max(Math.abs(A_ii), Math.abs(A_ji));\n  if (0 === max) return [1, 0, 0]; // <- handles NaN\n\n  A_ii /= max;\n  A_ji /= max;\n  var norm = Math.sqrt(A_ii * A_ii + A_ji * A_ji);\n  A_ii /= norm;\n  A_ji /= norm;\n  norm *= max;\n  /*DEBUG*/\n\n  if (!(0 <= norm)) throw new Error('Assertion failed: ' + norm);\n  return [A_ii, A_ji, norm];\n}\n/** Applies a Givens rotation to rows i and j.\n */\n\nfunction _giv_rot_rows(W, N, i, j, c, s) {\n  /*DEBUG*/\n  if (N % 1 !== 0) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (i % 1 !== 0) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (j % 1 !== 0) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(0 <= N)) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(0 <= i)) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(0 <= j)) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (0 !== W.length % 1) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(i < W.length - N + 1)) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(j < W.length - N + 1)) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  if (!(Math.abs(Math.hypot(c, s) - 1) <= 1e-6)) throw new Error('Assertion failed.');\n  N |= 0;\n  i |= 0;\n  j |= 0;\n  c = +c;\n  s = +s;\n\n  for (var k = N | 0; k-- > 0;) {\n    var W_i = W[i],\n        W_j = W[j];\n    W[i] = c * W_i + s * W_j;\n    W[j] = c * W_j - s * W_i;\n    i = i + 1 | 0;\n    j = j + 1 | 0;\n  }\n}\n/** Applies a Givens rotation to columns i and j (to a square matrix).\n */\n\nfunction _giv_rot_cols(W, N, i, j, c, s) {\n  /*DEBUG*/\n  if (!(Math.abs(Math.hypot(c, s) - 1) <= 1e-6)) throw new Error('Assertion failed.');\n  i |= 0;\n  j |= 0;\n  c = +c;\n  s = +s;\n\n  for (var k = N | 0; k-- > 0;) {\n    var W_i = W[i],\n        W_j = W[j];\n    W[i] = c * W_i - s * W_j;\n    W[j] = c * W_j + s * W_i;\n    i = i + N | 0;\n    j = j + N | 0;\n  }\n}\n\n//# sourceURL=webpack://nd/./src/la/_giv_rot.js?");

/***/ }),

/***/ "./src/la/_svd_jac_utils.js":
/*!**********************************!*\
  !*** ./src/la/_svd_jac_utils.js ***!
  \**********************************/
/*! exports provided: _svd_jac_angles, _svd_jac_post, _svd_jac_post_skip1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_jac_angles\", function() { return _svd_jac_angles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_jac_post\", function() { return _svd_jac_post; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_jac_post_skip1\", function() { return _svd_jac_post_skip1; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n//export function _svd_jac_angles( S_pp, S_pq,\n//                                 S_qp, S_qq )\n//{\n//  // determine rotation angles such that\n//  //                                                        \n//  //  cos() sin()   S_pp  S_pq   cos() sin()  !  s1   0 \n//  //                                              =         \n//  // -sin() cos()   S_qp  S_qq  -sin() cos()      0  s2 \n//  //                                                         \n//  const d = S_qp - S_pq;\n//  let  ca = 1,\n//       sa = 0,\n//        x = (S_qq - S_pp) / (2*S_pq);\n//  if( 0 !== d )\n//  { // SYMMETRIZE\n//    x = (S_pp + S_qq) / d;\n//    const    y = Math.sqrt(1 + x*x);\n//    sa = 1 / y;\n//    ca = x / y;\n//    x = ( x*(S_qq - S_pp) - (S_pq + S_qp) )\n//      / ( x*(S_pq + S_qp) + (S_qq - S_pp) );\n//  }\n//\n//  // DIAGONALIZE\n//  let   y = Math.abs(x) + Math.sqrt(1 + x*x);\n//  const s = x < 0 ? -1 : +1,\n//        z = 1 / y;\n//  let  cb =  1  / Math.sqrt(1 + z*z),\n//       sb = s*z / Math.sqrt(1 + z*z);\n////       sb = s / Math.sqrt(1 + y*y);\n//\n//   x = ca*cb + sa*sb;\n//  sa = sa*cb - ca*sb;\n//  ca = x;\n//\n//  x = cb*(sa*S_qp + ca*S_pp) - sb*(sa*S_qq + ca*S_pq),\n//  y = sb*(ca*S_qp - sa*S_pp) + cb*(ca*S_qq - sa*S_pq);\n//\n//  if( Math.abs(x) < Math.abs(y) ) {\n//    [ca,sa] = [-sa,ca];\n//    [sb,cb] = [-cb,sb]; x = y;\n//  }\n//\n//  if( x < 0 ) {\n//    cb = -cb;\n//    sb = -sb;\n//  }\n//\n//  return [ca,sa, cb,sb];\n//}\n\nfunction _svd_jac_angles(S_pp, S_pq, S_qp, S_qq) {\n  // determine rotation angles such that\n  //                                                        \n  //  cos() sin()   S_pp  S_pq   cos() sin()  !  s1   0 \n  //                                              =         \n  // -sin() cos()   S_qp  S_qq  -sin() cos()      0  s2 \n  //                                                        \n  //\n  // such that: s1  |s2|\n  //                                                                                      \n  // => 0 = { sin()S_qp + cos()S_pp }sin() + { sin()S_qq + cos()S_pq }cos() = {(S_qq - S_pp)sin(-) + (S_pp + S_qq)sin(+) + (S_pq + S_qp)cos(-) + (S_pq - S_qp)cos(+)}\n  //    0 = { cos()S_qp - sin()S_pp }cos() - { cos()S_qq - sin()S_pq }sin() = {(S_qq - S_pp)sin(-) - (S_qq + S_pp)sin(+) + (S_pq + S_qp)cos(-) - (S_pq - S_qp)cos(+)}\n  //   d1 = { sin()S_qp + cos()S_pp }cos() - { sin()S_qq + cos()S_pq }sin()\n  //   d2 = { cos()S_qp - sin()S_pp }sin() + { cos()S_qq - sin()S_pq }cos()\n  //\n  // => 0 = (S_qq - S_pp)sin(-) + (S_pq + S_qq)cos(-)  \n  //    0 = (S_qq + S_pp)sin(+) + (S_pq - S_qp)cos(+) \n  var x = Math.atan2(S_qp - S_pq, S_qq + S_pp),\n      y = Math.atan2(S_qp + S_pq, S_qq - S_pp);\n  var a = (x - y) / 2,\n      b = (x + y) / 2;\n  var ca = Math.cos(a),\n      sa = Math.sin(a),\n      cb = Math.cos(b),\n      sb = Math.sin(b);\n  x = cb * (sa * S_qp + ca * S_pp) - sb * (sa * S_qq + ca * S_pq);\n  y = sb * (ca * S_qp - sa * S_pp) + cb * (ca * S_qq - sa * S_pq);\n\n  if (Math.abs(x) < Math.abs(y)) {\n    var _ref = [ca, -sa];\n    sa = _ref[0];\n    ca = _ref[1];\n    var _ref2 = [sb, -cb];\n    cb = _ref2[0];\n    sb = _ref2[1];\n    x = y;\n  }\n\n  if (x < 0) {\n    cb = -cb;\n    sb = -sb;\n  }\n\n  return [ca, sa, cb, sb];\n}\n/** Postprocessing of the jacobi iteration result:\n *    1) Copy singular values from work matrix S to result array sv\n *    2) Make singular values positive\n *    3) Sort singular values\n *    4) Transpose U (was transposed for cache friendliness reasons)\n */\n\nfunction _svd_jac_post(N, U, S, V, UV_off, sv, sv_off, ord) {\n  N |= 0;\n  UV_off |= 0;\n  sv_off |= 0; // 1) MOVE S -> sv\n\n  for (var i = 0; i < N; i++) {\n    sv[sv_off + i] = S[N * i + i];\n  }\n\n  _svd_jac_post_skip1(N, U, V, UV_off, sv, sv_off, ord);\n}\n/** Same as `_svd_jac_post` except that step 1) is skipped.\n */\n\nfunction _svd_jac_post_skip1(N, U, V, UV_off, sv, sv_off, ord) {\n  N |= 0;\n  UV_off |= 0;\n  sv_off |= 0; // 2) MAKE SV POSITIVE\n\n  for (var i = N; i-- > 0;) {\n    var sv_i = sv[sv_off + i];\n\n    if (sv_i < 0 || Object.is(sv_i, -0)) {\n      sv[sv_off + i] = -sv_i;\n\n      for (var j = 0; j < N; j++) {\n        U[UV_off + N * i + j] *= -1;\n      }\n    }\n  } // 3) SORT SV\n\n\n  ord.sort(function (i, j) {\n    return sv[sv_off + j] - sv[sv_off + i];\n  }); // nested loop but actually O(N) operation\n\n  for (var _i = 0; _i < N; ++_i) {\n    for (var _j = _i;;) // <- start swap cycle\n    {\n      var tmp = ord[_j];\n      ord[_j] = _j;\n      _j = tmp;\n      if (_j <= _i) break; // SWAP ROWS IN U AND V\n\n      var rowI = UV_off + ord[_j] * N,\n          rowJ = UV_off + _j * N;\n\n      for (var k = 0; k < N; k++) {\n        var U_ik = U[rowI + k];\n        U[rowI + k] = U[rowJ + k];\n        U[rowJ + k] = U_ik;\n      }\n\n      for (var _k = 0; _k < N; _k++) {\n        var V_ik = V[rowI + _k];\n        V[rowI + _k] = V[rowJ + _k];\n        V[rowJ + _k] = V_ik;\n      } // SWAP SV\n\n\n      tmp = sv[sv_off + ord[_j]];\n      sv[sv_off + ord[_j]] = sv[sv_off + _j];\n      sv[sv_off + _j] = tmp;\n    }\n  } // 4) TRANSPOSE U\n\n\n  for (var _i2 = 0; _i2 < N - 1; _i2++) {\n    for (var _j2 = _i2; ++_j2 < N;) {\n      var ij = UV_off + N * _i2 + _j2,\n          ji = UV_off + N * _j2 + _i2,\n          U_ij = U[ij];\n      U[ij] = U[ji];\n      U[ji] = U_ij;\n    }\n  }\n}\n\n//# sourceURL=webpack://nd/./src/la/_svd_jac_utils.js?");

/***/ }),

/***/ "./src/la/bidiag.js":
/*!**************************!*\
  !*** ./src/la/bidiag.js ***!
  \**************************/
/*! exports provided: _bidiag_decomp_horiz, bidiag_decomp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_bidiag_decomp_horiz\", function() { return _bidiag_decomp_horiz; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bidiag_decomp\", function() { return bidiag_decomp; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n // TODO: bidiag_decomp_full\n// TODO: bidiag_solve\n// TODO: bidiag_lstsq?\n\nfunction _bidiag_decomp_vert(M, N, U, U_off, B, V, BV_off) {\n  M |= 0;\n  N |= 0;\n  U_off |= 0;\n  BV_off |= 0;\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"]();\n  if (M < N) throw new Error('Assertion failed.'); // init V to identity\n\n  for (var i = N; i-- > 0;) {\n    V[BV_off + N * i + i] = 1;\n  }\n\n  for (var _i = 0; _i < N; _i++) {\n    // ELIMINATE ELEMENTS BELOW (i,i) USING GIVENS\n    var ii = U_off + N * _i + _i;\n\n    for (var j = _i; ++j < M;) {\n      var ji = U_off + N * j + _i;\n      var B_ji = U[ji];\n      if (0 === B_ji) continue;\n      var B_ii = U[ii];\n\n      var _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(B_ii, B_ji),\n          _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n          c = _giv_rot_qr3[0],\n          s = _giv_rot_qr3[1],\n          norm = _giv_rot_qr3[2];\n\n      if (s !== 0) {\n        // <- might happen in case of underflow\n        if (c < 0) {\n          c *= -1;\n          s *= -1;\n          norm *= -1;\n        }\n\n        Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(U, N - 1 - _i, ii + 1, ji + 1, c, s);\n\n        U[ii] = norm;\n      }\n\n      U[ji] = s;\n    }\n\n    if (_i < N - 2) {\n      // ELIMINATE ELEMENTS RIGHT OF (i,i+1) USING HOUSEHOLDER\n      NORM.reset();\n\n      for (var _j = N; --_j > _i + 1;) {\n        NORM.include(U[U_off + N * _i + _j]);\n      }\n\n      if (NORM.max === 0) continue;\n\n      var _norm = NORM.resultIncl(U[ii + 1]) * (U[ii + 1] > 0 ? -1 : +1);\n\n      NORM.include(U[ii + 1] -= _norm);\n      var max = NORM.max,\n          div = Math.sqrt(NORM.sum);\n\n      for (var _j2 = _i; ++_j2 < N;) {\n        U[U_off + N * _i + _j2] = U[U_off + N * _i + _j2] / max / div;\n      } // apply householder to right of V\n\n\n      for (var _j3 = 0; _j3 < N; _j3++) {\n        var sum = 0;\n\n        for (var k = _i; ++k < N;) {\n          sum += V[BV_off + N * _j3 + k] * U[U_off + N * _i + k];\n        }\n\n        sum *= 2;\n\n        for (var _k = _i; ++_k < N;) {\n          V[BV_off + N * _j3 + _k] -= U[U_off + N * _i + _k] * sum;\n        }\n      } // apply householder to right of B\n\n\n      for (var _j4 = _i; ++_j4 < M;) {\n        var _sum = 0;\n\n        for (var _k2 = _i; ++_k2 < N;) {\n          _sum += U[U_off + N * _j4 + _k2] * U[U_off + N * _i + _k2];\n        }\n\n        _sum *= 2;\n\n        for (var _k3 = _i; ++_k3 < N;) {\n          U[U_off + N * _j4 + _k3] -= U[U_off + N * _i + _k3] * _sum;\n        }\n      }\n\n      U[ii + 1] = _norm;\n      U.fill(0.0, ii + 2, U_off + N * (_i + 1));\n    }\n  }\n\n  Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"_transpose_inplace\"])(N, V, BV_off); // COPY U -> B\n\n\n  for (var _i2 = N; --_i2 > 0;) {\n    B[BV_off + N * _i2 + _i2] = U[U_off + N * _i2 + _i2];\n    B[BV_off + N * (_i2 - 1) + _i2] = U[U_off + N * (_i2 - 1) + _i2];\n  }\n\n  B[BV_off] = U[U_off]; // COMPUTE U\n  // init upper right triangle of U\n\n  for (var _i3 = 0; _i3 < N; _i3++) {\n    for (var _j5 = _i3; _j5 < N; _j5++) {\n      U[U_off + N * _i3 + _j5] = +(_i3 === _j5);\n    }\n  }\n\n  for (var _i4 = N; _i4-- > 0;) {\n    for (var _j6 = M; --_j6 > _i4;) {\n      var _s = U[U_off + N * _j6 + _i4];\n      if (0 === _s) continue;\n      U[U_off + N * _j6 + _i4] = 0;\n\n      var _c = Math.sqrt((1 + _s) * (1 - _s));\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(U, N - _i4, U_off + N * _j6 + _i4, U_off + N * _i4 + _i4, _c, _s);\n    }\n  }\n}\n\nfunction _bidiag_decomp_square(N, U, B, V, off) {\n  N |= 0;\n  off |= 0;\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"](); // INIT U & V TO IDENTITY\n\n  for (var i = N; i-- > 0;) {\n    U[off + N * i + i] = 1;\n  }\n\n  for (var _i5 = N; _i5-- > 0;) {\n    V[off + N * _i5 + _i5] = 1;\n  }\n\n  for (var _i6 = 0; _i6 < N - 1; _i6++) {\n    // ELIMINATE ELEMENTS BELOW (i,i) USING GIVENS\n    var ii = off + N * _i6 + _i6;\n\n    for (var j = _i6; ++j < N;) {\n      var ji = off + N * j + _i6;\n      var B_ji = B[ji];\n      if (0 === B_ji) continue;\n\n      var B_ii = B[ii],\n          _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(B_ii, B_ji),\n          _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n          c = _giv_rot_qr5[0],\n          s = _giv_rot_qr5[1],\n          _norm2 = _giv_rot_qr5[2];\n\n      B[ji] = 0;\n      if (0 === s) continue; // <- can happen due to underflow\n\n      B[ii] = _norm2;\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(B, N - 1 - _i6, ii + 1, ji + 1, c, s);\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(U, 1 + j, off + N * _i6, off + N * j, c, s);\n    } // ELIMINATE ELEMENTS RIGHT OF (i,i+1) USING HOUSEHOLDER\n\n\n    NORM.reset();\n\n    for (var _j7 = N; --_j7 > _i6 + 1;) {\n      NORM.include(B[off + N * _i6 + _j7]);\n    }\n\n    if (NORM.max === 0) continue;\n    var norm = NORM.resultIncl(B[ii + 1]) * (B[ii + 1] > 0 ? -1 : +1);\n    NORM.include(B[ii + 1] -= norm);\n    var max = NORM.max,\n        div = Math.sqrt(NORM.sum);\n\n    for (var _j8 = _i6; ++_j8 < N;) {\n      B[off + N * _i6 + _j8] = B[off + N * _i6 + _j8] / max / div;\n    } // apply householder to right of V\n\n\n    for (var _j9 = 0; _j9 < N; _j9++) {\n      var sum = 0;\n\n      for (var k = _i6; ++k < N;) {\n        sum += V[off + N * _j9 + k] * B[off + N * _i6 + k];\n      }\n\n      sum *= 2;\n\n      for (var _k4 = _i6; ++_k4 < N;) {\n        V[off + N * _j9 + _k4] -= B[off + N * _i6 + _k4] * sum;\n      }\n    } // apply householder to right of B\n\n\n    for (var _j10 = _i6; ++_j10 < N;) {\n      var _sum2 = 0;\n\n      for (var _k5 = _i6; ++_k5 < N;) {\n        _sum2 += B[off + N * _j10 + _k5] * B[off + N * _i6 + _k5];\n      }\n\n      _sum2 *= 2;\n\n      for (var _k6 = _i6; ++_k6 < N;) {\n        B[off + N * _j10 + _k6] -= B[off + N * _i6 + _k6] * _sum2;\n      }\n    }\n\n    B[ii + 1] = norm;\n    B.fill(0.0, ii + 2, off + N * (_i6 + 1));\n  }\n\n  Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"_transpose_inplace\"])(N, V, off);\n\n  Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"_transpose_inplace\"])(N, U, off);\n}\n\nfunction _bidiag_decomp_horiz(M, N, U, U_off, B, B_off, V, V_off) {\n  M |= 0;\n  N |= 0;\n  U_off |= 0;\n  B_off |= 0;\n  V_off = V_off + N | 0;\n  if (!(M <= N)) throw Error('Assertion failed.');\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"](); // INIT U TO IDENTITY\n\n  for (var i = M; i-- > 0;) {\n    U[U_off + M * i + i] = 1;\n  }\n\n  outer_loop: for (var _i7 = 0; _i7 < M && _i7 < N - 1; _i7++) {\n    // ELIMINATE ELEMENTS BELOW (i,i) USING GIVENS\n    var ii = V_off + N * _i7 + _i7;\n\n    inner_loop: for (var j = _i7; ++j < M;) {\n      var ji = V_off + N * j + _i7;\n      var B_ji = V[ji];\n      if (0 === B_ji) continue inner_loop;\n\n      var B_ii = V[ii],\n          _giv_rot_qr6 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(B_ii, B_ji),\n          _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr6, 3),\n          c = _giv_rot_qr7[0],\n          s = _giv_rot_qr7[1],\n          _norm3 = _giv_rot_qr7[2];\n\n      V[ji] = 0;\n      if (0 === s) continue inner_loop;\n      V[ii] = _norm3;\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(V, N - 1 - _i7, ii + 1, ji + 1, c, s);\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(U, 1 + j, U_off + M * _i7, U_off + M * j, c, s);\n    } // ELIMINATE ELEMENTS RIGHT OF (i,i+1) USING HOUSEHOLDER\n    // compute householder vector\n\n\n    var above = V_off + N * (_i7 - 1); // <- write householder to row (i-1)\n\n    NORM.reset();\n\n    for (var _j11 = N - 1;;) {\n      var V_j = V[above + _j11] = V[V_off + N * _i7 + _j11];\n      if (--_j11 <= _i7) break;\n      NORM.include(V_j);\n    }\n\n    if (0 === NORM.max) {\n      V[above + (_i7 + 1)] = 0;\n      continue outer_loop;\n    }\n\n    var norm = NORM.resultIncl(V[above + (_i7 + 1)]) * (V[above + (_i7 + 1)] > 0 ? -1 : +1);\n    NORM.include(V[above + (_i7 + 1)] -= norm);\n    var max = NORM.max,\n        div = Math.sqrt(NORM.sum);\n\n    for (var _j12 = _i7; ++_j12 < N;) {\n      V[above + _j12] = V[above + _j12] / max / div;\n    } // apply householder to right of B (stored in V)\n\n\n    for (var _j13 = _i7; ++_j13 < M;) {\n      var sum = 0;\n\n      for (var k = _i7; ++k < N;) {\n        sum += V[V_off + N * _j13 + k] * V[above + k];\n      }\n\n      sum *= 2;\n\n      for (var _k7 = _i7; ++_k7 < N;) {\n        V[V_off + N * _j13 + _k7] -= V[above + _k7] * sum;\n      }\n    }\n\n    V[ii + 1] = norm;\n  } // TRANSPOSE U\n\n\n  Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"_transpose_inplace\"])(M, U, U_off); // COPY V -> B\n\n\n  for (var _i8 = M; _i8-- > 0;) {\n    B[B_off + (M + 1) * _i8 + (_i8 + 1)] = _i8 < N - 1 ? V[V_off + N * _i8 + (_i8 + 1)] : 0;\n    B[B_off + (M + 1) * _i8 + _i8] = V[V_off + N * _i8 + _i8];\n  } // COMPUTE V\n\n\n  for (var _i9 = Math.min(M, N - 1);;) {\n    --_i9;\n    V.fill(0.0, V_off + N * _i9, V_off + N * (_i9 + 1));\n    V[V_off + N * _i9 + (_i9 + 1)] = 1;\n    if (_i9 < 0) break;\n\n    var _above = V_off + N * (_i9 - 1); // <- read householder from row (i-1)\n    // apply householder to right of V\n\n\n    for (var _j14 = _i9; _j14 < M; _j14++) {\n      var _sum3 = 0;\n\n      for (var _k8 = _i9; ++_k8 < N;) {\n        _sum3 += V[V_off + N * _j14 + _k8] * V[_above + _k8];\n      }\n\n      _sum3 *= 2;\n\n      for (var _k9 = _i9; ++_k9 < N;) {\n        V[V_off + N * _j14 + _k9] -= V[_above + _k9] * _sum3;\n      }\n    }\n  }\n}\nfunction bidiag_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('bidiag_decomp(A): A must be at least 2D.');\n  if (A.dtype.startsWith('complex')) throw new Error('bidiag_decomp(A): complex A not yet supported.');\n\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][DType],\n      U_shape = Int32Array.from(A.shape),\n      B_shape = Int32Array.from(U_shape),\n      V_shape = Int32Array.from(U_shape),\n      _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      M = _A$shape$slice2[0],\n      N = _A$shape$slice2[1],\n      len = A.data.length / (M * N) | 0,\n      I = Math.min(M, N) | 0,\n      J = (M >= N ? I : I + 1) | 0; // #columns of bidiag. matrix B\n\n\n  U_shape[U_shape.length - 1] = I;\n  B_shape[B_shape.length - 2] = I;\n  B_shape[B_shape.length - 1] = J;\n  V_shape[V_shape.length - 2] = J;\n\n  var _ref = function () {\n    if (M === N) {\n      var _B = DTypeArray.from(A.data),\n          _U = new DTypeArray(_B.length),\n          _V = new DTypeArray(_B.length);\n\n      for (var off = 0; off < _B.length; off += N * N) {\n        _bidiag_decomp_square(N, _U, _B, _V, off);\n      }\n\n      return [_U, _B, _V];\n    } else if (M > N) {\n      var _U2 = DTypeArray.from(A.data);\n\n      A = undefined;\n\n      var _B2 = new DTypeArray(len * N * N),\n          _V2 = new DTypeArray(len * N * N);\n\n      for (var U_off = 0, BV_off = 0; BV_off < _B2.length; U_off += M * N, BV_off += N * N) {\n        _bidiag_decomp_vert(M, N, _U2, U_off, _B2, _V2, BV_off);\n      }\n\n      return [_U2, _B2, _V2];\n    } else {\n      /*M < N*/\n      var _V3 = new DTypeArray(len * (M + 1) * N);\n      /*DEBUG*/\n\n\n      if (!(M < N)) throw new Error('Assertion failed.');\n      A = A.data;\n\n      for (var j = 0, i = N; i < _V3.length; i += N) {\n        for (var _I = i + M * N; i < _I; j++, i++) {\n          _V3[i] = A[j];\n        }\n      }\n\n      A = undefined;\n\n      var _U3 = new DTypeArray(len * M * M),\n          _B3 = new DTypeArray(len * M * (M + 1));\n\n      for (var _U_off = 0, B_off = 0, V_off = 0; B_off < _B3.length; _U_off += M * M, B_off += M * (M + 1), V_off += (M + 1) * N) {\n        _bidiag_decomp_horiz(M, N, _U3, _U_off, _B3, B_off, _V3, V_off);\n      }\n\n      return [_U3, _B3, _V3];\n    }\n  }(),\n      _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 3),\n      U = _ref2[0],\n      B = _ref2[1],\n      V = _ref2[2];\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](U_shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](B_shape, B), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](V_shape, V)];\n}\n\n//# sourceURL=webpack://nd/./src/la/bidiag.js?");

/***/ }),

/***/ "./src/la/cholesky.js":
/*!****************************!*\
  !*** ./src/la/cholesky.js ***!
  \****************************/
/*! exports provided: _cholesky_decomp, cholesky_decomp, cholesky_solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_cholesky_decomp\", function() { return _cholesky_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cholesky_decomp\", function() { return cholesky_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cholesky_solve\", function() { return cholesky_solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _kahan_sum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../kahan_sum */ \"./src/kahan_sum.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\nfunction _cholesky_decomp(M, N, L, L_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  var kahan = new _kahan_sum__WEBPACK_IMPORTED_MODULE_2__[\"KahanSum\"](); // https://de.wikipedia.org/wiki/Cholesky-Zerlegung\n\n  for (var i = 0; i < M; i++) {\n    for (var j = 0; j <= i; j++) {\n      kahan.set(L[L_off + N * i + j]);\n\n      for (var k = 0; k < j; k++) {\n        kahan.add(-L[L_off + N * i + k] * L[L_off + N * j + k]);\n      }\n\n      if (i > j) L[L_off + N * i + j] = kahan.sum / L[L_off + N * j + j];else {\n        L[L_off + N * i + i] = Math.sqrt(kahan.sum);\n        if (isNaN(L[L_off + N * i + i])) throw new Error('Matrix contains NaNs or is (near) singular.');\n      }\n    }\n  }\n}\nfunction cholesky_decomp(S) {\n  S = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(S);\n\n  var dtype = S.dtype === 'float32' ? 'float32' : 'float64',\n      shape = S.shape,\n      _shape$slice = shape.slice(-2),\n      _shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_shape$slice, 2),\n      N = _shape$slice2[0],\n      M = _shape$slice2[1];\n\n  S = S.data;\n  var L = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](S.length);\n  if (N != M) throw new Error('Last two dimensions must be quadratic.');\n\n  for (var L_off = 0; L_off < L.length; L_off += N * N) {\n    for (var i = 0; i < N; i++) {\n      for (var j = 0; j <= i; j++) {\n        L[L_off + N * i + j] = S[L_off + N * i + j];\n      }\n    }\n\n    _cholesky_decomp(N, N, L, L_off);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, L);\n}\nfunction cholesky_solve(L, y) {\n  L = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(L);\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(y);\n  if (L.ndim < 2) throw new Error('L must be at least 2D.');\n  if (y.ndim < 2) throw new Error('y must be at least 2D.');\n\n  var _L$shape$slice = L.shape.slice(-2),\n      _L$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_L$shape$slice, 2),\n      N = _L$shape$slice2[0],\n      M = _L$shape$slice2[1],\n      _y$shape$slice = y.shape.slice(-2),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 2),\n      I = _y$shape$slice2[0],\n      J = _y$shape$slice2[1];\n\n  if (N != M) throw new Error('Last two dimensions of L must be quadratic.');\n  if (I != M) throw new Error(\"L and y don't match.\");\n  var ndim = Math.max(L.ndim, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i = 0, _arr = [L, y]; _i < _arr.length; _i++) {\n    var arr = _arr[_i];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var dtype = L.dtype === 'float32' && y.dtype === 'float32' ? 'float32' : 'float64',\n      x_dat = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      L_dat = L.data,\n      y_dat = y.data;\n  var L_off = 0,\n      L_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      L_stride = N * N;\n      y_stride = N * J; // COPYING y\n\n      for (var _i2 = 0; _i2 < y_stride; _i2++) {\n        x_dat[x_off + _i2] = y_dat[y_off + _i2];\n      }\n\n      Object(_tri__WEBPACK_IMPORTED_MODULE_4__[\"_tril_solve\"])(I, I, J, L_dat, L_off, x_dat, x_off);\n\n      Object(_tri__WEBPACK_IMPORTED_MODULE_4__[\"_tril_t_solve\"])(I, I, J, L_dat, L_off, x_dat, x_off);\n\n      L_off += L_stride;\n      y_off += y_stride;\n      x_off += y_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break;\n      if (!(L.shape[d - ndim + L.ndim] > 1)) L_off -= L_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    L_stride *= L.shape[d - ndim + L.ndim] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/cholesky.js?");

/***/ }),

/***/ "./src/la/det.js":
/*!***********************!*\
  !*** ./src/la/det.js ***!
  \***********************/
/*! exports provided: det_tri, slogdet_tri, det, slogdet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"det_tri\", function() { return det_tri; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"slogdet_tri\", function() { return slogdet_tri; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"det\", function() { return det; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"slogdet\", function() { return slogdet; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _qr__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./qr */ \"./src/la/qr.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nvar det_tri = function det_tri(a) {\n  a = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(a);\n  if (a.ndim < 2) throw new Error(\"det_tri(a): a.shape=[\".concat(a.shape, \"]; a.ndim must be at least 2.\"));\n\n  var a_shape = a.shape,\n      _a_shape$slice = a_shape.slice(-2),\n      _a_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_a_shape$slice, 2),\n      M = _a_shape$slice2[0],\n      N = _a_shape$slice2[1];\n\n  if (M !== N) throw new Error(\"det_tri(a): a must be square matrices.\");\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][a.dtype];\n  var A = a.data;\n  a = undefined;\n  var D = new DTypeArray(A.length / (N * N));\n\n  for (var D_off = 0, A_off = 0; D_off < D.length; D_off++) {\n    var i = A_off;\n    A_off += N * N;\n    var d = 1;\n\n    for (; i < A_off; i += N + 1) {\n      d *= A[i];\n    }\n\n    D[D_off] = d;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](a_shape.slice(0, -2), D);\n};\nvar slogdet_tri = function slogdet_tri(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error(\"det_tri(A): A.ndim must be at least 2.\");\n\n  var A_shape = A.shape,\n      _A_shape$slice = A_shape.slice(-2),\n      _A_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A_shape$slice, 2),\n      M = _A_shape$slice2[0],\n      N = _A_shape$slice2[1];\n\n  if (M !== N) throw new Error(\"det_tri(A): A must be square matrices.\");\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'];\n  A = A.data;\n  var S = new DTypeArray(A.length / (N * N)),\n      D = new DTypeArray(S.length);\n\n  for (var SD_off = 0, A_off = 0; SD_off < D.length; SD_off++) {\n    var i = A_off;\n    A_off += N * N;\n    var s = 1,\n        d = 0;\n\n    for (; i < A_off; i += N + 1) {\n      s *= Math.sign(A[i]);\n      d += Math.log(Math.abs(A[i]));\n    }\n\n    S[SD_off] = s;\n    D[SD_off] = d;\n  }\n\n  var SD_shape = A_shape.slice(0, -2);\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](SD_shape, S), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](SD_shape, D)];\n};\nvar det = function det(A) {\n  var _qr_decomp = Object(_qr__WEBPACK_IMPORTED_MODULE_3__[\"qr_decomp\"])(A),\n      _qr_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp, 2),\n      Q = _qr_decomp2[0],\n      R = _qr_decomp2[1];\n\n  return det_tri(R);\n};\nvar slogdet = function slogdet(A) {\n  var _qr_decomp3 = Object(_qr__WEBPACK_IMPORTED_MODULE_3__[\"qr_decomp\"])(A),\n      _qr_decomp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp3, 2),\n      Q = _qr_decomp4[0],\n      R = _qr_decomp4[1];\n\n  return slogdet_tri(R);\n};\n\n//# sourceURL=webpack://nd/./src/la/det.js?");

/***/ }),

/***/ "./src/la/diag.js":
/*!************************!*\
  !*** ./src/la/diag.js ***!
  \************************/
/*! exports provided: diag_mat, diag */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"diag_mat\", function() { return diag_mat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"diag\", function() { return diag; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nfunction diag_mat(diag) {\n  if (diag.ndim < 1) throw new Error(\"diag_mat(diag): diag.ndim=\".concat(diag.ndim, \" is less than 1.\"));\n  diag = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(diag);\n  var shape = diag.shape,\n      N = shape[shape.length - 1],\n      d = diag.data,\n      D = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][diag.dtype].from({\n    length: shape.reduce(function (a, b) {\n      return a * b;\n    }) * N\n  }, function () {\n    return 0;\n  });\n  diag = undefined;\n  if (shape.length < 1) throw new Error('diag_mat(diag): diag must be at least 1d.');\n  if (N <= 0) throw new Error('Assertion Failed!');\n\n  for (var d_off = 0, D_off = 0;;) {\n    var d_end = d_off + N;\n\n    while (true) {\n      D[D_off] = d[d_off];\n      if (++d_off === d_end) break;\n      D_off += N + 1;\n    }\n\n    if (++D_off == D.length) break;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(shape).concat([N])), D);\n}\nfunction diag(A) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  if (A.ndim < 2) throw new Error(\"diag(A, offset): A.ndim=\".concat(A.ndim, \" is less than 2.\"));\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n\n  var _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      N = _A$shape$slice2[0],\n      M = _A$shape$slice2[1],\n      shape = A.shape.slice(0, -1),\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][A.dtype];\n\n  A = A.data;\n  if (!(offset > -N && offset < +M)) throw new Error(\"diag(A, offset): offset=\".concat(offset, \" out of A.shape=[\").concat(A.shape, \"].\"));\n  var L = Math.min(N, N + offset, M, M - offset);\n  shape[shape.length - 1] = L;\n  var d = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  })),\n      a_off = Math.max(0, offset, -offset * M);\n\n  for (var d_off = 0, A_off = 0; A_off < A.length; d_off += L, A_off += N * M) {\n    for (var i = 0; i < L; i++) {\n      d[d_off + i] = A[A_off + a_off + M * i + i];\n    }\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, d);\n}\n\n//# sourceURL=webpack://nd/./src/la/diag.js?");

/***/ }),

/***/ "./src/la/eigen.js":
/*!*************************!*\
  !*** ./src/la/eigen.js ***!
  \*************************/
/*! exports provided: eigen, eigenvals, eigen_balance_pre, eigen_balance_post */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eigen\", function() { return eigen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eigenvals\", function() { return eigenvals; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eigen_balance_pre\", function() { return eigen_balance_pre; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eigen_balance_post\", function() { return eigen_balance_post; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _schur__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./schur */ \"./src/la/schur.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _zip_elems__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../zip_elems */ \"./src/zip_elems.js\");\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../math */ \"./src/math.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n // TODO: Add symmetric eigen decomposition methods\n//   export function eigen_sym(S)\n//   export function eigenvals_sym(S)\n\nfunction eigen(A) {\n  var _eigen_balance_pre = eigen_balance_pre(A, 2),\n      _eigen_balance_pre2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_eigen_balance_pre, 2),\n      D = _eigen_balance_pre2[0],\n      B = _eigen_balance_pre2[1],\n      _schur_decomp = Object(_schur__WEBPACK_IMPORTED_MODULE_2__[\"schur_decomp\"])(B),\n      _schur_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_schur_decomp, 2),\n      Q = _schur_decomp2[0],\n      T = _schur_decomp2[1],\n      _schur_eigen = Object(_schur__WEBPACK_IMPORTED_MODULE_2__[\"schur_eigen\"])(Q, T),\n      _schur_eigen2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_schur_eigen, 2),\n       = _schur_eigen2[0],\n      V = _schur_eigen2[1];\n\n  if (!V.dtype.startsWith('complex')) throw new Error('Assertion failed.');\n  if (!D.dtype.startsWith('float')) throw new Error('Assertion failed.');\n  var N = A.shape[A.ndim - 1],\n      norm_sum = new Float64Array(N),\n      norm_max = new Float64Array(N),\n      V_dat = V.data._array,\n      D_dat = D.data; // UNDO BALANCING\n\n  for (var D_off = 0, V_off = 0; V_off < V_dat.length; D_off += N, V_off += 2 * N * N) {\n    norm_sum.fill(0);\n    norm_max.fill(0); // SCALE ROWS & COMPUTE SCALED COLUMN NORMS\n\n    for (var i = 0; i < N; i++) {\n      var D_i = D_dat[D_off + i];\n\n      for (var j = 0; j < 2 * N; j++) {\n        // scale row\n        var V_ij = Math.abs(V_dat[V_off + 2 * N * i + j] *= D_i); // update norm\n\n        if (V_ij > 0) {\n          var k = j >> 1;\n\n          if (V_ij > norm_max[k]) {\n            norm_sum[k] *= Math.pow(norm_max[k] / V_ij, 2);\n            norm_max[k] = V_ij;\n          }\n\n          norm_sum[k] += Math.pow(V_ij / norm_max[k], 2);\n        }\n      }\n    }\n\n    for (var _j = 0; _j < N; _j++) {\n      var max = norm_max[_j];\n      norm_sum[_j] = isFinite(max) ? Math.sqrt(norm_sum[_j]) * max : max;\n    } // NORMALIZE COLUMNS\n\n\n    for (var _i = 0; _i < N; _i++) {\n      for (var _j2 = 0; _j2 < 2 * N; _j2++) {\n        V_dat[V_off + 2 * N * _i + _j2] /= norm_sum[_j2 >> 1];\n      }\n    }\n  }\n\n  return [, V];\n}\nfunction eigenvals(A) {\n  var _eigen_balance_pre3 = eigen_balance_pre(A, 2),\n      _eigen_balance_pre4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_eigen_balance_pre3, 2),\n      D = _eigen_balance_pre4[0],\n      B = _eigen_balance_pre4[1],\n      _schur_decomp3 = Object(_schur__WEBPACK_IMPORTED_MODULE_2__[\"schur_decomp\"])(B),\n      _schur_decomp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_schur_decomp3, 2),\n      Q = _schur_decomp4[0],\n      T = _schur_decomp4[1];\n\n  return Object(_schur__WEBPACK_IMPORTED_MODULE_2__[\"schur_eigenvals\"])(T);\n}\nfunction eigen_balance_pre(A, p) {\n  // SEE: RODNEY JAMES, JULIEN LANGOU, AND BRADLEY R. LOWERY,\n  //      \"ON MATRIX BALANCING AND EIGENVECTOR COMPUTATION\"\n  if (p == null) p = 2;\n  if (p > Number.MAX_VALUE) return eigen_balance_pre_inf(A);\n  var N = A.shape[A.ndim - 1],\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_4__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      A_shape = A.shape,\n      D_shape = A_shape.slice(0, -1);\n  if (!(p >= 1)) throw new Error(\"Invalid norm p=\".concat(p, \";\"));\n  if (A.shape[A.ndim - 2] != N) throw new Error('A is not square');\n  A = DTypeArray.from(A.data); // <- protection copy\n\n  var D = new DTypeArray(A.length / N),\n      TOL = Math.pow(0.95, 1 / p);\n  D.fill(1.0);\n\n  for (var A_off = A.length, D_off = D.length; A_off > 0;) {\n    A_off -= N * N;\n    D_off -= N;\n\n    for (var i, done = false; !done;) {\n      for (i = 0, done = true; i < N; i++) {\n        var c = 0.0,\n            c_max = 0.0,\n            r = 0.0,\n            r_max = 0.0; // COMPUTE ROW AND COLUMN NORM\n\n        for (var j = 0; j < N; j++) {\n          //        if(true)\n          if (i !== j) {\n            {\n              var A_ij = Math.abs(A[A_off + N * i + j]);\n\n              if (A_ij > 0) {\n                if (A_ij > r_max) {\n                  var _scale = r_max / A_ij;\n\n                  r_max = A_ij;\n                  r *= Math.pow(_scale, p);\n                }\n\n                var ratio = A_ij / r_max;\n                r += Math.pow(ratio, p);\n              }\n            }\n            {\n              var A_ji = Math.abs(A[A_off + N * j + i]);\n\n              if (A_ji > 0) {\n                if (A_ji > c_max) {\n                  var _scale2 = c_max / A_ji;\n\n                  c_max = A_ji;\n                  c *= Math.pow(_scale2, p);\n                }\n\n                var _ratio = A_ji / c_max;\n\n                c += Math.pow(_ratio, p);\n              }\n            }\n          }\n        }\n\n        r = !isFinite(r) ? r : Math.pow(r, 1 / p) * r_max;\n        c = !isFinite(c) ? c : Math.pow(c, 1 / p) * c_max;\n        if (r * c == 0.0) continue;\n        if (!isFinite(r * c)) throw new Error('NaN encountered.');\n        var old_norm = c >= r ? Math.pow(1 + Math.pow(r / c, p), 1 / p) * c : Math.pow(1 + Math.pow(c / r, p), 1 / p) * r; // FIND A POWER OF TWO THAT MORE OR LESS BALANCES r AND c\n\n        var scale = 1.0;\n\n        while (r >= c * 2) {\n          c *= 2;\n          r /= 2;\n          scale *= 2;\n        }\n\n        while (c >= r * 2) {\n          c /= 2;\n          r *= 2;\n          scale /= 2;\n        }\n\n        var new_norm = c >= r ? Math.pow(1 + Math.pow(r / c, p), 1 / p) * c : Math.pow(1 + Math.pow(c / r, p), 1 / p) * r;\n        if (new_norm >= TOL * old_norm) continue;\n        done = false;\n        D[D_off + i] *= scale;\n\n        for (var _j3 = 0; _j3 < N; _j3++) {\n          A[A_off + N * i + _j3] /= scale;\n          A[A_off + N * _j3 + i] *= scale;\n        }\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](D_shape, D), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](A_shape, A)];\n}\n\nfunction eigen_balance_pre_inf(A) {\n  // SEE: RODNEY JAMES, JULIEN LANGOU, AND BRADLEY R. LOWERY,\n  //      \"ON MATRIX BALANCING AND EIGENVECTOR COMPUTATION\"\n  var N = A.shape[A.ndim - 1],\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_4__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      A_shape = A.shape,\n      D_shape = A_shape.slice(0, -1);\n  if (A.shape[A.ndim - 2] != N) throw new Error('A is not square');\n  A = DTypeArray.from(A.data);\n  var D = new DTypeArray(A.length / N);\n  D.fill(1.0);\n\n  for (var A_off = A.length, D_off = D.length; A_off > 0;) {\n    A_off -= N * N;\n    D_off -= N;\n\n    for (var i, done = false; !done;) {\n      for (i = 0, done = true; i < N; i++) {\n        var c = 0.0,\n            r = 0.0; // COMPUTE ROW AND COLUMN NORM\n\n        for (var j = 0; j < N; j++) {\n          if (i !== j) {\n            var A_ij = Math.abs(A[A_off + N * i + j]);\n            r = Math.max(r, A_ij);\n            var A_ji = Math.abs(A[A_off + N * j + i]);\n            c = Math.max(c, A_ji);\n          }\n        }\n\n        if (r * c === 0.0) continue;\n        var old_norm = Math.max(c, r);\n        if (old_norm == 0.0) continue;\n        if (!isFinite(old_norm)) throw new Error('NaN encountered.'); // FIND A POWER OF TWO THAT MORE OR LESS BALANCES r AND c\n\n        var scale = 1.0;\n\n        while (r >= c * 2) {\n          c *= 2;\n          r /= 2;\n          scale *= 2;\n        }\n\n        while (c >= r * 2) {\n          c /= 2;\n          r *= 2;\n          scale /= 2;\n        }\n\n        var new_norm = Math.max(c, r);\n        if (new_norm >= old_norm) continue;\n        done = false;\n        D[D_off + i] *= scale;\n\n        for (var _j4 = 0; _j4 < N; _j4++) {\n          A[A_off + N * i + _j4] /= scale;\n          A[A_off + N * _j4 + i] *= scale;\n        }\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](D_shape, D), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](A_shape, A)];\n}\n\nfunction eigen_balance_post(D, V) {\n  if (V.ndim < 2) throw new Error('eigen_balance_post(D,V): V.ndim must be at least 2.');\n\n  var _V$shape$slice = V.shape.slice(-2),\n      _V$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_V$shape$slice, 2),\n      M = _V$shape$slice2[0],\n      N = _V$shape$slice2[1];\n\n  if (M !== N) throw new Error('eigen_balance_post(D,V): V must be square.');\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_4__[\"ARRAY_TYPES\"]['float64'],\n      V_arr = Object(_zip_elems__WEBPACK_IMPORTED_MODULE_5__[\"zip_elems\"])([V, D.reshape.apply(D, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(D.shape).concat([1]))], 'complex128', _math__WEBPACK_IMPORTED_MODULE_6__[\"default\"].mul);\n  V = V_arr.data;\n  var norm_sum = new DTypeArray(N),\n      norm_max = new DTypeArray(N); // NORMALIZE COLUMNS\n\n  for (var off = 0; off < V.length; off += M * N) {\n    norm_sum.fill(0);\n    norm_max.fill(0); // COMPUTE COLUMN NORMS\n\n    for (var i = 0; i < N; i++) {\n      for (var j = 0; j < N; j++) {\n        var V_ij = _math__WEBPACK_IMPORTED_MODULE_6__[\"default\"].abs(V[off + N * i + j]);\n\n        if (V_ij > 0) {\n          if (V_ij > norm_max[j]) {\n            norm_sum[j] *= Math.pow(norm_max[j] / V_ij, 2);\n            norm_max[j] = V_ij;\n          }\n\n          norm_sum[j] += Math.pow(V_ij / norm_max[j], 2);\n        }\n      }\n    }\n\n    for (var _j5 = 0; _j5 < N; _j5++) {\n      var max = norm_max[_j5];\n      norm_sum[_j5] = isFinite(max) ? Math.sqrt(norm_sum[_j5]) * max : max;\n    } // NORMALIZE COLUMNS\n\n\n    for (var _i2 = 0; _i2 < N; _i2++) {\n      for (var _j6 = 0; _j6 < N; _j6++) {\n        V[off + N * _i2 + _j6] = _math__WEBPACK_IMPORTED_MODULE_6__[\"default\"].div(V[off + N * _i2 + _j6], norm_sum[_j6]);\n      }\n    }\n  }\n\n  return V_arr;\n}\n\n//# sourceURL=webpack://nd/./src/la/eigen.js?");

/***/ }),

/***/ "./src/la/eye.js":
/*!***********************!*\
  !*** ./src/la/eye.js ***!
  \***********************/
/*! exports provided: eye */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eye\", function() { return eye; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction eye() {\n  for (var _len = arguments.length, shape = new Array(_len), _key = 0; _key < _len; _key++) {\n    shape[_key] = arguments[_key];\n  }\n\n  var dtype = shape[0] in _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"] ? shape.shift() : 'float64';\n  if (shape.length < 1) throw new Error('Size parameter missing.');\n  if (shape.length == 1) shape.push(shape[shape.length - 1]);\n  shape = Int32Array.from(shape, function (s) {\n    if (0 !== s % 1) throw new Error(\"eye(): Invalid shape [\".concat(shape, \"].\"));\n    return s;\n  });\n\n  var I = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (m, n) {\n    return m * n;\n  })),\n      _shape$slice = shape.slice(-2),\n      _shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_shape$slice, 2),\n      M = _shape$slice2[0],\n      N = _shape$slice2[1];\n\n  for (var off = I.length; (off -= M * N) >= 0;) {\n    for (var i = Math.min(M, N); i-- > 0;) {\n      I[off + N * i + i] = 1;\n    }\n  }\n\n  var result = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, I);\n  return result;\n}\n\n//# sourceURL=webpack://nd/./src/la/eye.js?");

/***/ }),

/***/ "./src/la/hessenberg.js":
/*!******************************!*\
  !*** ./src/la/hessenberg.js ***!
  \******************************/
/*! exports provided: _hessenberg_decomp, hessenberg_decomp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_hessenberg_decomp\", function() { return _hessenberg_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hessenberg_decomp\", function() { return hessenberg_decomp; });\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n // TODO: bidiag_solve\n\nfunction _hessenberg_decomp(N, U, H, off) {\n  N |= 0;\n  off |= 0; // INIT U TO IDENTITY\n\n  for (var i = N - 1; i-- > 0;) {\n    U[off + N * i + i] = 1.0;\n  }\n\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_2__[\"FrobeniusNorm\"](),\n      lastRow = off + N * (N - 1); // ELIMINATE ELEMENTS LEFT OF (i,i-1) VIA HOUSEHOLDER\n\n  for (var _i = N; --_i > 1;) {\n    var rowI = off + N * _i,\n        ii = rowI + (_i - 1); // COMPUTE HOUSEHOLDER VECTOR\n\n    NORM.reset();\n\n    for (var j = _i - 1; j-- > 0;) {\n      NORM.include(H[rowI + j]);\n    }\n\n    if (NORM.max === 0) continue;\n    var norm = NORM.resultIncl(H[ii]) * (H[ii] > 0 ? -1 : +1); // <- avoid cancellation error\n\n    NORM.include(H[ii] -= norm);\n    var max = NORM.max,\n        div = Math.sqrt(NORM.sum);\n\n    for (var _j = _i; _j-- > 0;) {\n      H[rowI + _j] = H[rowI + _j] / max * Math.SQRT2 / div;\n    } // APPLY HOUSEHOLDER TO RIGHT OF H\n\n\n    for (var _j2 = _i; _j2-- > 0;) {\n      var sum = 0;\n\n      for (var k = _i; k-- > 0;) {\n        sum += H[off + N * _j2 + k] * H[rowI + k];\n      }\n\n      for (var _k = _i; _k-- > 0;) {\n        H[off + N * _j2 + _k] -= H[rowI + _k] * sum;\n      }\n    } // APPLY HOUSEHOLDER TO LEFT OF H\n\n\n    U.fill(0.0, lastRow, off + N * N);\n\n    for (var _j3 = _i; _j3-- > 0;) {\n      for (var _k2 = N; _k2-- > 0;) {\n        U[lastRow + _k2] += H[off + N * _j3 + _k2] * H[rowI + _j3];\n      }\n    }\n\n    for (var _j4 = _i; _j4-- > 0;) {\n      for (var _k3 = N; _k3-- > 0;) {\n        H[off + N * _j4 + _k3] -= H[rowI + _j4] * U[lastRow + _k3];\n      }\n    } // APPLY HOUSEHOLDER TO RIGHT OF U\n\n\n    for (var _j5 = N - 1; _j5-- > 0;) {\n      var _sum = 0;\n\n      for (var _k4 = _i; _k4-- > 0;) {\n        _sum += U[off + N * _j5 + _k4] * H[rowI + _k4];\n      }\n\n      for (var _k5 = _i; _k5-- > 0;) {\n        U[off + N * _j5 + _k5] -= H[rowI + _k5] * _sum;\n      }\n    } // FINISH ROW i\n\n\n    H.fill(0.0, rowI, ii);\n    H[ii] = norm;\n  } // LAST ROW OF U WAS USED AS TEMP MEMORY\n\n\n  U.fill(0.0, lastRow, off + N * N - 1);\n  U[off + N * N - 1] = 1;\n}\nfunction hessenberg_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_0__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('hessenberg_decomp(A): A must at least be 2D.');\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      // <- ensure at least double precision\n  shape = A.shape,\n      N = shape[shape.length - 1] | 0;\n  if (N != shape[shape.length - 2]) throw new Error('hessenberg_decomp(A): A must be square.');\n  var H = DTypeArray.from(A.data);\n  A = undefined;\n  var U = new DTypeArray(H.length);\n\n  for (var off = H.length; (off -= N * N) >= 0;) {\n    _hessenberg_decomp(N, U, H, off);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"](shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_0__[\"NDArray\"](shape, H)];\n}\n;\n\n//# sourceURL=webpack://nd/./src/la/hessenberg.js?");

/***/ }),

/***/ "./src/la/index.js":
/*!*************************!*\
  !*** ./src/la/index.js ***!
  \*************************/
/*! exports provided: _bidiag_decomp_horiz, bidiag_decomp, cholesky_decomp, cholesky_solve, diag_mat, diag, det_tri, slogdet_tri, det, slogdet, eigen, eigenvals, eigen_balance_pre, eigen_balance_post, eye, hessenberg_decomp, ldl_decomp, ldl_solve, lstsq, lu_decomp, lu_solve, matmul2, matmul, norm, permute_rows, permute_cols, unpermute_rows, unpermute_cols, pldlp_decomp, pldlp_solve, pldlp_l, pldlp_d, pldlp_p, qr_decomp, qr_decomp_full, qr_lstsq, rand_ortho, rank, rrqr_decomp, rrqr_decomp_full, rrqr_rank, rrqr_lstsq, rrqr_solve, srrqr_decomp_full, schur_eigenvals, schur_eigen, schur_decomp, SingularMatrixSolveError, solve, svd_decomp, svd_rank, svd_solve, svd_lstsq, svd_dc, svd_jac_2sided, svd_jac_2sided_blocked, svd_jac_classic, tril, triu, tril_solve, triu_solve, urv_decomp_full, urv_lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bidiag__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bidiag */ \"./src/la/bidiag.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"_bidiag_decomp_horiz\", function() { return _bidiag__WEBPACK_IMPORTED_MODULE_0__[\"_bidiag_decomp_horiz\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bidiag_decomp\", function() { return _bidiag__WEBPACK_IMPORTED_MODULE_0__[\"bidiag_decomp\"]; });\n\n/* harmony import */ var _cholesky__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cholesky */ \"./src/la/cholesky.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"cholesky_decomp\", function() { return _cholesky__WEBPACK_IMPORTED_MODULE_1__[\"cholesky_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"cholesky_solve\", function() { return _cholesky__WEBPACK_IMPORTED_MODULE_1__[\"cholesky_solve\"]; });\n\n/* harmony import */ var _diag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./diag */ \"./src/la/diag.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"diag_mat\", function() { return _diag__WEBPACK_IMPORTED_MODULE_2__[\"diag_mat\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"diag\", function() { return _diag__WEBPACK_IMPORTED_MODULE_2__[\"diag\"]; });\n\n/* harmony import */ var _det__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./det */ \"./src/la/det.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"det_tri\", function() { return _det__WEBPACK_IMPORTED_MODULE_3__[\"det_tri\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"slogdet_tri\", function() { return _det__WEBPACK_IMPORTED_MODULE_3__[\"slogdet_tri\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"det\", function() { return _det__WEBPACK_IMPORTED_MODULE_3__[\"det\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"slogdet\", function() { return _det__WEBPACK_IMPORTED_MODULE_3__[\"slogdet\"]; });\n\n/* harmony import */ var _eigen__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./eigen */ \"./src/la/eigen.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"eigen\", function() { return _eigen__WEBPACK_IMPORTED_MODULE_4__[\"eigen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"eigenvals\", function() { return _eigen__WEBPACK_IMPORTED_MODULE_4__[\"eigenvals\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"eigen_balance_pre\", function() { return _eigen__WEBPACK_IMPORTED_MODULE_4__[\"eigen_balance_pre\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"eigen_balance_post\", function() { return _eigen__WEBPACK_IMPORTED_MODULE_4__[\"eigen_balance_post\"]; });\n\n/* harmony import */ var _eye__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./eye */ \"./src/la/eye.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"eye\", function() { return _eye__WEBPACK_IMPORTED_MODULE_5__[\"eye\"]; });\n\n/* harmony import */ var _hessenberg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./hessenberg */ \"./src/la/hessenberg.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"hessenberg_decomp\", function() { return _hessenberg__WEBPACK_IMPORTED_MODULE_6__[\"hessenberg_decomp\"]; });\n\n/* harmony import */ var _ldl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ldl */ \"./src/la/ldl.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ldl_decomp\", function() { return _ldl__WEBPACK_IMPORTED_MODULE_7__[\"ldl_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ldl_solve\", function() { return _ldl__WEBPACK_IMPORTED_MODULE_7__[\"ldl_solve\"]; });\n\n/* harmony import */ var _lstsq__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lstsq */ \"./src/la/lstsq.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lstsq\", function() { return _lstsq__WEBPACK_IMPORTED_MODULE_8__[\"lstsq\"]; });\n\n/* harmony import */ var _lu__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./lu */ \"./src/la/lu.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lu_decomp\", function() { return _lu__WEBPACK_IMPORTED_MODULE_9__[\"lu_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lu_solve\", function() { return _lu__WEBPACK_IMPORTED_MODULE_9__[\"lu_solve\"]; });\n\n/* harmony import */ var _matmul__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./matmul */ \"./src/la/matmul.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"matmul2\", function() { return _matmul__WEBPACK_IMPORTED_MODULE_10__[\"matmul2\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"matmul\", function() { return _matmul__WEBPACK_IMPORTED_MODULE_10__[\"matmul\"]; });\n\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"norm\", function() { return _norm__WEBPACK_IMPORTED_MODULE_11__[\"norm\"]; });\n\n/* harmony import */ var _permute__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./permute */ \"./src/la/permute.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"permute_rows\", function() { return _permute__WEBPACK_IMPORTED_MODULE_12__[\"permute_rows\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"permute_cols\", function() { return _permute__WEBPACK_IMPORTED_MODULE_12__[\"permute_cols\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"unpermute_rows\", function() { return _permute__WEBPACK_IMPORTED_MODULE_12__[\"unpermute_rows\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"unpermute_cols\", function() { return _permute__WEBPACK_IMPORTED_MODULE_12__[\"unpermute_cols\"]; });\n\n/* harmony import */ var _pldlp__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./pldlp */ \"./src/la/pldlp.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pldlp_decomp\", function() { return _pldlp__WEBPACK_IMPORTED_MODULE_13__[\"pldlp_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pldlp_solve\", function() { return _pldlp__WEBPACK_IMPORTED_MODULE_13__[\"pldlp_solve\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pldlp_l\", function() { return _pldlp__WEBPACK_IMPORTED_MODULE_13__[\"pldlp_l\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pldlp_d\", function() { return _pldlp__WEBPACK_IMPORTED_MODULE_13__[\"pldlp_d\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"pldlp_p\", function() { return _pldlp__WEBPACK_IMPORTED_MODULE_13__[\"pldlp_p\"]; });\n\n/* harmony import */ var _qr__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./qr */ \"./src/la/qr.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"qr_decomp\", function() { return _qr__WEBPACK_IMPORTED_MODULE_14__[\"qr_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"qr_decomp_full\", function() { return _qr__WEBPACK_IMPORTED_MODULE_14__[\"qr_decomp_full\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"qr_lstsq\", function() { return _qr__WEBPACK_IMPORTED_MODULE_14__[\"qr_lstsq\"]; });\n\n/* harmony import */ var _rand_ortho__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./rand_ortho */ \"./src/la/rand_ortho.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rand_ortho\", function() { return _rand_ortho__WEBPACK_IMPORTED_MODULE_15__[\"rand_ortho\"]; });\n\n/* harmony import */ var _rank__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./rank */ \"./src/la/rank.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rank\", function() { return _rank__WEBPACK_IMPORTED_MODULE_16__[\"rank\"]; });\n\n/* harmony import */ var _rrqr__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./rrqr */ \"./src/la/rrqr.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rrqr_decomp\", function() { return _rrqr__WEBPACK_IMPORTED_MODULE_17__[\"rrqr_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rrqr_decomp_full\", function() { return _rrqr__WEBPACK_IMPORTED_MODULE_17__[\"rrqr_decomp_full\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rrqr_rank\", function() { return _rrqr__WEBPACK_IMPORTED_MODULE_17__[\"rrqr_rank\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rrqr_lstsq\", function() { return _rrqr__WEBPACK_IMPORTED_MODULE_17__[\"rrqr_lstsq\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"rrqr_solve\", function() { return _rrqr__WEBPACK_IMPORTED_MODULE_17__[\"rrqr_solve\"]; });\n\n/* harmony import */ var _srrqr__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./srrqr */ \"./src/la/srrqr.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"srrqr_decomp_full\", function() { return _srrqr__WEBPACK_IMPORTED_MODULE_18__[\"srrqr_decomp_full\"]; });\n\n/* harmony import */ var _schur__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./schur */ \"./src/la/schur.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"schur_eigenvals\", function() { return _schur__WEBPACK_IMPORTED_MODULE_19__[\"schur_eigenvals\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"schur_eigen\", function() { return _schur__WEBPACK_IMPORTED_MODULE_19__[\"schur_eigen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"schur_decomp\", function() { return _schur__WEBPACK_IMPORTED_MODULE_19__[\"schur_decomp\"]; });\n\n/* harmony import */ var _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./singular_matrix_solve_error */ \"./src/la/singular_matrix_solve_error.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SingularMatrixSolveError\", function() { return _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_20__[\"SingularMatrixSolveError\"]; });\n\n/* harmony import */ var _solve__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./solve */ \"./src/la/solve.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"solve\", function() { return _solve__WEBPACK_IMPORTED_MODULE_21__[\"solve\"]; });\n\n/* harmony import */ var _svd__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./svd */ \"./src/la/svd.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_decomp\", function() { return _svd__WEBPACK_IMPORTED_MODULE_22__[\"svd_decomp\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_rank\", function() { return _svd__WEBPACK_IMPORTED_MODULE_22__[\"svd_rank\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_solve\", function() { return _svd__WEBPACK_IMPORTED_MODULE_22__[\"svd_solve\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_lstsq\", function() { return _svd__WEBPACK_IMPORTED_MODULE_22__[\"svd_lstsq\"]; });\n\n/* harmony import */ var _svd_dc__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./svd_dc */ \"./src/la/svd_dc.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_dc\", function() { return _svd_dc__WEBPACK_IMPORTED_MODULE_23__[\"svd_dc\"]; });\n\n/* harmony import */ var _svd_jac_2sided__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./svd_jac_2sided */ \"./src/la/svd_jac_2sided.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_2sided\", function() { return _svd_jac_2sided__WEBPACK_IMPORTED_MODULE_24__[\"svd_jac_2sided\"]; });\n\n/* harmony import */ var _svd_jac_2sided_blocked__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./svd_jac_2sided_blocked */ \"./src/la/svd_jac_2sided_blocked.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_2sided_blocked\", function() { return _svd_jac_2sided_blocked__WEBPACK_IMPORTED_MODULE_25__[\"svd_jac_2sided_blocked\"]; });\n\n/* harmony import */ var _svd_jac_classic__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./svd_jac_classic */ \"./src/la/svd_jac_classic.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_classic\", function() { return _svd_jac_classic__WEBPACK_IMPORTED_MODULE_26__[\"svd_jac_classic\"]; });\n\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tril\", function() { return _tri__WEBPACK_IMPORTED_MODULE_27__[\"tril\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"triu\", function() { return _tri__WEBPACK_IMPORTED_MODULE_27__[\"triu\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tril_solve\", function() { return _tri__WEBPACK_IMPORTED_MODULE_27__[\"tril_solve\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"triu_solve\", function() { return _tri__WEBPACK_IMPORTED_MODULE_27__[\"triu_solve\"]; });\n\n/* harmony import */ var _urv__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./urv */ \"./src/la/urv.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"urv_decomp_full\", function() { return _urv__WEBPACK_IMPORTED_MODULE_28__[\"urv_decomp_full\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"urv_lstsq\", function() { return _urv__WEBPACK_IMPORTED_MODULE_28__[\"urv_lstsq\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=webpack://nd/./src/la/index.js?");

/***/ }),

/***/ "./src/la/ldl.js":
/*!***********************!*\
  !*** ./src/la/ldl.js ***!
  \***********************/
/*! exports provided: _ldl_decomp, ldl_decomp, _ldl_solve, ldl_solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_ldl_decomp\", function() { return _ldl_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ldl_decomp\", function() { return ldl_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_ldl_solve\", function() { return _ldl_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ldl_solve\", function() { return ldl_solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n // THE FOLLOWING IMPLEMENTATION HAS BETTER CACHE ALIGNMENT BUT REQUIRES AN EXTRA ARRAY OF LENGTH M-1 (A benchmark would be required to justify that)\n//export function _ldl_decomp(M,N, LD,LD_off, V)\n//{\n//  if( ! (M   <= N       ) ) throw new Error('Assertion failed.');\n//  if( ! (M-1 <= V.length) ) throw new Error('Assertion failed.');\n//\n//  // https://arxiv.org/abs/1111.4144\n//  for( let j=0; j < M; j++ )\n//  {\n//    for( let k=0; k < j; k++ )\n//      V[k] = LD[LD_off + N*j+k] * LD[LD_off + N*k+k];\n//\n//    for( let i=j; i < M; i++ )\n//    {\n//      for( let k=0; k < j; k++ )\n//        LD[LD_off + N*i+j] -= LD[LD_off + N*i+k] * V[k];\n//\n//      if( j < i )\n//        LD[LD_off + N*i+j] /= LD[LD_off + N*j+j];\n//    }\n//  }\n//}\n\nfunction _ldl_decomp(M, N, LD, LD_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.'); // https://arxiv.org/abs/1111.4144\n\n  for (var j = 0; j < M; j++) {\n    for (var k = 0; k < j; k++) {\n      var V_k = LD[LD_off + N * j + k] * LD[LD_off + N * k + k];\n\n      for (var i = j; i < M; i++) {\n        LD[LD_off + N * i + j] -= LD[LD_off + N * i + k] * V_k;\n      }\n    }\n\n    for (var _i = j; ++_i < M;) {\n      LD[LD_off + N * _i + j] /= LD[LD_off + N * j + j];\n    }\n  }\n}\nfunction ldl_decomp(S) {\n  S = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(S);\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][S.dtype === 'float32' ? 'float32' : 'float64'],\n      shape = S.shape,\n      _shape$slice = shape.slice(-2),\n      _shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_shape$slice, 2),\n      N = _shape$slice2[0],\n      M = _shape$slice2[1];\n\n  S = S.data;\n  if (N !== M) throw new Error('Last two dimensions must be quadratic.');\n  var LD = new DTypeArray(S.length);\n\n  for (var LD_off = 0; LD_off < LD.length; LD_off += N * N) {\n    for (var i = 0; i < N; i++) {\n      for (var j = 0; j <= i; j++) {\n        LD[LD_off + N * i + j] = S[LD_off + N * i + j];\n      }\n    }\n\n    _ldl_decomp(N, N, LD, LD_off);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, LD);\n}\nfunction _ldl_solve(M, N, O, LD, LD_off, X, X_off) {\n  if (0 !== LD.length % 1) throw new Error('Assertion failed.');\n  if (0 !== X.length % 1) throw new Error('Assertion failed.');\n  if (0 !== LD_off % 1) throw new Error('Assertion failed.');\n  if (0 !== X_off % 1) throw new Error('Assertion failed.');\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== O % 1) throw new Error('Assertion failed.');\n  if (LD.length - LD_off < M * N) throw new Error('Assertion failed.');\n  if (X.length - X_off < M * O) throw new Error('Assertion failed.');\n  if (!(0 < M)) throw new Error('Assertion failed.');\n  if (!(0 < N)) throw new Error('Assertion failed.');\n  if (!(0 < O)) throw new Error('Assertion failed.');\n  if (!(M <= N)) throw new Error('Assertion failed.'); // FORWARD SUBSTITUTION\n\n  for (var i = 1; i < M; i++) {\n    for (var k = 0; k < i; k++) {\n      for (var j = 0; j < O; j++) {\n        X[X_off + O * i + j] -= LD[LD_off + N * i + k] * X[X_off + O * k + j];\n      }\n    }\n  } // SCALING\n\n\n  for (var _i2 = 0; _i2 < M; _i2++) {\n    for (var _j = 0; _j < O; _j++) {\n      X[X_off + O * _i2 + _j] /= LD[LD_off + N * _i2 + _i2];\n    }\n  } // BACKWARD SUBSTITUTION\n\n\n  for (var _k = M; _k-- > 1;) {\n    for (var _i3 = _k; _i3-- > 0;) {\n      for (var _j2 = O; _j2-- > 0;) {\n        X[X_off + O * _i3 + _j2] -= LD[LD_off + N * _k + _i3] * X[X_off + O * _k + _j2];\n      }\n    }\n  }\n}\nfunction ldl_solve(LD, y) {\n  LD = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(LD);\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(y);\n  if (LD.ndim < 2) throw new Error('ldl_solve(LD,y): LD must be at least 2D.');\n  if (y.ndim < 2) throw new Error('ldl_solve(LD,y): y must be at least 2D.');\n\n  var _LD$shape$slice = LD.shape.slice(-2),\n      _LD$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD$shape$slice, 2),\n      N = _LD$shape$slice2[0],\n      M = _LD$shape$slice2[1],\n      _y$shape$slice = y.shape.slice(-2),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 2),\n      I = _y$shape$slice2[0],\n      J = _y$shape$slice2[1];\n\n  if (N != M) throw new Error('ldl_solve(LD,y): Last two dimensions of LD must be quadratic.');\n  if (I != M) throw new Error(\"ldl_solve(LD,y): LD and y don't match.\");\n  var ndim = Math.max(LD.ndim, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i4 = 0, _arr = [LD, y]; _i4 < _arr.length; _i4++) {\n    var arr = _arr[_i4];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var dtype = LD.dtype === 'float32' && y.dtype === 'float32' ? 'float32' : 'float64',\n      x_dat = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      LD_dat = LD.data,\n      y_dat = y.data;\n  var LD_off = 0,\n      LD_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      LD_stride = N * N;\n      y_stride = N * J; // COPY y\n\n      for (var _i5 = 0; _i5 < y_stride; _i5++) {\n        x_dat[x_off + _i5] = y_dat[y_off + _i5];\n      }\n\n      _ldl_solve(N, N, J, LD_dat, LD_off, x_dat, x_off);\n\n      LD_off += LD_stride;\n      y_off += y_stride;\n      x_off += y_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break;\n      if (!(LD.shape[d - ndim + LD.ndim] > 1)) LD_off -= LD_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    LD_stride *= LD.shape[d - ndim + LD.ndim] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/ldl.js?");

/***/ }),

/***/ "./src/la/lstsq.js":
/*!*************************!*\
  !*** ./src/la/lstsq.js ***!
  \*************************/
/*! exports provided: lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lstsq\", function() { return lstsq; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _svd__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./svd */ \"./src/la/svd.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction lstsq(A, y) {\n  var _svd_decomp = Object(_svd__WEBPACK_IMPORTED_MODULE_1__[\"svd_decomp\"])(A),\n      _svd_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_decomp, 3),\n      U = _svd_decomp2[0],\n      sv = _svd_decomp2[1],\n      V = _svd_decomp2[2];\n\n  return Object(_svd__WEBPACK_IMPORTED_MODULE_1__[\"svd_lstsq\"])(U, sv, V, y);\n}\n\n//# sourceURL=webpack://nd/./src/la/lstsq.js?");

/***/ }),

/***/ "./src/la/lu.js":
/*!**********************!*\
  !*** ./src/la/lu.js ***!
  \**********************/
/*! exports provided: lu_decomp, lu_solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lu_decomp\", function() { return lu_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lu_solve\", function() { return lu_solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nfunction lu_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n\n  var LU = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'].from(A.data),\n      _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      N = _A$shape$slice2[0],\n      M = _A$shape$slice2[1],\n      P = new Int32Array(LU.length / M);\n\n  if (N != M) throw new Error('Last two dimensions must be quadratic.');\n\n  for (var LU_off = 0, P_off = 0; LU_off < LU.length; LU_off += N * N, P_off += N) {\n    for (var i = 0; i < N; i++) {\n      P[P_off + i] = i;\n    }\n\n    for (var _i = 0; _i < N; _i++) {\n      var row_i = LU_off + _i * N; // ROW PIVOTING\n\n      {\n        var p = _i;\n\n        for (var j = _i + 1; j < N; j++) {\n          if (Math.abs(LU[LU_off + N * j + _i]) > Math.abs(LU[LU_off + N * p + _i])) p = j;\n        }\n\n        if (_i != p) {\n          var P_p = P[P_off + _i];\n          P[P_off + _i] = P[P_off + p];\n          P[P_off + p] = P_p; // KEEP TRACK OF ROW SWAPS\n\n          var row_p = LU_off + p * N; // SWAP ROWS\n\n          for (var _j = 0; _j < N; _j++) {\n            var tmp = LU[row_i + _j];\n            LU[row_i + _j] = LU[row_p + _j];\n            LU[row_p + _j] = tmp;\n          }\n        }\n      } // ELIMINATE ELEMENTS BELOW PIVOT\n\n      for (var _j2 = _i + 1; _j2 < N; _j2++) {\n        var row_j = LU_off + _j2 * N,\n            scale = LU[row_j + _i] / LU[row_i + _i];\n        LU[row_j + _i] = scale;\n\n        for (var k = _i + 1; k < N; k++) {\n          LU[row_j + k] -= scale * LU[row_i + k];\n        }\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](A.shape, LU), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](A.shape.slice(0, -1), P)];\n}\nfunction lu_solve(LU, P, y) {\n  if (undefined == y) {\n    y = P;\n    var _LU = LU;\n\n    var _LU2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LU, 2);\n\n    LU = _LU2[0];\n    P = _LU2[1];\n  }\n\n  LU = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(LU);\n  if (LU.ndim < 2) throw new Error('LU must be at least 2D.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('P must be at least 1D.');\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(y);\n  if (y.ndim < 2) throw new Error('y must be at least 2D.');\n\n  var _LU$shape$slice = LU.shape.slice(-2),\n      _LU$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LU$shape$slice, 2),\n      N = _LU$shape$slice2[0],\n      M = _LU$shape$slice2[1],\n      _y$shape$slice = y.shape.slice(-2),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 2),\n      I = _y$shape$slice2[0],\n      J = _y$shape$slice2[1];\n\n  if (M != N) throw new Error('Last two dimensions of LU must be quadratic.');\n  if (M != I) throw new Error(\"LU and y don't match.\");\n  if (M != P.shape.slice(-1)) throw new Error(\"LU and P don't match.\");\n  var ndim = Math.max(LU.ndim, P.ndim + 1, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i2 = 0, _arr = [LU, y]; _i2 < _arr.length; _i2++) {\n    var arr = _arr[_i2];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('LU and y are not broadcast-compatible.');\n    }\n  }\n\n  for (var _i3 = ndim - 2, _j3 = P.ndim - 1; _i3-- > 0 && _j3-- > 0;) {\n    if (1 === shape[_i3]) shape[_i3] = P.shape[_j3];else if (shape[_i3] != P.shape[_j3] && P.shape[_j3] != 1) throw new Error('P is not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var x_dat = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][[LU, P, y].every(function (a) {\n    return a.dtype === 'float32';\n  }) ? 'float32' : 'float64'](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1));\n  var LU_dat = LU.data,\n      P_dat = P.data,\n      y_dat = y.data;\n  var LU_off = 0,\n      LU_stride = 1,\n      P_off = 0,\n      P_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      LU_stride = N * N;\n      P_stride = N;\n      y_stride = N * J; // COPYING PERMUTED y\n\n      for (var _i4 = 0; _i4 < I; _i4++) {\n        var row_x = x_off + J * _i4,\n            row_y = y_off + J * P_dat[P_off + _i4];\n\n        for (var _j4 = 0; _j4 < J; _j4++) {\n          x_dat[row_x + _j4] = y_dat[row_y + _j4];\n        }\n      } // FORWARD SUBSTITUTION\n\n\n      for (var _i5 = 0; _i5 < I; _i5++) {\n        for (var _j5 = 0; _j5 < J; _j5++) {\n          for (var k = 0; k < _i5; k++) {\n            x_dat[x_off + _i5 * J + _j5] -= LU_dat[LU_off + N * _i5 + k] * x_dat[x_off + k * J + _j5];\n          }\n        }\n      } // BACKWARD SUBSTITUTION\n\n\n      Object(_tri__WEBPACK_IMPORTED_MODULE_3__[\"_triu_solve\"])(I, I, J, LU_dat, LU_off, x_dat, x_off);\n\n      LU_off += LU_stride;\n      P_off += P_stride;\n      y_off += y_stride;\n      x_off += y_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break; // RESET ALONG BROADCAST AXES\n\n      if (!(LU.shape[d - ndim + LU.ndim] > 1)) LU_off -= LU_stride;\n      if (!(P.shape[d - ndim + P.ndim + 1] > 1)) P_off -= P_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    LU_stride *= LU.shape[d - ndim + LU.ndim] || 1;\n    P_stride *= P.shape[d - ndim + P.ndim + 1] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/lu.js?");

/***/ }),

/***/ "./src/la/matmul.js":
/*!**************************!*\
  !*** ./src/la/matmul.js ***!
  \**************************/
/*! exports provided: matmul2, matmul */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"matmul2\", function() { return matmul2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"matmul\", function() { return matmul; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../math */ \"./src/math.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\nvar _ref = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee() {\n  var mk_matmul2;\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          mk_matmul2 = function mk_matmul2(addProduct) {\n            return new Function('A_shape', 'A', 'B_shape', 'B', 'C_shape', 'C', \"\\n      const I = A_shape[A_shape.length-2],\\n            K = A_shape[A_shape.length-1],\\n            J = B_shape[B_shape.length-1]; \\n      let\\n        a = 0, aStride = 1,\\n        b = 0, bStride = 1,\\n        c = 0;\\n\\n      const loops = new Int32Array(C_shape.length-2);\\n      for( let d=0; d >= 0; )\\n        if( d === C_shape.length-2 ) {\\n          aStride = I*K;\\n          bStride = K*J;\\n          for( const cEnd = c + I*J; c < cEnd; c += J, b -= bStride ) {\\n          for( const aEnd = a + K  ; a < aEnd; c -= J, a++ ) {\\n          for( const bEnd = b +   J; b < bEnd; c += 1, b++ ) {\\n            \".concat(addProduct, \"\\n          }}}\\n          b += bStride;\\n          d -= 1;\\n        }\\n        else\\n        {\\n          if( loops[d]++ > 0 ) {\\n            if( loops[d] > C_shape[d] ) {\\n              aStride *= A_shape[ d - C_shape.length + A_shape.length ] || 1;\\n              bStride *= B_shape[ d - C_shape.length + B_shape.length ] || 1;\\n              loops[d--] = 0;\\n              continue;\\n            }\\n            if( ! (A_shape[ d - C_shape.length + A_shape.length ] > 1) ) a -= aStride;\\n            if( ! (B_shape[ d - C_shape.length + B_shape.length ] > 1) ) b -= bStride;\\n          }\\n          ++d;\\n        }\\n    \"));\n          };\n\n          _context.next = 3;\n          return mk_matmul2('C[c] += A[a]*B[b];');\n\n        case 3:\n          _context.next = 5;\n          return mk_matmul2(\"\\n    C[2*c+0] += A[a] * B[2*b+0];\\n    C[2*c+1] += A[a] * B[2*b+1];\\n  \");\n\n        case 5:\n          _context.next = 7;\n          return mk_matmul2(\"\\n    C[2*c+0] += B[b] * A[2*a+0];\\n    C[2*c+1] += B[b] * A[2*a+1];\\n  \");\n\n        case 7:\n          _context.next = 9;\n          return mk_matmul2(\"\\n    C[2*c+0] += B[2*b+0] * A[2*a+0]  -  B[2*b+1] * A[2*a+1];\\n    C[2*c+1] += B[2*b+0] * A[2*a+1]  +  B[2*b+1] * A[2*a+0];\\n  \");\n\n        case 9:\n          _context.next = 11;\n          return mk_matmul2('C[c] = this.add(C[c], this.mul(A[a],B[b]));').bind(_math__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n})(),\n    _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(_ref, 5),\n    matmul2_RR = _ref2[0],\n    matmul2_RC = _ref2[1],\n    matmul2_CR = _ref2[2],\n    matmul2_CC = _ref2[3],\n    matmul2_ELSE = _ref2[4];\n\nfunction matmul2(a, b) {\n  a = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(a);\n  b = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(b);\n  if (a.ndim < 2) throw new Error('A must be at least 2D.');\n  if (b.ndim < 2) throw new Error('B must be at least 2D.');\n\n  var _a$shape$slice = a.shape.slice(-2),\n      _a$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(_a$shape$slice, 2),\n      I = _a$shape$slice2[0],\n      K = _a$shape$slice2[1],\n      J = b.shape[b.ndim - 1];\n\n  if (b.shape[b.ndim - 2] != K) throw new Error('The last dimension of A and the 2nd to last dimension of B do not match.');\n  var ndim = Math.max(a.ndim, b.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i = 0, _arr = [a, b]; _i < _arr.length; _i++) {\n    var arr = _arr[_i];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_4__[\"ARRAY_TYPES\"][Object(_dt__WEBPACK_IMPORTED_MODULE_4__[\"super_dtype\"])(a.dtype, b.dtype)]; // INTEGER TYPE ID (0: scalar, 1: complex, 2: object)\n\n  var c = new DTypeArray(shape.reduce(function (m, n) {\n    return m * n;\n  }, 1));\n  if (c instanceof Array) c.fill(0);\n  var pairing = 0;\n\n  for (var _i2 = 0, _arr2 = [a, b]; _i2 < _arr2.length; _i2++) {\n    var ab = _arr2[_i2];\n    pairing *= 3;\n\n    switch (ab.dtype) {\n      default:\n        pairing += 1;\n\n      case 'complex128':\n        pairing += 1;\n\n      case 'int32':\n      case 'float32':\n      case 'float64':\n    }\n  }\n\n  switch (pairing) {\n    case 0:\n      matmul2_RR(a.shape, a.data, b.shape, b.data, shape, c);\n      break;\n\n    case 1:\n      matmul2_RC(a.shape, a.data, b.shape, b.data._array, shape, c._array);\n      break;\n\n    case 3:\n      matmul2_CR(a.shape, a.data._array, b.shape, b.data, shape, c._array);\n      break;\n\n    case 4:\n      matmul2_CC(a.shape, a.data._array, b.shape, b.data._array, shape, c._array);\n      break;\n\n    default:\n      matmul2_ELSE(a.shape, a.data, b.shape, b.data, shape, c);\n      break;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, c);\n}\nfunction matmul() {\n  for (var _len = arguments.length, matrices = new Array(_len), _key = 0; _key < _len; _key++) {\n    matrices[_key] = arguments[_key];\n  }\n\n  matrices = matrices.map(function (a) {\n    return Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(a);\n  });\n  if (matrices.length == 1) return matrices[0];\n  if (matrices.length == 2) return matmul2.apply(void 0, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(matrices));\n  /** Returns the number of floating point operations necessary to\n   *  matrix multiply two arrays of the given shapes.\n   */\n\n  function nOps(shapeA, shapeB) {\n    var _shapeA$slice = shapeA.slice(-2),\n        _shapeA$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(_shapeA$slice, 2),\n        I = _shapeA$slice2[0],\n        K = _shapeA$slice2[1],\n        J = shapeB[shapeB.length - 1];\n\n    if (shapeB[shapeB.length - 2] != K) throw new Error('Shape mismatch.');\n    var ndim = Math.max(shapeA.length, shapeB.length),\n        shape = Int32Array.from({\n      length: ndim\n    }, function () {\n      return 1;\n    });\n    shape[ndim - 2] = I;\n    shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n    for (var _i3 = 0, _arr3 = [shapeA, shapeB]; _i3 < _arr3.length; _i3++) {\n      var shp = _arr3[_i3];\n\n      for (var i = ndim - 2, j = shp.length - 2; i-- > 0 && j-- > 0;) {\n        if (1 === shape[i]) shape[i] = shp[j];else if (shape[i] != shp[j] && shp[j] != 1) throw new Error('Shapes are not broadcast-compatible.');\n      }\n    }\n\n    return [shape.reduce(function (a, b) {\n      return a * b;\n    }, 1) * K, shape];\n  }\n\n  ; // https://en.wikipedia.org/wiki/Matrix_chain_multiplication\n  // https://www.geeksforgeeks.org/matrix-chain-multiplication-dp-8/\n  // opMap[i][j] (j >= i) caches the optimal number of FLOPs required to multiply matrices[i] up to (including) matrices[j]\n\n  var opMap = Array.from({\n    length: matrices.length\n  }, function () {\n    return [];\n  }); // initialized opMap\n\n  for (var i = 0; i < matrices.length; i++) {\n    opMap[i][i] = [0, matrices[i].shape];\n  } // compute remaining opMap\n\n\n  for (var len = 2; len <= matrices.length; len++) {\n    for (var _i4 = 0; _i4 <= matrices.length - len; _i4++) {\n      var minFlops = Infinity,\n          minShape = void 0;\n\n      for (var j = 1; j < len; j++) {\n        var _opMap$_i = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(opMap[_i4][_i4 + j - 1], 2),\n            lFlops = _opMap$_i[0],\n            lShape = _opMap$_i[1];\n\n        var _opMap = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(opMap[_i4 + j][_i4 + len - 1], 2),\n            rFlops = _opMap[0],\n            rShape = _opMap[1];\n\n        var _nOps = nOps(lShape, rShape),\n            _nOps2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(_nOps, 2),\n            flops = _nOps2[0],\n            shape = _nOps2[1];\n\n        flops += lFlops + rFlops;\n\n        if (flops < minFlops) {\n          minFlops = flops;\n          minShape = shape; // <- the shape should always be the same so this is not strictly necessary\n        }\n      }\n\n      if (minShape === undefined) throw new Error('Integer overflow (too many FLOPs).');\n      opMap[_i4][_i4 + len - 1] = [minFlops, minShape];\n    }\n  } // compute the result using the minimal number of FLOPs using opMap\n\n\n  function product(from, to) {\n    if (from == to) return matrices[from];\n    var minFlops = Infinity,\n        minIdx;\n\n    for (var _i5 = from; _i5 < to; _i5++) {\n      var _opMap$from$_i = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(opMap[from][_i5], 2),\n          _lFlops = _opMap$from$_i[0],\n          _lShape = _opMap$from$_i[1];\n\n      var _opMap$to = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(opMap[_i5 + 1][to], 2),\n          _rFlops = _opMap$to[0],\n          _rShape = _opMap$to[1];\n\n      var _nOps3 = nOps(_lShape, _rShape),\n          _nOps4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2___default()(_nOps3, 2),\n          _flops = _nOps4[0],\n          _ = _nOps4[1];\n\n      _flops += _lFlops + _rFlops;\n\n      if (_flops < minFlops) {\n        minFlops = _flops;\n        minIdx = _i5;\n      }\n    }\n\n    return matmul2(product(from, minIdx), product(minIdx + 1, to));\n  }\n\n  return product(0, matrices.length - 1);\n}\n\n//# sourceURL=webpack://nd/./src/la/matmul.js?");

/***/ }),

/***/ "./src/la/norm.js":
/*!************************!*\
  !*** ./src/la/norm.js ***!
  \************************/
/*! exports provided: FrobeniusNorm, norm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FrobeniusNorm\", function() { return FrobeniusNorm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"norm\", function() { return norm; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\nvar FrobeniusNorm = /*#__PURE__*/function () {\n  function FrobeniusNorm() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, FrobeniusNorm);\n\n    this.sum = 0.0;\n    this.max = 0.0;\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(FrobeniusNorm, [{\n    key: \"reset\",\n    value: function reset() {\n      this.sum = this.max = 0;\n    }\n  }, {\n    key: \"include\",\n    value: function include(x) {\n      x = Math.abs(x);\n\n      if (x !== 0) {\n        if (this.max < x) {\n          var s = this.max / x;\n          this.sum *= s * s;\n          this.max = x;\n        }\n\n        x /= this.max;\n        this.sum += x * x;\n      }\n    }\n  }, {\n    key: \"resultIncl\",\n    value: function resultIncl(x) {\n      x = Math.abs(x);\n      var sum = this.sum,\n          max = this.max;\n\n      if (x !== 0) {\n        if (max < x) {\n          var s = max / x;\n          sum *= s * s;\n          max = x;\n        }\n\n        x /= max;\n        sum += x * x;\n      }\n\n      return isFinite(max) ? Math.sqrt(sum) * max : max;\n    }\n  }, {\n    key: \"result\",\n    get: function get() {\n      var max = this.max,\n          sum = this.sum;\n      return isFinite(max) ? Math.sqrt(sum) * max : max;\n    }\n  }, {\n    key: \"resultSquare\",\n    get: function get() {\n      var max = this.max,\n          sum = this.sum;\n      return isFinite(max) ? sum * max * max : max;\n    }\n  }]);\n\n  return FrobeniusNorm;\n}();\nfunction norm(A) {\n  var ord = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'fro';\n  var axis = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n  var norm;\n\n  switch (ord) {\n    case 'fro':\n      norm = new FrobeniusNorm();\n      break;\n\n    default:\n      throw new Error(\"norm(A,ord,axis): Unsupported ord: \".concat(ord, \".\"));\n  }\n\n  if (null == axis) {\n    var _iterator = _createForOfIteratorHelper(A.data),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var x = _step.value;\n        norm.include(x);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return norm.result;\n  }\n\n  throw new Error('norm(A,ord,axis): axis argument not yet supported.');\n} //    if( null == reducer )\n//    {\n//      if( null    ==  dtype      ) return this.data.reduce(axes)\n//      if('string' === typeof axes) return this.data.reduce(dtype)\n//      reducer = dtype; dtype = undefined\n//    }\n//    if( null == dtype ) dtype = 'object'\n//\n//    if( ! is_subdtype(this.dtype, dtype) )\n//      throw new Error('New dtype must be a super-dtype.')\n//\n//    const oldNDim = this.ndim\n//\n//    if( 'number' === typeof axes ) axes = [axes]\n//    if( axes instanceof NDArray ) {\n//      if( ! is_subdtype(axes.dtype,'int32') ) throw new Error(`Invalid dtype ${axes.dtype} for axes.`) \n//      if( axes.ndim === 1 )\n//        axes = axes.data\n//      else\n//        throw new Error('Only 1D nd.Array allowed for axes.')\n//    }\n//    axes = new Set( function*() {\n//      for( let ax of axes ) {\n//        if( 0 > ax )  ax += oldNDim\n//        if( 0 > ax || ax >= oldNDim ) throw new Error('Reduction axis '+ax+' out of bounds.')\n//        yield +ax\n//      }\n//    }() )\n//\n//    const\n//      oldShape= this.shape,\n//      newShape= oldShape.filter( (size,i) => ! axes.has(i) ),\n//      newData = new ARRAY_TYPES[dtype]( newShape.reduce((a,b) => a*b, 1) ),\n//      oldData = this.data\n//    let\n//      newIdx = 0,\n//      oldIdx = 0\n//\n//    function fill(d, reduce)\n//    {\n//      if( oldShape.length === d )\n//      {\n//        if(reduce) newData[newIdx]=reducer(oldData[oldIdx++], newData[newIdx])\n//        else       newData[newIdx]=        oldData[oldIdx++]\n//        ++newIdx\n//      }\n//      else if( axes.has(d) ) {\n//        const idx = newIdx\n//        for( let j=oldShape[d]; j-- > 0; reduce=true ) // <- copy over very first value and only then start reduction\n//        {\n//          newIdx = idx\n//          fill(d+1, reduce)\n//        }\n//      }\n//      else for( let j=oldShape[d]; j-- > 0; )\n//        fill(d+1, reduce)\n//    }\n//    fill(0,false)\n//\n//    if( newIdx !=   newData.length ) throw new Error([newIdx,   newData.length])\n//    if( oldIdx != this.data.length ) throw new Error([oldIdx, this.data.length])\n//\n//    return new NDArray(newShape,newData)\n\n//# sourceURL=webpack://nd/./src/la/norm.js?");

/***/ }),

/***/ "./src/la/permute.js":
/*!***************************!*\
  !*** ./src/la/permute.js ***!
  \***************************/
/*! exports provided: permute_rows, permute_cols, unpermute_rows, unpermute_cols */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"permute_rows\", function() { return permute_rows; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"permute_cols\", function() { return permute_cols; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unpermute_rows\", function() { return unpermute_rows; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unpermute_cols\", function() { return unpermute_cols; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction permute_rows(A, P) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('permute_rows(A,P): A.ndim must be at least 2.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('permute_rows(A,P): P.ndim must be at least 1.');\n  if (P.dtype !== 'int32') throw new Error('permute_rows(A,P): P.dtype must be \"int32\".');\n\n  var ndim = Math.max(A.ndim, P.ndim + 1),\n      B_shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  }),\n      _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      M = _A$shape$slice2[0],\n      N = _A$shape$slice2[1];\n\n  if (M !== P.shape[P.ndim - 1]) throw new Error('permute_rows(A,P): A.shape[-2] and P.shape[-1] must match.');\n\n  for (var i = ndim, j = A.ndim; i-- > 0 && j-- > 0;) {\n    B_shape[i] = A.shape[j];\n  } // FIND COMMON (BROADCASTED) SHAPE\n\n\n  for (var _i = ndim - 2, _j = P.ndim - 1; _i-- > 0 && _j-- > 0;) {\n    if (1 === B_shape[_i]) B_shape[_i] = P.shape[_j];else if (B_shape[_i] != P.shape[_j] && P.shape[_j] != 1) throw new Error('permute_rows(A,P): A and P not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var B = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype](B_shape.reduce(function (a, b) {\n    return a * b;\n  })),\n      A_shape = A.shape,\n      A_ndim = A.ndim,\n      P_shape = P.shape,\n      P_ndim = P.ndim;\n  A = A.data;\n  P = P.data;\n  var A_off = 0,\n      A_stride = -1,\n      P_off = 0,\n      P_stride = -1,\n      B_off = 0;\n\n  function perm(d) {\n    if (d === ndim - 2) {\n      // Q.T @ y\n      for (var _i2 = 0; _i2 < M; _i2++) {\n        var k = P[P_off + _i2];\n        if (!(k >= 0)) throw new Error('permute_rows(A,P): P.contains invalid indices.');\n        if (!(k < M)) throw new Error('permute_rows(A,P): P.contains invalid indices.');\n\n        for (var _j2 = 0; _j2 < N; _j2++) {\n          B[B_off + N * _i2 + _j2] = A[A_off + N * k + _j2];\n        }\n      }\n\n      A_off += A_stride = M * N;\n      P_off += P_stride = M;\n      B_off += A_stride;\n      return;\n    }\n\n    for (var l = B_shape[d];; l--) {\n      perm(d + 1);\n      if (l === 1) break;\n      if (!(A_shape[d - ndim + A_ndim] > 1)) A_off -= A_stride;\n      if (!(P_shape[d - ndim + 1 + P_ndim] > 1)) P_off -= P_stride;\n    }\n\n    A_stride *= A_shape[d - ndim + A_ndim] || 1;\n    P_stride *= P_shape[d - ndim + 1 + P_ndim] || 1;\n  }\n\n  perm(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](B_shape, B);\n}\nfunction permute_cols(A, P) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('permute_cols(A,P): A.ndim must be at least 2.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('permute_cols(A,P): P.ndim must be at least 1.');\n  if (P.dtype !== 'int32') throw new Error('permute_cols(A,P): P.dtype must be \"int32\".');\n\n  var ndim = Math.max(A.ndim, P.ndim + 1),\n      B_shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  }),\n      _A$shape$slice3 = A.shape.slice(-2),\n      _A$shape$slice4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice3, 2),\n      M = _A$shape$slice4[0],\n      N = _A$shape$slice4[1];\n\n  if (N !== P.shape[P.ndim - 1]) throw new Error('permute_cols(A,P): A.shape[-1] and P.shape[-1] must match.');\n\n  for (var i = ndim, j = A.ndim; i-- > 0 && j-- > 0;) {\n    B_shape[i] = A.shape[j];\n  } // FIND COMMON (BROADCASTED) SHAPE\n\n\n  for (var _i3 = ndim - 2, _j3 = P.ndim - 1; _i3-- > 0 && _j3-- > 0;) {\n    if (1 === B_shape[_i3]) B_shape[_i3] = P.shape[_j3];else if (B_shape[_i3] != P.shape[_j3] && P.shape[_j3] != 1) throw new Error('permute_cols(A,P): A and P not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var B = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype](B_shape.reduce(function (a, b) {\n    return a * b;\n  })),\n      A_shape = A.shape,\n      A_ndim = A.ndim,\n      P_shape = P.shape,\n      P_ndim = P.ndim;\n  A = A.data;\n  P = P.data;\n  var A_off = 0,\n      A_stride = -1,\n      P_off = 0,\n      P_stride = -1,\n      B_off = 0;\n\n  function perm(d) {\n    if (d === ndim - 2) {\n      // Q.T @ y\n      for (var _i4 = 0; _i4 < M; _i4++) {\n        for (var _j4 = 0; _j4 < N; _j4++) {\n          var k = P[P_off + _j4];\n          if (!(k >= 0)) throw new Error('permute_cols(A,P): P.contains invalid indices.');\n          if (!(k < N)) throw new Error('permute_cols(A,P): P.contains invalid indices.');\n          B[B_off + N * _i4 + _j4] = A[A_off + N * _i4 + k];\n        }\n      }\n\n      A_off += A_stride = M * N;\n      P_off += P_stride = N;\n      B_off += A_stride;\n      return;\n    }\n\n    for (var l = B_shape[d];; l--) {\n      perm(d + 1);\n      if (l === 1) break;\n      if (!(A_shape[d - ndim + A_ndim] > 1)) A_off -= A_stride;\n      if (!(P_shape[d - ndim + 1 + P_ndim] > 1)) P_off -= P_stride;\n    }\n\n    A_stride *= A_shape[d - ndim + A_ndim] || 1;\n    P_stride *= P_shape[d - ndim + 1 + P_ndim] || 1;\n  }\n\n  perm(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](B_shape, B);\n}\nfunction unpermute_rows(A, P) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('unpermute_rows(A,P): A.ndim must be at least 2.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('unpermute_rows(A,P): P.ndim must be at least 1.');\n  if (P.dtype !== 'int32') throw new Error('unpermute_rows(A,P): P.dtype must be \"int32\".');\n\n  var ndim = Math.max(A.ndim, P.ndim + 1),\n      B_shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  }),\n      _A$shape$slice5 = A.shape.slice(-2),\n      _A$shape$slice6 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice5, 2),\n      M = _A$shape$slice6[0],\n      N = _A$shape$slice6[1];\n\n  if (M !== P.shape[P.ndim - 1]) throw new Error('unpermute_rows(A,P): A.shape[-2] and P.shape[-1] must match.');\n\n  for (var i = ndim, j = A.ndim; i-- > 0 && j-- > 0;) {\n    B_shape[i] = A.shape[j];\n  } // FIND COMMON (BROADCASTED) SHAPE\n\n\n  for (var _i5 = ndim - 2, _j5 = P.ndim - 1; _i5-- > 0 && _j5-- > 0;) {\n    if (1 === B_shape[_i5]) B_shape[_i5] = P.shape[_j5];else if (B_shape[_i5] != P.shape[_j5] && P.shape[_j5] != 1) throw new Error('unpermute_rows(A,P): A and P not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var B = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype](B_shape.reduce(function (a, b) {\n    return a * b;\n  })),\n      A_shape = A.shape,\n      A_ndim = A.ndim,\n      P_shape = P.shape,\n      P_ndim = P.ndim;\n  A = A.data;\n  P = P.data;\n  var A_off = 0,\n      A_stride = -1,\n      P_off = 0,\n      P_stride = -1,\n      B_off = 0;\n\n  function perm(d) {\n    if (d === ndim - 2) {\n      // Q.T @ y\n      for (var _i6 = 0; _i6 < M; _i6++) {\n        var k = P[P_off + _i6];\n        if (!(k >= 0)) throw new Error('unpermute_rows(A,P): P.contains invalid indices.');\n        if (!(k < M)) throw new Error('unpermute_rows(A,P): P.contains invalid indices.');\n\n        for (var _j6 = 0; _j6 < N; _j6++) {\n          B[B_off + N * k + _j6] = A[A_off + N * _i6 + _j6];\n        }\n      }\n\n      A_off += A_stride = M * N;\n      P_off += P_stride = M;\n      B_off += A_stride;\n      return;\n    }\n\n    for (var l = B_shape[d];; l--) {\n      perm(d + 1);\n      if (l === 1) break;\n      if (!(A_shape[d - ndim + A_ndim] > 1)) A_off -= A_stride;\n      if (!(P_shape[d - ndim + 1 + P_ndim] > 1)) P_off -= P_stride;\n    }\n\n    A_stride *= A_shape[d - ndim + A_ndim] || 1;\n    P_stride *= P_shape[d - ndim + 1 + P_ndim] || 1;\n  }\n\n  perm(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](B_shape, B);\n}\nfunction unpermute_cols(A, P) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('unpermute_cols(A,P): A.ndim must be at least 2.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('unpermute_cols(A,P): P.ndim must be at least 1.');\n  if (P.dtype !== 'int32') throw new Error('unpermute_cols(A,P): P.dtype must be \"int32\".');\n\n  var ndim = Math.max(A.ndim, P.ndim + 1),\n      B_shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  }),\n      _A$shape$slice7 = A.shape.slice(-2),\n      _A$shape$slice8 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice7, 2),\n      M = _A$shape$slice8[0],\n      N = _A$shape$slice8[1];\n\n  if (N !== P.shape[P.ndim - 1]) throw new Error('unpermute_cols(A,P): A.shape[-1] and P.shape[-1] must match.');\n\n  for (var i = ndim, j = A.ndim; i-- > 0 && j-- > 0;) {\n    B_shape[i] = A.shape[j];\n  } // FIND COMMON (BROADCASTED) SHAPE\n\n\n  for (var _i7 = ndim - 2, _j7 = P.ndim - 1; _i7-- > 0 && _j7-- > 0;) {\n    if (1 === B_shape[_i7]) B_shape[_i7] = P.shape[_j7];else if (B_shape[_i7] != P.shape[_j7] && P.shape[_j7] != 1) throw new Error('unpermute_cols(A,P): A and P not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var B = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype](B_shape.reduce(function (a, b) {\n    return a * b;\n  })),\n      A_shape = A.shape,\n      A_ndim = A.ndim,\n      P_shape = P.shape,\n      P_ndim = P.ndim;\n  A = A.data;\n  P = P.data;\n  var A_off = 0,\n      A_stride = -1,\n      P_off = 0,\n      P_stride = -1,\n      B_off = 0;\n\n  function perm(d) {\n    if (d === ndim - 2) {\n      // Q.T @ y\n      for (var _i8 = 0; _i8 < M; _i8++) {\n        for (var _j8 = 0; _j8 < N; _j8++) {\n          var k = P[P_off + _j8];\n          if (!(k >= 0)) throw new Error('unpermute_cols(A,P): P.contains invalid indices.');\n          if (!(k < N)) throw new Error('unpermute_cols(A,P): P.contains invalid indices.');\n          B[B_off + N * _i8 + k] = A[A_off + N * _i8 + _j8];\n        }\n      }\n\n      A_off += A_stride = M * N;\n      P_off += P_stride = N;\n      B_off += A_stride;\n      return;\n    }\n\n    for (var l = B_shape[d];; l--) {\n      perm(d + 1);\n      if (l === 1) break;\n      if (!(A_shape[d - ndim + A_ndim] > 1)) A_off -= A_stride;\n      if (!(P_shape[d - ndim + 1 + P_ndim] > 1)) P_off -= P_stride;\n    }\n\n    A_stride *= A_shape[d - ndim + A_ndim] || 1;\n    P_stride *= P_shape[d - ndim + 1 + P_ndim] || 1;\n  }\n\n  perm(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](B_shape, B);\n}\n\n//# sourceURL=webpack://nd/./src/la/permute.js?");

/***/ }),

/***/ "./src/la/pldlp.js":
/*!*************************!*\
  !*** ./src/la/pldlp.js ***!
  \*************************/
/*! exports provided: _pldlp_decomp, pldlp_decomp, pldlp_l, pldlp_d, pldlp_p, _pldlp_solve, pldlp_solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_pldlp_decomp\", function() { return _pldlp_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pldlp_decomp\", function() { return pldlp_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pldlp_l\", function() { return pldlp_l; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pldlp_d\", function() { return pldlp_d; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pldlp_p\", function() { return pldlp_p; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_pldlp_solve\", function() { return _pldlp_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pldlp_solve\", function() { return pldlp_solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n // REFERENCES\n// ----------\n// .. [1] \"DSYTF2.f\"\n//         Reference-LAPACK v3.9.0\n//         https://github.com/Reference-LAPACK/lapack/blob/v3.9.0/SRC/dsytf2.f\n// .. [2] \"Matrix Computations\" 4th Edition\n//         Chapter 4   \"Special Linear Systems\"\n//         Section 4.4 \"Symmetric Indefinite Systems\"\n//         pp. 186ff\n//         Hindustan Book Agency, 2015\n\nvar _pldlp_decomp_1x1 = function _pldlp_decomp_1x1(M, N, LD, LD_off, k) {\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== k % 1) throw new Error('Assertion failed.');\n  if (0 !== LD_off % 1) throw new Error('Assertion failed.');\n  if (0 !== LD.length % 1) throw new Error('Assertion failed.');\n  if (!(0 <= M)) throw new Error('Assertion failed.');\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  if (!(k >= 0)) throw new Error('Assertion failed.');\n  if (!(k < M)) throw new Error('Assertion failed.');\n  var D_kk = LD[LD_off + N * k + k];\n\n  for (var i = k; ++i < M;) {\n    var LD_ik = LD[LD_off + N * i + k] / D_kk;\n\n    for (var j = k; j++ < i;) {\n      LD[LD_off + N * i + j] -= LD_ik * LD[LD_off + N * j + k];\n    }\n  }\n\n  for (var _i = k; ++_i < M;) {\n    LD[LD_off + N * _i + k] /= D_kk;\n  }\n};\n\nvar _pldlp_decomp_2x2 = function _pldlp_decomp_2x2(M, N, LD, LD_off, k) {\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== k % 1) throw new Error('Assertion failed.');\n  if (0 !== LD_off % 1) throw new Error('Assertion failed.');\n  if (0 !== LD.length % 1) throw new Error('Assertion failed.');\n  if (!(0 <= M)) throw new Error('Assertion failed.');\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  if (!(k >= 0)) throw new Error('Assertion failed.');\n  if (!(k < M - 1)) throw new Error('Assertion failed.'); // INVERSE OF DIAGONAL 2X2 BLOCK\n\n  var tmp = LD[LD_off + N * (k + 1) + k],\n      D00 = LD[LD_off + N * (k + 1) + (k + 1)] / tmp,\n      D11 = LD[LD_off + N * k + k] / tmp,\n      D10 = 1 / (D00 * D11 - 1) / tmp; // <- TODO: understand this underflow-safe Vodoo magic\n\n  for (var j = k + 2; j < M; j++) {\n    var s0 = D10 * (D00 * LD[LD_off + N * j + k] - LD[LD_off + N * j + k + 1]),\n        s1 = D10 * (D11 * LD[LD_off + N * j + k + 1] - LD[LD_off + N * j + k]);\n\n    for (var i = j; i < M; i++) {\n      LD[LD_off + N * i + j] -= LD[LD_off + N * i + k] * s0 + LD[LD_off + N * i + k + 1] * s1;\n    }\n\n    LD[LD_off + N * j + k] = s0;\n    LD[LD_off + N * j + k + 1] = s1;\n  }\n};\n\nvar _pldlp_swap = function _pldlp_swap(M, N, LD, LD_off, P, P_off, k, l) {\n  if (!(k <= l)) throw new Error('Assertion failed: ' + JSON.stringify({\n    k: k,\n    l: l\n  }));\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  var P_k = P[P_off + k];\n  P[P_off + k] = P[P_off + l];\n  P[P_off + l] = P_k;\n\n  for (var i = 0; i < k; i++) {\n    var LD_ki = LD[LD_off + N * k + i];\n    LD[LD_off + N * k + i] = LD[LD_off + N * l + i];\n    LD[LD_off + N * l + i] = LD_ki;\n  }\n\n  for (var _i2 = k; ++_i2 < l;) {\n    var LD_ik = LD[LD_off + N * _i2 + k];\n    LD[LD_off + N * _i2 + k] = LD[LD_off + N * l + _i2];\n    LD[LD_off + N * l + _i2] = LD_ik;\n  }\n\n  var LD_kk = LD[LD_off + N * k + k];\n  LD[LD_off + N * k + k] = LD[LD_off + N * l + l];\n  LD[LD_off + N * l + l] = LD_kk;\n\n  for (var _i3 = l; ++_i3 < M;) {\n    var _LD_ik = LD[LD_off + N * _i3 + k];\n    LD[LD_off + N * _i3 + k] = LD[LD_off + N * _i3 + l];\n    LD[LD_off + N * _i3 + l] = _LD_ik;\n  }\n};\n\nfunction _pldlp_decomp(M, N, LD, LD_off, P, P_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n\n  for (var i = 0; i < M; i++) {\n    P[P_off + i] = i;\n  }\n\n  var  = (Math.sqrt(17) + 1) / 8;\n\n  for (var k = 0; k < M; k++) {\n    var is1x1 = true;\n\n    if (k < M - 1) {\n      var r = void 0,\n          A_rk = -Infinity,\n          A_kk = Math.abs(LD[LD_off + N * k + k]);\n\n      for (var _i4 = k; ++_i4 < M;) {\n        var A_ik = Math.abs(LD[LD_off + N * _i4 + k]);\n\n        if (!(A_rk >= A_ik)) {\n          // <- handles NaN\n          A_rk = A_ik;\n          r = _i4;\n        }\n      }\n\n      if (!(0 < Math.max(A_rk, A_kk))) throw new Error('_pldlp_decomp(M,N, LD,LD_off, P,P_off): Zero column or NaN encountered.');\n\n      if (A_kk <  * A_rk) {\n        var s = void 0,\n            A_sr = -Infinity;\n\n        for (var _i5 = k; _i5 < r; _i5++) {\n          var A_ri = Math.abs(LD[LD_off + N * r + _i5]);\n\n          if (!(A_sr >= A_ri)) {\n            // <- handles NaN\n            A_sr = A_ri;\n            s = _i5;\n          }\n        }\n\n        for (var _i6 = r; ++_i6 < M;) {\n          var A_ir = Math.abs(LD[LD_off + N * _i6 + r]);\n\n          if (!(A_sr >= A_ir)) {\n            // <- handles NaN\n            A_sr = A_ir;\n            s = _i6;\n          }\n        }\n\n        if (r === s) throw new Error('Assertion failed.');\n\n        if (A_kk <  * A_rk * (A_rk / A_sr)) {\n          var A_rr = Math.abs(LD[LD_off + N * r + r]);\n\n          if (A_rr <  * A_sr) {\n            is1x1 = false;\n            P[P_off + r] ^= -1;\n            ++k;\n          }\n\n          if (k !== r) _pldlp_swap(M, N, LD, LD_off, P, P_off, k, r);\n        }\n      }\n    }\n\n    if (is1x1) _pldlp_decomp_1x1(M, N, LD, LD_off, k);else _pldlp_decomp_2x2(M, N, LD, LD_off, k - 1);\n  }\n}\nfunction pldlp_decomp(S) {\n  S = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(S);\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][S.dtype === 'float32' ? 'float32' : 'float64'],\n      LD_shape = S.shape,\n      P_shape = LD_shape.slice(0, -1),\n      _LD_shape$slice = LD_shape.slice(-2),\n      _LD_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD_shape$slice, 2),\n      N = _LD_shape$slice2[0],\n      M = _LD_shape$slice2[1];\n\n  S = S.data;\n  if (N !== M) throw new Error('Last two dimensions must be quadratic.');\n  var LD = new DTypeArray(S.length),\n      P = new Int32Array(S.length / N);\n\n  for (var LD_off = 0; LD_off < LD.length; LD_off += N * N) {\n    for (var i = 0; i < N; i++) {\n      for (var j = 0; j <= i; j++) {\n        LD[LD_off + N * i + j] = S[LD_off + N * i + j];\n      }\n    }\n\n    var P_off = LD_off / N;\n\n    _pldlp_decomp(N, N, LD, LD_off, P, P_off);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](LD_shape, LD), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](P_shape, P)];\n}\nfunction pldlp_l(LD, P) {\n  if (null == P) {\n    var _LD = LD;\n\n    var _LD2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD, 2);\n\n    LD = _LD2[0];\n    P = _LD2[1];\n  }\n\n  LD = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(LD);\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(P);\n  if (LD.ndim < 2) throw new Error('pldlp_solve(LD,P,y): LD must be at least 2D.');\n  if (P.ndim < 1) throw new Error('pldlp_solve(LD,P,y): P must be at least 1D.');\n  var N = LD.shape[LD.ndim - 2];\n  if (N !== LD.shape[LD.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD must be square.');\n  if (N !== P.shape[P.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD and P shape mismatch.');\n  var ndim = Math.max(LD.ndim, P.ndim + 1),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = N;\n  shape[ndim - 1] = N; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i7 = 0, _arr = [LD.shape.slice(0, -2), P.shape.slice(0, -1)]; _i7 < _arr.length; _i7++) {\n    var shp = _arr[_i7];\n\n    for (var i = ndim - 2, j = shp.length; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = shp[j];else if (shape[i] !== shp[j] && shp[j] !== 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var DType = [LD, P].every(function (x) {\n    return x.dtype === 'float32';\n  }) ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][DType],\n      L_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      LD_dat = LD.data,\n      P_dat = P.data;\n  var LD_off = 0,\n      LD_stride = 1,\n      P_off = 0,\n      P_stride = 1,\n      L_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      LD_stride = N * N;\n      P_stride = N;\n\n      for (var _i8 = 0; _i8 < N; _i8++) {\n        var I = _i8 - (P_dat[P_off + _i8] < 0);\n\n        for (var _j = 0; _j < I; _j++) {\n          L_dat[L_off + N * _i8 + _j] = LD_dat[LD_off + N * _i8 + _j];\n        }\n\n        L_dat[L_off + N * _i8 + _i8] = 1; //        L_dat[L_off + N*i+i] = LD_dat[LD_off + N*i+i];\n        //        if( P[P_off + i] < 0 )\n        //          L_dat[ L_off + N* i   + i-1] =\n        //          L_dat[ L_off + N*(i-1)+ i  ] =\n        //         LD_dat[LD_off + N* i   + i-1];\n      }\n\n      LD_off += LD_stride;\n      L_off += LD_stride;\n      P_off += P_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l === 1) break;\n      if (!(LD.shape[d - ndim + LD.ndim] > 1)) LD_off -= LD_stride;\n      if (!(P.shape[d - ndim + P.ndim + 1] > 1)) P_off -= P_stride;\n    }\n\n    LD_stride *= LD.shape[d - ndim + LD.ndim] || 1;\n    P_stride *= P.shape[d - ndim + P.ndim + 1] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, L_dat);\n}\nfunction pldlp_d(LD, P) {\n  if (null == P) {\n    var _LD3 = LD;\n\n    var _LD4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD3, 2);\n\n    LD = _LD4[0];\n    P = _LD4[1];\n  }\n\n  LD = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(LD);\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(P);\n  if (LD.ndim < 2) throw new Error('pldlp_solve(LD,P,y): LD must be at least 2D.');\n  if (P.ndim < 1) throw new Error('pldlp_solve(LD,P,y): P must be at least 1D.');\n  var N = LD.shape[LD.ndim - 2];\n  if (N !== LD.shape[LD.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD must be square.');\n  if (N !== P.shape[P.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD and P shape mismatch.');\n  var ndim = Math.max(LD.ndim, P.ndim + 1),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = N;\n  shape[ndim - 1] = N; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i9 = 0, _arr2 = [LD.shape.slice(0, -2), P.shape.slice(0, -1)]; _i9 < _arr2.length; _i9++) {\n    var shp = _arr2[_i9];\n\n    for (var i = ndim - 2, j = shp.length; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = shp[j];else if (shape[i] !== shp[j] && shp[j] !== 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var DType = [LD, P].every(function (x) {\n    return x.dtype === 'float32';\n  }) ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][DType],\n      D_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      LD_dat = LD.data,\n      P_dat = P.data;\n  var LD_off = 0,\n      LD_stride = 1,\n      P_off = 0,\n      P_stride = 1,\n      D_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      LD_stride = N * N;\n      P_stride = N;\n\n      for (var _i10 = 0; _i10 < N; _i10++) {\n        D_dat[D_off + N * _i10 + _i10] = LD_dat[LD_off + N * _i10 + _i10];\n        if (P_dat[P_off + _i10] < 0) D_dat[D_off + N * _i10 + _i10 - 1] = D_dat[D_off + N * (_i10 - 1) + _i10] = LD_dat[LD_off + N * _i10 + _i10 - 1];\n      }\n\n      LD_off += LD_stride;\n      D_off += LD_stride;\n      P_off += P_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l === 1) break;\n      if (!(LD.shape[d - ndim + LD.ndim] > 1)) LD_off -= LD_stride;\n      if (!(P.shape[d - ndim + P.ndim + 1] > 1)) P_off -= P_stride;\n    }\n\n    LD_stride *= LD.shape[d - ndim + LD.ndim] || 1;\n    P_stride *= P.shape[d - ndim + P.ndim + 1] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, D_dat);\n}\nfunction pldlp_p(LD, P) {\n  if (null == P) {\n    var _LD5 = LD;\n\n    var _LD6 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD5, 2);\n\n    LD = _LD6[0];\n    P = _LD6[1];\n  }\n\n  LD = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(LD);\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(P);\n  if (LD.ndim < 2) throw new Error('pldlp_solve(LD,P,y): LD must be at least 2D.');\n  if (P.ndim < 1) throw new Error('pldlp_solve(LD,P,y): P must be at least 1D.');\n  var N = LD.shape[LD.ndim - 2];\n  if (N !== LD.shape[LD.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD must be square.');\n  if (N !== P.shape[P.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD and P shape mismatch.');\n\n  for (var i = LD.ndim - 2, j = P.ndim - 1; i-- > 0 && j-- > 0;) {\n    if (P.shape[j] !== 1 && LD.shape[i] !== 1 && LD.shape[i] !== P.shape[j]) throw new Error('Shapes are not broadcast-compatible.');\n  }\n\n  var P_shape = P.shape;\n  P = Int32Array.from(P.data);\n  LD = undefined;\n  var test = new Uint8Array(N);\n\n  for (var P_off = P.length; (P_off -= N) >= 0;) {\n    test.fill(false);\n\n    for (var _i11 = N; _i11-- > 0;) {\n      var p = P[P_off + _i11];\n\n      if (p < 0) {\n        if (!(0 < _i11) || P[P_off + _i11 - 1] < 0) throw new Error('pldlp_solve(LD,P,y): P is invalid.');\n        p ^= -1;\n      }\n\n      if (!(p >= 0)) throw new Error('pldlp_solve(LD,P,y): P contains out-of-bounds indices.');\n      if (!(p < N)) throw new Error('pldlp_solve(LD,P,y): P contains out-of-bounds indices.');\n      if (test[p]) throw new Error('pldlp_solve(LD,P,y): P contains duplicate indices.');\n      test[p] = true;\n      P[P_off + _i11] = p;\n    }\n\n    if (test.some(function (x) {\n      return !x;\n    })) throw new Error('pldlp_solve(LD,P,y): P is invalid.');\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](P_shape, P);\n}\nfunction _pldlp_solve(M, N, O, LD, LD_off, P, P_off, X, X_off, tmp) {\n  if (0 !== LD.length % 1) throw new Error('Assertion failed.');\n  if (0 !== P.length % 1) throw new Error('Assertion failed.');\n  if (0 !== X.length % 1) throw new Error('Assertion failed.');\n  if (0 !== tmp.length % 1) throw new Error('Assertion failed.');\n  if (0 !== LD_off % 1) throw new Error('Assertion failed.');\n  if (0 !== P_off % 1) throw new Error('Assertion failed.');\n  if (0 !== X_off % 1) throw new Error('Assertion failed.');\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== O % 1) throw new Error('Assertion failed.');\n  if (LD.length - LD_off < M * N) throw new Error('Assertion failed.');\n  if (P.length - P_off < M) throw new Error('Assertion failed.');\n  if (X.length - X_off < M * O) throw new Error('Assertion failed.');\n  if (tmp.length < M * O) throw new Error('Assertion failed.');\n  if (!(0 < M)) throw new Error('Assertion failed.');\n  if (!(0 < N)) throw new Error('Assertion failed.');\n  if (!(0 < O)) throw new Error('Assertion failed.');\n  if (!(M <= N)) throw new Error('Assertion failed.'); // PERMUTE INPUT\n\n  for (var i = 0; i < M; i++) {\n    var I = P[P_off + i];\n    I ^= -(I < 0);\n\n    for (var j = 0; j < O; j++) {\n      tmp[O * i + j] = X[X_off + O * I + j];\n    }\n  } // FORWARD SUBSTITUTION\n\n\n  for (var _i12 = 1; _i12 < M; _i12++) {\n    var K = _i12 - (P[P_off + _i12] < 0);\n\n    for (var k = 0; k < K; k++) {\n      for (var _j2 = 0; _j2 < O; _j2++) {\n        tmp[O * _i12 + _j2] -= LD[LD_off + N * _i12 + k] * tmp[O * k + _j2];\n      }\n    }\n  } // SCALING\n\n\n  for (var _i13 = 0; _i13 < M; _i13++) {\n    if (_i13 < M - 1 && P[P_off + _i13 + 1] < 0) {\n      // 2x2 BLOCK\n      var s = LD[LD_off + N * (_i13 + 1) + _i13],\n          D00 = LD[LD_off + N * (_i13 + 1) + _i13 + 1] / s,\n          D11 = LD[LD_off + N * _i13 + _i13] / s,\n          D10 = 1 / (D00 * D11 - 1) / s; // <- TODO: understand this underflow-safe Vodoo magic (see [1])\n\n      for (var _j3 = 0; _j3 < O; _j3++) {\n        var y0 = tmp[O * _i13 + _j3],\n            y1 = tmp[O * (_i13 + 1) + _j3];\n        tmp[O * _i13 + _j3] = D10 * (D00 * y0 - y1);\n        tmp[O * (_i13 + 1) + _j3] = D10 * (D11 * y1 - y0);\n      }\n\n      ++_i13;\n    } else {\n      // 1x1 BLOCK\n      for (var _j4 = 0; _j4 < O; _j4++) {\n        tmp[O * _i13 + _j4] /= LD[LD_off + N * _i13 + _i13];\n      }\n    }\n  } // BACKWARD SUBSTITUTION\n\n\n  for (var _k = M; _k-- > 1;) {\n    var _I = _k - (P[P_off + _k] < 0);\n\n    for (var _i14 = _I; _i14-- > 0;) {\n      for (var _j5 = O; _j5-- > 0;) {\n        tmp[O * _i14 + _j5] -= LD[LD_off + N * _k + _i14] * tmp[O * _k + _j5];\n      }\n    }\n  } // (UN)PERMUTE OUTPUT\n\n\n  for (var _i15 = 0; _i15 < M; _i15++) {\n    var _I2 = P[P_off + _i15];\n    _I2 ^= -(_I2 < 0);\n\n    for (var _j6 = 0; _j6 < O; _j6++) {\n      X[X_off + O * _I2 + _j6] = tmp[O * _i15 + _j6];\n    }\n  }\n}\nfunction pldlp_solve(LD, P, y) {\n  if (null == y) {\n    if (null == P) throw new Error('Assertion failed.');\n    y = P;\n    var _LD7 = LD;\n\n    var _LD8 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_LD7, 2);\n\n    LD = _LD8[0];\n    P = _LD8[1];\n  }\n\n  LD = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(LD);\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(P);\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(y);\n  if (LD.ndim < 2) throw new Error('pldlp_solve(LD,P,y): LD must be at least 2D.');\n  if (P.ndim < 1) throw new Error('pldlp_solve(LD,P,y): P must be at least 1D.');\n  if (y.ndim < 2) throw new Error('pldlp_solve(LD,P,y): y must be at least 2D.');\n  var N = LD.shape[LD.ndim - 2],\n      O = y.shape[y.ndim - 1];\n  if (N !== LD.shape[LD.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD must be square.');\n  if (N !== P.shape[P.ndim - 1]) throw new Error('pldlp_solve(LD,P,y): LD and P shape mismatch.');\n  if (N !== y.shape[y.ndim - 2]) throw new Error('pldlp_solve(LD,P,y): LD and y shape mismatch.');\n  var ndim = Math.max(LD.ndim, P.ndim + 1, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = N;\n  shape[ndim - 1] = O; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i16 = 0, _arr3 = [LD.shape.slice(0, -2), P.shape.slice(0, -1), y.shape.slice(0, -2)]; _i16 < _arr3.length; _i16++) {\n    var shp = _arr3[_i16];\n\n    for (var i = ndim - 2, j = shp.length; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = shp[j];else if (shape[i] !== shp[j] && shp[j] !== 1) throw new Error('Shapes are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var DType = [LD, P, y].every(function (x) {\n    return x.dtype === 'float32';\n  }) ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][DType],\n      tmp = new DTypeArray(N * O),\n      x_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      LD_dat = LD.data,\n      P_dat = P.data,\n      y_dat = y.data;\n  var LD_off = 0,\n      LD_stride = 1,\n      P_off = 0,\n      P_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      LD_stride = N * N;\n      P_stride = N;\n      y_stride = N * O; // COPY y\n\n      for (var _i17 = 0; _i17 < y_stride; _i17++) {\n        x_dat[x_off + _i17] = y_dat[y_off + _i17];\n      }\n\n      _pldlp_solve(N, N, O, LD_dat, LD_off, P_dat, P_off, x_dat, x_off, tmp);\n\n      LD_off += LD_stride;\n      P_off += P_stride;\n      y_off += y_stride;\n      x_off += y_stride;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l === 1) break;\n      if (!(LD.shape[d - ndim + LD.ndim] > 1)) LD_off -= LD_stride;\n      if (!(P.shape[d - ndim + P.ndim + 1] > 1)) P_off -= P_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    LD_stride *= LD.shape[d - ndim + LD.ndim] || 1;\n    P_stride *= P.shape[d - ndim + P.ndim + 1] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/pldlp.js?");

/***/ }),

/***/ "./src/la/qr.js":
/*!**********************!*\
  !*** ./src/la/qr.js ***!
  \**********************/
/*! exports provided: qr_decomp_full, qr_decomp, _qr_decomp_inplace, qr_lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"qr_decomp_full\", function() { return qr_decomp_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"qr_decomp\", function() { return qr_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_qr_decomp_inplace\", function() { return _qr_decomp_inplace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"qr_lstsq\", function() { return qr_lstsq; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\nfunction qr_decomp_full(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('A must be at least 2D.');\n\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][DType],\n      B = DType === 'float32' ? 64 / 4 : 64 / 8,\n      R_shape = A.shape,\n      Q_shape = Int32Array.from(R_shape),\n      _R_shape$slice = R_shape.slice(-2),\n      _R_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R_shape$slice, 2),\n      M = _R_shape$slice2[0],\n      N = _R_shape$slice2[1],\n      R = DTypeArray.from(A.data);\n\n  A = undefined;\n  Q_shape[Q_shape.length - 1] = M;\n  var Q = new DTypeArray(R.length / N * M); //  Q.fill(0); // <- in case of an object array\n\n  for (var Q_off = 0, R_off = 0; Q_off < Q.length; Q_off += M * M, R_off += M * N) {\n    // INIT Q TO IDENTITY MATRIX\n    for (var i = 0; i < M; i++) {\n      Q[Q_off + M * i + i] = 1.0;\n    } // The idea of the blocked loop is that the top B rows\n\n\n    for (var J = 0; J < N; J += B) {\n      // are cached and used to elimate B columns in the remaining\n      for (var I = J; I < M; I += B) {\n        // rows. This should reduce the number of cache misses.\n        for (var _i = I; _i < I + B && _i < M; _i++) {\n          // Some quick and dirty benchmarks indicate a ~15% perfomance\n          for (var j = J; j < J + B && j < N && j < _i; j++) // improvement for matrix sizes of [300,300] and above.\n          {\n            // USE GIVENS ROTATION TO ELIMINATE ELEMENT R_ji\n            var ij = R_off + N * _i + j,\n                R_ij = R[ij];\n            if (0 === R_ij) continue;\n\n            var jj = R_off + N * j + j,\n                R_jj = R[jj],\n                _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(R_jj, R_ij),\n                _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n                c = _giv_rot_qr3[0],\n                s = _giv_rot_qr3[1],\n                norm = _giv_rot_qr3[2];\n\n            R[ij] = 0;\n            if (0 === s) continue;\n            R[jj] = norm;\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(R, N - 1 - j, jj + 1, ij + 1, c, s);\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, 1 + _i, Q_off + M * j, Q_off + M * _i, c, s);\n          }\n        }\n      }\n    }\n\n    Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_4__[\"_transpose_inplace\"])(M, Q, Q_off);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](Q_shape, Q), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](R_shape, R)];\n}\nfunction qr_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('qr_decomp(A): A.ndim must be at least 2.');\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      Q_shape = A.shape,\n      R_shape = Int32Array.from(Q_shape),\n      _Q_shape$slice = Q_shape.slice(-2),\n      _Q_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q_shape$slice, 2),\n      N = _Q_shape$slice2[0],\n      M = _Q_shape$slice2[1];\n\n  R_shape[R_shape.length - 2] = M;\n  if (N <= M) return qr_decomp_full(A);\n  var Q = DTypeArray.from(A.data); // <- we could encourage GC by setting `A = undefined` after this line\n\n  A = undefined;\n  var R = new DTypeArray(Q.length / N * M); // <- additional space to temp. store rows of R not contained in the result\n\n  for (var R_off = 0, Q_off = 0; Q_off < Q.length; Q_off += N * M, R_off += M * M) {\n    // COMPUTE R (inside of Q)\n    for (var i = 1; i < N; i++) {\n      var I = Math.min(i, M);\n\n      for (var j = 0; j < I; j++) {\n        // USE GIVENS ROTATION TO ELIMINATE ELEMENT R_ji\n        var ij = Q_off + M * i + j,\n            R_ij = Q[ij];\n        if (0 === R_ij) continue;\n        var jj = Q_off + M * j + j,\n            R_jj = Q[jj];\n\n        var _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(R_jj, R_ij),\n            _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n            c = _giv_rot_qr5[0],\n            s = _giv_rot_qr5[1],\n            norm = _giv_rot_qr5[2];\n\n        if (s !== 0) {\n          if (c < 0) {\n            c *= -1;\n            s *= -1;\n            norm *= -1;\n          }\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, M - 1 - j, jj + 1, ij + 1, c, s);\n\n          Q[jj] = norm;\n        }\n\n        Q[ij] = s;\n      }\n    } // MOVE R FROM Q -> R AND INIT Q TO I\n\n\n    for (var _i2 = 0; _i2 < M; _i2++) {\n      for (var _j = _i2; _j < M; _j++) {\n        R[R_off + M * _i2 + _j] = Q[Q_off + M * _i2 + _j];\n        Q[Q_off + M * _i2 + _j] = +(_i2 === _j);\n      }\n    } // COMPUTE Q\n\n\n    for (var _i3 = N; --_i3 > 0;) {\n      var _I = Math.min(_i3, M);\n\n      for (var _j2 = _I; _j2-- > 0;) {\n        var _s = Q[Q_off + M * _i3 + _j2];\n        if (0 === _s) continue;\n        Q[Q_off + M * _i3 + _j2] = 0;\n\n        var _c = Math.sqrt((1 - _s) * (1 + _s));\n\n        Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, M - _j2, Q_off + M * _i3 + _j2, Q_off + M * _j2 + _j2, _c, _s);\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](Q_shape, Q), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](R_shape, R)];\n}\nfunction _qr_decomp_inplace(M, N, L, A, A_off, Y, Y_off) {\n  if (M % 1 !== 0) throw new Error('Assertion failed.');\n  if (N % 1 !== 0) throw new Error('Assertion failed.');\n  if (L % 1 !== 0) throw new Error('Assertion failed.');\n  if (A_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (Y_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (A.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (Y.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (!(0 <= M)) throw new Error('Assertion failed.');\n  if (!(0 <= N)) throw new Error('Assertion failed.');\n  if (!(0 <= L)) throw new Error('Assertion failed.');\n  if (!(0 <= A_off)) throw new Error('Assertion failed.');\n  if (!(0 <= Y_off)) throw new Error('Assertion failed.');\n  if (!(0 <= A.length)) throw new Error('Assertion failed.');\n  if (!(0 <= Y.length)) throw new Error('Assertion failed.');\n  if (!(M * N <= A.length - A_off)) throw new Error('Assertion failed.');\n  if (!(M * L <= Y.length - Y_off)) throw new Error('Assertion failed.');\n\n  for (var i = 1; i < M; i++) {\n    for (var j = 0; j < N && j < i; j++) {\n      // USE GIVENS ROTATION TO ELIMINATE ELEMENT R_ji\n      var ij = A_off + N * i + j,\n          A_ij = A[ij];\n      if (0 === A_ij) continue;\n\n      var jj = A_off + N * j + j,\n          A_jj = A[jj],\n          _giv_rot_qr6 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(A_jj, A_ij),\n          _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr6, 3),\n          c = _giv_rot_qr7[0],\n          s = _giv_rot_qr7[1],\n          norm = _giv_rot_qr7[2];\n\n      A[ij] = 0;\n      if (0 === s) continue;\n      A[jj] = norm;\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(A, N - 1 - j, jj + 1, ij + 1, c, s);\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Y, L, Y_off + L * j, Y_off + L * i, c, s);\n    }\n  }\n}\nfunction qr_lstsq(Q, R, y) {\n  if (undefined == y) {\n    y = R;\n    var _Q = Q;\n\n    var _Q2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q, 2);\n\n    Q = _Q2[0];\n    R = _Q2[1];\n  }\n\n  Q = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(Q);\n  if (Q.ndim < 2) throw new Error('qr_lstsq(Q,R,y): Q.ndim must be at least 2.');\n  R = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(R);\n  if (R.ndim < 2) throw new Error('qr_lstsq(Q,R,y): R.ndim must be at least 2.');\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(y);\n  if (y.ndim < 2) throw new Error('qr_lstsq(Q,R,y): y.ndim must be at least 2.'); //  ________________   ______                   ___________\n  // |                | |\\(MxI)|                 |           |\n  // |                | | \\ R  |  ___________    |           |\n  // |     (NxM)      | |  \\   | |   (IxJ)   |   |   (NxJ)   |\n  // |       Q        | |   \\  | |     X     | = |     Y     |\n  // |                | |    \\ | |           |   |           |\n  // |                | |     \\| |___________|   |           |\n  // |                | |  0   |                 |           |\n  // |________________| |______|                 |___________|\n\n  var _Q$shape$slice = Q.shape.slice(-2),\n      _Q$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q$shape$slice, 2),\n      N = _Q$shape$slice2[0],\n      M = _Q$shape$slice2[1],\n      _R$shape$slice = R.shape.slice(-1),\n      _R$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R$shape$slice, 1),\n      I = _R$shape$slice2[0],\n      _y$shape$slice = y.shape.slice(-1),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 1),\n      J = _y$shape$slice2[0],\n      L = Math.min(M, I);\n\n  if (N != y.shape[y.ndim - 2]) throw new Error(\"qr_lstsq(Q,R,y): Q and y don't match.\");\n  if (M != R.shape[R.ndim - 2]) throw new Error(\"qr_lstsq(Q,R,y): Q and R don't match.\");\n  if (I > N) throw new Error(\"qr_lstsq(Q,R,y): Under-determined systems not supported. Use rrqr instead.\");\n  var ndim = Math.max(Q.ndim, R.ndim, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i4 = 0, _arr = [Q, R, y]; _i4 < _arr.length; _i4++) {\n    var arr = _arr[_i4];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('Q, R, y are not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][[Q, R, y].every(function (a) {\n    return a.dtype === 'float32';\n  }) ? 'float32' : 'float64'],\n      x_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      Q_dat = Q.data,\n      R_dat = R.data,\n      y_dat = y.data;\n  var Q_off = 0,\n      Q_stride = 1,\n      R_off = 0,\n      R_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      Q_stride = N * M;\n      R_stride = M * I;\n      y_stride = N * J; // Q.T @ y\n\n      for (var _i5 = 0; _i5 < L; _i5++) {\n        for (var _j3 = 0; _j3 < J; _j3++) {\n          for (var k = 0; k < N; k++) {\n            x_dat[x_off + _i5 * J + _j3] += Q_dat[Q_off + k * M + _i5] * y_dat[y_off + k * J + _j3];\n          }\n        }\n      }\n\n      Object(_tri__WEBPACK_IMPORTED_MODULE_5__[\"_triu_solve\"])(L, I, J, R_dat, R_off, x_dat, x_off);\n\n      Q_off += Q_stride;\n      R_off += R_stride;\n      y_off += y_stride;\n      x_off += I * J;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break;\n      if (!(Q.shape[d - ndim + Q.ndim] > 1)) Q_off -= Q_stride;\n      if (!(R.shape[d - ndim + R.ndim] > 1)) R_off -= R_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    Q_stride *= Q.shape[d - ndim + Q.ndim] || 1;\n    R_stride *= R.shape[d - ndim + R.ndim] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/qr.js?");

/***/ }),

/***/ "./src/la/rand_ortho.js":
/*!******************************!*\
  !*** ./src/la/rand_ortho.js ***!
  \******************************/
/*! exports provided: rand_ortho */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rand_ortho\", function() { return rand_ortho; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _rand_normal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rand_normal */ \"./src/rand_normal.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\nvar WARN = true;\nfunction rand_ortho(dtype) {\n  for (var _len = arguments.length, shape = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    shape[_key - 1] = arguments[_key];\n  }\n\n  if (WARN) {\n    WARN = false;\n    console.warn(new Error('nd.la.rand_ortho is deprecated, use nd.rand.AleaRNG instead.'));\n  } // REFERENCES:\n  //   - https://blogs.sas.com/content/iml/2012/03/28/generating-a-random-orthogonal-matrix.html\n\n\n  if (!(dtype in _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"])) {\n    shape.unshift(dtype);\n    dtype = 'float64';\n  }\n\n  if (!dtype.startsWith('float')) throw new Error(\"Unsupported dtype: '\".concat(dtype, \"'.\"));\n  if (shape.length === 1) shape.push(shape[0]);\n\n  for (var i = shape.length; i-- > 0;) {\n    if (shape[i] % 1 !== 0 || shape[i] < 1) throw new Error(\"shape[\".concat(i, \"] = \").concat(shape[i], \" not a positive integer.\"));\n  }\n\n  shape = Int32Array.from(shape);\n\n  var _shape$slice = shape.slice(-2),\n      _shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_shape$slice, 2),\n      M = _shape$slice2[0],\n      N = _shape$slice2[1],\n      L = Math.max(M, N);\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype],\n      U = new DTypeArray(shape.reduce(function (x, y) {\n    return x * y;\n  })),\n      Q = new DTypeArray(L * L),\n      x = new DTypeArray(L),\n      d = new DTypeArray(L);\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"](); // TODO: this should be computable more efficiently for non-square matrices\n\n  for (var off = 0; off < U.length; off += M * N) {\n    // INIT Q TO IDENTITY\n    for (var _i = 0; _i < L; _i++) {\n      for (var j = 0; j < L; j++) {\n        Q[L * _i + j] = (_i === j) * 1;\n      }\n    }\n\n    d[0] = Math.random() <= 0.5 ? -1 : +1; // apply series of random householder transformations/reflections\n\n    for (var k = L; k-- > 1;) {\n      NORM.reset();\n\n      for (var _i2 = 0;; _i2++) {\n        var x_i = x[_i2] = Object(_rand_normal__WEBPACK_IMPORTED_MODULE_3__[\"rand_normal\"])();\n        if (_i2 >= k) break;\n        NORM.include(x_i);\n      }\n\n      d[k] = x[k] > 0 ? -1 : +1;\n      var norm = NORM.resultIncl(x[k]) * d[k];\n      if (0 === norm) continue;\n      NORM.include(x[k] -= norm);\n      var max = NORM.max,\n          div = Math.sqrt(NORM.sum);\n\n      for (var _i3 = k; _i3 >= 0; _i3--) {\n        x[_i3] = x[_i3] / max / div;\n      } // apply householder to right of Q\n\n\n      for (var _i4 = L; _i4-- > 0;) {\n        var sum = 0;\n\n        for (var _j = k; _j >= 0; _j--) {\n          sum += Q[L * _i4 + _j] * x[_j];\n        }\n\n        sum *= 2;\n\n        for (var _j2 = k; _j2 >= 0; _j2--) {\n          Q[L * _i4 + _j2] -= x[_j2] * sum;\n        }\n      }\n    } // flip row signs according to d\n\n\n    for (var _i5 = 0; _i5 < L; _i5++) {\n      for (var _j3 = 0; _j3 < L; _j3++) {\n        Q[L * _i5 + _j3] *= d[_i5];\n      }\n    } // MOVE Q -> U\n\n\n    for (var _i6 = 0; _i6 < M; _i6++) {\n      for (var _j4 = 0; _j4 < N; _j4++) {\n        U[off + N * _i6 + _j4] = Q[L * _i6 + _j4];\n      }\n    }\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, U);\n}\n\n//# sourceURL=webpack://nd/./src/la/rand_ortho.js?");

/***/ }),

/***/ "./src/la/rank.js":
/*!************************!*\
  !*** ./src/la/rank.js ***!
  \************************/
/*! exports provided: rank */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rank\", function() { return rank; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _svd__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./svd */ \"./src/la/svd.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction rank(A) {\n  var _svd_decomp = Object(_svd__WEBPACK_IMPORTED_MODULE_1__[\"svd_decomp\"])(A),\n      _svd_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_decomp, 3),\n      U = _svd_decomp2[0],\n      sv = _svd_decomp2[1],\n      V = _svd_decomp2[2];\n\n  return Object(_svd__WEBPACK_IMPORTED_MODULE_1__[\"svd_rank\"])(sv);\n}\n\n//# sourceURL=webpack://nd/./src/la/rank.js?");

/***/ }),

/***/ "./src/la/rrqr.js":
/*!************************!*\
  !*** ./src/la/rrqr.js ***!
  \************************/
/*! exports provided: _norm_update, _norm, _rrqr_rank, rrqr_decomp_full, _rrqr_decomp_inplace, rrqr_decomp, rrqr_rank, rrqr_solve, rrqr_lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_norm_update\", function() { return _norm_update; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_norm\", function() { return _norm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rrqr_rank\", function() { return _rrqr_rank; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rrqr_decomp_full\", function() { return rrqr_decomp_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_rrqr_decomp_inplace\", function() { return _rrqr_decomp_inplace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rrqr_decomp\", function() { return rrqr_decomp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rrqr_rank\", function() { return rrqr_rank; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rrqr_solve\", function() { return rrqr_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rrqr_lstsq\", function() { return rrqr_lstsq; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./singular_matrix_solve_error */ \"./src/la/singular_matrix_solve_error.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nfunction _norm_update(norm, Q, i, j) {\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot#Polyfill\n  i |= 0;\n  j <<= 1;\n\n  for (; j < norm.length; j = j + 2 | 0) {\n    var s = Math.abs(Q[i + (j >>> 1)]);\n\n    if (s !== 0) {\n      if (norm[j] < s) {\n        var r = norm[j] / s;\n        norm[j + 1] *= r * r;\n        norm[j] = s;\n      }\n\n      s /= norm[j];\n      norm[j + 1] += s * s;\n    }\n  }\n}\nfunction _norm(norm, i) {\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot#Polyfill\n  i <<= 1;\n  var max = norm[i];\n  return isFinite(max) ? Math.sqrt(norm[i + 1]) * max : max;\n}\nfunction _rrqr_rank(M, N, R, R_off, tmp) {\n  // SEE: Gene H. Golub, Charles F. Van Golub\n  //      \"Matrix Computations\", 4th edition\n  //      Page 276f, Chap. 5.4.2 (QR with Column Pivoting) & 5.4.3 (Numerical Rank and A=QR)\n  var L = Math.min(M, N);\n  if (!(tmp.length >= L)) throw new Error('Assertion failed.');\n  var norm = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"]();\n\n  for (var i = L; i-- > 0;) {\n    for (var j = N; j-- > i;) {\n      norm.include(R[R_off + N * i + j]);\n    }\n\n    tmp[i] = norm.result;\n    if (!isFinite(tmp[i])) throw new Error('Infinity or NaN encountered during rank estimation.');\n  }\n\n  var dtype = tmp instanceof Float32Array ? 'float32' : 'float64',\n      T = Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(dtype) * 2 * Math.max(M, N) * tmp[0]; // <- threshold\n\n  var r = L;\n\n  while (r > 0 && tmp[r - 1] <= T) {\n    // <- TODO use binary search here for slightly improved performance\n    --r;\n  }\n\n  return r;\n}\nfunction rrqr_decomp_full(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('A must be at least 2D.');\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      R_shape = A.shape,\n      Q_shape = Int32Array.from(R_shape),\n      P_shape = Q_shape.slice(0, -1),\n      _R_shape$slice = R_shape.slice(-2),\n      _R_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R_shape$slice, 2),\n      M = _R_shape$slice2[0],\n      N = _R_shape$slice2[1],\n      K = Math.min(M, N); // <- M not M-1, because the last row still needs pivotization\n\n\n  Q_shape[Q_shape.length - 1] = M;\n  P_shape[P_shape.length - 1] = N;\n  var R = DTypeArray.from(A.data); // <- we could encourage GC by setting `A = undefined` after this line\n\n  A = undefined;\n  var P = new Int32Array(R.length / M),\n      // <- tracks column permutations\n  Q = new DTypeArray(R.length / N * M),\n      norm = new DTypeArray(N << 1); // < underflow-safe representation of the column norm (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot#Polyfill)\n\n  for (var Q_off = 0, R_off = 0, P_off = 0; Q_off < Q.length; Q_off += M * M, R_off += M * N, P_off += N) {\n    // INIT P\n    for (var i = 0; i < N; i++) {\n      P[P_off + i] = i;\n    } // INIT Q (TO IDENTITY)\n\n\n    for (var _i = 0; _i < M; _i++) {\n      Q[Q_off + M * _i + _i] = 1;\n    } // INIT COLUMN NORM\n    //*DEBUG*/    if( norm.some(x => x!==0) )\n    //*DEBUG*/      throw new Error('Assertion failed.');\n\n\n    for (var j = 0; j < M; j++) {\n      _norm_update(norm, R, R_off + N * j, 0);\n    } // ELIMINATE COLUMN BY COLUMN OF R\n\n\n    for (var _i2 = 0; _i2 < K; _i2++) {\n      // FIND PIVOT COLUMN THAT (HOPEFULLY) ENSURES RANK REVEAL (RRQR is inherently not guaranteed to do that)\n      var p = -1,\n          norm_p = -Infinity;\n\n      for (var _j = _i2; _j < N; _j++) {\n        var norm_j = _norm(norm, _j);\n\n        if (norm_p < norm_j) {\n          p = _j;\n          norm_p = norm_j;\n        }\n      } // swap pivot to column i\n\n\n      if (p !== _i2) {\n        for (var _j2 = 0; _j2 < M; _j2++) {\n          var ji = R_off + N * _j2 + _i2,\n              jp = R_off + N * _j2 + p,\n              R_ji = R[ji];\n          R[ji] = R[jp];\n          R[jp] = R_ji;\n        }\n\n        var P_i = P[P_off + _i2];\n        P[P_off + _i2] = P[P_off + p];\n        P[P_off + p] = P_i;\n      } // RESET COLUMN NORM (INDEX i IS SET TO ZERO FOR THE NEXT RRQR)\n\n\n      norm.fill(0.0, _i2 << 1);\n      if (0 === norm_p) break; // <- clearly rank-deficient case\n      // ELIMINATE COLUMN BELOW DIAGONAL\n\n      var ii = R_off + N * _i2 + _i2;\n\n      for (var _j3 = _i2; ++_j3 < M;) {\n        var _ji = R_off + N * _j3 + _i2;\n\n        var _R_ji = R[_ji];\n\n        if (0 !== _R_ji) {\n          var R_ii = R[ii],\n              _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(R_ii, _R_ji),\n              _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n              c = _giv_rot_qr3[0],\n              s = _giv_rot_qr3[1],\n              _norm2 = _giv_rot_qr3[2];\n\n          R[_ji] = 0;\n\n          if (s !== 0) {\n            R[ii] = _norm2;\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(R, N - 1 - _i2, ii + 1, _ji + 1, c, s);\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Q, 1 + _j3, Q_off + M * _i2, Q_off + M * _j3, c, s);\n          }\n        }\n\n        _norm_update(norm, R, R_off + N * _j3, _i2 + 1);\n      }\n\n      R[ii] = (R[ii] < 0 || Object.is(-0, R[ii]) ? -1 : +1) * norm_p;\n    }\n\n    Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_6__[\"_transpose_inplace\"])(M, Q, Q_off);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Q_shape, Q), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](R_shape, R), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](P_shape, P)];\n}\nfunction _rrqr_decomp_inplace(M, N, L, A, A_off, Y, Y_off, P, P_off, norm) {\n  // this method could be used to implement rrqr_decomp_full BUT it\n  // would be inefficient because, due to the special structure of Q,\n  // Givens rotations of Q can be made more efficient in rrqr_decomp_full\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== L % 1) throw new Error('Assertion failed.');\n  if (0 !== A_off % 1) throw new Error('Assertion failed.');\n  if (0 !== Y_off % 1) throw new Error('Assertion failed.');\n  if (0 !== P_off % 1) throw new Error('Assertion failed.');\n  if (!(0 < M)) throw new Error('Assertion failed.');\n  if (!(0 < N)) throw new Error('Assertion failed.');\n  if (!(0 < L)) throw new Error('Assertion failed.');\n  if (!(0 <= A_off)) throw new Error('Assertion failed.');\n  if (!(0 <= Y_off)) throw new Error('Assertion failed.');\n  if (!(0 <= P_off)) throw new Error('Assertion failed.');\n  if (!(M * N <= A.length - A_off)) throw new Error('Assertion failed.');\n  if (!(M * L <= Y.length - Y_off)) throw new Error('Assertion failed.');\n  if (!(N <= P.length - P_off)) throw new Error('Assertion failed.');\n  M |= 0;\n  N |= 0;\n  L |= 0;\n  A_off |= 0;\n  Y_off |= 0;\n  P_off |= 0;\n  if (norm.length !== N << 1) throw new Error('Assertion failed.'); // INIT COLUMN NORM\n\n  norm.fill(0.0, 0, N << 1);\n\n  for (var j = 0; j < M; j++) {\n    _norm_update(norm, A, A_off + N * j, 0);\n  }\n\n  var K = Math.min(M, N); // <- M not M-1, because the last row still needs pivotization\n  // ELIMINATE COLUMN BY COLUMN OF R\n\n  for (var i = 0; i < K; i++) {\n    // FIND PIVOT COLUMN THAT (HOPEFULLY) ENSURES RANK REVEAL (RRQR is inherently not guaranteed to do that)\n    var p = -1,\n        norm_p = -Infinity;\n\n    for (var _j4 = i; _j4 < N; _j4++) {\n      var norm_j = _norm(norm, _j4);\n\n      if (norm_p < norm_j) {\n        p = _j4;\n        norm_p = norm_j;\n      }\n    } // swap pivot to column i\n\n\n    if (p !== i) {\n      for (var _j5 = 0; _j5 < M; _j5++) {\n        var ji = A_off + N * _j5 + i,\n            jp = A_off + N * _j5 + p,\n            A_ji = A[ji];\n        A[ji] = A[jp];\n        A[jp] = A_ji;\n      }\n\n      var P_i = P[P_off + i];\n      P[P_off + i] = P[P_off + p];\n      P[P_off + p] = P_i;\n    } // RESET COLUMN NORM (INDEX i IS SET TO ZERO FOR THE NEXT RRQR)\n\n\n    norm.fill(0.0, i << 1);\n    if (0 === norm_p) break; // <- clearly rank-deficient case\n    // ELIMINATE COLUMN BELOW DIAGONAL\n\n    var ii = A_off + N * i + i;\n\n    for (var _j6 = i; ++_j6 < M;) {\n      var _ji2 = A_off + N * _j6 + i;\n\n      var _A_ji = A[_ji2];\n\n      if (0 !== _A_ji) {\n        var A_ii = A[ii],\n            _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(A_ii, _A_ji),\n            _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n            c = _giv_rot_qr5[0],\n            s = _giv_rot_qr5[1],\n            _norm3 = _giv_rot_qr5[2];\n\n        A[_ji2] = 0;\n\n        if (s !== 0) {\n          A[ii] = _norm3;\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(A, N - 1 - i, ii + 1, _ji2 + 1, c, s);\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Y, L, Y_off + L * i, Y_off + L * _j6, c, s);\n        }\n      }\n\n      _norm_update(norm, A, A_off + N * _j6, i + 1);\n    }\n\n    A[ii] = (A[ii] < 0 || Object.is(-0, A[ii]) ? -1 : +1) * norm_p;\n  }\n}\nfunction rrqr_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n  if (A.ndim < 2) throw new Error('A must be at least 2D.');\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][A.dtype === 'float32' ? 'float32' : 'float64'],\n      Q_shape = A.shape,\n      R_shape = Int32Array.from(Q_shape),\n      P_shape = Q_shape.slice(0, -1),\n      _Q_shape$slice = Q_shape.slice(-2),\n      _Q_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q_shape$slice, 2),\n      N = _Q_shape$slice2[0],\n      M = _Q_shape$slice2[1];\n\n  R_shape[R_shape.length - 2] = M;\n  P_shape[P_shape.length - 1] = M;\n  if (N <= M) return rrqr_decomp_full(A);\n  var Q = DTypeArray.from(A.data); // <- we could encourage GC by setting `A = undefined` after this line\n\n  A = undefined;\n  var P = new Int32Array(Q.length / N),\n      // <- tracks column permutations\n  R = new DTypeArray(Q.length / N * M),\n      // <- cache cos() and sin() values to apply M column rotations to Q at once\n  norm = new DTypeArray(M << 1); // < underflow-safe representation of the column norm (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot#Polyfill)\n\n  for (var Q_off = 0, R_off = 0, P_off = 0; Q_off < Q.length; Q_off += N * M, R_off += M * M, P_off += M) {\n    // INIT P\n    for (var i = 0; i < M; i++) {\n      P[P_off + i] = i;\n    } // INIT COLUMN NORM\n    //*DEBUG*/    if( norm.some(x => x!==0) )\n    //*DEBUG*/      throw new Error('Assertion failed.');\n\n\n    for (var j = 0; j < N; j++) {\n      _norm_update(norm, Q, Q_off + M * j, 0);\n    } // ELIMINATE COLUMN BY COLUMN OF R (WHICH IS CURRENTLY STORED IN Q)\n\n\n    for (var _i3 = 0; _i3 < M; _i3++) {\n      // FIND PIVOT COLUMN THAT (HOPEFULLY) ENSURES RANK REVEAL (RRQR is inherently not guaranteed to do that)\n      var p = -1,\n          norm_p = -Infinity;\n\n      for (var _j7 = _i3; _j7 < M; _j7++) {\n        var norm_j = _norm(norm, _j7);\n\n        if (norm_p < norm_j) {\n          p = _j7;\n          norm_p = norm_j;\n        }\n      } // swap pivot to column i\n\n\n      if (p !== _i3) {\n        for (var _j8 = 0; _j8 < N; _j8++) {\n          var ji = Q_off + M * _j8 + _i3,\n              jp = Q_off + M * _j8 + p,\n              A_ji = Q[ji];\n          Q[ji] = Q[jp];\n          Q[jp] = A_ji;\n        }\n\n        var P_i = P[P_off + _i3];\n        P[P_off + _i3] = P[P_off + p];\n        P[P_off + p] = P_i;\n      } // RESET COLUMN NORM (INDEX i IS SET TO ZERO FOR THE NEXT RRQR)\n\n\n      norm.fill(0.0, _i3 << 1);\n      if (0 === norm_p) break; // <- clearly rank-deficient case\n      // ELIMINATE COLUMN BELOW DIAGONAL\n\n      var ii = Q_off + M * _i3 + _i3;\n\n      for (var _j9 = _i3; ++_j9 < N;) {\n        var _ji3 = Q_off + M * _j9 + _i3;\n\n        var _A_ji2 = Q[_ji3];\n\n        if (0 !== _A_ji2) {\n          var A_ii = Q[ii];\n\n          var _giv_rot_qr6 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(A_ii, _A_ji2),\n              _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr6, 3),\n              c = _giv_rot_qr7[0],\n              s = _giv_rot_qr7[1],\n              _norm4 = _giv_rot_qr7[2];\n\n          if (s !== 0) {\n            if (c < 0) {\n              c *= -1;\n              s *= -1;\n              _norm4 *= -1;\n            } // rotate i and j\n\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Q, M - 1 - _i3, ii + 1, _ji3 + 1, c, s);\n\n            Q[ii] = _norm4;\n          }\n\n          Q[_ji3] = s;\n        }\n\n        _norm_update(norm, Q, Q_off + M * _j9, _i3 + 1);\n      }\n\n      Q[ii] = (Q[ii] < 0 || Object.is(Q[ii], -0) ? -1 : +1) * norm_p;\n    } // MOVE R FROM Q -> R\n\n\n    for (var _i4 = 0; _i4 < M; _i4++) {\n      var R_ii = R[R_off + M * _i4 + _i4],\n          _s = R_ii < 0 || Object.is(R_ii, -0) ? -1 : +1;\n\n      for (var _j10 = _i4; _j10 < M; _j10++) {\n        R[R_off + M * _i4 + _j10] = Q[Q_off + M * _i4 + _j10] * _s;\n        Q[Q_off + M * _i4 + _j10] = _s * (_i4 === _j10);\n      }\n    } // COMPUTE Q\n\n\n    for (var _i5 = M; _i5-- > 0;) {\n      for (var _j11 = N; --_j11 > _i5;) {\n        var _s2 = Q[Q_off + M * _j11 + _i5];\n        if (0 === _s2) continue;\n        Q[Q_off + M * _j11 + _i5] = 0;\n\n        var _c = Math.sqrt((1 - _s2) * (1 + _s2));\n\n        Object(_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Q, M - _i5, Q_off + M * _j11 + _i5, Q_off + M * _i5 + _i5, _c, _s2);\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Q_shape, Q), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](R_shape, R), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](P_shape, P)];\n}\nfunction rrqr_rank(R) {\n  R = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(R);\n\n  var _R$shape$slice = R.shape.slice(-2),\n      _R$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R$shape$slice, 2),\n      M = _R$shape$slice2[0],\n      N = _R$shape$slice2[1],\n      r_shape = R.shape.slice(0, -2);\n\n  R = R.data;\n  var r = new _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"]['int32'](R.length / M / N),\n      tmp = new _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][R.dtype === 'float32' ? 'float32' : 'float64'](Math.min(M, N));\n\n  for (var r_off = 0, R_off = 0; r_off < r.length; r_off++, R_off += M * N) {\n    r[r_off] = _rrqr_rank(M, N, R, R_off, tmp);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](r_shape, r);\n}\nfunction rrqr_solve(Q, R, P, y) {\n  if (y == undefined) {\n    if (P != undefined) throw new Error('rrqr_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.');\n    y = R;\n    var _Q = Q;\n\n    var _Q2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q, 3);\n\n    Q = _Q2[0];\n    R = _Q2[1];\n    P = _Q2[2];\n  }\n\n  Q = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(Q);\n  R = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(R);\n  var N = Q.shape[Q.ndim - 2];\n  if (N !== R.shape[R.ndim - 1]) throw new Error('rrqr_solve(Q,R,P, y): Q @ R not square.');\n  var x = rrqr_lstsq(Q, R, P, y),\n      tmp = new _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][R.dtype === 'float32' ? 'float32' : 'float64'](N);\n\n  for (var R_off = 0; R_off < R.data.length; R_off += N * N) {\n    var rank = _rrqr_rank(N, N, R.data, R_off, tmp);\n\n    if (rank < N) // FIXME: what if (Qy)[i >= rank]  0 then the system would still be solvable\n      throw new _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_1__[\"SingularMatrixSolveError\"](x);\n  }\n\n  return x;\n}\nfunction rrqr_lstsq(Q, R, P, y) {\n  if (y == undefined) {\n    if (P != undefined) throw new Error('rrqr_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.');\n    y = R;\n    var _Q3 = Q;\n\n    var _Q4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q3, 3);\n\n    Q = _Q4[0];\n    R = _Q4[1];\n    P = _Q4[2];\n  }\n\n  Q = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(Q);\n  if (Q.ndim < 2) throw new Error('rrqr_lstsq(Q,R,P, y): Q.ndim must be at least 2.');\n  R = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(R);\n  if (R.ndim < 2) throw new Error('rrqr_lstsq(Q,R,P, y): R.ndim must be at least 2.');\n  P = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(P);\n  if (P.ndim < 1) throw new Error('rrqr_lstsq(Q,R,P, y): P.ndim must be at least 1.');\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(y);\n  if (y.ndim < 2) throw new Error('rrqr_lstsq(Q,R,P, y): y.ndim must be at least 2.');\n  if (P.dtype !== 'int32') throw new Error('rrqr_lstsq(Q,R,P, y): P.dtype must be \"int32\".'); //  ________________   ______                   ___________\n  // |                | |\\(MxI)|                 |           |\n  // |                | | \\ R  |  ___________    |           |\n  // |     (NxM)      | |  \\   | |   (IxJ)   |   |   (NxJ)   |\n  // |       Q        | |   \\  | |     X     | = |     Y     |\n  // |                | |    \\ | |           |   |           |\n  // |                | |     \\| |___________|   |           |\n  // |                | |  0   |                 |           |\n  // |________________| |______|                 |___________|\n\n  var _Q$shape$slice = Q.shape.slice(-2),\n      _Q$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Q$shape$slice, 2),\n      N = _Q$shape$slice2[0],\n      M = _Q$shape$slice2[1],\n      _R$shape$slice3 = R.shape.slice(-1),\n      _R$shape$slice4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R$shape$slice3, 1),\n      I = _R$shape$slice4[0],\n      _y$shape$slice = y.shape.slice(-1),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 1),\n      J = _y$shape$slice2[0];\n\n  if (N != y.shape[y.ndim - 2]) throw new Error(\"rrqr_lstsq(Q,R,P,y): Q and y don't match.\");\n  if (M != R.shape[R.ndim - 2]) throw new Error(\"rrqr_lstsq(Q,R,P,y): Q and R don't match.\");\n  if (I != P.shape[P.ndim - 1]) throw new Error(\"rrqr_lstsq(Q,R,P,y): R and P don't match.\");\n  var ndim = Math.max(Q.ndim, R.ndim, P.ndim + 1, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i6 = 0, _arr = [Q, R, y]; _i6 < _arr.length; _i6++) {\n    var arr = _arr[_i6];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('rrqr_lstsq(Q,R,P,y): Q,R,P,y not broadcast-compatible.');\n    }\n  }\n\n  for (var _i7 = ndim - 2, _j12 = P.ndim - 1; _i7-- > 0 && _j12-- > 0;) {\n    if (1 === shape[_i7]) shape[_i7] = P.shape[_j12];else if (shape[_i7] != P.shape[_j12] && P.shape[_j12] != 1) throw new Error('rrqr_lstsq(Q,R,P,y): Q,R,P,y not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][[Q, R, y].every(function (a) {\n    return a.dtype === 'float32';\n  }) ? 'float32' : 'float64'],\n      tmp_rank = new DTypeArray(Math.min(M, I)),\n      tmp_perm = new Int32Array(I),\n      x_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      Q_dat = Q.data,\n      R_dat = R.data,\n      P_dat = P.data,\n      y_dat = y.data;\n  var Q_off = 0,\n      Q_stride = 1,\n      R_off = 0,\n      R_stride = 1,\n      P_off = 0,\n      P_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      Q_stride = N * M;\n      R_stride = M * I;\n      P_stride = I;\n      y_stride = N * J;\n\n      var _R = _rrqr_rank(M, I, R_dat, R_off, tmp_rank); // Q.T @ y\n\n\n      for (var k = 0; k < N; k++) {\n        for (var _i8 = 0; _i8 < _R; _i8++) {\n          for (var _j13 = 0; _j13 < J; _j13++) {\n            x_dat[x_off + _i8 * J + _j13] += Q_dat[Q_off + k * M + _i8] * y_dat[y_off + k * J + _j13];\n          }\n        }\n      }\n\n      Object(_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_solve\"])(_R, I, J, R_dat, R_off, x_dat, x_off); // APPLY P TO X (PERMUTE ROWS)\n      // https://www.geeksforgeeks.org/reorder-a-array-according-to-given-indexes/\n\n\n      for (var _i9 = I; _i9-- > 0;) {\n        tmp_perm[_i9] = P_dat[P_off + _i9];\n      }\n\n      for (var _i10 = I; _i10-- > 0;) {\n        var _k = void 0;\n\n        while ((_k = tmp_perm[_i10]) !== _i10) {\n          if (tmp_perm[_k] === _k) throw new Error(\"rrqr_lstsq(Q,R,P,y): Invalid indices in P.\");\n          tmp_perm[_i10] = tmp_perm[_k];\n          tmp_perm[_k] = _k;\n\n          for (var _j14 = J; _j14-- > 0;) {\n            var x_ij = x_dat[x_off + J * _i10 + _j14];\n            x_dat[x_off + J * _i10 + _j14] = x_dat[x_off + J * _k + _j14];\n            x_dat[x_off + J * _k + _j14] = x_ij;\n          }\n        }\n      }\n\n      Q_off += Q_stride;\n      R_off += R_stride;\n      P_off += P_stride;\n      y_off += y_stride;\n      x_off += I * J;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break;\n      if (!(Q.shape[d - ndim + Q.ndim] > 1)) Q_off -= Q_stride;\n      if (!(R.shape[d - ndim + R.ndim] > 1)) R_off -= R_stride;\n      if (!(P.shape[d - ndim + 1 + P.ndim] > 1)) P_off -= P_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    Q_stride *= Q.shape[d - ndim + Q.ndim] || 1;\n    R_stride *= R.shape[d - ndim + R.ndim] || 1;\n    P_stride *= P.shape[d - ndim + 1 + P.ndim] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_dat);\n}\n\n//# sourceURL=webpack://nd/./src/la/rrqr.js?");

/***/ }),

/***/ "./src/la/schur.js":
/*!*************************!*\
  !*** ./src/la/schur.js ***!
  \*************************/
/*! exports provided: schur_eigenvals, schur_eigen, schur_decomp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"schur_eigenvals\", function() { return schur_eigenvals; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"schur_eigen\", function() { return schur_eigen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"schur_decomp\", function() { return schur_decomp; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _dt_mutable_complex__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt/mutable_complex */ \"./src/dt/mutable_complex.js\");\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../math */ \"./src/math.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _rand_alea_rng__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../rand/alea_rng */ \"./src/rand/alea_rng.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _hessenberg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./hessenberg */ \"./src/la/hessenberg.js\");\n/* harmony import */ var _matmul__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./matmul */ \"./src/la/matmul.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\nfunction schur_eigenvals(T) {\n  T = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(T);\n\n  var _T$shape$slice = T.shape.slice(-1),\n      _T$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_T$shape$slice, 1),\n      N = _T$shape$slice2[0],\n      _shape = T.shape.slice(0, -1),\n       = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"]['complex128'](T.data.length / N);\n\n  if (T.shape[T.ndim - 2] != N) throw new Error('T is not square.');\n  T = T.data;\n  var T_off = 0;\n\n  var t = function t(i, j) {\n    return T[T_off + N * i + j];\n  };\n\n  for (var _off = 0; T_off < T.length; T_off += N * N, _off += N) {\n    // COMPUTE EIGENVECTORS (right -> left)\n    for (var j = N - 1; j >= 0; j--) {\n      var i = j - 1;\n\n      if (0 === j || 0 == t(j, i)) {\n        //\n        // 1x1 BLOCK\n        //\n        // the eigenvalue is the diagonal value\n        [_off + j] = t(j, j);\n      } else {\n        //\n        // 2x2 BLOCK\n        //\n        // STEP1: compute eigenpairs of the 2x2 matrix\n        var T_ii = t(i, i),\n            T_ij = t(i, j),\n            T_ji = t(j, i),\n            T_jj = t(j, j),\n            diag = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(T_ii, T_jj),\n            tr = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(T_ii, T_jj),\n            sqr = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(_math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(diag, diag), _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(_math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(4, T_ij), T_ji));\n        if (sqr >= 0) throw new Error(\"schur_eigenvals(T): T must not contain real eigenvalued 2x2 blocks.\");\n        var sqrt = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(0.5, _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sqrt(sqr)),\n            half = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(0.5, tr);\n        [_off + i] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(half, sqrt);\n        [_off + j] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(half, sqrt);\n        j--;\n      }\n    }\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](_shape, );\n}\nfunction schur_eigen(Q, T) {\n  Q = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(Q);\n  T = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(T);\n  if (Q.ndim != T.ndim) throw new Error('Q.ndim != T.ndim.');\n\n  for (var i = T.ndim; i-- > 0;) {\n    if (Q.shape[i] != T.shape[i]) throw new Error('Q.shape != T.shape.');\n  }\n\n  var _T$shape$slice3 = T.shape.slice(-1),\n      _T$shape$slice4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_T$shape$slice3, 1),\n      N = _T$shape$slice4[0],\n      V_shape = T.shape,\n      _shape = V_shape.slice(0, -1); // T is quasi-triangular. For simplification let's assume it's upper triangular:\n  //                         \n  //   ...                 \n  //                         \n  //  0    ...             \n  //        .                \n  //  0   0   .              \n  //            .            \n  //  .       .    ...     \n  //  .         .   .        \n  //  .           .   .      \n  //                    .    \n  //  0    ...        0    \n  //                         \n  //\n  // Let's say we want to find an eigenvector for , we can just solve:\n  //                                          \n  //  - ...                           x  \n  //                                          \n  //  0   - ...                       x  \n  //           .                          .   \n  //  0     0    .                        .   \n  //               .                      .    ! \n  //  .         .  - ...            x = 0\n  //                                          \n  //  .             .    - ...        1   \n  //                         .                \n  //  .                 .      .          0   \n  //                             .        :   \n  //  0     .   .   .       0    -    0   \n  //                                          \n  //\n  // Since T is quasi-triangular this is solvable via a modified Backward Substition.\n  // For multiple (equivalent) eigenvalues, there is not guaranteed to be more than\n  // one linearily independent eigenvector. If that is the case, we at some point\n  // arrive at an row in the backward substitution where:\n  //\n  // (-)x = 0x = 0 - T[s,s+1]x ... - T[s,k-1]*x - T[s,k] = -x  0.\n  //\n  // We can resolve this by setting:\n  //\n  // x := 0; for t > s\n  // x := 1\n  //\n  // This will of course than mean that for s and k, we have the same eigenvector.\n  //\n\n\n  if (T.shape[T.ndim - 2] != N) throw new Error('Q is not square.');\n  var ComplexArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"]['complex128'],\n      V = ComplexArray.from(T.data);\n  T = undefined;\n\n  var  = new ComplexArray(V.length / N),\n      V_arr = V._array,\n      _arr = ._array,\n      // temporary vectors for the eigenvalue computation\n  v1 = new ComplexArray(N),\n      v1_arr = v1._array,\n      v2 = new ComplexArray(N),\n      v2_arr = v2._array,\n      norm_sum = v1._array.subarray(0, N),\n      norm_max = v2._array.subarray(N);\n\n  var v_i = new _dt_mutable_complex__WEBPACK_IMPORTED_MODULE_2__[\"MutableComplex\"](NaN, NaN),\n      v_j = new _dt_mutable_complex__WEBPACK_IMPORTED_MODULE_2__[\"MutableComplex\"](NaN, NaN),\n      det = new _dt_mutable_complex__WEBPACK_IMPORTED_MODULE_2__[\"MutableComplex\"](NaN, NaN);\n  var TOL = NaN;\n  /** Computes indices j < J of an eigenvector v using backward substition (see amazing UTF-8 art above).\n   */\n\n  function computeVec(, v, J) {\n    var K = Math.min(N, J + 2),\n        v_arr = v._array;\n\n    for (var j = J; j-- > 0;) {\n      for (var k = K; --k > j;) {\n        var re0 = v_arr[2 * k + 0],\n            re1 = V_arr[2 * (V_off + N * j + k) + 0],\n            im0 = v_arr[2 * k + 1],\n            im1 = V_arr[2 * (V_off + N * j + k) + 1];\n        v_arr[2 * j + 0] -= re0 * re1 - im0 * im1;\n        v_arr[2 * j + 1] -= re0 * im1 + im0 * re1;\n      }\n\n      if (0 == j || t(j, j - 1) == 0) {\n        //\n        // 1x1 BLOCK\n        //\n        var T_jj_re = V_arr[2 * (V_off + N * j + j) + 0] - .re,\n            T_jj_im = V_arr[2 * (V_off + N * j + j) + 1] - .im;\n        v_j.re = v_arr[2 * j + 0];\n        v_j.im = v_arr[2 * j + 1];\n\n        if (Math.hypot(T_jj_re, T_jj_im) <= TOL) {\n          // <- TODO\n          if (v_j.abs() <= TOL) {\n            // <- TODO add test case for this zeroness test\n            // v is already a valid eigenvalue, let's return it\n            v_arr[2 * j + 0] = 0;\n            v_arr[2 * j + 1] = 0;\n          } else {\n            // v is invalid, let's reset\n            v_arr[2 * j] = 1.0;\n            v_arr.fill(0.0, 2 * j + 1, 2 * K);\n          }\n        } else {\n          v_j['/='](T_jj_re, T_jj_im);\n          v_arr[2 * j + 0] = v_j.re;\n          v_arr[2 * j + 1] = v_j.im;\n        }\n      } else {\n        //\n        // 2x2 BLOCK\n        //\n        var _i = j - 1;\n\n        for (var _k = K; --_k > j;) {\n          var _re = v_arr[2 * _k + 0],\n              _re2 = V_arr[2 * (V_off + N * _i + _k) + 0],\n              _im = v_arr[2 * _k + 1],\n              _im2 = V_arr[2 * (V_off + N * _i + _k) + 1];\n          v_arr[2 * _i + 0] -= _re * _re2 - _im * _im2;\n          v_arr[2 * _i + 1] -= _re * _im2 + _im * _re2;\n        }\n\n        var T_ii_re = V_arr[2 * (V_off + N * _i + _i) + 0] - .re,\n            T_ii_im = V_arr[2 * (V_off + N * _i + _i) + 1] - .im,\n            _T_jj_re = V_arr[2 * (V_off + N * j + j) + 0] - .re,\n            _T_jj_im = V_arr[2 * (V_off + N * j + j) + 1] - .im,\n            T_ij_re = V_arr[2 * (V_off + N * _i + j) + 0],\n            T_ij_im = V_arr[2 * (V_off + N * _i + j) + 1],\n            T_ji_re = V_arr[2 * (V_off + N * j + _i) + 0],\n            T_ji_im = V_arr[2 * (V_off + N * j + _i) + 1];\n\n        det['= c0*c1'](\n        /*c0=*/\n        T_ii_re, T_ii_im,\n        /*c1=*/\n        _T_jj_re, _T_jj_im);\n        det['-= c0*c1'](\n        /*c0=*/\n        T_ij_re, T_ij_im,\n        /*c1=*/\n        T_ji_re, T_ji_im);\n        if (det.re === 0 && det.im === 0) throw new Error('Assertion failed.');\n        v_j['= c0*c1'](\n        /*c0=*/\n        T_ii_re, T_ii_im,\n        /*c1=*/\n        v_arr[2 * j + 0], v_arr[2 * j + 1]);\n        v_j['-= c0*c1'](\n        /*c0=*/\n        T_ji_re, T_ji_im,\n        /*c1=*/\n        v_arr[2 * _i + 0], v_arr[2 * _i + 1]);\n        v_j['/='](det.re, det.im);\n        v_i['= c0*c1'](\n        /*c0=*/\n        _T_jj_re, _T_jj_im,\n        /*c1=*/\n        v_arr[2 * _i + 0], v_arr[2 * _i + 1]);\n        v_i['-= c0*c1'](\n        /*c0=*/\n        T_ij_re, T_ij_im,\n        /*c1=*/\n        v_arr[2 * j + 0], v_arr[2 * j + 1]);\n        v_i['/='](det.re, det.im);\n        v_arr[2 * _i + 0] = v_i.re;\n        v_arr[2 * _i + 1] = v_i.im;\n        v_arr[2 * j + 0] = v_j.re;\n        v_arr[2 * j + 1] = v_j.im;\n        j--;\n      }\n    }\n  }\n\n  var V_off = 0;\n\n  var t = function t(i, j) {\n    return V[V_off + N * i + j];\n  };\n\n  for (var _off = 0; V_off < V.length; V_off += N * N, _off += N) {\n    TOL = Math.sqrt(Number.EPSILON) * function () {\n      // compute Frobenius norm\n      var sum = 0,\n          max = 0;\n      var iEnd = V_off + N * N;\n\n      for (var _i2 = V_off; _i2 < iEnd; _i2++) {\n        var elem = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].abs(V[_i2]);\n\n        if (elem != 0) {\n          // <- handles NaN (by making the result NaN)\n          if (elem > max) {\n            sum *= Math.pow(max / elem, 2);\n            max = elem;\n          }\n\n          sum += Math.pow(elem / max, 2);\n        }\n      }\n\n      return Math.sqrt(sum) * max;\n    }();\n\n    if (!(TOL >= 0)) throw new Error('Assertion failed.'); // COMPUTE EIGENVECTORS (right -> left)\n\n    for (var j = N - 1; j >= 0; j--) {\n      var _i3 = j - 1;\n\n      if (0 == j || t(j, _i3) == 0) {\n        //\n        // 1x1 BLOCK\n        //\n        // the eigenvalue is the diagonal value\n        var  = t(j, j);\n        [_off + j] = ; // since 0*1 is zero, the eigenequation should be solvable for vec1[j] = 1\n        // (unless there is a duplicate eigenvalue with linarily non-independent eigenvectors, but that will be resolved by computeVec)\n\n        v1.fill(0.0, 0, j + 2);\n        v1[j] = 1;\n        computeVec(, v1, j); // write the solution in the the (j+1)-th column\n\n        for (var k = Math.min(N, j + 2); k-- > 0;) {\n          V_arr[2 * (V_off + N * k + j) + 0] = v1_arr[2 * k + 0];\n          V_arr[2 * (V_off + N * k + j) + 1] = v1_arr[2 * k + 1];\n        }\n      } else {\n        //\n        // 2x2 BLOCK\n        //\n        // STEP1: compute eigenpairs of the 2x2 matrix\n        var T_ii = t(_i3, _i3),\n            T_ij = t(_i3, j),\n            T_ji = t(j, _i3),\n            T_jj = t(j, j),\n            diag = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(T_ii, T_jj),\n            tr = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(T_ii, T_jj),\n            sqr = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(_math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(diag, diag), _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(_math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(4, T_ij), T_ji));\n        if (sqr >= 0) throw new Error(\"schur_eigenvals(T): T must not contain real eigenvalued 2x2 blocks.\");\n        var sqrt = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(0.5, _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sqrt(sqr)),\n            half = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].mul(0.5, tr),\n            1 = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].add(half, sqrt),\n            2 = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(half, sqrt); // TODO: the whole following section should be feasible with only a single temporary vector instead of two (vec1,vec2)\n\n        v1_arr.fill(0.0, 0, 2 * (j + 1));\n        v2_arr.fill(0.0, 0, 2 * (j + 1)); // http://www.math.harvard.edu/archive/21b_fall_04/exhibits/2dmatrices/\n\n        if (_math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].abs(T_ij) >= _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].abs(T_ji)) {\n          v1[_i3] = T_ij;\n          v1[j] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(1, T_ii);\n          v2[_i3] = T_ij;\n          v2[j] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(2, T_ii);\n        } else {\n          v1[j] = T_ji;\n          v1[_i3] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(1, T_jj);\n          v2[j] = T_ji;\n          v2[_i3] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].sub(2, T_jj);\n        }\n\n        computeVec(1, v1, _i3);\n        computeVec(2, v2, _i3);\n\n        for (var _k2 = j + 1; _k2-- > 0;) {\n          V_arr[2 * (V_off + N * _k2 + _i3) + 0] = v1_arr[2 * _k2 + 0];\n          V_arr[2 * (V_off + N * _k2 + _i3) + 1] = v1_arr[2 * _k2 + 1];\n          V_arr[2 * (V_off + N * _k2 + j) + 0] = v2_arr[2 * _k2 + 0];\n          V_arr[2 * (V_off + N * _k2 + j) + 1] = v2_arr[2 * _k2 + 1];\n        }\n\n        [_off + _i3] = 1;\n        [_off + j] = 2;\n        --j;\n      }\n    } // COMPUTE COLUMN NORMS\n\n\n    norm_sum.fill(0.0);\n    norm_max.fill(0.0);\n\n    for (var _i4 = 0; _i4 < N; _i4++) {\n      for (var J = 0; J < N * 2; J++) {\n        var _j = J >>> 1,\n            V_ij = Math.abs(V_arr[2 * (V_off + N * _i4) + J]);\n\n        if (V_ij > 0) {\n          if (V_ij > norm_max[_j]) {\n            var scale = norm_max[_j] / V_ij;\n            norm_max[_j] = V_ij;\n            norm_sum[_j] *= scale * scale;\n          }\n\n          var ratio = V_ij / norm_max[_j];\n          norm_sum[_j] += ratio * ratio;\n        }\n      }\n    }\n\n    var norm = norm_sum;\n\n    for (var _i5 = 0; _i5 < N; _i5++) {\n      var max = norm_max[_i5];\n      norm[_i5] = isFinite(max) ? Math.sqrt(norm_sum[_i5]) * max : max;\n    } // NORMALIZE COLUMNS\n\n\n    for (var _i6 = 0; _i6 < N; _i6++) {\n      for (var _j2 = 0; _j2 < N; _j2++) {\n        V[V_off + N * _i6 + _j2] = _math__WEBPACK_IMPORTED_MODULE_3__[\"math\"].div(V[V_off + N * _i6 + _j2], norm[_j2]);\n      }\n    }\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](_shape, ), Object(_matmul__WEBPACK_IMPORTED_MODULE_8__[\"matmul2\"])(Q, new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](V_shape, V))];\n}\nfunction schur_decomp(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])(A); // HESSENBERG DECOMPOSITION\n\n  var N = A.shape[A.ndim - 1],\n      _hessenberg_decomp = Object(_hessenberg__WEBPACK_IMPORTED_MODULE_7__[\"hessenberg_decomp\"])(A),\n      _hessenberg_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_hessenberg_decomp, 2),\n      Q = _hessenberg_decomp2[0],\n      H = _hessenberg_decomp2[1];\n\n  A = undefined; // FRANCIS QR\n\n  schur_qrfrancis_inplace(Q, H);\n  return [Q, H];\n}\n/** Takes a Hessenberg Decomposition as input and performs a real Schur Decomposition IN-PLACE.\n *  Does not perform any scaling.\n *  Does not check Hessenberg property.\n */\n\nfunction schur_qrfrancis_inplace(Q, H) {\n  var N = Q.shape[Q.ndim - 1],\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][Q.dtype],\n      tmp = new DTypeArray(N);\n  if (Q.shape[Q.ndim - 2] != N) throw new Error('Q is not square.');\n  if (Q.ndim != H.ndim) throw new Error('Q.ndim != H.ndim.');\n\n  for (var i = Q.ndim; i-- > 0;) {\n    if (Q.shape[i] != H.shape[i]) throw new Error('Q.shape != H.shape.');\n  }\n\n  Q = Q.data;\n  H = H.data;\n  var TOL = Number.EPSILON;\n  /** This function is recursively called to perform the Francis QR Algorithm, which is\n   *  an implicit double-shift version of the QR Algorithm. This function only works on\n   *  a subregion of H and an independent Q on each recursive call. That nested Q is\n   *  applied to the remaining H and the outer Q once the nested schur decomposition\n   *  is finished.\n   *\n   *  SEE: Prof. Dr. Peter Arbenz\n   *       252-0504-00 G\n   *       Numerical Methods for Solving Large Scale Eigenvalue Problems\n   *       (Spring semester 2018)\n   *       Chapter 3: The QR Algorithm\n   *       http://people.inf.ethz.ch/arbenz/ewp/Lnotes/2010/chapter3.pdf \n   */\n\n  var francis_qr = function francis_qr(Q, Q_off, Q_stride, H_off) {\n    var h = function h(i, j) {\n      return H[H_off + N * i + j];\n    },\n        is_zero = function is_zero(i) {\n      if (Math.abs(h(i, i - 1)) > TOL * (Math.abs(h(i - 1, i - 1)) + Math.abs(h(i, i)))) // <- goes to else on NaN\n        return false;else {\n        H[H_off + N * i + i - 1] *= 0.0; // <- Handles NaN. If a value is that small, its digits are likely nonsense (due to cancellation error) so let's set it to zero.\n\n        return true;\n      }\n    },\n\n    /** Applies a two-sided given rotation.\n     */\n    giv = function giv(i, j, c, s) {\n      if (j <= i) throw new Error('Assertion failed.'); // ROTATE ROWS IN H\n\n      for (var k = Math.max(0, i - 1); k < Q_stride; k++) {\n        var H_i = H[H_off + N * i + k],\n            H_j = H[H_off + N * j + k];\n        H[H_off + N * i + k] = s * H_j + c * H_i;\n        H[H_off + N * j + k] = c * H_j - s * H_i;\n      } // ROTATE COLUMNS IN H\n\n\n      for (var _k3 = Math.min(Q_stride, j + 2); _k3-- > 0;) {\n        var _H_i = H[H_off + N * _k3 + i],\n            _H_j = H[H_off + N * _k3 + j];\n        H[H_off + N * _k3 + i] = s * _H_j + c * _H_i;\n        H[H_off + N * _k3 + j] = c * _H_j - s * _H_i;\n      } // ROTATE ROWS IN Q\n\n\n      for (var _k4 = Q_stride; _k4-- > 0;) {\n        var Q_i = Q[Q_off + Q_stride * i + _k4],\n            Q_j = Q[Q_off + Q_stride * j + _k4];\n        Q[Q_off + Q_stride * i + _k4] = s * Q_j + c * Q_i;\n        Q[Q_off + Q_stride * j + _k4] = c * Q_j - s * Q_i;\n      }\n    },\n\n    /** Recursively performs the schur-decomposition of the sub-region [s,e).\n     * \n     *  During iteration, the givens rotations are only applied to current\n     *  subregion and are accumulated in a temporary matrix. Only after the\n     *  Francis QR algorithm is done, the transformations are applied to \n     */\n    recurse = function recurse(s, e) {\n      if (e - s > Q_stride >>> 1) throw new Error('Assertion failed.'); // <- assert that memory is bounded by O(n)\n\n      var n = e - s;\n      if (n < 3) throw new Error('Assertion failed.');\n      var q = new DTypeArray(n * n); // INIT q TO IDENTITY\n\n      for (var _i7 = 0; _i7 < n; _i7++) {\n        q[n * _i7 + _i7] = 1.0;\n      } // RUN FRANCIS QR ON SUB-PROBLEM\n\n\n      francis_qr(q, 0, n, H_off + N * s + s); // TRANSPOSE q\n\n      for (var _i8 = 0; _i8 < n; _i8++) {\n        for (var j = 0; j < _i8; j++) {\n          var q_ij = q[n * _i8 + j];\n          q[n * _i8 + j] = q[n * j + _i8];\n          q[n * j + _i8] = q_ij;\n        }\n      } // APPLY q TO LEFT OF Q (Q' = q.T @ Q)\n\n\n      for (var _i9 = 0; _i9 < Q_stride; _i9++) // <- each column in Q\n      {\n        tmp.fill(0.0, 0, n);\n\n        for (var _j3 = 0; _j3 < n; _j3++) {\n          for (var k = 0; k < n; k++) {\n            tmp[k] += q[n * _j3 + k] * Q[Q_off + Q_stride * (s + _j3) + _i9];\n          }\n        }\n\n        for (var _j4 = 0; _j4 < n; _j4++) {\n          Q[Q_off + Q_stride * (s + _j4) + _i9] = tmp[_j4];\n        }\n      } // APPLY q TO LEFT OF H (H' = q.T @ H)\n\n\n      for (var _i10 = e; _i10 < Q_stride; _i10++) // <- each column in H\n      {\n        tmp.fill(0.0, 0, n);\n\n        for (var _j5 = 0; _j5 < n; _j5++) {\n          for (var _k5 = 0; _k5 < n; _k5++) {\n            tmp[_k5] += q[n * _j5 + _k5] * H[H_off + N * (s + _j5) + _i10];\n          }\n        }\n\n        for (var _j6 = 0; _j6 < n; _j6++) {\n          H[H_off + N * (s + _j6) + _i10] = tmp[_j6];\n        }\n      } // APPLY q TO RIGHT H (H\" = H' @ q)\n\n\n      for (var _i11 = 0; _i11 < s; _i11++) // <- each row in H\n      {\n        tmp.fill(0.0, 0, n);\n\n        for (var _j7 = 0; _j7 < n; _j7++) {\n          for (var _k6 = 0; _k6 < n; _k6++) {\n            tmp[_k6] += q[n * _j7 + _k6] * H[H_off + N * _i11 + (s + _j7)];\n          }\n        }\n\n        for (var _j8 = 0; _j8 < n; _j8++) {\n          H[H_off + N * _i11 + (s + _j8)] = tmp[_j8];\n        }\n      }\n    };\n\n    var stuck_o_meter = 0,\n        start = 0,\n        end = Q_stride,\n        rng = new _rand_alea_rng__WEBPACK_IMPORTED_MODULE_5__[\"AleaRNG\"]('nd.la.schur_qrfrancis_inplace');\n\n    while (true) {\n      // DETECT ZEROS ON THE SUB-DIAGONAL AND SHRINK WORK SIZE ACCORDINGLY\n      for (var done = false; !done;) {\n        if (end - start < 3) return;\n        if (end - start < Q_stride >>> 4) return recurse(start, end); // <- ZOOM IN IF SUBPROBLEM IS SMALL ENOUGH\n\n        done = false;\n        if (is_zero(start + 1)) start += 1;else if (is_zero(end - 1)) end -= 1;else if (is_zero(start + 2)) start += 2;else if (is_zero(end - 2)) end -= 2;else done = true;\n        var mid = start + end >>> 1;\n\n        for (var _i13 = start + 2; done && ++_i13 < end - 2;) {\n          if (is_zero(_i13)) {\n            done = false; // RUN NESTED FRANCIS QR ON THE SMALLER OF THE TWO \n\n            if (_i13 > mid) {\n              recurse(_i13, end);\n              end = _i13;\n            } else {\n              recurse(start, _i13);\n              start = _i13;\n            }\n          }\n        }\n\n        if (!done) stuck_o_meter = 0;\n      }\n\n      stuck_o_meter += 1; // DETERMINE (DOUBLE) SHIFT FROM LOWER RIGHT 2x2 BLOCK\n\n      var _i12 = end - 2,\n          j = end - 1,\n          tr = h(_i12, _i12) + h(j, j),\n          det = h(_i12, _i12) * h(j, j) - h(_i12, j) * h(j, _i12); // FOR REAL EIGENVALUES LETS USE THE ONE THAT'S CLOSER TO THE LOWER RIGHT ENTRY\n\n\n      if (tr * tr > 4 * det) {\n        var sign = tr >= 0 ? +1.0 : -1.0,\n            ev1 = 0.5 * (tr + sign * Math.sqrt(tr * tr - 4 * det)),\n            ev2 = det * 2.0 / (tr + sign * Math.sqrt(tr * tr - 4 * det)); // <- Citardauq Formula\n        // use the eigenvalue closer to A[j,j]\n        // SEE: Bindel, Fall 2016, Matrix Computations (CS 6210)\n        //      Notes for 2016-10-24\n        //      https://www.cs.cornell.edu/~bindel/class/cs6210-f16/lec/2016-10-24.pdf\n\n        if (Math.abs(h(j, j) - ev1) > Math.abs(h(j, j) - ev2)) ev1 = ev2;\n        tr = ev1 * 2;\n        det = ev1 * ev1;\n      } // IF WE'RE STUCK, LET'S WIGGLE LIKE A FISH ON LAND (... well except maybe that fella: https://www.youtube.com/watch?v=fJLCSsnhLFc)\n      // SEE: NUMERICAL RECIPES Webnote No. 16, Rev. 1\n      //      Description of the QR Algorithm for Hessenberg Matrices\n      //      http://numerical.recipes/webnotes/nr3web16.pdf\n\n\n      if (stuck_o_meter % 16 == 0) {\n        if (stuck_o_meter > 1e9) throw new Error('Too many iterations for a single eigenvalue.');\n        tr = Math.abs(h(j, _i12)) + Math.abs(h(_i12, end - 3));\n        det = tr * tr;\n        tr *= rng.uniform(1.25, 1.75);\n      } // FIRST COLUMN OF DOUBLE SHIFTED MATRIX (H-sI)*(H-conj(s)I) = H - 2*Re(s)*H + |s|I\n\n\n      _i12 = start + 0;\n      j = start + 1;\n      var k = start + 2,\n          a1 = h(_i12, _i12) * h(_i12, _i12) + h(_i12, j) * h(j, _i12) - tr * h(_i12, _i12) + det,\n          a2 = h(j, _i12) * (h(_i12, _i12) + h(j, j) - tr),\n          a3 = h(j, _i12) * h(k, j); // APPLY \"DOUBLE SHIFTED\" GIVENS ROTATIONS\n\n      for (var row = 2; row-- > 0; j = k, a2 = a3) {\n        if (a2 != 0) {\n          var _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_6__[\"_giv_rot_qr\"])(a1, a2),\n              _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n              c = _giv_rot_qr3[0],\n              s = _giv_rot_qr3[1],\n              norm = _giv_rot_qr3[2];\n\n          giv(_i12, j, c, s);\n          a1 = norm; //*DEBUG*/          if( !(Math.abs(c*a2 - s*a1) <= 1e-8) ) throw new Error('Assertion failed.')\n        }\n      } // REINSTATE HESSENBERG PROPERTY\n\n\n      for (var col = start; col < end - 2; col++) {\n        _i12 = col + 1;\n        var J = Math.min(end, col + 4);\n\n        for (j = col + 2; j < J; j++) {\n          var H_i = h(_i12, col),\n              H_j = h(j, col);\n          if (0 === H_j) continue;\n\n          var _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_6__[\"_giv_rot_qr\"])(H_i, H_j),\n              _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n              _c = _giv_rot_qr5[0],\n              _s = _giv_rot_qr5[1],\n              _norm = _giv_rot_qr5[2];\n\n          giv(_i12, j, _c, _s);\n          H[H_off + N * j + col] *= 0.0; // <- handles NaN\n          //*DEBUG*/          if( !(Math.abs(h(j,col)) <= 1e-8) ) throw new Error('Assertion failed.')\n        }\n      }\n    }\n  }; // BEGIN SCHUR DECOMPOSING MATRICES\n\n\n  for (var off = 0; off < Q.length; off += N * N) {\n    // TRANSPOSE Q\n    for (var _i14 = 0; _i14 < N; _i14++) {\n      for (var j = 0; j < _i14; j++) {\n        var Q_ij = Q[off + N * _i14 + j];\n        Q[off + N * _i14 + j] = Q[off + N * j + _i14];\n        Q[off + N * j + _i14] = Q_ij;\n      }\n    } // RUN FRANCIS QR ALGORITHM\n\n\n    francis_qr(Q, off, N, off); // BEGIN RESOLVE REAL-VALUED 2x2 BLOCKS\n\n    for (var _j9 = 1; _j9 < N; _j9++) {\n      var _i15 = _j9 - 1;\n\n      if (H[off + N * _j9 + _i15] != 0) {\n        var _ret = function () {\n          // The goal is to find a givens rotation that Schur-decomposes a real-eigenvalue 2x2 matrix.\n          //                                                        \n          //  cos() -sin()   H_ii  H_ij   cos() -sin()  !   p \n          //                                                =       \n          //  sin()  cos()   H_ji  H_jj   sin()  cos()     0   => 0 == (H_jicos() - H_iisin())cos() + (H_jjcos() - H_ijsin())sin()\n          //                                                         => 0 == (H_jj-H_ii)sin(2) + (H_ij+H_ji)cos(2) + H_ji-H_ij =: f()\n          //\n          // This brings us to a standard trigonometry equation:\n          //   A*sin(x) + B*cos(x) = C\n          // Where\n          //   A = H_jj-H_ii\n          //   B = H_ij+H_ji\n          //   C = H_ij-H_ji\n          //\n          // Solution:\n          //   x = 360 * n + 2*atan2( a  sqrt(a + b - c), b+c )\n          //   (n=0)\n          //     = 2*atan2( H_jj-H_ii + sqrt( (H_jj-H_ii) + 4*H_ij*H_ji ), 2*H_ij )\n          //\n          // Another simple and very numerically accurate solution would be Binary Search. In order to do that, we have to bracket a solution. So let's determine the extrema of f().\n          // \n          // f'(_max) =!= 0 = 2*(H_jj-H_ii)cos(2_max) - 2*(H_ij+H_ji)sin(2_max) => _max = atan2( H_jj-H_ii, H_ij+H_ji ) / 2 + n*/2\n          var H_ii = H[off + N * _i15 + _i15],\n              H_ij = H[off + N * _i15 + _j9],\n              H_ji = H[off + N * _j9 + _i15],\n              H_jj = H[off + N * _j9 + _j9]; // const _min =         Math.atan2(H_jj-H_ii, H_ij+H_ji) / 2,\n          //       _max = _min + Math.PI/2 * (_min <= 0 ? +1 : -1),\n          //        = 0.5 * root1d_bisect(\n          //          => ( (H_ij+H_ji) * Math.cos()\n          //              + (H_ji-H_ij)\n          //              + (H_jj-H_ii) * Math.sin() ),\n          //         2*_min, 2*_max\n          //       ),\n          //       c = Math.cos(),\n          //       s = Math.sin();\n\n          var A = H_jj - H_ii,\n              ABC = A * A + 4 * H_ij * H_ji; // = A + B - C\n\n          if (ABC < 0) return \"continue\";\n\n          var _ref = function () {\n            if (0 === H_ij) return [0, 1];\n            var T = A + (A < 0 ? -1 : +1) * Math.sqrt(ABC),\n                R = H_ij * 2,\n                TR = Math.hypot(T, R),\n                //  = atan2(T,R)\n            s = (R < 0 ? -T : +T) / TR,\n                c = Math.abs(R) / TR;\n            return [c, s];\n          }(),\n              _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 2),\n              c = _ref2[0],\n              s = _ref2[1];\n\n          for (var k = _i15; k < N; k++) // ROTATE ROWS IN H\n          {\n            var H_i = H[off + N * _i15 + k],\n                H_j = H[off + N * _j9 + k];\n            H[off + N * _i15 + k] = s * H_j + c * H_i;\n            H[off + N * _j9 + k] = c * H_j - s * H_i;\n          }\n\n          for (var _k7 = _j9 + 1; _k7-- > 0;) // ROTATE COLUMNS IN H\n          {\n            var _H_i2 = H[off + N * _k7 + _i15],\n                _H_j2 = H[off + N * _k7 + _j9];\n            H[off + N * _k7 + _i15] = s * _H_j2 + c * _H_i2;\n            H[off + N * _k7 + _j9] = c * _H_j2 - s * _H_i2;\n          }\n\n          for (var _k8 = N; _k8-- > 0;) // ROTATE ROWS IN Q\n          {\n            var Q_i = Q[off + N * _i15 + _k8],\n                Q_j = Q[off + N * _j9 + _k8];\n            Q[off + N * _i15 + _k8] = s * Q_j + c * Q_i;\n            Q[off + N * _j9 + _k8] = c * Q_j - s * Q_i;\n          }\n\n          H[off + N * _j9 + _i15] *= 0.0; // <- Handles NaN. If a value is that small, its digits are likely nonsense (due to cancellation error) so let's set it to zero.\n        }();\n\n        if (_ret === \"continue\") continue;\n      }\n    } // END RESOLVE REAL-VALUED 2x2 BLOCKS\n    // TRANSPOSE Q BACK\n\n\n    for (var _i16 = 0; _i16 < N; _i16++) {\n      for (var _j10 = 0; _j10 < _i16; _j10++) {\n        var _Q_ij = Q[off + N * _i16 + _j10];\n        Q[off + N * _i16 + _j10] = Q[off + N * _j10 + _i16];\n        Q[off + N * _j10 + _i16] = _Q_ij;\n      }\n    }\n  } // END SCHUR DECOMPOSING MATRICES\n\n} // END schur_qrfrancis_inplace\n\n//# sourceURL=webpack://nd/./src/la/schur.js?");

/***/ }),

/***/ "./src/la/singular_matrix_solve_error.js":
/*!***********************************************!*\
  !*** ./src/la/singular_matrix_solve_error.js ***!
  \***********************************************/
/*! exports provided: SingularMatrixSolveError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SingularMatrixSolveError\", function() { return SingularMatrixSolveError; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n\nvar SingularMatrixSolveError = /*#__PURE__*/function (_Error) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default()(SingularMatrixSolveError, _Error);\n\n  var _super = _createSuper(SingularMatrixSolveError);\n\n  function SingularMatrixSolveError(x) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, SingularMatrixSolveError);\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    if (!(x instanceof _nd_array__WEBPACK_IMPORTED_MODULE_5__[\"NDArray\"])) throw new Error('Assertion failed.');\n    _this.x = x;\n    return _this;\n  }\n\n  return SingularMatrixSolveError;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default()(Error));\n\n//# sourceURL=webpack://nd/./src/la/singular_matrix_solve_error.js?");

/***/ }),

/***/ "./src/la/solve.js":
/*!*************************!*\
  !*** ./src/la/solve.js ***!
  \*************************/
/*! exports provided: solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"solve\", function() { return solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _rrqr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rrqr */ \"./src/la/rrqr.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction solve(A, y) {\n  var _rrqr_decomp = Object(_rrqr__WEBPACK_IMPORTED_MODULE_1__[\"rrqr_decomp\"])(A),\n      _rrqr_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_rrqr_decomp, 3),\n      Q = _rrqr_decomp2[0],\n      R = _rrqr_decomp2[1],\n      P = _rrqr_decomp2[2];\n\n  return Object(_rrqr__WEBPACK_IMPORTED_MODULE_1__[\"rrqr_solve\"])(Q, R, P, y);\n}\n\n//# sourceURL=webpack://nd/./src/la/solve.js?");

/***/ }),

/***/ "./src/la/srrqr.js":
/*!*************************!*\
  !*** ./src/la/srrqr.js ***!
  \*************************/
/*! exports provided: _row_norm_update, srrqr_decomp_full */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_row_norm_update\", function() { return _row_norm_update; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"srrqr_decomp_full\", function() { return srrqr_decomp_full; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n/* harmony import */ var _rrqr__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./rrqr */ \"./src/la/rrqr.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n // TODO: add economic srrqr\n// FIXME: there seems to be an infinite-loop bug with close to zero matrices like:\n//   [[0,0,0],\n//    [0,0,0],\n//    [Number.MIN_VALUE,0,0],\n//    [0,Number.MIN_VALUE,0],\n//    [0,0,Number.MIN_VALUE]]\n\nfunction _row_norm_update(norm, AB, AB_off, M) {\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot#Polyfill\n  AB_off |= 0;\n  M <<= 1;\n\n  for (var j = 0; j < M; j += 2) {\n    var s = Math.abs(AB[AB_off + (j >>> 1)]);\n\n    if (s !== 0) {\n      if (norm[j] < s) {\n        var r = norm[j] / s;\n        norm[j + 1] *= r * r;\n        norm[j] = s;\n      }\n\n      s /= norm[j];\n      norm[j + 1] += s * s;\n    }\n  }\n}\nfunction srrqr_decomp_full(X) {\n  var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  // Overview\n  // --------\n  //\n  // [1] \"EFFICIENT ALGORITHMS FOR COMPUTING A STRONG RANK-REVEALING QR FACTORIZATION\"\n  //      Ming Gu, Stanley C. Eisenstat,\n  //      https://math.berkeley.edu/~mgu/MA273/Strong_RRQR.pdf\n  //\n  // \"Weak\" vs. \"Strong\" RRQR\n  // ------------------------\n  // While the RRQR works well in practice, there are constructed examples of matrices\n  // for which the \n  //\n  // L2R vs. BIN RRQR\n  // ----------------\n  // Instead of test every potential rank `k` from left to right, as suggested [1],\n  // we use binary search to find the proper rank. This requires significantly less\n  // \"strong\" swaps in most cases and few more swaps in very low-rank cases.\n  X = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(X);\n  if (X.ndim < 2) throw new Error('srrqr_decomp_full(A,opt): A must be at least 2D.');\n  if (X.dtype.startsWith('complex')) throw new Error('srrqr_decomp_full(A,opt): Complex A not (yet) supported.'); //\n  //\n\n  var dtype = X.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype],\n      R_shape = X.shape,\n      Q_shape = Int32Array.from(R_shape),\n      P_shape = Q_shape.slice(0, -1),\n      r_shape = R_shape.slice(0, -2),\n      _R_shape$slice = R_shape.slice(-2),\n      _R_shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_R_shape$slice, 2),\n      M = _R_shape$slice2[0],\n      N = _R_shape$slice2[1],\n      L = Math.min(M, N); // <- M not M-1, because the last row still needs pivotization\n\n\n  Q_shape[Q_shape.length - 1] = M;\n  P_shape[P_shape.length - 1] = N; // At each step of the decomposition we have:\n  //\n  //   X[:,P] = Q @ R\n  //\n  // Where R is partially triangularized, P keeps track of the column swaps and\n  // Q is an orthogonals matrix.\n  //\n  // As part of the SRRQR we test different ranks `k` that X might actually have.\n  // For every `k`, R[k] consists of the following quadrants:\n  //                   \n  //          A[k]B[k]\n  //   R[k] = \n  //              C[k]\n  //                   \n  //\n  // Where A[k] is already triangularized. We try to find a column permutation P that\n  // norm(C[k],'fro') becomes as small as possible. We achieve that by swapping the\n  // columns that maximize det(A[k]). Since:\n  //\n  //   det(X) = det(R[k]) = det(A[k])*det(C[k])\n  //\n  // norm(C[k],'fro') becomes smaller and smaller using the so-called \"strong\" column\n  // swaps. Such swaps are only performed until the factor of determinant increase is\n  // above a certain threshold:\n  //                          !\n  //   det(A'[k]) / det(A[k]) > dtol\n  //\n  // Where `dtol` is some small-ish constant value above 1. Without this threshold, an\n  // exponential amount of column swaps might be performed. With the threshold however,\n  // at most log[f](sqrt(n)) column swaps are required.\n  //\n  // Gu and Eisenstat [1] have shown how to compute a matrix `W` of size (k,n-k) which,\n  // for each possible column swap, contains the factors by which det(A[k]) would increase\n  // or decrease, i.e.:\n  //\n  // W[i,j] = det(A[k] with columns i,j swapped) / det(A[k])\n  //\n  // In order to compute `W`, we need inv(A[k]) and A[k]\\B[k]. To compute these efficiently,\n  // we need to keep track of them in memory during iteration in a matrix `AB`.\n  // Gu and Eisenstat [1] proposed \"update\" and \"downdate\" methods that can be used to\n  // adjust AB during column swaps or changes of `k`.\n  //\n  // Once we have found a series of column permutations that minimized norm(C[k],'fro'),\n  // we can check if C[k] can be considered zero:\n  //             ?\n  //  norm(C[k]) <= ztol\n  //\n  // If this is the case, we know that the rank is `k` or less. Using this test inside\n  // of a binary search algorithm, we can find the correct rank by testing log2(n)\n  // different values for `k`.\n  //\n  // At each step of the binary search we have a lower and upper inclusive limit `k0` and\n  // `K` of the actual rank, while we are currently testing `k`. Depending on the result\n  // of the aforementioned test the new binary search range is going to be either [k0+1,k]\n  // or [k,K]. In the former case we need avoid downdating from a (nearly) rank-deficient A[k].\n  // To achieve this we need to keep track of inv(A[k0]) and A[k0]\\B[k0] in a matrix `AB0`.\n  // This allows us to update from `AB0` instead of ever downdating `AB`.\n\n  var R = DTypeArray.from(X.data);\n  X = undefined;\n  var r = new Int32Array(R.length / N / M),\n      P = new Int32Array(R.length / M),\n      // <- tracks column permutations\n  Q = new DTypeArray(R.length / N * M),\n      AB = new DTypeArray(M * N),\n      // <- stores inv(A) and A\\B in COLUMN MAJOR order\n  AB0 = new DTypeArray(M * N),\n      norm = new DTypeArray(N << 1),\n      NORM = new _norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"](); // < underflow-safe representation of the column norm\n\n  for (var i = r.length; i-- > 0;) {\n    r[i] = Math.random() * 1024 - 1024;\n  }\n\n  var ztol = NaN,\n      dtol = NaN; // If no \"strong\" column swaps have been performed yet, Q has a special\n  // structure that allows faster givens rotations while eliminating columns\n  // of R. As soon as a \"strong\" swap occours, Q is \"dirty\" from now on.\n\n  var Q_dirty = false;\n  var Q_off = 0,\n      R_off = 0,\n      P_off = 0; // `k0` and `K` are the lower and upper inclusive bounds of the binary\n  // search range while `k` is the currently considered potential rank\n\n  var k0 = 0,\n      k = 0,\n      K = 0; // PROCESS THE (TOLERANCE) OPTIONS\n\n  var _ref = function () {\n    var _opt = opt,\n        _opt$dtol = _opt.dtol,\n        dtol = _opt$dtol === void 0 ? 1.01 : _opt$dtol,\n        _opt$ztol = _opt.ztol,\n        ztol = _opt$ztol === void 0 ? undefined : _opt$ztol;\n\n    if (dtol instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n      throw new Error(\"srrqr_decomp_full(A,opt): NDArray as opt.dtol not yet supported.\");\n    } else {\n      if (!(dtol >= 1)) throw new Error(\"srrqr_decomp_full(A,opt): Invalid opt.dtol: \".concat(dtol, \". Must be >=1.\"));\n\n      var _DTOL = Number(dtol);\n\n      dtol = function dtol() {\n        return _DTOL;\n      };\n    }\n\n    if (ztol instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n      throw new Error(\"srrqr_decomp_full(A,opt): NDArray as opt.ztol not yet supported.\");\n    } else if (null == ztol) {\n      var _eps = Math.sqrt(Object(_dt__WEBPACK_IMPORTED_MODULE_1__[\"eps\"])(dtype));\n\n      ztol = function ztol(i) {\n        i *= M * N;\n        var I = i + M * N;\n        NORM.reset();\n\n        for (; i < I; i++) {\n          NORM.include(R[i]);\n        }\n\n        return _eps * NORM.result * Math.max(M, N); // <- should be a little stricter than rrqr_rank such they work well together\n      };\n    } else {\n      if (!(ztol >= 0)) throw new Error(\"srrqr_decomp_full(A,opt): invalid opt.ztol: \".concat(ztol, \". Must be non-negative number.\"));\n\n      var _ZTOL = Number(ztol);\n\n      ztol = function ztol() {\n        return _ZTOL;\n      };\n    }\n\n    return [dtol, ztol];\n  }(),\n      _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 2),\n      DTOL = _ref2[0],\n      ZTOL = _ref2[1];\n\n  opt = undefined;\n  /* Updates inv(A[k]) and A[k]\\B[k]. Used to update both `AB` and `AB0`.\n   */\n\n  var update = function update(AB, k) {\n    //*DEBUG*/    // CHECK TRIANGULARITY OF R AND AB\n    //*DEBUG*/    for( let j=0;   j < k; j++)\n    //*DEBUG*/    for( let i=j; ++i < M;    )\n    //*DEBUG*/    {\n    //*DEBUG*/      if( !(R [R_off + N*i+j  ] === 0) ) throw new Error(`Assertion failed.`);\n    //*DEBUG*/      if( !(AB[          i+j*M] === 0) ) throw new Error(`Assertion failed.`);\n    //*DEBUG*/    }\n    // UPDATE inv(A)\n    {\n      var R_kk = -R[R_off + N * k + k];\n      AB[k + k * M] = -1 / R_kk;\n\n      for (var _i = k; _i-- > 0;) {\n        AB[_i + k * M] /= R_kk;\n      }\n    } // UPDATE A\\B\n\n    for (var j = k; ++j < N;) {\n      for (var _i2 = 0; _i2 <= k; _i2++) {\n        AB[_i2 + j * M] += AB[_i2 + k * M] * R[R_off + N * k + j];\n      }\n    }\n  };\n  /* Downdates inv(A) and A\\B. Used to downdate AB and AB0 once\n   * during each \"strong\" column swaps. AB0 is not downdate if\n   * the column swap does not affect it.\n   */\n\n\n  var downdate = function downdate(AB, k) {\n    //*DEBUG*/    // CHECK TRIANGULARITY OF R AND AB\n    //*DEBUG*/    for( let j=0;   j < k; j++)\n    //*DEBUG*/    for( let i=j; ++i < M;    )\n    //*DEBUG*/    {\n    //*DEBUG*/      if( !(R [R_off + N*i+j  ] === 0) ) throw new Error(`Assertion failed.`);\n    //*DEBUG*/      if( !(AB[          i+j*M] === 0) ) throw new Error(`Assertion failed.`);\n    //*DEBUG*/    }\n    // DOWNDATE A\\B\n    for (var j = N; --j > k;) {\n      AB[k + j * M] = 0;\n\n      for (var _i3 = k; _i3-- > 0;) {\n        AB[_i3 + j * M] -= AB[_i3 + k * M] * R[R_off + N * k + j];\n      }\n    } // DOWNDATE inv(A)\n\n\n    AB[k + k * M] = 0;\n    {\n      var R_kk = -R[R_off + N * k + k];\n\n      for (var _i4 = k; _i4-- > 0;) {\n        AB[_i4 + k * M] *= R_kk;\n      }\n    }\n  };\n  /* Swaps column `p` and `k` and eliminates the (new) column `k` in R.\n   * A\\B and A0\\B0 are updated accordingly. `p` must not be less than `k`.\n   */\n\n\n  var swap_elim = function swap_elim(p) {\n    //*DEBUG*/    if(!(k <= p)) throw new Error('Assertion failed.');\n    // swap columns in R\n    for (var j = 0; j < M; j++) {\n      var R_jk = R[R_off + N * j + k];\n      R[R_off + N * j + k] = R[R_off + N * j + p];\n      R[R_off + N * j + p] = R_jk;\n    } // swap columns in A\\B (which is column major)\n\n\n    for (var _j = 0; _j < k; _j++) {\n      var AB_jk = AB0[_j + k * M];\n      AB0[_j + k * M] = AB0[_j + p * M];\n      AB0[_j + p * M] = AB_jk;\n    }\n\n    for (var _j2 = 0; _j2 < k; _j2++) {\n      var _AB_jk = AB[_j2 + k * M];\n      AB[_j2 + k * M] = AB[_j2 + p * M];\n      AB[_j2 + p * M] = _AB_jk;\n    } // swap P\n\n\n    var P_i = P[P_off + k];\n    P[P_off + k] = P[P_off + p];\n    P[P_off + p] = P_i; // RESET COLUMN NORM (INDEX k IS SET TO ZERO FOR THE NEXT RRQR)\n\n    norm.fill(0.0); // ELIMINATE COLUMN k BELOW DIAGONAL (USING GIVEN ROTATIONS)\n\n    var count = 0;\n\n    for (var _j3 = k; ++_j3 < M;) {\n      var kk = R_off + N * k + k,\n          jk = R_off + N * _j3 + k,\n          _R_jk = R[jk];\n\n      if (0 !== _R_jk) {\n        var R_kk = R[kk],\n            _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(R_kk, _R_jk),\n            _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n            c = _giv_rot_qr3[0],\n            s = _giv_rot_qr3[1],\n            _norm2 = _giv_rot_qr3[2];\n\n        R[jk] = 0;\n\n        if (s !== 0) {\n          R[kk] = _norm2;\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(R, N - 1 - k, kk + 1, jk + 1, c, s);\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, Q_dirty ? M : _j3 + 1, // <- \"strong\" column swaps \"contaminate\" Q -> be fully rotate\n          Q_off + M * k, Q_off + M * _j3, c, s);\n        }\n      }\n\n      Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm_update\"])(norm, R, R_off + N * _j3, k + 1);\n    }\n  };\n  /* Swaps column `k` and the column with the largest remaining norm.\n   * Afterwards, this method eliminates the (new) column `k` in R.\n   * A\\B and A0\\B0 are updated accordingly.\n   */\n\n\n  var piv_elim = function piv_elim() {\n    //*DEBUG*/    check_col_norms();\n    var p = -1,\n        norm_p = -Infinity;\n\n    for (var j = k; j < N; j++) {\n      var norm_j = Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm\"])(norm, j);\n\n      if (norm_p < norm_j) {\n        p = j;\n        norm_p = norm_j;\n      }\n    } //*DEBUG*/    if(!(norm_p >= 0))\n    //*DEBUG*/      throw new Error('Assertion failed.');\n\n\n    swap_elim(p);\n  }; //*DEBUG*/  const check = (AB, k) =>\n  //*DEBUG*/  {\n  //*DEBUG*/    // check inv(A)\n  //*DEBUG*/    for( let i=0; i < k; i++ )\n  //*DEBUG*/    for( let j=0; j < k; j++ )\n  //*DEBUG*/    {\n  //*DEBUG*/      let sum = 0;\n  //*DEBUG*/      for( let h=0; h < k; h++ )\n  //*DEBUG*/        sum += AB[i+h*M] * R[R_off + N*h+j];\n  //*DEBUG*/      if( ! (Math.abs(sum - (i===j)) <= 1e-4) )\n  //*DEBUG*/        throw new Error(`${sum} != ${(i===j)*1}.`);\n  //*DEBUG*/    }\n  //*DEBUG*/    // check A\\B\n  //*DEBUG*/    for( let i=0; i < k; i++ )\n  //*DEBUG*/    for( let j=k; j < N; j++ )\n  //*DEBUG*/    {\n  //*DEBUG*/      let sum = 0;\n  //*DEBUG*/      for( let h=0; h < k; h++ )\n  //*DEBUG*/        sum += AB[i+h*M] * R[R_off + N*h+j];\n  //*DEBUG*/      if( ! (Math.abs(sum - AB[i+j*M]) <= 1e-4) )\n  //*DEBUG*/        throw new Error(`${sum} != ${AB[i+j*M]}.`);\n  //*DEBUG*/    }\n  //*DEBUG*/  }\n  //*DEBUG*/\n  //*DEBUG*/\n  //*DEBUG*/  const check_col_norms = () =>\n  //*DEBUG*/  {\n  //*DEBUG*/    for( let j=k; j < N; j++ )\n  //*DEBUG*/    {\n  //*DEBUG*/      const nj = _norm(norm, j),\n  //*DEBUG*/            uj = Math.hypot(...function*(){\n  //*DEBUG*/              for( let i=k; i < M; i++ )\n  //*DEBUG*/                yield R[R_off + N*i+j];\n  //*DEBUG*/            }());\n  //*DEBUG*/      if( !(Math.abs(nj-uj) <= 1e-8) )\n  //*DEBUG*/        throw new Error('Assertion failed.');\n  //*DEBUG*/    }\n  //*DEBUG*/  }\n\n  /* Used to copy either AB to AB0 or AB0 to AB.\n   */\n\n\n  var copy = function copy(AB_src, AB_dst) {\n    for (var j = 0; j < N; j++) {\n      for (var _i5 = 0; _i5 < k; _i5++) {\n        AB_dst[_i5 + j * M] = AB_src[_i5 + j * M];\n      }\n    }\n  };\n  /* Used to move column `p` of R to column `k` >= `p` using cyclic permutation.\n   * This method is used to prepare a \"strong\" column swap. After the cycle\n   * followed by a retriangulation, we can downdate AB (and sometimes AB0) such\n   * the the column swap does no longer affect AB (and AB0).\n   * \n   * The column swap in R looks roughly as follows:\n   * \n   *                                             \n   *      .   p x   x k          .   x   x k p   \n   *       .  . .   . k           .  .   . k .   \n   *        . . .   . k            . .   . k .   \n   *         .. .   . k   (cycle)   ..   . k .   \n   *   R:     p x   x k     ==>      x   x k p   \n   *            x   x k              x   x k 0   \n   *               x k                 x k .   \n   *                x k                  x k .   \n   *                  k                    k .   \n   *                                           \n   *                                             \n   * \n   * The advantage of this cyclic permutation is that only (k-p) Givens rotations\n   * are required to retriangulate R.\n   *\n   *                                              \n   *           .                    .             \n   *            .  .       .         .  .       . \n   *             . .       .          . .       . \n   *              ..       . (cycle)   ..       . \n   *   inv(A):     p p  p p   ==>      0 x   x x \n   *                 x   x x                 x x \n   *                    x x                  x x \n   *                     x x                    k \n   *                       k            p p  p p \n   *                                              \n   *                                              \n   * \n   * Since the cycle is a column swap inside of triangulate region A of R, we\n   * have to perform the same cycle as ROW permutation in inv(A).\n   * \n   * \n   * \n   * Keep in mind that while retriangulating R, the same givens rotations in\n   * the same order must be applied to the columns of inv(A) after which\n   * inv(A) is triangular again as well.\n   */\n\n\n  var cycle = function cycle(AB, p, k) {\n    for (var j = p; j < N; j++) {\n      var AB_pj = AB[p + j * M];\n\n      if (j < k) {\n        for (var _i6 = p; _i6 < j; _i6++) {\n          AB[_i6 + j * M] = AB[_i6 + 1 + j * M];\n        }\n\n        AB[j + j * M] = 0;\n      } else for (var _i7 = p; _i7 < k; _i7++) {\n        AB[_i7 + j * M] = AB[_i7 + 1 + j * M];\n      }\n\n      AB[k + j * M] = AB_pj;\n    }\n  };\n  /* Computes the column norms of C\n   */\n\n\n  var update_col_norms = function update_col_norms() {\n    norm.fill(0.0);\n\n    for (var _i8 = k; _i8 < M; _i8++) {\n      Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm_update\"])(norm, R, R_off + N * _i8, k);\n    }\n  };\n  /* Computes Frobenius norm of C.\n   */\n\n\n  var norm_C = function norm_C() {\n    //*DEBUG*/    check_col_norms();\n    NORM.reset();\n\n    for (var j = k; j < N; j++) {\n      NORM.include(Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm\"])(norm, j));\n    }\n\n    return NORM.result;\n  };\n  /* Adjusts the binary search range and moves `k` to the\n   * middle of that new range. If `increase` is true the\n   * binary search range is moved to the right of the\n   * current `k`. \n   */\n\n\n  var adjust_k = function adjust_k(increase) {\n    //*DEBUG*/    if( 'boolean' !== typeof increase )\n    //*DEBUG*/      throw new Error('Assertion failed.');\n    //*DEBUG*/    if(!(k0 <= k     )) throw new Error('Assertion failed.');\n    //*DEBUG*/    if(!(      k <= K)) throw new Error('Assertion failed.');\n    //*DEBUG*/    check_col_norms();\n    if (increase) {\n      //*DEBUG*/      if(!(k < K)) throw new Error('Assertion failed.');\n      piv_elim();\n      update(AB, k++);\n      copy(AB, AB0);\n      k0 = k;\n    } else {\n      //*DEBUG*/      if(!(k0 < k)) throw new Error('Assertion failed.');\n      //*DEBUG*/      if(!(K == k)) throw new Error('Assertion failed.');\n      copy(AB0, AB);\n      k = k0;\n      update_col_norms();\n    }\n\n    var mid = k0 + K >>> 1;\n\n    while (k < mid) {\n      //*DEBUG*/      check_col_norms();\n      if (norm_C() <= ztol) {\n        // we have found a new upper bound for the rank\n        K = k;\n\n        if (k0 < k) {\n          // if we can go back let's always go back binary search style\n          copy(AB0, AB);\n          k = k0;\n          update_col_norms();\n          mid = k0 + K >>> 1;\n          increase = false;\n          continue;\n        } // if we can't go back we have found the correct rank, let's return\n\n\n        break;\n      }\n\n      if (increase) piv_elim();\n      update(AB, k++);\n      if (!increase) update_col_norms(); //*DEBUG*/      check_col_norms();\n    }\n  }; //*DEBUG*/  const logdet_A = () =>\n  //*DEBUG*/  {\n  //*DEBUG*/    // CHECK TRIANGULARITY OF R AND AB\n  //*DEBUG*/    for( let j=0;   j < k; j++)\n  //*DEBUG*/    for( let i=j; ++i < M;    )\n  //*DEBUG*/      if( !(R [R_off + N*i+j  ] === 0) ) throw new Error(`Assertion failed.`);\n  //*DEBUG*/\n  //*DEBUG*/    let logdet_A = 0;\n  //*DEBUG*/    for( let i=0; i < k; i++ )\n  //*DEBUG*/      logdet_A += Math.log2(Math.abs(R[R_off + N*i+i]));\n  //*DEBUG*/    return logdet_A;\n  //*DEBUG*/  };\n  // FOR EACH MATRIX IN THE BATCH\n\n\n  for (var r_off = 0; Q_off < Q.length; Q_off += M * M, R_off += M * N, P_off += N, r_off += 1) {\n    // SCALE R // <- FIXME: rethink scaling regarding underflow and overflow\n    NORM.reset();\n\n    for (var _i9 = M * N; _i9-- > 0;) {\n      NORM.include(R[R_off + _i9]);\n    }\n\n    var SCALE = NORM.max === 0 ? 1 : NORM.result;\n    if (!isFinite(SCALE)) throw new Error('Assertion failed: ' + SCALE);\n    if (!(0 < SCALE)) throw new Error('Assertion failed: ' + SCALE);\n    if (1 !== SCALE) for (var _i10 = M * N; _i10-- > 0;) {\n      R[R_off + _i10] /= SCALE;\n    } // INIT P\n\n    for (var _i11 = 0; _i11 < N; _i11++) {\n      P[P_off + _i11] = _i11;\n    } // INIT Q (TO IDENTITY)\n\n\n    for (var _i12 = 0; _i12 < M; _i12++) {\n      Q[Q_off + M * _i12 + _i12] = 1;\n    } // INIT AB\n\n\n    AB0.fill(0.0);\n    AB.fill(0.0); // RETRIEVE TOLERANCES\n\n    dtol = DTOL(r_off), ztol = ZTOL(r_off);\n    if (!isFinite(dtol)) throw new Error(\"Assertion failed. Invalid dtol: \".concat(dtol, \".\"));\n    if (!isFinite(ztol)) throw new Error(\"Assertion failed. Invalid ztol: \".concat(ztol, \".\"));\n    if (!(1 <= dtol)) throw new Error(\"Assertion failed. Invalid dtol: \".concat(dtol, \".\"));\n    if (!(0 <= ztol)) throw new Error(\"Assertion failed. Invalid ztol: \".concat(ztol, \".\")); // INIT BINARY SEARCH BOUNDS\n\n    k0 = k = 0;\n    K = L;\n    Q_dirty = false;\n    update_col_norms();\n\n    loop: for (;;) {\n      //*DEBUG*/      check(AB, k );\n      //*DEBUG*/      check(AB0,k0);\n      //*DEBUG*/      if(!(k0 <= k)) throw new Error('Assertion failed.');\n      //*DEBUG*/      if(!(   k<=N)) throw new Error('Assertion failed.');\n      if (norm_C() <= ztol) {\n        // WE HAVE FOUND A NEW UPPER BOUND FOR THE RANK\n        K = k;\n\n        if (k0 < k) {\n          // IF WE CAN GO BACK, LET'S GO BACK BINARY SEARCH STYLE\n          adjust_k(\n          /*increase=*/\n          false); //*DEBUG*/          check(AB, k );\n          //*DEBUG*/          check(AB0,k0);\n        } else if (k === N) break loop; // <- no more column swaps possible -> stop\n        //*DEBUG*/        else if( k !== k0) throw new Error('Assertion failed.');\n        // AT THIS POINT WE KNOW THE RANK BUT\n        // LET'S STRONG SWAP AS MUCH AS POSSIBLE\n\n      } // SEARCH BEST COLUMN SWAPS\n\n\n      var p = -1,\n          q = -1,\n          F = -Infinity; // COMPUTE ROW NORMS OF inv(A)\n\n      for (var j = 0; j < k; j++) {\n        _row_norm_update(norm, AB, j * M, j + 1);\n      } // FIND BEST \"STRONG\" COLUMN SWAP\n\n\n      for (var _i13 = 0; _i13 < k; _i13++) {\n        var _r = Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm\"])(norm, _i13);\n\n        for (var _j4 = k; _j4 < N; _j4++) {\n          var c = Object(_rrqr__WEBPACK_IMPORTED_MODULE_5__[\"_norm\"])(norm, _j4);\n\n          var f = Math.hypot(AB[_i13 + _j4 * M], _r * c);\n\n          if (F < f) {\n            F = f;\n            p = _i13;\n            q = _j4;\n          }\n        }\n      } // IF NO GOOD COLUMN SWAP IS FOUND ANYMORE\n\n\n      if (!(F > dtol)) {\n        if (k0 >= K) {\n          // WE HAVE FOUND THE EXACT RANK\n          //*DEBUG*/          if( k0 !== K ) throw new Error('Assertion failed.');\n          //*DEBUG*/          if( k0 !== k ) throw new Error('Assertion failed.');\n          break loop;\n        } else {\n          // WE HAVE TO GO FURTHER (the current k is less than the rank)\n          //*DEBUG*/          if(!(k < K))\n          //*DEBUG*/            throw new Error('Assertion failed.');\n          adjust_k(\n          /*increase=*/\n          true);\n          continue loop;\n        }\n      } //*DEBUG*/      if( !(0 < k) )\n      //*DEBUG*/        throw new Error('Assertion failed.');\n\n\n      Q_dirty = true; //*DEBUG*/      const predict_logdet_A = logdet_A() + Math.log2(F);\n      // IF inv(A0) IS AFFECTED BY COLUMN SWAP\n\n      if (p < k0) {\n        --k0; // MOVE COLUMN p TO k0 (VIA CYCLIC PERMUTATION) TODO use triangulary property to reduces Ops\n        // CYCLE COLUMNS of R\n\n        for (var _i14 = 0; _i14 <= k0; _i14++) {\n          var R_ip = R[R_off + N * _i14 + p];\n\n          for (var _j5 = Math.max(p, _i14 - 1); _j5 < k0; _j5++) {\n            R[R_off + N * _i14 + _j5] = R[R_off + N * _i14 + (_j5 + 1)];\n          }\n\n          R[R_off + N * _i14 + k0] = R_ip;\n        } // CYCLE ROWS OF inv(A)\n\n\n        cycle(AB, p, k0);\n        cycle(AB0, p, k0); // CYCLE P P\n\n        {\n          var P_p = P[P_off + p];\n\n          for (var _j6 = p; _j6 < k0; _j6++) {\n            P[P_off + _j6] = P[P_off + _j6 + 1];\n          }\n\n          P[P_off + k0] = P_p;\n        } // RETRIANGULATE USING GIVENS ROTATIONS\n        // (since cyclic permutation turned R from triangular to Hessenberg)\n\n        for (var _i15 = p; _i15 < k0; _i15++) {\n          var ii = R_off + N * _i15 + _i15,\n              ji = R_off + N * (_i15 + 1) + _i15,\n              R_ji = R[ji];\n\n          if (0 !== R_ji) {\n            var R_ii = R[ii],\n                _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(R_ii, R_ji),\n                _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n                _c = _giv_rot_qr5[0],\n                s = _giv_rot_qr5[1],\n                _norm3 = _giv_rot_qr5[2];\n\n            R[ji] = 0;\n\n            if (s !== 0) {\n              R[ii] = _norm3;\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(R, N - 1 - _i15, ii + 1, ji + 1, _c, s);\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, M, Q_off + M * _i15, Q_off + M * (_i15 + 1), _c, s);\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(AB, _i15 + 1, M * _i15, M * (_i15 + 1), _c, s);\n\n              AB[k0 + (_i15 + 1) * M] = -s * AB[k0 + _i15 * M] + _c * AB[k0 + (_i15 + 1) * M];\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(AB0, _i15 + 1, M * _i15, M * (_i15 + 1), _c, s);\n\n              AB0[k0 + (_i15 + 1) * M] = -s * AB0[k0 + _i15 * M] + _c * AB0[k0 + (_i15 + 1) * M];\n            }\n          }\n\n          AB[k0 + _i15 * M] = 0;\n          AB0[k0 + _i15 * M] = 0;\n        }\n\n        downdate(AB0, k0);\n        p = k0++;\n      }\n\n      --k; // <- go back one step since the swappend column needs retriangulation\n      // MOVE COLUMN p TO k (VIA CYCLIC PERMUTATION) TODO use triangulary property to reduces Ops\n      // CYCLE COLUMNS of R\n\n      for (var _i16 = 0; _i16 <= k; _i16++) {\n        var _R_ip = R[R_off + N * _i16 + p];\n\n        for (var _j7 = Math.max(p, _i16 - 1); _j7 < k; _j7++) {\n          R[R_off + N * _i16 + _j7] = R[R_off + N * _i16 + (_j7 + 1)];\n        }\n\n        R[R_off + N * _i16 + k] = _R_ip;\n      } // CYCLE ROWS OF inv(A)\n\n\n      cycle(AB, p, k); // CYCLE COLS OF inv(A0)\n\n      for (var _i17 = 0; _i17 < k0; _i17++) {\n        norm[_i17] = AB0[_i17 + p * M];\n      }\n\n      for (var _j8 = p; _j8 < k; _j8++) {\n        for (var _i18 = 0; _i18 < k0; _i18++) {\n          AB0[_i18 + _j8 * M] = AB0[_i18 + (_j8 + 1) * M];\n        }\n      }\n\n      for (var _i19 = 0; _i19 < k0; _i19++) {\n        AB0[_i19 + k * M] = norm[_i19];\n      } // CYCLE P P\n\n\n      {\n        var _P_p = P[P_off + p];\n\n        for (var _j9 = p; _j9 < k; _j9++) {\n          P[P_off + _j9] = P[P_off + _j9 + 1];\n        }\n\n        P[P_off + k] = _P_p;\n      } // RETRIANGULATE USING GIVENS ROTATIONS\n      // (since cyclic permutation turned R from triangular to Hessenberg)\n\n      for (var _i20 = p; _i20 < k; _i20++) {\n        var _ii = R_off + N * _i20 + _i20,\n            _ji = R_off + N * (_i20 + 1) + _i20,\n            _R_ji = R[_ji];\n\n        if (0 !== _R_ji) {\n          var _R_ii = R[_ii],\n              _giv_rot_qr6 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_qr\"])(_R_ii, _R_ji),\n              _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr6, 3),\n              _c2 = _giv_rot_qr7[0],\n              _s = _giv_rot_qr7[1],\n              _norm4 = _giv_rot_qr7[2];\n\n          R[_ji] = 0;\n\n          if (_s !== 0) {\n            R[_ii] = _norm4;\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(R, N - 1 - _i20, _ii + 1, _ji + 1, _c2, _s);\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(Q, M, Q_off + M * _i20, Q_off + M * (_i20 + 1), _c2, _s);\n\n            Object(_giv_rot__WEBPACK_IMPORTED_MODULE_3__[\"_giv_rot_rows\"])(AB, _i20 + 1, M * _i20, M * (_i20 + 1), _c2, _s); // rotate last row of inv(A)\n\n\n            AB[k + (_i20 + 1) * M] = -_s * AB[k + _i20 * M] + _c2 * AB[k + (_i20 + 1) * M];\n          }\n        }\n\n        AB[k + _i20 * M] = 0; // <- aside from rounding errors, inv(A) is going to be triangular again\n      }\n\n      downdate(AB, k);\n      swap_elim(q);\n\n      if (p < k0) {\n        //*DEBUG*/        if(!(p === k0-1)) throw new Error('Assertion failed.');\n        update(AB0, p);\n      }\n\n      update(AB, k++); //*DEBUG*/      check(AB, k );\n      //*DEBUG*/      check(AB0,k0);\n      //*DEBUG*/      // CHECK DET PREDICTION\n      //*DEBUG*/      if( !(Math.abs(logdet_A() - predict_logdet_A) <= 1e-6) )\n      //*DEBUG*/        throw new Error(`${logdet_A()} != ${predict_logdet_A}`); \n    } // UNSCALE R\n\n\n    if (1 !== SCALE) for (var _i21 = M * N; _i21-- > 0;) {\n      R[R_off + _i21] *= SCALE;\n    } // WRITE RANK\n\n    r[r_off] = k; // TRANSPOSE Q (was transposed for cache alignment)\n\n    Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_6__[\"_transpose_inplace\"])(M, Q, Q_off);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Q_shape, Q), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](R_shape, R), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](P_shape, P), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](r_shape, r)];\n}\n\n//# sourceURL=webpack://nd/./src/la/srrqr.js?");

/***/ }),

/***/ "./src/la/svd.js":
/*!***********************!*\
  !*** ./src/la/svd.js ***!
  \***********************/
/*! exports provided: svd_decomp, svd_rank, svd_solve, svd_lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_rank\", function() { return svd_rank; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_solve\", function() { return svd_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_lstsq\", function() { return svd_lstsq; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math */ \"./src/math.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./singular_matrix_solve_error */ \"./src/la/singular_matrix_solve_error.js\");\n/* harmony import */ var _svd_dc__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./svd_dc */ \"./src/la/svd_dc.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"svd_decomp\", function() { return _svd_dc__WEBPACK_IMPORTED_MODULE_5__[\"svd_dc\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n // TODO: svd_decomp_full\n\nfunction svd_rank(sv) {\n  sv = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(sv);\n  var N = sv.shape[sv.ndim - 1],\n      r_shape = sv.shape.slice(0, -1),\n      EPS = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].sqrt(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(sv.dtype));\n  sv = sv.data;\n  var r = new _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"]['int32'](sv.length / N);\n\n  for (var off = 0; off < r.length; off++) {\n    var T = EPS * _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv[N * off]);\n    if (r[off] !== 0) throw new Error('Assertion failed.');\n\n    for (; r[off] < N; r[off]++) {\n      var sv_r = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv[N * off + r[off]]);\n      if (!isFinite(sv_r)) throw new Error('svd_rank(): NaN or Infinity encountered.');\n      if (sv_r <= T) break;\n    }\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](r_shape, r);\n}\nfunction svd_solve(U, sv, V, y) {\n  if (y == undefined) {\n    if (V != undefined) throw new Error('svd_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.');\n    y = sv;\n    var _U = U;\n\n    var _U2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_U, 3);\n\n    U = _U2[0];\n    sv = _U2[1];\n    V = _U2[2];\n  }\n\n  U = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(U);\n  sv = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(sv);\n  V = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(V);\n  if (U.shape[U.ndim - 2] !== V.shape[V.ndim - 1]) throw new Error('rrqr_solve(Q,R,P, y): System not square.');\n  var x = svd_lstsq(U, sv, V, y),\n      EPS = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].sqrt(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(sv.dtype)),\n      N = sv.shape[sv.ndim - 1];\n  sv = sv.data;\n\n  for (var sv_off = 0; sv_off < sv.length; sv_off += N) {\n    var T = EPS * _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv[sv_off]);\n\n    for (var r; r < N; r++) {\n      var sv_r = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv[sv_off + r]);\n      if (!isFinite(sv_r)) throw new Error('svd_solve(): NaN or Infinity encountered.');\n      if (sv_r <= T) // FIXME: what if (Uy)[i >= rank]  0\n        throw new _singular_matrix_solve_error__WEBPACK_IMPORTED_MODULE_4__[\"SingularMatrixSolveError\"](x);\n    }\n  }\n\n  return x;\n}\nfunction svd_lstsq(U, sv, V, y) {\n  if (y == undefined) {\n    if (V != undefined) throw new Error('svd_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.');\n    y = sv;\n    var _U3 = U;\n\n    var _U4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_U3, 3);\n\n    U = _U4[0];\n    sv = _U4[1];\n    V = _U4[2];\n  }\n\n  U = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(U);\n  if (U.ndim < 2) throw new Error('svd_lstsq(U,sv,V, y): U.ndim must be at least 2.');\n  sv = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(sv);\n  if (sv.ndim < 1) throw new Error('svd_lstsq(U,sv,V, y): sv.ndim must be at least 1.');\n  V = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(V);\n  if (V.ndim < 2) throw new Error('svd_lstsq(U,sv,V, y): V.ndim must be at least 2.');\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(y);\n  if (y.ndim < 2) throw new Error('svd_lstsq(U,sv,V, y): y.ndim must be at least 2.');\n\n  var _U$shape$slice = U.shape.slice(-2),\n      _U$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_U$shape$slice, 2),\n      N = _U$shape$slice2[0],\n      M = _U$shape$slice2[1],\n      _V$shape$slice = V.shape.slice(-1),\n      _V$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_V$shape$slice, 1),\n      I = _V$shape$slice2[0],\n      _y$shape$slice = y.shape.slice(-1),\n      _y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_y$shape$slice, 1),\n      J = _y$shape$slice2[0];\n\n  if (N !== y.shape[y.ndim - 2]) throw new Error(\"svd_lstsq(U,sv,V, y): U and y don't match.\");\n  if (M !== sv.shape[sv.ndim - 1]) throw new Error(\"svd_lstsq(U,sv,V, y): U and sv don't match.\");\n  if (M !== V.shape[V.ndim - 2]) throw new Error(\"svd_lstsq(U,sv,V, y): V and sv don't match.\");\n  var ndim = Math.max(U.ndim, sv.ndim + 1, V.ndim, y.ndim),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  });\n  shape[ndim - 2] = I;\n  shape[ndim - 1] = J; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i = 0, _arr = [U, V, y]; _i < _arr.length; _i++) {\n    var arr = _arr[_i];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('svd_lstsq(U,sv,V, y): U,sv,V,y not broadcast-compatible.');\n    }\n  }\n\n  for (var _i2 = ndim - 2, _j = sv.ndim - 1; _i2-- > 0 && _j-- > 0;) {\n    if (1 === shape[_i2]) shape[_i2] = sv.shape[_j];else if (shape[_i2] != sv.shape[_j] && sv.shape[_j] != 1) throw new Error('svd_lstsq(U,sv,V, y): U,sv,V,y not broadcast-compatible.');\n  } // GENERATE RESULT DATA\n\n\n  var EPS = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].sqrt(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(sv.dtype)),\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][[U, sv, V, y].every(function (a) {\n    return a.dtype === 'float32';\n  }) ? 'float32' : 'float64'],\n      tmp = new DTypeArray(M * J),\n      x_dat = new DTypeArray(shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      U_dat = U.data,\n      sv_dat = sv.data,\n      V_dat = V.data,\n      y_dat = y.data;\n  var U_off = 0,\n      U_stride = 1,\n      sv_off = 0,\n      sv_stride = 1,\n      V_off = 0,\n      V_stride = 1,\n      y_off = 0,\n      y_stride = 1,\n      x_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      U_stride = N * M;\n      sv_stride = M;\n      V_stride = M * I;\n      y_stride = N * J;\n\n      var R = function () {\n        var T = EPS * _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv_dat[sv_off]);\n\n        for (var r = 0; r < M; r++) {\n          var sv_r = _math__WEBPACK_IMPORTED_MODULE_1__[\"default\"].abs(sv_dat[sv_off + r]);\n          if (!isFinite(sv_r)) throw new Error('svd_solve(): NaN or Infinity encountered.');\n          if (sv_r <= T) return r;\n        }\n\n        return M;\n      }(); // SEE: Gene H. Golub, Charles F. Van Golub\n      //     \"Matrix Computations\", 4th edition\n      //      Page 260f, Chap. 5.3.1 (Implications of Full Rank)\n      // tmp = U.T @ y\n\n\n      tmp.fill(0);\n\n      for (var k = 0; k < N; k++) {\n        for (var _i3 = 0; _i3 < R; _i3++) {\n          for (var _j2 = 0; _j2 < J; _j2++) {\n            tmp[J * _i3 + _j2] += U_dat[U_off + M * k + _i3] * y_dat[y_off + J * k + _j2];\n          }\n        }\n      } // tmp \\= diag(sv)\n\n\n      for (var _i4 = 0; _i4 < R; _i4++) {\n        for (var _j3 = 0; _j3 < J; _j3++) {\n          tmp[J * _i4 + _j3] /= sv_dat[sv_off + _i4];\n        }\n      } // x = V.T @ tmp\n\n\n      for (var _k = 0; _k < R; _k++) {\n        for (var _i5 = 0; _i5 < I; _i5++) {\n          for (var _j4 = 0; _j4 < J; _j4++) {\n            x_dat[x_off + J * _i5 + _j4] += V_dat[V_off + I * _k + _i5] * tmp[J * _k + _j4];\n          }\n        }\n      }\n\n      U_off += U_stride;\n      sv_off += sv_stride;\n      V_off += V_stride;\n      y_off += y_stride;\n      x_off += I * J;\n      return;\n    }\n\n    for (var l = shape[d];; l--) {\n      solv(d + 1);\n      if (l == 1) break;\n      if (!(U.shape[d - ndim + U.ndim] > 1)) U_off -= U_stride;\n      if (!(sv.shape[d - ndim + 1 + sv.ndim] > 1)) sv_off -= sv_stride;\n      if (!(V.shape[d - ndim + V.ndim] > 1)) V_off -= V_stride;\n      if (!(y.shape[d - ndim + y.ndim] > 1)) y_off -= y_stride;\n    }\n\n    U_stride *= U.shape[d - ndim + U.ndim] || 1;\n    sv_stride *= sv.shape[d - ndim + 1 + sv.ndim] || 1;\n    V_stride *= V.shape[d - ndim + V.ndim] || 1;\n    y_stride *= y.shape[d - ndim + y.ndim] || 1;\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_dat);\n  throw new Error('Not yet implemented!');\n}\n\n//# sourceURL=webpack://nd/./src/la/svd.js?");

/***/ }),

/***/ "./src/la/svd_dc.js":
/*!**************************!*\
  !*** ./src/la/svd_dc.js ***!
  \**************************/
/*! exports provided: _svd_dc_1x2, _svd_dc_2x3, _svd_dc_neves, _svd_dc_bidiag, _svd_dc, svd_dc */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_dc_1x2\", function() { return _svd_dc_1x2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_dc_2x3\", function() { return _svd_dc_2x3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_dc_neves\", function() { return _svd_dc_neves; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_dc_bidiag\", function() { return _svd_dc_bidiag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_svd_dc\", function() { return _svd_dc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_dc\", function() { return svd_dc; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _svd_jac_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_svd_jac_utils */ \"./src/la/_svd_jac_utils.js\");\n/* harmony import */ var _norm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./norm */ \"./src/la/norm.js\");\n/* harmony import */ var _bidiag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./bidiag */ \"./src/la/bidiag.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n // WARNING:\n//   The following methods expect V to be stored in transposed/colum-major fashion.\n//     * _svd_dc_1x2\n//     * _svd_dc_2x3\n//     * _svd_dc_neves\n//     * _svd_dc_bidiag\n\n/* Computes the SVD of the 1x2 matrix B\n */\n\nvar _svd_dc_1x2 = function _svd_dc_1x2(N, U, U_off, F, B_off, V_off) {\n  N |= 0;\n  U_off |= 0;\n  B_off |= 0;\n  V_off |= 0;\n\n  var _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(F[B_off], F[B_off + 1]),\n      _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n      c = _giv_rot_qr3[0],\n      s = _giv_rot_qr3[1],\n      norm = _giv_rot_qr3[2];\n\n  if (0 !== norm) {\n    F[B_off] = norm;\n    F[B_off + 1] = NaN;\n    F[V_off] = c;\n    F[V_off + 1] = -s;\n    F[V_off + N * 1] = s;\n    F[V_off + N * 1 + 1] = c;\n  } else {\n    F[V_off] = 1;\n    F[V_off + N * 1 + 1] = 1;\n  }\n\n  U[U_off] = 1;\n};\n/* Computes the SVD of the 2x3 matrix B\n *                 \n *      b1  b2   0 \n * B =             \n *      0   b3  b4 \n *                 \n */\n\nvar _svd_dc_2x3 = function _svd_dc_2x3(N, U, U_off, F, B_off, V_off) {\n  U_off |= 0;\n  B_off |= 0;\n  V_off |= 0;\n  N |= 0;\n  var M = N - 1 | 0;\n  var b1 = F[B_off],\n      b2 = F[B_off + 1],\n      b3 = F[B_off + 2],\n      b4 = F[B_off + 3]; // STEP 1:\n  //   RQ-decompose down to 2x2 problem\n\n  if (0 !== b4) {\n    // eliminate B[1,2] (stored in b4)\n    var _giv_rot_qr4 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(b3, b4),\n        _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr4, 3),\n        _ca = _giv_rot_qr5[0],\n        _sa = _giv_rot_qr5[1],\n        norm = _giv_rot_qr5[2];\n\n    F[V_off + N * 1 + 1] = _ca;\n    F[V_off + N * 2 + 1] = _sa;\n    b3 = norm;\n    b4 = -_sa * b2;\n    b2 = _ca * b2;\n\n    if (0 !== b4) {\n      // eliminate B[0,2] (stored in b4)\n      var _giv_rot_qr6 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(b1, b4),\n          _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr6, 3),\n          _cb = _giv_rot_qr7[0],\n          _sb = _giv_rot_qr7[1],\n          _norm = _giv_rot_qr7[2];\n\n      b1 = _norm;\n      F[V_off] = _cb;\n      F[V_off + N * 1] = _sb * -_sa;\n      F[V_off + N * 2] = _sb * _ca;\n      F[V_off + 2] = -_sb;\n      F[V_off + N * 1 + 2] = _cb * -_sa;\n      F[V_off + N * 2 + 2] = _cb * _ca;\n    } else {\n      F[V_off] = 1;\n      F[V_off + N * 1 + 2] = -_sa;\n      F[V_off + N * 2 + 2] = _ca;\n    }\n  } else {\n    F[V_off] = 1;\n    F[V_off + N * 1 + 1] = 1;\n    F[V_off + N * 2 + 2] = 1;\n  } // STEP 2;\n  //   USE SINGLE JACOBI ROTATION TO COMPUTE SVD\n\n\n  var _svd_jac_angles2 = Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_5__[\"_svd_jac_angles\"])(b1, b2, 0, b3),\n      _svd_jac_angles3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_angles2, 4),\n      ca = _svd_jac_angles3[0],\n      sa = _svd_jac_angles3[1],\n      cb = _svd_jac_angles3[2],\n      sb = _svd_jac_angles3[3]; // WRITE SINGULAR VALUES TO B  \n\n\n  F[B_off + 1] = NaN; // <- TODO remove after testing\n\n  F[B_off + 3] = NaN; // <- TODO remove after testing\n\n  F[B_off] = ca * b1 * cb - (ca * b2 + sa * b3) * sb;\n  b3 = (-sa * b2 + ca * b3) * cb - sa * b1 * sb;\n  var s = b3 < 0 ? -1 : +1;\n  F[B_off + 2] = s * b3; // WRITE U\n\n  U[U_off] = ca;\n  U[U_off + 1] = -sa * s;\n  U[U_off + M * 1] = sa;\n  U[U_off + M * 1 + 1] = ca * s; // ROTATE V\n\n  F[V_off + 1] = sb * F[V_off];\n  F[V_off] *= cb;\n  var V1 = F[V_off + N * 1] * cb - F[V_off + N * 1 + 1] * sb;\n  F[V_off + N * 1 + 1] = F[V_off + N * 1] * sb + F[V_off + N * 1 + 1] * cb;\n  F[V_off + N * 1] = V1;\n  var V2 = F[V_off + N * 2] * cb - F[V_off + N * 2 + 1] * sb;\n  F[V_off + N * 2 + 1] = F[V_off + N * 2] * sb + F[V_off + N * 2 + 1] * cb;\n  F[V_off + N * 2] = V2;\n};\n/* Computes the singular values of a matrix shaped like a backwards seven.\n *                             \n *      d1                     \n *                             \n *          d2                 \n *            .                \n * B =          .              \n *                .            \n *                 d[n-1]      \n *                             \n *      z1  . . .  z[n-1] z[n] \n *                             \n * See:\n *   - \"INTRODUCTION OF DOUBLE DIVIDE AND CONQUER AND THE RECENT PROGRESS\", TARO KONDA & YOSHIMASA NAKAMURA\n *\n * Keep in mind that B is stored in a sparse memory layout.\n * \n * B = Array(d1, z1, d2, z2, ..., d[n]=0, z[n])\n * \n * where d[i] >= d[i+1]\n * \n * Keep in mind that V is stored in a column-major order in this method.\n */\n\nvar _svd_dc_neves = function _svd_dc_neves(N, n, U, U_off, F, B_off, V_off, I) {\n  U_off |= 0;\n  B_off |= 0;\n  V_off |= 0;\n  N |= 0;\n  var M = N - 1 | 0;\n  n |= 0;\n  var m = n - 1 | 0;\n  if (I.length < M * 3) throw new Error('Assertion failed: Integer work matrix I too small.');\n  if (F.length < M * (M + 2) + M * 2\n  /*B*/\n  + (M + 1) * (M + 1)\n  /*V*/\n  ) throw new Error('Assertion failed: Scalar work matrix F too small.'); // Amount of temp. float memory:\n  //   - m*m entries to store the matrix to update U and V\n  //   -   m entries to store the (shifted) singular values\n  //   -   m entries to compute the matrix multiplication (row by row)\n\n  var _off = M * (M + 2) - m,\n      mm_off = M * (M + 2) - m * 2,\n      W_off = M * (M + 2) - m * (m + 2); // <- mm as in \"matrix multiplication\"\n  // Amount of temp. int memory:\n  //   - m entries for the outer (row   ) order of U & V update matrices\n  //   - m entries for the inner (column) order of U & V update matrices\n  //   - m entries for the rotation pairings from step 2\n\n  var rot_off = m * 2,\n      inn_off = m,\n      // <- inner order\n  out_off = 0; // <- outer order\n\n  if (n < 2) throw new Error('Assertion failed.'); //     DIAGONAL ELEMENTS: d[i] = F[B_off + 2*i  ]\n  // OFF-DIAGONAL ELEMENTS: z[i] = F[B_off + 2*i+1]\n  // TODO remove checks after testing\n\n  /*DEBUG*/\n  // ensure d[-1] === 1\n\n  /*DEBUG*/\n\n  if (F[B_off + 2 * m - 2] !== 0)\n    /*DEBUG*/\n    throw new Error('Assertion failed.');\n  /*DEBUG*/\n  // ensure d[i] >= d[i+1]\n\n  /*DEBUG*/\n\n  for (var i = 1; i < m; i++) {\n    /*DEBUG*/\n    if (F[B_off + 2 * (i - 1)] < F[B_off + 2 * i])\n      /*DEBUG*/\n      throw new Error('Assertion failed.');\n  }\n\n  var NORM = new _norm__WEBPACK_IMPORTED_MODULE_6__[\"FrobeniusNorm\"]();\n\n  var _ref = function () {\n    for (var _i = 0; _i < m; _i++) {\n      NORM.include(F[B_off + 2 * _i + 1]);\n    }\n\n    var zNorm = NORM.result;\n\n    for (var _i2 = 0; _i2 < m; _i2++) {\n      NORM.include(F[B_off + 2 * _i2]);\n    }\n\n    var scale = NORM.result;\n    if (scale === 0) scale = 1;\n    return [zNorm / scale, scale];\n  }(),\n      _ref2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref, 2),\n      zNorm = _ref2[0],\n      scale = _ref2[1]; // normalize\n\n\n  for (var _i3 = 0; _i3 < 2 * m; _i3++) {\n    F[B_off + _i3] /= scale;\n  }\n\n  var TOL = Object(_dt__WEBPACK_IMPORTED_MODULE_1__[\"eps\"])(U instanceof Float32Array ? 'float32' : 'float64'); // STEP 1: DEFLATION\n  //   TEMPORARILY MOVE VALUES WITH z[j]  0 TO THE LEFT SUCH THAT\n  //\n  //                                          \n  //        d1                                \n  //           .                              \n  //             .                            \n  //               .                          \n  //               d[i]                       \n  //                                          \n  //   B =             d[i+1]                 \n  //                        .                 \n  //                          .               \n  //                            .             \n  //                              d[n-1]      \n  //                                          \n  //        0 . . . 0  z[i+1] ... z[n-1] z[n] \n  //                                          \n  //\n  //   This way only the lower right quadrant needs to be solved\n  //   iteratively (using the secular equations). The actual\n  //   implementation moves the deflated values to  and not to\n  //   the left.\n\n  var n0 = function () {\n    var n0 = 0;\n\n    for (var j = m - 1, _i4 = m - 1; _i4-- > 0;) {\n      var di = F[B_off + 2 * _i4],\n          zi = F[B_off + 2 * _i4 + 1],\n          oi = I[out_off + _i4];\n\n      if (Math.abs(zi) / TOL <= di) {\n        // <- FIXME this could be estimated more accurately\n        F[_off + n0] = di;\n        I[inn_off + n0] = oi; // <- used as temp. for outerOrder\n\n        ++n0;\n      } else {\n        --j;\n        F[B_off + 2 * j] = di;\n        F[B_off + 2 * j + 1] = F[B_off + 2 * _i4 + 1];\n        I[inn_off + j] = oi; // <- used as temp. for outerOrder\n      }\n    }\n\n    return n0;\n  }(); // innerOrder just used as temp. memory, move to outerOrder\n\n\n  for (var _i5 = 0; _i5 < n0; _i5++) {\n    I[out_off + _i5] = I[inn_off + _i5];\n  } // STEP 2:\n  //   HANDLE DUPLICATE VALUES ON THE DIAGONAL\n  //\n  // Lets say d[i] == d[i+1] and z[i] != 0 with 0 < i < n-1\n  //                                         \n  //      d1                                 \n  //        .                                \n  //          .                              \n  //            .                            \n  //             d[i]                        \n  //                                         \n  // B =              d[i+1]                 \n  //                       .                 \n  //                         .               \n  //                           .             \n  //                             d[n-1]      \n  //                                         \n  //      z1 ... z[i] z[i+1] ... z[n-1] z[n] \n  //                                         \n  //\n  // We can now use a left and right Givens rotation\n  // to eliminate z[i+1].\n  // n := (z + z)\n  // c := z   / n\n  // s := z / n\n  //\n  //                                 \n  //      1                          \n  //        .                        \n  //          .                      \n  //            .                    \n  //              1                  \n  //                                 \n  //                 c -s            \n  // G =                             \n  //                 s  c            \n  //                                 \n  //                       1         \n  //                         .       \n  //                           .     \n  //                             .   \n  //                               1 \n  //                                 \n  //\n  //                                                              \n  //                            d1                                \n  //                              .                               \n  //                                .                             \n  //                                  .                           \n  //                                   d[i]                       \n  //                                                              \n  // B = GGBGG = GB'G =             d[i+1]                 \n  //                                            .                 \n  //                                              .               \n  //                                                .             \n  //                                                  d[n-1]      \n  //                                                              \n  //                            z1 ...  0    n  . . . z[n-1] z[n] \n  //                                                              \n  //\n  // Thus z'[i] is now 0 and can be moved to the left side (similar to Step 1)\n\n\n  var n1 = function () {\n    var n1 = n0;\n\n    for (var j = m - 1, _i6 = m - 1; _i6-- > n0;) {\n      var di = F[B_off + 2 * _i6],\n          dj = F[B_off + 2 * j],\n          oi = I[inn_off + _i6],\n          zi = F[B_off + 2 * _i6 + 1],\n          zj = F[B_off + 2 * j + 1],\n          _giv_rot_qr8 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(zj, zi),\n          _giv_rot_qr9 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr8, 3),\n          c = _giv_rot_qr9[0],\n          s = _giv_rot_qr9[1],\n          z = _giv_rot_qr9[2];\n\n      if ((di - dj) / TOL <= di || !isFinite(Math.sqrt(m) / (di - dj))) // <- TODO find better criteria\n        {\n          F[W_off + 2 * n1] = c;\n          F[W_off + 2 * n1 + 1] = s;\n          F[B_off + 2 * j + 1] = z;\n          F[B_off + 2 * j] = F[_off + n1] = di;\n          I[out_off + n1] = oi; // <- used as temp. for outerOrder\n\n          I[rot_off + n1] = j;\n          ++n1;\n        } else {\n        --j;\n        F[B_off + 2 * j] = di;\n        F[B_off + 2 * j + 1] = F[B_off + 2 * _i6 + 1];\n        I[out_off + j] = oi;\n      }\n    }\n\n    return n1;\n  }();\n\n  for (var _i7 = 2 * n0; _i7 < 2 * n1; _i7++) {\n    F[B_off + _i7] = F[W_off + _i7];\n    F[W_off + _i7] = 0;\n  } // STEP 3:\n  //   SOLVE THE SECULAR EQUATIONS\n  //\n  //      !            z\n  //   0  =  1 +        k = 0, ..., m-1\n  //                d - \n  //\n\n\n  var _loop = function _loop(_i8) {\n    var sLo = F[B_off + 2 * _i8],\n        sHi = n1 < _i8 ? F[B_off + 2 * _i8 - 2] : sLo + zNorm;\n    if (sLo > sHi) throw new Error('Assertion failed.');\n\n    var shift = function () {\n      if (_i8 > n1) {\n        var mid = (sLo + sHi) / 2;\n        var sum = 1;\n\n        for (var _i32 = n1; _i32 < m; _i32++) {\n          var _di = F[B_off + 2 * _i32],\n              _zi = F[B_off + 2 * _i32 + 1];\n          sum += _zi / (_di - mid) * (_zi / (_di + mid));\n        }\n\n        if (!isFinite(sum)) throw new Error('Assertion failed.');\n\n        if (sum < 0) {\n          var _s2 = sHi;\n          sLo = sLo - sHi;\n          sHi = -Number.MIN_VALUE;\n          return _s2;\n        }\n      }\n\n      var s = sLo;\n      sHi = sHi - sLo;\n      sLo = +Number.MIN_VALUE;\n      return s;\n    }(); // TODO: Make bisection more accurate (see nd.opt.root1d_bisect)\n\n\n    for (;;) {\n      // bisect\n      var _s3 = (sLo + sHi) / 2;\n\n      if (_s3 === sLo || _s3 === sHi) {\n        F[_off + _i8] = _s3; // FIXME at this point sLo and sHi still have to be compared\n\n        break;\n      } // evalue the secular equation\n\n\n      var sum = 1;\n\n      for (var _i33 = n1; _i33 < m; _i33++) {\n        var _di2 = F[B_off + 2 * _i33],\n            _zi2 = F[B_off + 2 * _i33 + 1];\n        sum += _zi2 / (_di2 - shift - _s3) * (_zi2 / (_di2 + shift + _s3));\n      }\n\n      if (!isFinite(sum)) throw new Error('Assertion failed.'); // adjust bisection bounds\n\n      if (sum <= 0) sLo = _s3;\n      if (sum >= 0) sHi = _s3;\n    }\n  };\n\n  for (var _i8 = n1; _i8 < m; _i8++) {\n    _loop(_i8);\n  }\n\n  if (Math.abs(F[B_off + 2 * m - 1]) === 0) {\n    F[B_off + 2 * m - 2] = 0;\n    F[B_off + 2 * m - 1] = 0;\n    F[_off + m - 1] = 0;\n  } // STEP 4:\n  //   RECOMPUTE z TO ORTHOGONALIZE U & V\n  //   (as originally suggested by Gu and Eisenstat)\n\n\n  {\n    var n = F[_off + m - 1],\n        sn = F[B_off + 2 * (m - 1 - (n < 0))]; // <- shift\n\n    for (var _i9 = n1; _i9 < m; _i9++) {\n      var di = F[B_off + 2 * _i9];\n      var zi = (sn - di + n) * (sn + di + n);\n\n      for (var j = n1; j < _i9; j++) {\n        var j = F[_off + j],\n            sj = F[B_off + 2 * (j - (j < 0))],\n            // <- shift\n        dj = F[B_off + 2 * j];\n        zi *= (sj - di + j) / (dj - di) * ((sj + di + j) / (dj + di));\n      }\n\n      for (var _j = _i9; _j < m - 1; _j++) {\n        var _j2 = F[_off + _j],\n            _sj = F[B_off + 2 * (_j - (_j2 < 0))],\n            // <- shift\n        _dj = F[B_off + 2 * _j + 2];\n        zi *= (_sj - di + _j2) / (_dj - di) * ((_sj + di + _j2) / (_dj + di));\n      }\n\n      F[B_off + 2 * _i9 + 1] = Math.sign(F[B_off + 2 * _i9 + 1]) * Math.sqrt(zi);\n    }\n  } // triple-merge-sort singular values from deflation\n  // and the ones from the secular equation solutions\n\n  for (var h = n0 - 1, _i10 = n1 - 1, _j3 = n1, k = 0; k < m; k++) {\n    var val = -Infinity,\n        best = 3;\n\n    if (_j3 < m) {\n      var _j4 = F[_off + _j3];\n      best = 2;\n      val = _j4 + F[B_off + 2 * (_j3 - (_j4 < 0))];\n    }\n\n    if (_i10 >= n0) {\n      var i = F[_off + _i10];\n\n      if (!(i < val)) {\n        best = 1;\n        val = i;\n      }\n    }\n\n    if (h >= 0) {\n      var h = F[_off + h];\n\n      if (!(h < val)) {\n        best = 0;\n        val = h;\n      }\n    }\n\n    switch (best) {\n      case 0:\n        I[inn_off + h--] = k;\n        continue;\n\n      case 1:\n        I[inn_off + _i10--] = k;\n        continue;\n\n      case 2:\n        I[inn_off + _j3++] = k;\n        continue;\n\n      default:\n        throw new Error('Assertion failed.');\n    }\n  } // STEP 5:\n  //   UPDATE U\n\n\n  for (var _i11 = n1; _i11 < m; _i11++) {\n    var _i12 = F[_off + _i11],\n        si = F[B_off + 2 * (_i11 - (_i12 < 0))]; // <- shift\n\n    NORM.reset();\n\n    for (var _j5 = n1; _j5 < m - 1; _j5++) {\n      var _dj2 = F[B_off + 2 * _j5],\n          zj = F[B_off + 2 * _j5 + 1],\n          W_ij = zj / (_dj2 - si - _i12) * (_dj2 / (_dj2 + si + _i12));\n      NORM.include(F[W_off + m * _i11 + _j5] = W_ij);\n    }\n\n    NORM.include(F[W_off + m * _i11 + m - 1] = -1);\n    var norm = NORM.result;\n    if (!(0 < norm)) throw new Error('Assertion failed.');\n\n    for (var _j6 = n1; _j6 < m; _j6++) {\n      F[W_off + m * _i11 + _j6] /= norm;\n    }\n  } // transpose dense part of W\n\n\n  for (var _i13 = n1; _i13 < m; _i13++) {\n    for (var _j7 = _i13; ++_j7 < m;) {\n      var _W_ij = F[W_off + m * _i13 + _j7];\n      F[W_off + m * _i13 + _j7] = F[W_off + m * _j7 + _i13];\n      F[W_off + m * _j7 + _i13] = _W_ij;\n    }\n  }\n\n  if (n0 < n1) {\n    // init deflated region in W\n    for (var _i14 = n0; _i14 < n1; _i14++) {\n      F.fill(0.0, W_off + m * _i14 + n0, W_off + m * _i14 + m);\n      F[W_off + m * _i14 + _i14] = 1;\n    }\n\n    for (var _i15 = n1; _i15 < m; _i15++) {\n      F.fill(0.0, W_off + m * _i15 + n0, W_off + m * _i15 + n1);\n    } // rotate W\n\n\n    for (var _i16 = n1; _i16-- > n0;) {\n      var _j8 = I[rot_off + _i16];\n\n      if (_j8 < m - 1) {\n        var c = F[B_off + 2 * _i16],\n            s = F[B_off + 2 * _i16 + 1];\n\n        Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_rows\"])(F, m - _i16, W_off + m * _i16 + _i16, W_off + m * _j8 + _i16, c, s);\n      }\n    }\n  } // UPDATE U: U = UW\n\n\n  for (var r = 0; r < m; r++) {\n    // compute dense part of row (matrix multiplication)\n    // U is fairly sparse so the matrix multiplication\n    // is designed to benefit from that fact\n    F.fill(0.0, mm_off + n0, mm_off + m);\n\n    for (var _i17 = n0; _i17 < m; _i17++) {\n      var U_ri = U[U_off + M * r + I[out_off + _i17]];\n      if (0 !== U_ri) for (var _j9 = n0; _j9 < m; _j9++) {\n        F[mm_off + _j9] += U_ri * F[W_off + m * _i17 + _j9];\n      }\n    } // compute deflated part of row\n\n\n    for (var _i18 = 0; _i18 < n0; _i18++) {\n      var _c = I[out_off + _i18];\n      F[mm_off + _i18] = U[U_off + M * r + _c];\n    } // write back row\n\n\n    for (var _i19 = 0; _i19 < m; _i19++) {\n      var _c2 = I[inn_off + _i19];\n      U[U_off + M * r + _c2] = F[mm_off + _i19];\n    }\n  } // STEP 6:\n  //   UPDATE V\n\n\n  for (var _i20 = n1; _i20 < m; _i20++) {\n    var _i21 = F[_off + _i20],\n        _si = F[B_off + 2 * (_i20 - (_i21 < 0))];\n    NORM.reset();\n\n    for (var _j10 = n1; _j10 < m; _j10++) {\n      var _dj3 = F[B_off + 2 * _j10],\n          _zj = F[B_off + 2 * _j10 + 1],\n          _W_ij2 = _zj / (_dj3 - _si - _i21) / (_dj3 + _si + _i21);\n\n      NORM.include(F[W_off + m * _i20 + _j10] = _W_ij2);\n    }\n\n    var _norm2 = NORM.result;\n    if (!(0 < _norm2 || _i20 === m - 1)) throw new Error('Assertion failed: ' + _norm2);\n\n    for (var _j11 = n1; _j11 < m; _j11++) {\n      F[W_off + m * _i20 + _j11] /= _norm2;\n    }\n  }\n\n  if (0 === F[B_off + 2 * m - 1]) {\n    for (var _i22 = n1; _i22 < m - 1; _i22++) {\n      F[W_off + m * (m - 1) + _i22] = 0;\n    }\n\n    F[W_off + m * (m - 1) + (m - 1)] = 1;\n  } // transpose dense part of W\n\n\n  for (var _i23 = n1; _i23 < m; _i23++) {\n    for (var _j12 = _i23; ++_j12 < m;) {\n      var _W_ij3 = F[W_off + m * _i23 + _j12];\n      F[W_off + m * _i23 + _j12] = F[W_off + m * _j12 + _i23];\n      F[W_off + m * _j12 + _i23] = _W_ij3;\n    }\n  }\n\n  if (n0 < n1) {\n    // init deflated region in W\n    for (var _i24 = n0; _i24 < n1; _i24++) {\n      F.fill(0.0, W_off + m * _i24 + n0, W_off + m * _i24 + m);\n      F[W_off + m * _i24 + _i24] = 1;\n    }\n\n    for (var _i25 = n1; _i25 < m; _i25++) {\n      F.fill(0.0, W_off + m * _i25 + n0, W_off + m * _i25 + n1);\n    } // rotate W\n\n\n    for (var _i26 = n1; _i26-- > n0;) {\n      var _j13 = I[rot_off + _i26],\n          _c3 = F[B_off + 2 * _i26],\n          _s = F[B_off + 2 * _i26 + 1];\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_rows\"])(F, m - _i26, W_off + m * _i26 + _i26, W_off + m * _j13 + _i26, _c3, _s);\n    }\n  } // UPDATE V: V = VW\n\n\n  for (var _r = 0; _r < n; _r++) {\n    // compute dense part of row (matrix multiplication)\n    // U is fairly sparse so the matrix multiplication\n    // is designed to benefit from that fact\n    F.fill(0.0, mm_off + n0, mm_off + m);\n\n    for (var _i27 = n0; _i27 < m; _i27++) {\n      var V_ri = F[V_off + N * _r + I[out_off + _i27]];\n      if (0 !== V_ri) for (var _j14 = n0; _j14 < m; _j14++) {\n        F[mm_off + _j14] += V_ri * F[W_off + m * _i27 + _j14];\n      }\n    } // compute deflated part of row\n\n\n    for (var _i28 = 0; _i28 < n0; _i28++) {\n      var _c4 = I[out_off + _i28];\n      F[mm_off + _i28] = F[V_off + N * _r + _c4];\n    } // write back row\n\n\n    for (var _i29 = 0; _i29 < m; _i29++) {\n      var _c5 = I[inn_off + _i29];\n      F[V_off + N * _r + _c5] = F[mm_off + _i29];\n    }\n  } // STEP 7:\n  //   GENERAL POSTPROCESSING\n\n\n  for (var _i30 = n1; _i30 < m; _i30++) {\n    F[_off + _i30] += F[B_off + 2 * (_i30 - (F[_off + _i30] < 0))];\n  }\n\n  for (var _i31 = 0; _i31 < m; _i31++) {\n    var _j15 = I[inn_off + _i31];\n    F[B_off + 2 * _j15] = F[_off + _i31] * scale;\n    F[B_off + 2 * _j15 + 1] = NaN; // <- TEST ONLY\n  }\n};\n/* Computes the svd of an upper bidiagonal matrix inplace.\n * The bidiagonal matrix is stored in a memory efficient\n * banded memory format where B[B_off+2*i] is the diagonal\n * entry B(i,i) and B[B_off+2*i+1] is the off-diagonal\n * element B(i,i+1).\n */\n\nfunction _svd_dc_bidiag(N, n, U, U_off, F, B_off, V_off, I) {\n  // TODO:\n  //   Replacing this recursion with a loop would likely\n  //   increase performance by a significant amount\n  // TODO:\n  //   For small enough bidiagonal matrices (around m <= 64),\n  //   the QR method could be used to compute the SVD not just\n  //   fast but also more accurately, see:\n  //     * \"Accurate Singular Values of Bidiagonal Matrices\"\n  //       by James Demmel & W. Kahan\n  //       Lapack Working Note (LAWN) No. 3\n  //       http://www.netlib.org/lapack/lawnspdf/lawn03.pdf\n  //     * \"Computing Small Singular Values of Bidiagonal Matrices with Guaranteed High Relative Accuracy\"\n  //       by James Demmel & W. Kahan\n  if (n > N) throw new Error('Assertion failed.');\n  if (1 >= n) throw new Error('Assertion failed.');\n  if (2 === n) return _svd_dc_1x2(N, U, U_off, F, B_off, V_off);\n  if (3 === n) return _svd_dc_2x3(N, U, U_off, F, B_off, V_off);\n  var M = N - 1,\n      m = n - 1,\n      n0 = n >>> 1,\n      m0 = n0 - 1;\n  if (I.length < M) throw new Error('Assertion failed: Integer work matrix I too small.');\n  if (F.length < M * 2) throw new Error('Assertion failed: Scalar work matrix F too small.'); // STEP 1: DIVIDE\n  // --------------\n  // The idea is to divide the bidiagonal matrix into an upper left block B1 and\n  // a lower right block B2 with one row of the bidiagonal with the non-zero entries\n  // b1 and b2 separating the two blocks.\n  //                                                      \n  //                                                    \n  //           B1                    U1S1V1           \n  //                                                    \n  //              (SVD)       \n  //   B =        b1b2         =         b1b2       \n  //                          \n  //                                                    \n  //                     B2                    U2S2V2 \n  //                                                    \n  //                                                      \n\n  _svd_dc_bidiag(N, n0, U, U_off, F, B_off, V_off, I);\n\n  _svd_dc_bidiag(N, n - n0, U, U_off + M * n0 + n0, F, B_off + 2 * n0, V_off + N * n0 + n0, I);\n\n  U[U_off + M * m0 + m0] = 1;\n  var b1 = F[B_off + 2 * m0],\n      b2 = F[B_off + 2 * m0 + 1]; //  if( ! isFinite(b1) ) throw new Error('Assertion failed.');\n  //  if( ! isFinite(b2) ) throw new Error('Assertion failed.');\n  // The orthogonal matrix U1,U2,V1,V2 can moved to separate left and right orthogonal\n  // matrices. V1[-1] is the last row of the transpose of V1. V2[0] is the first row of\n  // the transpose of V2.                                                                        \n  //                                                                                      \n  //                                                                                  \n  //      U1S1V1                U1              S1'  0              V1              \n  //                                                                                  \n  //                                           \n  // B =        b1b2        =       1       b1V1[-1]b2V2[0] \n  //                                           \n  //                                                                                  \n  //                U2S2V2              U2                S2' 0               V2    \n  //                                                                                  \n  //                                                                                      \n  //                                                                                             \n\n  for (var i = 0; i < m0; i++) {\n    F[B_off + 2 * i + 1] = b1 * F[V_off + N * m0 + i];\n  }\n\n  for (var _i34 = n0; _i34 < m; _i34++) {\n    F[B_off + 2 * _i34 + 1] = b2 * F[V_off + N * n0 + _i34];\n  } // With the following definitions:\n  //                               \n  //   b1V1[-1] =:     R1     r1 \n  //                               \n  //                               \n  //   b2V2[ 0] =:     R2     r2 \n  //                               \n  //   h := (r1 + r2)\n  //   c = r1 / h\n  //   s = r2 / h\n  //                      \n  //                      \n  //               W1     \n  //   V1 =:              \n  //         \n  //               w1     \n  //                      \n  //                      \n  //                      \n  //               W2     \n  //   V2 =:              \n  //         \n  //               w2     \n  //                      \n  // And a single Givens rotation, we can make the right-most column of the middle matrix zero.\n  //                                                                                                                                        \n  //                                                                                                                              \n  //                                                                                                         W1             \n  //         U1              S1'   0               V1                   U1              S1'  0                              \n  //                                                                                                    \n  //                                                 c*w1     s*w2    \n  //   B =       1          R1   r1  R2   r2  =       1          R1   h  R2     \n  //                                                                   \n  //                                                                                                  0               W2    \n  //                 U2                 S2'  0               V2                 U2                S2'                       \n  //                                                                                                    \n  //                                                                                                            -s*w1     c*w2    \n  //                                                                                                                                        \n\n\n  var _giv_rot_qr10 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(b1 * F[V_off + N * m0 + m0], b2 * F[V_off + N * n0 + m]),\n      _giv_rot_qr11 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr10, 3),\n      c = _giv_rot_qr11[0],\n      s = _giv_rot_qr11[1],\n      h = _giv_rot_qr11[2]; //  if( ! isFinite(h) ) throw new Error('Assertion failed.'); \n\n\n  F[B_off + 2 * m0] = 0;\n  F[B_off + 2 * m0 + 1] = h;\n\n  if (0 !== h) {\n    for (var _i35 = 0; _i35 < n0; _i35++) {\n      F[V_off + N * _i35 + m] = F[V_off + N * _i35 + m0] * -s;\n      F[V_off + N * _i35 + m0] *= c;\n    }\n\n    for (var _i36 = n0; _i36 < n; _i36++) {\n      F[V_off + N * _i36 + m0] = F[V_off + N * _i36 + m] * s;\n      F[V_off + N * _i36 + m] *= c;\n    }\n  } // STEP 2: CONQUER\n  // ---------------\n  // After step 1, row and column swaps can be used to turn the middle matrix into a Neves matrix.\n  // See _svd_dc_neves() for more information about the shape of the Neves matrix. An integer array\n  // called the \"outer order\" is used to keep track of the row and column swaps. The outer order\n  // indicates where the rows and column of the middle matrix have originaally been.\n\n\n  I[m - 1] = m0; // merge sort diagonal entries\n\n  for (var _i37 = 0, j = n0, k = 0; k < m - 1; k++) {\n    I[k] = j >= m || _i37 < m0 && F[B_off + 2 * _i37] >= F[B_off + 2 * j] ? _i37++ : j++;\n  } //  if( I.slice(0,m).sort().some((i,j) => i !== j) ) throw new Error('Assertion failed.');\n\n\n  for (var _i38 = 0; _i38 < m; _i38++) {\n    var _j16 = I[_i38];\n    F[2 * _i38] = F[B_off + 2 * _j16];\n    F[2 * _i38 + 1] = F[B_off + 2 * _j16 + 1];\n  }\n\n  for (var _i39 = 0; _i39 < m; _i39++) {\n    F[B_off + 2 * _i39] = F[2 * _i39];\n    F[B_off + 2 * _i39 + 1] = F[2 * _i39 + 1];\n  }\n\n  _svd_dc_neves(N, n, U, U_off, F, B_off, V_off, I);\n}\nfunction _svd_dc(M, N, U, U_off, sv, sv_off, V, V_off, I, F) {\n  if (M > N) throw new Error('Assertion failed.');\n  if (I.length < M * 3) throw new Error('Assertion failed: Integer work matrix I too small.');\n  if (F.length < M * (M + 2) + M * 2 + (M + 1) * (M + 1) + (M + 1) * N) throw new Error('Assertion failed: Scalar work matrix F too small.');\n  var B_off = M * (M + 2),\n      V1_off = B_off + M * 2,\n      V2_off = V1_off + (M + 1) * (M + 1);\n  F.fill(0.0, V1_off, V2_off + N); // COPY A FROM V TO V2\n\n  for (var i = 0; i < M; i++) {\n    for (var j = 0; j < N; j++) {\n      F[V2_off + N + N * i + j] = V[V_off + N * i + j];\n    }\n  }\n\n  V.fill(0.0, V_off, V_off + M * N);\n\n  Object(_bidiag__WEBPACK_IMPORTED_MODULE_7__[\"_bidiag_decomp_horiz\"])(M, N, U, U_off, F, 0, F, V2_off);\n\n  for (var _i40 = 0; _i40 < M; _i40++) {\n    F[B_off + 2 * _i40] = F[(M + 1) * _i40 + _i40];\n    F[B_off + 2 * _i40 + 1] = F[(M + 1) * _i40 + _i40 + 1];\n  }\n\n  _svd_dc_bidiag(M + 1, M + 1, V, V_off, F, B_off, V1_off, I);\n\n  for (var _i41 = 0; _i41 < M; _i41++) {\n    sv[sv_off + _i41] = F[B_off + 2 * _i41];\n  } // update U = U @ U2 (U2 is stored in V)\n\n\n  for (var _i42 = 0; _i42 < M; _i42++) {\n    F.fill(0.0, 0, M);\n\n    for (var k = 0; k < M; k++) {\n      for (var _j17 = 0; _j17 < M; _j17++) {\n        F[_j17] += U[U_off + M * _i42 + k] * V[V_off + M * k + _j17];\n      }\n    }\n\n    for (var _j18 = 0; _j18 < M; _j18++) {\n      U[U_off + M * _i42 + _j18] = F[_j18];\n    }\n  } // update V = V1 @ V2 (keep in mind that VV was computed in a transposed/column-major fashion)\n\n\n  V.fill(0.0, V_off, V_off + M * M);\n\n  for (var _k = 0; _k < M + 1; _k++) {\n    for (var _i43 = 0; _i43 < M; _i43++) {\n      for (var _j19 = 0; _j19 < N; _j19++) {\n        V[V_off + N * _i43 + _j19] += F[V1_off + (M + 1) * _k + _i43] * F[V2_off + N * _k + _j19];\n      }\n    }\n  }\n}\nfunction svd_dc(A) {\n  // SEE:\n  //  - \"INTRODUCTION OF DOUBLE DIVIDE AND CONQUER AND THE RECENT PROGRESS\", TARO KONDA & YOSHIMASA NAKAMURA\n  //  - \"A Divide-and-Conquer Approach for Solving Singular Value Decomposition on a Heterogeneous System\", Ding Liu & Ruixuan Li & David J. Lilja & Weijun Xiao\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n  if (A.dtype.startsWith('complex')) throw new Error('svd_dc(A): A.dtype must be float.');\n\n  var _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      M = _A$shape$slice2[0],\n      N = _A$shape$slice2[1];\n\n  if (M > N) {\n    var _svd_dc2 = svd_dc(A.T),\n        _svd_dc3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_dc2, 3),\n        _U = _svd_dc3[0],\n        _sv = _svd_dc3[1],\n        _V = _svd_dc3[2];\n\n    Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_3__[\"transpose_inplace\"])(_U);\n    return [_V.T, _sv, _U];\n  }\n\n  var V_shape = A.shape,\n      U_shape = V_shape.slice(),\n      sv_shape = V_shape.slice(0, -1);\n  U_shape[U_shape.length - 1] = M;\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][DType];\n  A = A.data;\n  var len = A.length / (M * N),\n      V = DTypeArray.from(A);\n  A = undefined;\n  var U = new DTypeArray(len * M * M),\n      sv = new DTypeArray(len * M),\n      F = new DTypeArray(M * (M + 2)\n  /*F*/\n  + M * 2\n  /*B*/\n  + (M + 1) * (M + 1)\n  /*V1*/\n  + (M + 1) * Math.max(1 + M, N)\n  /*V2*/\n  ),\n      I = new Int32Array(M * 3);\n\n  for (var U_off = 0, sv_off = 0, V_off = 0; sv_off < sv.length; U_off += M * M, sv_off += M, V_off += M * N) {\n    _svd_dc(M, N, U, U_off, sv, sv_off, V, V_off, I, F);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](U_shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](sv_shape, sv), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](V_shape, V)];\n}\n\n//# sourceURL=webpack://nd/./src/la/svd_dc.js?");

/***/ }),

/***/ "./src/la/svd_jac_2sided.js":
/*!**********************************!*\
  !*** ./src/la/svd_jac_2sided.js ***!
  \**********************************/
/*! exports provided: svd_jac_2sided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_2sided\", function() { return svd_jac_2sided; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _matmul__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./matmul */ \"./src/la/matmul.js\");\n/* harmony import */ var _qr__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./qr */ \"./src/la/qr.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./_svd_jac_utils */ \"./src/la/_svd_jac_utils.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nfunction svd_jac_2sided(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(A);\n  if (A.dtype.startsWith('complex')) throw new Error('svd_jac_1sided(A): A.dtype must be float.');\n  var shape = A.shape,\n      N = shape[shape.length - 2] | 0; // QR DECOMPOSE RECTANGULAR MATRICES AND WORK ON (QUADRATIC) R\n\n  {\n    var M = shape[shape.length - 1]; // if A is not square use QR Decomposition\n\n    if (N > M) {\n      var _qr_decomp = Object(_qr__WEBPACK_IMPORTED_MODULE_4__[\"qr_decomp\"])(A),\n          _qr_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp, 2),\n          Q = _qr_decomp2[0],\n          R = _qr_decomp2[1],\n          _svd_jac_2sided = svd_jac_2sided(R),\n          _svd_jac_2sided2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_2sided, 3),\n          _U = _svd_jac_2sided2[0],\n          _sv = _svd_jac_2sided2[1],\n          _V = _svd_jac_2sided2[2];\n\n      return [Object(_matmul__WEBPACK_IMPORTED_MODULE_3__[\"matmul2\"])(Q, _U), _sv, _V];\n    }\n\n    if (N < M) {\n      var _qr_decomp3 = Object(_qr__WEBPACK_IMPORTED_MODULE_4__[\"qr_decomp\"])(A.T),\n          _qr_decomp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp3, 2),\n          _Q = _qr_decomp4[0],\n          _R = _qr_decomp4[1],\n          _svd_jac_2sided3 = svd_jac_2sided(_R),\n          _svd_jac_2sided4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_2sided3, 3),\n          _U2 = _svd_jac_2sided4[0],\n          _sv2 = _svd_jac_2sided4[1],\n          _V2 = _svd_jac_2sided4[2];\n\n      Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"transpose_inplace\"])(_V2);\n      return [_V2, _sv2, Object(_matmul__WEBPACK_IMPORTED_MODULE_3__[\"matmul2\"])(_Q, _U2).T];\n    }\n  } // ALLOCATE RESULT DATA\n\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][DType],\n      TOL = Math.pow(N * Object(_dt__WEBPACK_IMPORTED_MODULE_1__[\"eps\"])(DType), 2),\n      B = DType === 'float32' ? 64 / 4 : 64 / 8,\n      // <- block size should match cache line size\n  U = DTypeArray.from(A.data);\n  A = undefined; // <- potentially allow GC\n\n  var S = new DTypeArray(N * N),\n      // <- tempory storage for decomposition\n  V = new DTypeArray(U.length),\n      sv = new DTypeArray(U.length / N),\n      ord = Int32Array.from({\n    length: N\n  }, function (_, i) {\n    return i;\n  });\n  if (1 > N) throw new Error('Assertion failed.');\n\n  if (1 == N) {\n    for (var i = U.length; i-- > 0;) {\n      if (U[i] < +0.0) {\n        U[i] *= -1.0;\n        sv[i] = -1.0;\n      } else sv[i] = +1.0;\n    }\n\n    return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, sv), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape.slice(0, -1), U), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, V.fill(1))];\n  }\n\n  for (var UV_off = 0, sv_off = 0; sv_off < sv.length; UV_off += N * N, sv_off += N) {\n    // MOVE FROM U TO S\n    for (var _i = 0; _i < N; _i++) {\n      for (var j = 0; j < N; j++) {\n        S[N * _i + j] = U[UV_off + N * _i + j];\n        U[UV_off + N * _i + j] = +(_i === j);\n      }\n    }\n\n    ; // INIT V TO IDENTITY\n\n    for (var _i2 = 0; _i2 < N; _i2++) {\n      for (var _j = 0; _j < N; _j++) {\n        V[UV_off + N * _i2 + _j] = +(_i2 === _j);\n      }\n    } //\n    // JACOBI SVD ITERATIONS\n    //\n\n\n    for (var finished = false; !finished;) {\n      finished = true; // SWEEP\n\n      for (var _Q2 = 0; _Q2 < N; _Q2 += B) {\n        for (var P = 0; P <= _Q2; P += B) {\n          for (var q = _Q2; q < _Q2 + B && q < N; q++) {\n            for (var p = P; p < P + B && p < q; p++) {\n              var S_pp = S[N * p + p],\n                  S_pq = S[N * p + q],\n                  S_qp = S[N * q + p],\n                  S_qq = S[N * q + q]; // stopping criterion inspiredy by:\n              //  \"Jacobi's Method is More Accurate than QR\"\n              //   by James Demmel\n              //   SIAM J. Matrix Anal. Appl, vol. 13, pp. 1204-1245, 1992\n\n              if (!(S_pq * S_pq + S_qp * S_qp > Math.abs(S_pp * S_qq) * TOL)) continue;\n              finished = false;\n\n              var _svd_jac_angles2 = Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__[\"_svd_jac_angles\"])(S_pp, S_pq, S_qp, S_qq),\n                  _svd_jac_angles3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_angles2, 4),\n                  c = _svd_jac_angles3[0],\n                  s = _svd_jac_angles3[1],\n                  c = _svd_jac_angles3[2],\n                  s = _svd_jac_angles3[3]; // ROTATE S\n\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_rows\"])(S, N, N * p, N * q, c, s);\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_cols\"])(S, N, p, q, c, s); // ENTRIES (k,l) AND (l,k) ARE REMAINDERS (CANCELLATION ERROR) FROM ELIMINATION => SHOULD BE SAFELY ZEROABLE\n\n\n              S[N * p + q] = S[N * q + p] = 0.0; // ROTATE U & V\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_rows\"])(U, N, UV_off + N * p, UV_off + N * q, c, s);\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_rows\"])(V, N, UV_off + N * p, UV_off + N * q, c, -s);\n            }\n          }\n        }\n      }\n    }\n\n    Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__[\"_svd_jac_post\"])(N, U, S, V, UV_off, sv, sv_off, ord);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape.slice(0, -1), sv), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, V)];\n}\n\n//# sourceURL=webpack://nd/./src/la/svd_jac_2sided.js?");

/***/ }),

/***/ "./src/la/svd_jac_2sided_blocked.js":
/*!******************************************!*\
  !*** ./src/la/svd_jac_2sided_blocked.js ***!
  \******************************************/
/*! exports provided: svd_jac_2sided_blocked */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_2sided_blocked\", function() { return svd_jac_2sided_blocked; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _matmul__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./matmul */ \"./src/la/matmul.js\");\n/* harmony import */ var _qr__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./qr */ \"./src/la/qr.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./_svd_jac_utils */ \"./src/la/_svd_jac_utils.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nvar B = 4,\n    // <- block size should match cache line size\nBB = B * B; // The memory of `S` is organized in a tiled order with a tile size\n// of [B,B]. If for example BR=2 and BC=3, a matrix of shape [4,6]\n// would have the following memory order.\n//                        \n//   0  1    4  5    8  9 \n//   2  3    6  7   10 11 \n//                        \n//  12 13   16 17   20 21 \n//  14 15   18 19   22 23 \n//                        \n// The purpose of this memory order is to make column (Givens) rotations\n// faster.\n//\n// Let's say the cache line size is L. If we had a fortran-style,\n// column major memory order that would correspond to a tile size of\n// [L,1]. Say we have an [L,L] block and we want to access one row and\n// one column of it. Accessing the column requires L cache lines to be\n// read/written. Accessing the row only takes one cache line for a\n// total of (L+1) cache lines.\n//\n// If we, on the other hand, used a tile size of [(L),(L)], both\n// row and column access would require (L) cache lines to be\n// read/written each for a total of only 2*(L) cache lines.\n//\n// ('B' as in Block)\n//\n// A power of two square block size is chosen such that it barely fits\n// at least on cache line (64 bytes).\n//\n// Some quick and dirty tests have shown that is this method is faster\n// for matrix sizes 800 and above.\n\nfunction svd_jac_2sided_blocked(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(A);\n  if (A.dtype.startsWith('complex')) throw new Error('svd_jac_1sided(A): A.dtype must be float.');\n  var shape = A.shape,\n      N = shape[shape.length - 2] | 0; // QR DECOMPOSE RECTANGULAR MATRICES AND WORK ON (QUADRATIC) R\n\n  {\n    var M = shape[shape.length - 1]; // if A is not square use QR Decomposition\n\n    if (N > M) {\n      var _qr_decomp = Object(_qr__WEBPACK_IMPORTED_MODULE_4__[\"qr_decomp\"])(A),\n          _qr_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp, 2),\n          Q = _qr_decomp2[0],\n          R = _qr_decomp2[1],\n          _svd_jac_2sided_block = svd_jac_2sided_blocked(R),\n          _svd_jac_2sided_block2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_2sided_block, 3),\n          _U = _svd_jac_2sided_block2[0],\n          _sv = _svd_jac_2sided_block2[1],\n          _V = _svd_jac_2sided_block2[2];\n\n      return [Object(_matmul__WEBPACK_IMPORTED_MODULE_3__[\"matmul2\"])(Q, _U), _sv, _V];\n    }\n\n    if (N < M) {\n      var _qr_decomp3 = Object(_qr__WEBPACK_IMPORTED_MODULE_4__[\"qr_decomp\"])(A.T),\n          _qr_decomp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_qr_decomp3, 2),\n          _Q = _qr_decomp4[0],\n          _R = _qr_decomp4[1],\n          _svd_jac_2sided_block3 = svd_jac_2sided_blocked(_R),\n          _svd_jac_2sided_block4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_2sided_block3, 3),\n          _U2 = _svd_jac_2sided_block4[0],\n          _sv2 = _svd_jac_2sided_block4[1],\n          _V2 = _svd_jac_2sided_block4[2];\n\n      Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_5__[\"transpose_inplace\"])(_V2);\n      return [_V2, _sv2, Object(_matmul__WEBPACK_IMPORTED_MODULE_3__[\"matmul2\"])(_Q, _U2).T];\n    }\n  } // ALLOCATE RESULT DATA\n\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][DType],\n      TOL = Math.pow(N * Object(_dt__WEBPACK_IMPORTED_MODULE_2__[\"eps\"])(DType), 2),\n      n = Math.ceil(N / B) | 0,\n      U = DTypeArray.from(A.data);\n  A = undefined; // <- potentially allow GC\n\n  var S = new DTypeArray(n * n * B * B),\n      // <- tempory storage for decomposition\n  V = new DTypeArray(U.length),\n      sv = new DTypeArray(U.length / N),\n      ord = Int32Array.from({\n    length: N\n  }, function (_, i) {\n    return i;\n  });\n  if (1 > N) throw new Error('Assertion failed.');\n\n  if (1 == N) {\n    for (var i = U.length; i-- > 0;) {\n      if (U[i] < +0.0) {\n        U[i] *= -1.0;\n        sv[i] = -1.0;\n      } else sv[i] = +1.0;\n    }\n\n    return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, sv), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape.slice(0, -1), U), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, V.fill(1))];\n  }\n\n  for (var UV_off = 0, sv_off = 0; sv_off < sv.length; UV_off += N * N, sv_off += N) {\n    // MOVE FROM U TO S\n    for (var _i = 0; _i < N; _i++) {\n      for (var j = 0; j < N; j++) {\n        var k = BB * (n * (_i / B | 0) + (j / B | 0)) + B * (_i % B) + j % B | 0;\n        S[k] = U[UV_off + N * _i + j];\n        U[UV_off + N * _i + j] = +(_i === j);\n      }\n    }\n\n    ; // INIT V TO IDENTITY\n\n    for (var _i2 = 0; _i2 < N; _i2++) {\n      for (var _j = 0; _j < N; _j++) {\n        V[UV_off + N * _i2 + _j] = +(_i2 === _j);\n      }\n    } //\n    // JACOBI SVD ITERATIONS\n    //\n\n\n    for (var finished = false; !finished;) {\n      finished = true;\n\n      for (var _Q2 = n; _Q2-- > 0;) {\n        for (var P = _Q2; P >= 0; P--) {\n          for (var q = B; q-- > 0;) {\n            for (var p = P === _Q2 ? q : B; p-- > 0;) {\n              var S_pp = S[BB * (n * P + P) + B * p + p],\n                  S_pq = S[BB * (n * P + _Q2) + B * p + q],\n                  S_qp = S[BB * (n * _Q2 + P) + B * q + p],\n                  S_qq = S[BB * (n * _Q2 + _Q2) + B * q + q]; // stopping criterion inspiredy by:\n              //  \"Jacobi's Method is More Accurate than QR\"\n              //   by James Demmel\n              //   SIAM J. Matrix Anal. Appl, vol. 13, pp. 1204-1245, 1992\n\n              if (!(S_pq * S_pq + S_qp * S_qp > Math.abs(S_pp * S_qq) * TOL)) continue;\n              finished = false;\n\n              var _svd_jac_angles2 = Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__[\"_svd_jac_angles\"])(S_pp, S_pq, S_qp, S_qq),\n                  _svd_jac_angles3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_svd_jac_angles2, 4),\n                  c = _svd_jac_angles3[0],\n                  s = _svd_jac_angles3[1],\n                  c = _svd_jac_angles3[2],\n                  s = _svd_jac_angles3[3]; // ROTATE ROWS IN S\n\n\n              for (var _i3 = P * n * BB + p * B, _j2 = _Q2 * n * BB + q * B, I = _i3 + n * BB; _i3 < I; _i3 += BB, _j2 += BB) {\n                for (var _k = 0; _k < B; _k++) {\n                  var S_ki = c * S[_k + _i3] + s * S[_k + _j2];\n                  S[_k + _j2] = -s * S[_k + _i3] + c * S[_k + _j2];\n                  S[_k + _i3] = S_ki;\n                }\n              } // ROTATE COLUMNS IN S\n\n\n              for (var _i4 = P * BB + p + n * n * B * B, _j3 = _Q2 * BB + q + n * n * B * B; (_i4 -= n * BB) >= 0;) {\n                _j3 -= n * BB;\n\n                for (var _k2 = BB; (_k2 -= B) >= 0;) {\n                  var S_ik = S[_i4 + _k2] * c + S[_j3 + _k2] * -s;\n                  S[_j3 + _k2] = S[_i4 + _k2] * s + S[_j3 + _k2] * c;\n                  S[_i4 + _k2] = S_ik;\n                }\n              } // ENTRIES (k,l) AND (l,k) ARE REMAINDERS (CANCELLATION ERROR) FROM ELIMINATION => SHOULD BE SAFELY ZEROABLE\n\n\n              S[BB * (n * P + _Q2) + B * p + q] = S[BB * (n * _Q2 + P) + B * q + p] = 0.0;\n              var rowP = UV_off + N * (B * P + p),\n                  rowQ = UV_off + N * (B * _Q2 + q); // ROTATE U & V\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_rows\"])(U, N, rowP, rowQ, c, s);\n\n              Object(_giv_rot__WEBPACK_IMPORTED_MODULE_7__[\"_giv_rot_rows\"])(V, N, rowP, rowQ, c, -s);\n            }\n          }\n        }\n      }\n    }\n\n    for (var _i5 = 0; _i5 < N; _i5++) {\n      var _k3 = BB * (n + 1) * (_i5 / B | 0) + (B + 1) * (_i5 % B) | 0;\n\n      sv[sv_off + _i5] = S[_k3];\n    }\n\n    Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_6__[\"_svd_jac_post_skip1\"])(N, U, V, UV_off, sv, sv_off, ord);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape.slice(0, -1), sv), new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, V)];\n}\n\n//# sourceURL=webpack://nd/./src/la/svd_jac_2sided_blocked.js?");

/***/ }),

/***/ "./src/la/svd_jac_classic.js":
/*!***********************************!*\
  !*** ./src/la/svd_jac_classic.js ***!
  \***********************************/
/*! exports provided: svd_jac_classic */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"svd_jac_classic\", function() { return svd_jac_classic; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _matmul__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./matmul */ \"./src/la/matmul.js\");\n/* harmony import */ var _qr__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./qr */ \"./src/la/qr.js\");\n/* harmony import */ var _transpose_inplace__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transpose_inplace */ \"./src/la/transpose_inplace.js\");\n/* harmony import */ var _svd_jac_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_svd_jac_utils */ \"./src/la/_svd_jac_utils.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\nfunction svd_jac_classic(A) {\n  A = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(A);\n  if (A.dtype.startsWith('complex')) throw new Error('svd_jac_1sided(A): A.dtype must be float.');\n  var shape = A.shape,\n      N = shape[shape.length - 2]; // QR DECOMPOSE RECTANGULAR MATRICES AND WORK ON (QUADRATIC) R\n\n  {\n    var M = shape[shape.length - 1]; // if A is not square use QR Decomposition\n\n    if (N > M) {\n      var _qr_decomp = Object(_qr__WEBPACK_IMPORTED_MODULE_5__[\"qr_decomp\"])(A),\n          _qr_decomp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_qr_decomp, 2),\n          Q = _qr_decomp2[0],\n          R = _qr_decomp2[1],\n          _svd_jac_classic = svd_jac_classic(R),\n          _svd_jac_classic2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_svd_jac_classic, 3),\n          _U = _svd_jac_classic2[0],\n          _sv = _svd_jac_classic2[1],\n          _V = _svd_jac_classic2[2];\n\n      return [Object(_matmul__WEBPACK_IMPORTED_MODULE_4__[\"matmul2\"])(Q, _U), _sv, _V];\n    }\n\n    if (N < M) {\n      var _qr_decomp3 = Object(_qr__WEBPACK_IMPORTED_MODULE_5__[\"qr_decomp\"])(A.T),\n          _qr_decomp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_qr_decomp3, 2),\n          _Q = _qr_decomp4[0],\n          _R = _qr_decomp4[1],\n          _svd_jac_classic3 = svd_jac_classic(_R),\n          _svd_jac_classic4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_svd_jac_classic3, 3),\n          _U2 = _svd_jac_classic4[0],\n          _sv2 = _svd_jac_classic4[1],\n          _V2 = _svd_jac_classic4[2];\n\n      Object(_transpose_inplace__WEBPACK_IMPORTED_MODULE_6__[\"transpose_inplace\"])(_V2);\n      return [_V2, _sv2, Object(_matmul__WEBPACK_IMPORTED_MODULE_4__[\"matmul2\"])(_Q, _U2).T];\n    }\n  } // ALLOCATE RESULT DATA\n\n  var DType = A.dtype === 'float32' ? 'float32' : 'float64',\n      DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][DType],\n      TOL = Object(_dt__WEBPACK_IMPORTED_MODULE_2__[\"eps\"])(DType) * N,\n      U = DTypeArray.from(A.data);\n  A = undefined; // <- potentially allow GC\n\n  var S = new DTypeArray(N * N),\n      // <- tempory storage for decomposition\n  V = new DTypeArray(U.length),\n      sv = new DTypeArray(U.length / N),\n      diag = new DTypeArray(N),\n      ord = Int32Array.from({\n    length: N\n  }, function (_, i) {\n    return i;\n  });\n  if (1 > N) throw new Error('Assertion failed.');\n\n  if (1 === N) {\n    for (var i = U.length; i-- > 0;) {\n      if (U[i] < +0.0) {\n        U[i] *= -1.0;\n        sv[i] = -1.0;\n      } else sv[i] = +1.0;\n    }\n\n    return [new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, sv), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape.slice(0, -1), U), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, V.fill(1))];\n  } //\n  // BUILD TRIANGLE TREE\n  //\n  // the size of each level of the tree\n\n\n  var treeSizes = Int32Array.from( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n    var n;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            n = N;\n\n          case 1:\n            if (!(n > 1)) {\n              _context.next = 7;\n              break;\n            }\n\n            n = n + 1 >>> 1;\n            _context.next = 5;\n            return n;\n\n          case 5:\n            _context.next = 1;\n            break;\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })());\n  var treeData = new DTypeArray(treeSizes.reduce(function (len, N) {\n    return len + (N * N + N >>> 1);\n  }, 0)); //*DEBUG*/  const piv = (i,j) => {\n  //*DEBUG*/    const S_ij = S[N*i+j],\n  //*DEBUG*/          S_ji = S[N*j+i];\n  //*DEBUG*/    return S_ij*S_ij + S_ji*S_ji;\n  //*DEBUG*/  };\n\n  var find_pivot = function find_pivot() {\n    var k = 0,\n        l = 0,\n        i = 0,\n        j = 0;\n\n    var _loop = function _loop(_off, h) {\n      var val = function val(k, l) {\n        k += i;\n        l += j;\n        off = _off;\n        return treeData[_off + (k * k + k >>> 1) + l];\n      };\n\n      var n = treeSizes[h];\n      _off -= n * n + n >>> 1;\n      var max = val(0, 0);\n      k = i;\n      l = j;\n\n      if (i + 1 < n) {\n        var v10 = val(1, 0);\n\n        if (v10 > max) {\n          max = v10;\n          k = i + 1;\n          l = j;\n        }\n\n        var v11 = val(1, 1);\n\n        if (v11 > max) {\n          max = v11;\n          k = i + 1;\n          l = j + 1;\n        }\n      }\n\n      if (i != j) {\n        var v01 = val(0, 1);\n\n        if (v01 > max) {\n          max = v01;\n          k = i;\n          l = j + 1;\n        }\n      }\n\n      i = 2 * k;\n      j = 2 * l;\n      off = _off;\n    };\n\n    for (var off = treeData.length, h = treeSizes.length; h-- > 0;) {\n      _loop(off, h);\n    }\n\n    var max = -Infinity;\n\n    var hyp = function hyp(s, t) {\n      s += i;\n      t += j;\n      var S_st = S[N * s + t],\n          S_ts = S[N * t + s];\n      return S_st * S_st + S_ts * S_ts;\n    };\n\n    if (i + 1 < N) {\n      var h10 = hyp(1, 0);\n\n      if (h10 > max) {\n        max = h10;\n        k = i + 1;\n        l = j;\n      }\n    }\n\n    if (j + 1 < N) {\n      var h01 = hyp(0, 1);\n\n      if (h01 > max) {\n        max = h01;\n        k = i;\n        l = j + 1;\n      }\n    }\n\n    if (i != j) {\n      var h00 = hyp(0, 0);\n\n      if (h00 > max) {\n        max = h00;\n        k = i;\n        l = j;\n      }\n\n      if (i + 1 < N) {\n        var h11 = hyp(1, 1);\n\n        if (h11 > max) {\n          k = i + 1;\n          l = j + 1;\n        }\n      }\n    }\n\n    return [l, k];\n  };\n  /** updates the specified row in the triangle tree.\n   */\n\n\n  var update_row = function update_row(row) {\n    row = row >>> 1 << 1; // <- round down to pow2\n    // build bottom tree level\n\n    for (var _i = row; _i < row + 2 && _i < N; _i++) {\n      var r = _i >>> 1,\n          _off2 = r * r + r >>> 1;\n\n      for (var j = 0; j < row + 1; j++) {\n        var x = S[N * _i + j],\n            y = S[N * j + _i],\n            S_ij = _i === j ? -Infinity : x * x + y * y,\n            k = _off2 + (j >>> 1);\n        treeData[k] = _i % 2 || j % 2 ? Math.max(treeData[k], S_ij) : S_ij;\n      }\n    } // build remaining tree levels\n\n\n    for (var _off3 = 0, h = 1; h < treeSizes.length; h++) {\n      var _N = treeSizes[h - 1],\n          OFF = _off3;\n      _off3 += _N * _N + _N >>> 1;\n      row = row >>> 2 << 1;\n\n      for (var _R2 = row; _R2 < row + 2 && _R2 < _N; _R2++) {\n        var ROFF = OFF + (_R2 * _R2 + _R2 >>> 1),\n            _r = _R2 >>> 1,\n            roff = _off3 + (_r * _r + _r >>> 1);\n\n        for (var C = 0; C <= _R2; C++) {\n          var _k = roff + (C >>> 1),\n              T = treeData[ROFF + C];\n\n          treeData[_k] = _R2 % 2 || C % 2 ? Math.max(treeData[_k], T) : T;\n        }\n      }\n    }\n  };\n  /** updates the specified column in the triangle tree.\n   */\n\n\n  var update_col = function update_col(col) {\n    col = col >>> 1 << 1; // <- round down to pow2\n    // build bottom tree level\n\n    var J = Math.min(col + 2, N);\n\n    for (var _i2 = col; _i2 < N; _i2++) {\n      var r = _i2 >>> 1,\n          _off4 = r * r + r >>> 1;\n\n      for (var j = col; j < J; j++) {\n        var x = S[N * _i2 + j],\n            y = S[N * j + _i2],\n            S_ij = _i2 === j ? -Infinity : x * x + y * y,\n            k = _off4 + (j >>> 1);\n        treeData[k] = _i2 % 2 || j % 2 ? Math.max(treeData[k], S_ij) : S_ij;\n      }\n    } // build remaining tree levels\n\n\n    for (var _off5 = 0, h = 1; h < treeSizes.length; h++) {\n      col = col >>> 2 << 1;\n\n      var _N2 = treeSizes[h - 1],\n          _J = Math.min(col + 2, _N2),\n          OFF = _off5;\n\n      _off5 += _N2 * _N2 + _N2 >>> 1;\n\n      for (var _R3 = col; _R3 < _N2; _R3++) {\n        var ROFF = OFF + (_R3 * _R3 + _R3 >>> 1),\n            _r2 = _R3 >>> 1,\n            roff = _off5 + (_r2 * _r2 + _r2 >>> 1);\n\n        for (var C = col; C < _J && C <= _R3; C++) {\n          var _k2 = roff + (C >>> 1),\n              T = treeData[ROFF + C];\n\n          treeData[_k2] = _R3 % 2 || C % 2 ? Math.max(treeData[_k2], T) : T;\n        }\n      }\n    }\n  };\n\n  for (var UV_off = 0, sv_off = 0; sv_off < sv.length; UV_off += N * N, sv_off += N) {\n    // MOVE FROM U TO S\n    for (var _i3 = 0; _i3 < N; _i3++) {\n      for (var j = 0; j < N; j++) {\n        S[N * _i3 + j] = U[UV_off + N * _i3 + j];\n        U[UV_off + N * _i3 + j] = +(_i3 === j);\n      }\n    }\n\n    ; // INIT V TO IDENTITY\n\n    for (var _i4 = 0; _i4 < N; _i4++) {\n      for (var _j = 0; _j < N; _j++) {\n        V[UV_off + N * _i4 + _j] = +(_i4 === _j);\n      }\n    } // INIT TRIANGLE TREE\n\n\n    for (var _i5 = 0; _i5 < N; _i5 += 2) {\n      update_row(_i5);\n    } //\n    // (CLASSICAL) JACOBI SVD ITERATIONS\n    //\n\n\n    for (var s = -1, t = -1;;) {\n      // FIND THE OFF DIAGONAL PAIR WITH THE LARGEST HYPOTHENUSE\n      var _find_pivot = find_pivot(),\n          _find_pivot2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_find_pivot, 2),\n          l = _find_pivot2[0],\n          k = _find_pivot2[1];\n\n      if (l >= k) throw new Error('Assertion failed.');\n      if (s == k && t == l) break; // <- DRY PRINCIPLE\n\n      s = k;\n      t = l; //*DEBUG*/      // CHECK THAT THIS IS TRULY THE MAXIMUM (TODO: COMMENT OUT)\n      //*DEBUG*/      for( let i=1; i < N; i++ )\n      //*DEBUG*/      for( let j=0; j < i; j++ )\n      //*DEBUG*/        if( ! (piv(i,j) <= piv(k,l)) ) throw new Error(`Assertion failed: ${i}, ${j}.`);\n\n      var S_kk = S[N * k + k],\n          S_kl = S[N * k + l],\n          S_lk = S[N * l + k],\n          S_ll = S[N * l + l]; // stopping criterion inspiredy by:\n      //  \"Jacobi's Method is More Accurate than QR\"\n      //   by James Demmel\n      //   SIAM J. Matrix Anal. Appl, vol. 13, pp. 1204-1245, 1992\n\n      if (!(Math.max(Math.abs(S_kl), Math.abs(S_lk)) > Math.sqrt(Math.abs(S_kk * S_ll)) * TOL)) break;\n\n      var _svd_jac_angles2 = Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_7__[\"_svd_jac_angles\"])(S_ll, S_lk, S_kl, S_kk),\n          _svd_jac_angles3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_svd_jac_angles2, 4),\n          c = _svd_jac_angles3[0],\n          s = _svd_jac_angles3[1],\n          c = _svd_jac_angles3[2],\n          s = _svd_jac_angles3[3]; // ROTATE S\n\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_8__[\"_giv_rot_rows\"])(S, N, N * l, N * k, c, s);\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_8__[\"_giv_rot_cols\"])(S, N, l, k, c, s); // ENTRIES (k,l) AND (l,k) ARE REMAINDERS (CANCELLATION ERROR) FROM ELIMINATION => SHOULD BE SAFELY ZEROABLE\n\n\n      S[N * k + l] = 0.0;\n      S[N * l + k] = 0.0; // UPDATE TRIANGLE TREE ROWS AND COLUMNS\n\n      update_row(k);\n      update_row(l);\n      update_col(k);\n      update_col(l); // ROTATE U & V\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_8__[\"_giv_rot_rows\"])(U, N, UV_off + N * l, UV_off + N * k, c, s);\n\n      Object(_giv_rot__WEBPACK_IMPORTED_MODULE_8__[\"_giv_rot_rows\"])(V, N, UV_off + N * l, UV_off + N * k, c, -s);\n    }\n\n    Object(_svd_jac_utils__WEBPACK_IMPORTED_MODULE_7__[\"_svd_jac_post\"])(N, U, S, V, UV_off, sv, sv_off, ord);\n  }\n\n  return [new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, U), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape.slice(0, -1), sv), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](shape, V)];\n}\n\n//# sourceURL=webpack://nd/./src/la/svd_jac_classic.js?");

/***/ }),

/***/ "./src/la/transpose_inplace.js":
/*!*************************************!*\
  !*** ./src/la/transpose_inplace.js ***!
  \*************************************/
/*! exports provided: _transpose_inplace, transpose_inplace */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_transpose_inplace\", function() { return _transpose_inplace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"transpose_inplace\", function() { return transpose_inplace; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction _transpose_inplace(N, A, A_off) {\n  for (var i = N; --i > 0;) {\n    for (var j = i; j-- > 0;) {\n      var ij = A_off + N * i + j,\n          ji = A_off + N * j + i,\n          A_ij = A[ij];\n      A[ij] = A[ji];\n      A[ji] = A_ij;\n    }\n  }\n}\nfunction transpose_inplace(A) {\n  var _A$shape$slice = A.shape.slice(-2),\n      _A$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_A$shape$slice, 2),\n      N = _A$shape$slice2[0],\n      M = _A$shape$slice2[1];\n\n  if (N != M) throw new Error('In-place transposition is only supported for square matrices.');\n  A = A.data;\n\n  for (var A_off = 0; A_off < A.length; A_off += N * N) {\n    _transpose_inplace(N, A, A_off);\n  }\n}\n\n//# sourceURL=webpack://nd/./src/la/transpose_inplace.js?");

/***/ }),

/***/ "./src/la/tri.js":
/*!***********************!*\
  !*** ./src/la/tri.js ***!
  \***********************/
/*! exports provided: tril, triu, _tril_solve, _triu_solve, _tril_t_solve, _triu_t_solve, tril_solve, triu_solve */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tril\", function() { return tril; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triu\", function() { return triu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_tril_solve\", function() { return _tril_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_triu_solve\", function() { return _triu_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_tril_t_solve\", function() { return _tril_t_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_triu_t_solve\", function() { return _triu_t_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tril_solve\", function() { return tril_solve; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triu_solve\", function() { return triu_solve; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction tril(m) {\n  var k = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  m = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(m);\n  if (m.ndim < 2) throw new Error('Input must be at least 2D.');\n  return m.mapElems(m.dtype, function (x) {\n    for (var _len = arguments.length, indices = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      indices[_key - 1] = arguments[_key];\n    }\n\n    var _indices$slice = indices.slice(-2),\n        _indices$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_indices$slice, 2),\n        i = _indices$slice2[0],\n        j = _indices$slice2[1];\n\n    return i < j - k ? 0 : x;\n  });\n}\nfunction triu(m) {\n  var k = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  m = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(m);\n  if (m.ndim < 2) throw new Error('Input must be at least 2D.');\n  return m.mapElems(m.dtype, function (x) {\n    for (var _len2 = arguments.length, indices = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      indices[_key2 - 1] = arguments[_key2];\n    }\n\n    var _indices$slice3 = indices.slice(-2),\n        _indices$slice4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_indices$slice3, 2),\n        i = _indices$slice4[0],\n        j = _indices$slice4[1];\n\n    return i > j - k ? 0 : x;\n  });\n}\nfunction _tril_solve(M, N, O, L, L_off, X, X_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  M |= 0;\n  N |= 0;\n  O |= 0;\n  L_off |= 0;\n  X_off |= 0;\n  if (!(0 <= L_off)) throw new Error('Assertion failed.');\n  if (!(0 <= X_off)) throw new Error('Assertion failed.');\n  if (!(M * N <= L.length - L_off)) throw new Error('Assertion failed.');\n  if (!(M * O <= X.length - X_off)) throw new Error('Assertion failed.'); // FORWARD SUBSTITUTION\n\n  for (var i = 0; i < M; i++) {\n    for (var k = 0; k < i; k++) {\n      for (var j = 0; j < O; j++) {\n        X[X_off + O * i + j] -= L[L_off + N * i + k] * X[X_off + O * k + j];\n      }\n    }\n\n    for (var _j = 0; _j < O; _j++) {\n      X[X_off + O * i + _j] /= L[L_off + N * i + i];\n    }\n  }\n}\nfunction _triu_solve(M, N, O, U, U_off, X, X_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  M |= 0;\n  N |= 0;\n  O |= 0;\n  U_off |= 0;\n  X_off |= 0;\n  if (!(0 <= U_off)) throw new Error('Assertion failed.');\n  if (!(0 <= X_off)) throw new Error('Assertion failed.');\n  if (!(M * N <= U.length - U_off)) throw new Error('Assertion failed.');\n  if (!(M * O <= X.length - X_off)) throw new Error('Assertion failed.'); // BACKWARD SUBSTITUTION\n\n  for (var i = M; i-- > 0;) {\n    for (var j = O; j-- > 0;) {\n      for (var k = M; --k > i;) {\n        X[X_off + O * i + j] -= U[U_off + N * i + k] * X[X_off + O * k + j];\n      }\n\n      X[X_off + O * i + j] /= U[U_off + N * i + i];\n    }\n  }\n}\nfunction _tril_t_solve(M, N, O, L, L_off, X, X_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  M |= 0;\n  N |= 0;\n  O |= 0;\n  L_off |= 0;\n  X_off |= 0;\n  if (!(0 <= L_off)) throw new Error('Assertion failed.');\n  if (!(0 <= X_off)) throw new Error('Assertion failed.');\n  if (!(M * N <= L.length - L_off)) throw new Error('Assertion failed.');\n  if (!(M * O <= X.length - X_off)) throw new Error('Assertion failed.'); // BACKWARD SUBSTITUTION\n\n  for (var k = M; k-- > 0;) {\n    for (var j = O; j-- > 0;) {\n      X[X_off + O * k + j] /= L[L_off + N * k + k];\n    }\n\n    for (var i = k; i-- > 0;) {\n      for (var _j2 = O; _j2-- > 0;) {\n        X[X_off + O * i + _j2] -= L[L_off + N * k + i] * X[X_off + O * k + _j2];\n      }\n    }\n  }\n}\nfunction _triu_t_solve(M, N, O, U, U_off, X, X_off) {\n  if (!(M <= N)) throw new Error('Assertion failed.');\n  M |= 0;\n  N |= 0;\n  O |= 0;\n  U_off |= 0;\n  X_off |= 0;\n  if (!(0 <= U_off)) throw new Error('Assertion failed.');\n  if (!(0 <= X_off)) throw new Error('Assertion failed.');\n  if (!(M * N <= U.length - U_off)) throw new Error('Assertion failed.');\n  if (!(M * O <= X.length - X_off)) throw new Error('Assertion failed.'); // FORWARD SUBSTITUTION\n\n  for (var k = 0; k < M; k++) {\n    for (var j = 0; j < O; j++) {\n      X[X_off + O * k + j] /= U[U_off + N * k + k];\n    }\n\n    for (var i = k; ++i < M;) {\n      for (var _j3 = 0; _j3 < O; _j3++) {\n        X[X_off + O * i + _j3] -= U[U_off + N * k + i] * X[X_off + O * k + _j3];\n      }\n    }\n  }\n}\nfunction tril_solve(L, Y) {\n  L = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(L);\n  if (L.ndim < 2) throw new Error('tril_solve(L,Y): L.ndim must be at least 2.');\n  Y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(Y);\n  if (Y.ndim < 2) throw new Error('tril_solve(L,Y): Y.ndim must be at least 2.');\n\n  var _Y$shape$slice = Y.shape.slice(-2),\n      _Y$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Y$shape$slice, 2),\n      M = _Y$shape$slice2[0],\n      N = _Y$shape$slice2[1];\n\n  if (L.shape[L.ndim - 2] !== M) throw new Error(\"tril_solve(L,Y): L and Y don't match.\");\n  if (L.shape[L.ndim - 1] !== M) throw new Error('tril_solve(L,Y): Last two dimensions of L must be quadratic.');\n  var ndim = Math.max(L.ndim, Y.ndim),\n      L_shape = L.shape,\n      Y_shape = Y.shape,\n      X_shape = new Int32Array(ndim);\n  X_shape.fill(1, 0, -2);\n  X_shape[ndim - 2] = M;\n  X_shape[ndim - 1] = N; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i = 0, _arr = [L_shape, Y_shape]; _i < _arr.length; _i++) {\n    var shape = _arr[_i];\n\n    for (var i = ndim - 2, j = shape.length - 2; i-- > 0 && j-- > 0;) {\n      if (1 === X_shape[i]) X_shape[i] = shape[j];else if (X_shape[i] != shape[j] && shape[j] != 1) throw new Error('tril_solve(L,Y): L and Y not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var dtype = [L, Y].every(function (A) {\n    return A.dtype === 'float32';\n  }) ? 'float32' : 'float64';\n  L = L.data;\n  Y = Y.data;\n  var X = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](X_shape.reduce(function (a, b) {\n    return a * b;\n  }));\n  var L_off = 0,\n      L_stride = 1,\n      Y_off = 0,\n      Y_stride = 1,\n      X_off = 0;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      L_stride = M * M;\n      Y_stride = M * N; // COPYING y\n\n      for (var _i2 = Y_stride; _i2-- > 0;) {\n        X[X_off + _i2] = Y[Y_off + _i2];\n      }\n\n      _tril_solve(M, M, N, L, L_off, X, X_off);\n\n      L_off += L_stride;\n      Y_off += Y_stride;\n      X_off += Y_stride;\n    } else {\n      for (var l = X_shape[d];; l--) {\n        solv(d + 1);\n        if (l == 1) break;\n        if (!(L_shape[d - ndim + L_shape.length] > 1)) L_off -= L_stride;\n        if (!(Y_shape[d - ndim + Y_shape.length] > 1)) Y_off -= Y_stride;\n      }\n\n      L_stride *= L_shape[d - ndim + L_shape.length] || 1;\n      Y_stride *= Y_shape[d - ndim + Y_shape.length] || 1;\n    }\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](X_shape, X);\n}\nfunction triu_solve(U, Y) {\n  U = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(U);\n  if (U.ndim < 2) throw new Error('triu_solve(U,Y): U.ndim must be at least 2.');\n  Y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(Y);\n  if (Y.ndim < 2) throw new Error('triu_solve(U,Y): Y.ndim must be at least 2.');\n\n  var _Y$shape$slice3 = Y.shape.slice(-2),\n      _Y$shape$slice4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Y$shape$slice3, 2),\n      M = _Y$shape$slice4[0],\n      N = _Y$shape$slice4[1];\n\n  if (U.shape[U.ndim - 2] !== M) throw new Error(\"triu_solve(U,Y): U and Y don't match.\");\n  if (U.shape[U.ndim - 1] !== M) throw new Error('triu_solve(U,Y): Last two dimensions of U must be quadratic.');\n  var ndim = Math.max(U.ndim, Y.ndim),\n      U_shape = U.shape,\n      Y_shape = Y.shape,\n      X_shape = new Int32Array(ndim);\n  X_shape.fill(1, 0, -2);\n  X_shape[ndim - 2] = M;\n  X_shape[ndim - 1] = N; // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i3 = 0, _arr2 = [U_shape, Y_shape]; _i3 < _arr2.length; _i3++) {\n    var shape = _arr2[_i3];\n\n    for (var i = ndim - 2, j = shape.length - 2; i-- > 0 && j-- > 0;) {\n      if (1 === X_shape[i]) X_shape[i] = shape[j];else if (X_shape[i] != shape[j] && shape[j] != 1) throw new Error('triu_solve(U,Y): U and Y not broadcast-compatible.');\n    }\n  } // GENERATE RESULT DATA\n\n\n  var dtype = [U, Y].every(function (A) {\n    return A.dtype === 'float32';\n  }) ? 'float32' : 'float64';\n  U = U.data;\n  Y = Y.data;\n  var X = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](X_shape.reduce(function (a, b) {\n    return a * b;\n  }));\n  var U_off = U.length,\n      U_stride = 1,\n      Y_off = Y.length,\n      Y_stride = 1,\n      X_off = X.length;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      U_stride = M * M;\n      Y_stride = M * N;\n      U_off -= U_stride;\n      Y_off -= Y_stride;\n      X_off -= Y_stride; // COPYING y\n\n      for (var _i4 = Y_stride; _i4-- > 0;) {\n        X[X_off + _i4] = Y[Y_off + _i4];\n      }\n\n      _triu_solve(M, M, N, U, U_off, X, X_off);\n    } else {\n      for (var l = X_shape[d];; l--) {\n        solv(d + 1);\n        if (l == 1) break;\n        if (!(U_shape[d - ndim + U_shape.length] > 1)) U_off += U_stride;\n        if (!(Y_shape[d - ndim + Y_shape.length] > 1)) Y_off += Y_stride;\n      }\n\n      U_stride *= U_shape[d - ndim + U_shape.length] || 1;\n      Y_stride *= Y_shape[d - ndim + Y_shape.length] || 1;\n    }\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](X_shape, X);\n}\n\n//# sourceURL=webpack://nd/./src/la/tri.js?");

/***/ }),

/***/ "./src/la/urv.js":
/*!***********************!*\
  !*** ./src/la/urv.js ***!
  \***********************/
/*! exports provided: _urv_decomp_full, urv_decomp_full, _urv_lstsq, urv_lstsq */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_urv_decomp_full\", function() { return _urv_decomp_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"urv_decomp_full\", function() { return urv_decomp_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_urv_lstsq\", function() { return _urv_lstsq; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"urv_lstsq\", function() { return urv_lstsq; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _srrqr__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./srrqr */ \"./src/la/srrqr.js\");\n/* harmony import */ var _giv_rot__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _tri__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n // TODO: add economic URV decomposition\n\nfunction _urv_decomp_full(M, N, R, R_off, V, V_off, P, P_off) {\n  if (0 !== M % 1) throw new Error('Assertion failed.');\n  if (0 !== N % 1) throw new Error('Assertion failed.');\n  if (0 !== R_off % 1) throw new Error('Assertion failed.');\n  if (0 !== V_off % 1) throw new Error('Assertion failed.');\n  /*DEBUG*/\n\n  for (var i = N; i-- > 0;) {\n    /*DEBUG*/\n    for (var j = N; j-- > 0;) {\n      /*DEBUG*/\n      if (0 !== V[V_off + N * i + j]) throw new Error('Assertion failed.');\n    }\n  }\n\n  M |= 0;\n  N |= 0;\n  R_off |= 0;\n  V_off |= 0;\n  if (!(M <= N)) throw new Error('Assertion failed.');\n\n  if (M === N) {\n    for (var _i = N; _i-- > 0;) {\n      var _j = P[P_off + _i];\n      V[V_off + N * _i + _j] = 1;\n    }\n  } else {\n    // INIT V TO IDENTITY\n    for (var _i2 = N; _i2-- > 0;) {\n      V[V_off + N * _i2 + _i2] = 1;\n    }\n\n    for (var _i3 = M; _i3-- > 0;) {\n      for (var _j2 = M; _j2 < N; _j2++) {\n        var ij = R_off + N * _i3 + _j2,\n            R_ij = R[ij];\n        if (0 === R_ij) continue;\n        var ii = R_off + N * _i3 + _i3,\n            R_ii = R[ii];\n\n        var _giv_rot_qr2 = Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(R_ii, R_ij),\n            _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n            c = _giv_rot_qr3[0],\n            s = _giv_rot_qr3[1],\n            norm = _giv_rot_qr3[2];\n\n        if (s !== 0) {\n          // ROT COLUMNS IN R\n          for (var k = _i3; k-- > 0;) // <- TODO can this be made cache friendlier?\n          {\n            var ki = R_off + N * k + _i3,\n                R_ki = R[ki],\n                kj = R_off + N * k + _j2,\n                R_kj = R[kj];\n            R[ki] = R_kj * s + R_ki * c;\n            R[kj] = R_kj * c - R_ki * s;\n          } // ROT ROWS IN V\n\n\n          Object(_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_rows\"])(V, 1 + _j2 - _i3, V_off + N * _i3 + _i3, V_off + N * _j2 + _i3, c, s);\n\n          R[ii] = norm;\n        }\n\n        R[ij] = 0;\n      }\n    } // apply colum permutations\n    // nested loop but actually only O(N) swaps\n\n\n    for (var _i4 = 0; _i4 < N; ++_i4) {\n      for (;;) // <- start swap cycle\n      {\n        var _j3 = P[P_off + _i4];\n        P[P_off + _i4] = P[P_off + _j3];\n        P[P_off + _j3] = _j3;\n        if (_j3 <= _i4) break; // SWAP COLUMNS IN V\n\n        for (var _k = N; _k-- > 0;) {\n          var tmp = V[V_off + N * _k + _i4];\n          V[V_off + N * _k + _i4] = V[V_off + N * _k + _j3];\n          V[V_off + N * _k + _j3] = tmp;\n        }\n      }\n    }\n  }\n}\nfunction urv_decomp_full(A) // <- TODO add tolerance parameters to pass on to SRRQR\n{\n  var _srrqr_decomp_full = Object(_srrqr__WEBPACK_IMPORTED_MODULE_3__[\"srrqr_decomp_full\"])(A),\n      _srrqr_decomp_full2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_srrqr_decomp_full, 4),\n      U = _srrqr_decomp_full2[0],\n      RR = _srrqr_decomp_full2[1],\n      P = _srrqr_decomp_full2[2],\n      rnks = _srrqr_decomp_full2[3];\n\n  A = undefined;\n\n  var _RR$shape$slice = RR.shape.slice(-2),\n      _RR$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_RR$shape$slice, 2),\n      M = _RR$shape$slice2[0],\n      N = _RR$shape$slice2[1],\n      V_shape = RR.shape.slice();\n\n  V_shape[V_shape.length - 2] = N;\n  P = P.data;\n  var r = rnks.data,\n      R = RR.data,\n      V = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][RR.dtype](R.length / M * N);\n\n  for (var R_off = 0, V_off = 0, P_off = 0, r_off = 0; r_off < r.length; R_off += M * N, V_off += N * N, P_off += N, r_off += 1) {\n    var rnk = r[r_off];\n\n    if (rnk < N) {\n      // set close-to-zero lower right region to zero\n      for (var i = rnk; i < M; i++) {\n        for (var j = rnk; j < N; j++) {\n          R[R_off + N * i + j] = 0;\n        }\n      } // <- TODO consider doing this in SRRQR already\n\n    }\n\n    _urv_decomp_full(rnk, N, R, R_off, V, V_off, P, P_off); // <- TODO if we init V to identity then we can do faster rotations of V. P would then be applied after computing V.\n\n  }\n\n  return [U, RR, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](V_shape, V), rnks];\n}\nfunction _urv_lstsq(rnk, I, J, K, L, M, U, U_off, R, R_off, V, V_off, X, X_off, Y, Y_off, tmp) {\n  //                                                 \n  //                                                 \n  //    U[I,J]   R[J,K]   V[K,L]   X[L,M]  =  Y[I,M] \n  //                                                 \n  //                                                 \n  if (rnk % 1 !== 0) throw new Error('Assertion failed.');\n  if (I % 1 !== 0) throw new Error('Assertion failed.');\n  if (J % 1 !== 0) throw new Error('Assertion failed.');\n  if (K % 1 !== 0) throw new Error('Assertion failed.');\n  if (L % 1 !== 0) throw new Error('Assertion failed.');\n  if (M % 1 !== 0) throw new Error('Assertion failed.');\n  if (U_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (R_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (V_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (X_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (Y_off % 1 !== 0) throw new Error('Assertion failed.');\n  if (!(0 <= I)) throw new Error('Assertion failed.');\n  if (!(0 <= J)) throw new Error('Assertion failed.');\n  if (!(0 <= K)) throw new Error('Assertion failed.');\n  if (!(0 <= L)) throw new Error('Assertion failed.');\n  if (!(0 <= M)) throw new Error('Assertion failed.');\n  if (!(0 <= U_off)) throw new Error('Assertion failed.');\n  if (!(0 <= R_off)) throw new Error('Assertion failed.');\n  if (!(0 <= V_off)) throw new Error('Assertion failed.');\n  if (!(0 <= X_off)) throw new Error('Assertion failed.');\n  if (!(0 <= Y_off)) throw new Error('Assertion failed.');\n  if (!(U_off <= U.length - I * J)) throw new Error('Assertion failed.');\n  if (!(R_off <= R.length - J * K)) throw new Error('Assertion failed.');\n  if (!(V_off <= V.length - K * L)) throw new Error('Assertion failed.');\n  if (!(X_off <= X.length - L * M)) throw new Error('Assertion failed.');\n  if (!(Y_off <= Y.length - I * M)) throw new Error('Assertion failed.');\n  if (tmp.length < I * M) throw new Error('Assertion failed.');\n  tmp.fill(0.0, 0, I * M); // TMP = U.T @ Y\n\n  for (var k = 0; k < I; k++) {\n    for (var i = 0; i < rnk; i++) {\n      for (var j = 0; j < M; j++) {\n        tmp[M * i + j] += U[U_off + J * k + i] * Y[Y_off + M * k + j];\n      }\n    }\n  } // TMP = R \\ TMP\n\n\n  Object(_tri__WEBPACK_IMPORTED_MODULE_5__[\"_triu_solve\"])(rnk, K, M, R, R_off, tmp, 0); // TMP = V.T @ TMP\n\n\n  for (var _k2 = 0; _k2 < rnk; _k2++) {\n    for (var _i5 = 0; _i5 < L; _i5++) {\n      for (var _j4 = 0; _j4 < M; _j4++) {\n        X[X_off + M * _i5 + _j4] += V[V_off + L * _k2 + _i5] * tmp[M * _k2 + _j4];\n      }\n    }\n  }\n}\nfunction urv_lstsq(U, R, V, ranks, Y) {\n  if (Y == null) {\n    if (null != ranks || null != V) throw new Error('urv_lstsq( U,R,V,ranks, Y ): Either 2 ([U,R,V,ranks], Y) or 5 arguments (U,R,V,ranks, Y) expected.');\n    Y = R;\n    var _U = U;\n\n    var _U2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_U, 4);\n\n    U = _U2[0];\n    R = _U2[1];\n    V = _U2[2];\n    ranks = _U2[3];\n  }\n\n  U = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(U);\n  if (!(U.ndim >= 2)) throw new Error('urv_lstsq(U,R,V, Y): U.ndim must be at least 2.');\n  R = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(R);\n  if (!(R.ndim >= 2)) throw new Error('urv_lstsq(U,R,V, Y): R.ndim must be at least 2.');\n  V = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(V);\n  if (!(V.ndim >= 2)) throw new Error('urv_lstsq(U,R,V, Y): V.ndim must be at least 2.');\n  Y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(Y);\n  if (!(Y.ndim >= 2)) throw new Error('urv_lstsq(U,R,V, Y): Y.ndim must be at least 2.');\n  ranks = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(ranks);\n  var U_shape = U.shape,\n      R_shape = R.shape,\n      V_shape = V.shape,\n      Y_shape = Y.shape,\n      ranks_shape = ranks.shape;\n  var dtype = [U, R, V, Y].every(function (x) {\n    return x.dtype === 'float32';\n  }) ? 'float32' : 'float64';\n  var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype];\n  var ndim = [U, R, V, Y].reduce(function (max, _ref) {\n    var ndim = _ref.ndim;\n    return Math.max(max, ndim);\n  }, ranks.ndim + 2);\n  var X_shape = new Int32Array(ndim);\n  X_shape.fill(1); // FIND COMMON (BROADCASTED) SHAPE\n\n  for (var _i6 = 0, _arr = [U, R, V, Y]; _i6 < _arr.length; _i6++) {\n    var arr = _arr[_i6];\n\n    for (var i = ndim - 2, j = arr.ndim - 2; i-- > 0 && j-- > 0;) {\n      if (1 === X_shape[i]) X_shape[i] = arr.shape[j];else if (X_shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('urv_lstsq( U,R,V,ranks, Y ): U,R,V,ranks, Y not broadcast-compatible.');\n    }\n  }\n\n  for (var _i7 = ndim - 2, _j5 = ranks.ndim; _i7-- > 0 && _j5-- > 0;) {\n    if (1 === X_shape[_i7]) X_shape[_i7] = ranks.shape[_j5];else if (X_shape[_i7] != ranks.shape[_j5] && ranks.shape[_j5] != 1) throw new Error('urv_lstsq( U,R,V,ranks, Y ): U,R,V,ranks, Y not broadcast-compatible.');\n  } // CHECK MATRIX SHAPES\n  //                                                 \n  //                                                 \n  //    U[I,J]   R[J,K]   V[K,L]   X[L,M]  =  Y[I,M] \n  //                                                 \n  //                                                 \n\n\n  var _U$shape$slice = U.shape.slice(-2),\n      _U$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_U$shape$slice, 2),\n      I = _U$shape$slice2[0],\n      J = _U$shape$slice2[1],\n      _V$shape$slice = V.shape.slice(-2),\n      _V$shape$slice2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_V$shape$slice, 2),\n      K = _V$shape$slice2[0],\n      L = _V$shape$slice2[1],\n      M = Y.shape[Y.ndim - 1];\n\n  if (R.shape[R.ndim - 2] !== J) throw new Error('urv_lstsq( U,R,V,ranks, Y ): Matrix dimensions incompatible.');\n  if (R.shape[R.ndim - 1] !== K) throw new Error('urv_lstsq( U,R,V,ranks, Y ): Matrix dimensions incompatible.');\n  if (Y.shape[Y.ndim - 2] !== I) throw new Error('urv_lstsq( U,R,V,ranks, Y ): Matrix dimensions incompatible.');\n\n  if (J !== K) {\n    if (I < L) if (I !== J) throw new Error('Assertion failed.');else if (K !== L) throw new Error('Assertion failed.');\n  }\n\n  if (!(I >= J)) throw new Error('Assertion failed.');\n  if (!(K <= L)) throw new Error('Assertion failed.');\n  X_shape[ndim - 2] = L;\n  X_shape[ndim - 1] = M;\n  ranks = ranks.data;\n  U = U.data;\n  R = R.data;\n  V = V.data;\n  Y = Y.data;\n  var X = new DTypeArray(X_shape.reduce(function (m, n) {\n    return m * n;\n  })),\n      tmp = new DTypeArray(I * M);\n  var U_off = U.length,\n      U_stride = 1,\n      R_off = R.length,\n      R_stride = 1,\n      V_off = V.length,\n      V_stride = 1,\n      Y_off = Y.length,\n      Y_stride = 1,\n      ranks_off = ranks.length,\n      ranks_stride = 1,\n      X_off = X.length;\n\n  function solv(d) {\n    if (d === ndim - 2) {\n      U_stride = I * J;\n      R_stride = J * K;\n      V_stride = K * L;\n      Y_stride = I * M;\n      ranks_stride = 1;\n      U_off -= U_stride;\n      R_off -= R_stride;\n      V_off -= V_stride;\n      Y_off -= Y_stride;\n      ranks_off -= ranks_stride;\n      X_off -= L * M;\n      var rnk = ranks[ranks_off];\n\n      _urv_lstsq(rnk, I, J, K, L, M, U, U_off, R, R_off, V, V_off, X, X_off, Y, Y_off, tmp);\n    } else {\n      for (var l = X_shape[d];; l--) {\n        solv(d + 1);\n        if (l == 1) break;\n        if (!(U_shape[d - ndim + U_shape.length] > 1)) U_off += U_stride;\n        if (!(R_shape[d - ndim + R_shape.length] > 1)) R_off += R_stride;\n        if (!(V_shape[d - ndim + V_shape.length] > 1)) V_off += V_stride;\n        if (!(Y_shape[d - ndim + Y_shape.length] > 1)) Y_off += Y_stride;\n        if (!(ranks_shape[d - ndim + 2 + ranks_shape.length] > 1)) ranks_off += ranks_stride;\n      }\n\n      U_stride *= U_shape[d - ndim + U_shape.length] || 1;\n      R_stride *= R_shape[d - ndim + R_shape.length] || 1;\n      V_stride *= V_shape[d - ndim + V_shape.length] || 1;\n      Y_stride *= Y_shape[d - ndim + Y_shape.length] || 1;\n      ranks_stride *= ranks_shape[d - ndim + 2 + ranks_shape.length] || 1;\n    }\n  }\n\n  solv(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](X_shape, X);\n}\n\n//# sourceURL=webpack://nd/./src/la/urv.js?");

/***/ }),

/***/ "./src/math.js":
/*!*********************!*\
  !*** ./src/math.js ***!
  \*********************/
/*! exports provided: math, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"math\", function() { return math; });\n/* harmony import */ var _dt_complex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dt/complex */ \"./src/dt/complex.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nvar math = {\n  nextUp: function nextUp(x) {\n    // FIXME implement this completely\n    // https://gist.github.com/Yaffle/4654250\n    var EPSILON = Number.EPSILON,\n        MIN_VALUE = Number.MIN_VALUE;\n    var y = x * (x < 0 ? 1 - EPSILON / 2 : 1 + EPSILON);\n    if (!isFinite(x)) throw new Error('Assertion failed!');\n    if (!isFinite(y)) throw new Error('Assertion failed!');\n    if (y === x) y += MIN_VALUE;\n    var b = x + (y - x) / 2;\n\n    if (x < b && b < y) {\n      y = b;\n    }\n\n    var c = (y + x) / 2;\n\n    if (x < c && c < y) {\n      y = c;\n    }\n\n    return y === 0 ? -0 : y;\n  },\n  add: function add(x, y) {\n    if (x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return x.add(y);\n    if (y instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return y.add(x);\n    return x + y;\n  },\n  sub: function sub(x, y) {\n    if (x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return x.sub(y);\n    if (y instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return new _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"](x).sub(y);\n    return x - y;\n  },\n  mul: function mul(x, y) {\n    if (x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return x.mul(y);\n    if (y instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return y.mul(x);\n    return x * y;\n  },\n  div: function div(x, y) {\n    if (x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return x.div(y);\n    if (y instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return new _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"](x).div(y);\n    return x / y;\n  },\n  zero: function zero(dtype) {\n    return math.cast(0, dtype);\n  },\n  one: function one(dtype) {\n    return math.cast(1, dtype);\n  },\n  neg: function neg(x) {\n    return x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x.neg() : -x;\n  },\n  abs: function abs(x) {\n    return x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x.abs() : Math.abs(x);\n  },\n  sqrt: function sqrt(x) {\n    return x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x.sqrt() : x >= 0 ? Math.sqrt(x) : new _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"](x).sqrt();\n  },\n  exp: function exp(x) {\n    return x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x.exp() : Math.exp(x);\n  },\n  min: function min(x, y) {\n    return Math.min(x, y);\n  },\n  max: function max(x, y) {\n    return Math.max(x, y);\n  },\n  hypot: function hypot(x, y) {\n    return Math.hypot(x, y);\n  },\n  atan2: function atan2(x, y) {\n    return Math.atan2(x, y);\n  },\n  conj: function conj(x) {\n    return x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"] ? x.conj() : x;\n  },\n  is_equal: function is_equal(x, y) {\n    if (x instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return x.equals(y);\n    if (y instanceof _dt_complex__WEBPACK_IMPORTED_MODULE_0__[\"Complex\"]) return y.equals(x);\n    return x == y;\n  },\n  is_close: function is_close(x, y) {\n    var atol = 1e-8,\n        rtol = 1e-5,\n        tol = atol + rtol * math.max(math.abs(x), math.abs(y));\n    return math.abs(math.sub(x, y)) <= tol;\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (math);\n\n//# sourceURL=webpack://nd/./src/math.js?");

/***/ }),

/***/ "./src/nd_array.js":
/*!*************************!*\
  !*** ./src/nd_array.js ***!
  \*************************/
/*! exports provided: array, asarray, NDArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"array\", function() { return array; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"asarray\", function() { return asarray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NDArray\", function() { return NDArray; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ \"./node_modules/@babel/runtime/helpers/typeof.js\");\n/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _zip_elems__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./zip_elems */ \"./src/zip_elems.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n\n\nfunction array(dtype, content) {\n  var _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(shape);\n\n  if (null == content) {\n    content = dtype;\n    dtype = undefined;\n  }\n\n  if (('object' == _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_9___default()(content) || 'function' == typeof content) && 'shape' in content && 'data' in content) {\n    var _data = content.data;\n    if (dtype == null) dtype = content.dtype;else if (dtype === 'float') {\n      if (content.dtype.startsWith('float') && _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"].hasOwnProperty(dtype)) dtype = content.dtype;else dtype = 'float64';\n    }\n\n    Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"_check_dtype\"])(dtype);\n\n    if (!(_data instanceof _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][dtype])) _data = _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][dtype].from(_data);else _data = _data.slice();\n    return new NDArray(content.shape, _data);\n  }\n\n  function shape(content) {\n    var len;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function shape$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!('object' === _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_9___default()(content) && 'length' in content)) {\n              _context.next = 11;\n              break;\n            }\n\n            len = content.length;\n\n            if (!('number' !== typeof len)) {\n              _context.next = 4;\n              break;\n            }\n\n            throw new Error('Illegal argument(s).');\n\n          case 4:\n            if (!(0 !== len % 1)) {\n              _context.next = 6;\n              break;\n            }\n\n            throw new Error('Illegal argument(s).');\n\n          case 6:\n            if (!(0 === len)) {\n              _context.next = 8;\n              break;\n            }\n\n            throw new Error('Illegal argument(s).');\n\n          case 8:\n            _context.next = 10;\n            return len;\n\n          case 10:\n            return _context.delegateYield(shape(content[0]), \"t0\", 11);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _marked);\n  }\n\n  shape = Int32Array.from(shape(content));\n  if (null == dtype) dtype = function dtype(d, content) {\n    if (d === shape.length) return Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"dtypeof\"])(content);else {\n      var j = shape[d] - 1,\n          dt = dtype(d + 1, content[j]);\n\n      for (; j >= 0; j--) {\n        dt = Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"super_dtype\"])(dt, dtype(d + 1, content[j]));\n      }\n\n      return dt;\n    }\n  }(0, content);else if ('float' === dtype) dtype = 'float64';\n\n  Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"_check_dtype\"])(dtype);\n\n  var data = new _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1));\n  var idx = 0;\n\n  function fill(d, content) {\n    if (d === shape.length) data[idx++] = content;else {\n      if (content.length !== shape[d]) throw new Error('Nested array not axis-aligned.');\n\n      for (var j = 0; j < shape[d]; j++) {\n        fill(d + 1, content[j]);\n      }\n    }\n  }\n\n  fill(0, content);\n  return new NDArray(shape, data);\n}\nfunction asarray(dtype, arrayLike) {\n  if (null == arrayLike) {\n    arrayLike = dtype;\n    dtype = undefined;\n  }\n\n  if (dtype != null && dtype !== 'float' && !(dtype in _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"])) throw new Error(\"asarray(dtype, arrayLike): Invalid dtype: '\".concat(dtype, \"'.\"));\n\n  if (arrayLike instanceof NDArray) {\n    if (dtype == null || dtype === arrayLike.dtype || dtype === 'float' && arrayLike.dtype.startsWith('float')) return arrayLike;\n    return new NDArray(arrayLike.shape, _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][dtype].from(arrayLike.data));\n  }\n\n  if (dtype === 'float') dtype = 'float64';\n  return array(dtype, arrayLike);\n}\nvar NDArray = /*#__PURE__*/function (_Function) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(NDArray, _Function);\n\n  var _super = _createSuper(NDArray);\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(NDArray, null, [{\n    key: \"name\",\n    get: function get() {\n      return 'nd.Array';\n    } //\n    // FACTORY METHODS\n    //\n\n  }]);\n\n  function NDArray(shape, data) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this, NDArray);\n\n    if (!(shape instanceof Int32Array)) throw new Error('Shape must be Int32Array.');\n    if (shape.some(function (s) {\n      return s < 1;\n    })) throw new Error(\"Invalid shape: \".concat(shape, \".\"));\n    if (data.length != shape.reduce(function (x, y) {\n      return x * y;\n    }, 1)) throw new Error(\"Shape [\".concat(shape, \"] does not match array length of \").concat(data.length, \".\"));\n\n    var self = function self() {\n      for (var _len = arguments.length, indices = new Array(_len), _key = 0; _key < _len; _key++) {\n        indices[_key] = arguments[_key];\n      }\n\n      return self.data[self._flat_idx(indices)];\n    };\n\n    Object.setPrototypeOf(self, NDArray.prototype);\n    Object.freeze(shape.buffer);\n    self.shape = shape;\n    self.data = data;\n    Object.seal(self);\n    return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5___default()(_this, self);\n  } //\n  // GENERAL\n  //\n\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(NDArray, [{\n    key: \"set\",\n    //    TODO implements this in combination with a PROXY\n    //    get length() {\n    //      return this.shape[0];\n    //    }\n    value: function set(indices, value) {\n      this.data[this._flat_idx(indices)] = value;\n    }\n  }, {\n    key: \"modify\",\n    value: function modify(indices, modifier) {\n      var i = this._flat_idx(indices);\n\n      this.data[i] = modifier.apply(void 0, [this.data[i]].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(indices)));\n    }\n  }, {\n    key: \"_flat_idx\",\n    value: function _flat_idx(indices) {\n      var shape = this.shape;\n      if (indices.length != shape.length) throw new Error(\"Multi-index [\".concat(indices, \"] does not have expected length of \").concat(shape.length, \".\"));\n      var flat_idx = 0,\n          stride = 1;\n\n      for (var i = shape.length; i-- > 0; stride *= shape[i]) {\n        var idx = indices[i];\n        if (idx % 1 != 0) throw new Error(\"Multi-index [\".concat(indices, \"] contains non-integer entries.\"));\n        if (idx < 0) idx += shape[i];\n        if (idx < 0 || idx >= shape[i]) throw new Error(\"Multi-index [\".concat(indices, \"] out of bounds [\").concat(shape, \"].\"));\n        flat_idx += idx * stride;\n      }\n\n      return flat_idx;\n    }\n  }, {\n    key: Symbol[\"for\"]('nodejs.util.inspect.custom'),\n    value: function value(depth, options) {\n      return this.toString();\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(entries),\n          _marked3 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(str);\n\n      var max_len_fn = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (d, shape) {\n        return d >= shape.length - 2 ? 6 : 6;\n      };\n\n      if (!(max_len_fn instanceof Function)) {\n        var max_len = max_len_fn * 1;\n\n        max_len_fn = function max_len_fn() {\n          return max_len;\n        };\n      }\n\n      var shape = this.shape,\n          data = this.data,\n          strides = new Int32Array(shape.length);\n      strides[strides.length - 1] = 1;\n\n      for (var i = strides.length; --i > 0;) {\n        strides[i - 1] = strides[i] * shape[i];\n      }\n      /** Collects the String representations of all (displayed) entries.\n       */\n\n\n      function entries(d, idx) {\n        var max_len, last, first, data_idx, j, _j, _j2;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function entries$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                max_len = max_len_fn(d, shape), last = max_len >>> 1, first = max_len - last;\n\n                if (!(shape.length === d)) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                data_idx = data[idx];\n                _context2.t0 = data_idx;\n                _context2.next = _context2.t0 === null ? 6 : _context2.t0 === undefined ? 9 : 12;\n                break;\n\n              case 6:\n                _context2.next = 8;\n                return 'null';\n\n              case 8:\n                return _context2.abrupt(\"break\", 14);\n\n              case 9:\n                _context2.next = 11;\n                return 'undefined';\n\n              case 11:\n                return _context2.abrupt(\"break\", 14);\n\n              case 12:\n                _context2.next = 14;\n                return data_idx.toString();\n\n              case 14:\n                _context2.next = 37;\n                break;\n\n              case 16:\n                if (!(shape[d] > max_len + 1)) {\n                  _context2.next = 31;\n                  break;\n                }\n\n                j = 0;\n\n              case 18:\n                if (!(j < first)) {\n                  _context2.next = 23;\n                  break;\n                }\n\n                return _context2.delegateYield(entries(d + 1, idx + j * strides[d]), \"t1\", 20);\n\n              case 20:\n                j++;\n                _context2.next = 18;\n                break;\n\n              case 23:\n                _j = shape[d] - last;\n\n              case 24:\n                if (!(_j < shape[d])) {\n                  _context2.next = 29;\n                  break;\n                }\n\n                return _context2.delegateYield(entries(d + 1, idx + _j * strides[d]), \"t2\", 26);\n\n              case 26:\n                _j++;\n                _context2.next = 24;\n                break;\n\n              case 29:\n                _context2.next = 37;\n                break;\n\n              case 31:\n                _j2 = 0;\n\n              case 32:\n                if (!(_j2 < shape[d])) {\n                  _context2.next = 37;\n                  break;\n                }\n\n                return _context2.delegateYield(entries(d + 1, idx + _j2 * strides[d]), \"t3\", 34);\n\n              case 34:\n                _j2++;\n                _context2.next = 32;\n                break;\n\n              case 37:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _marked2);\n      }\n\n      entries = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(entries(0, 0)); // pad all entries to the same string length\n\n      if (this.ndim > 1) {\n        var padLen = entries.reduce(function (a, b) {\n          return Math.max(a, b.length);\n        }, 0);\n        entries = entries.map(function (e) {\n          return e.padStart(padLen);\n        });\n      }\n\n      var iEntries = 0;\n\n      function str(indent, d, idx) {\n        var prefix, infix, suffix, max_len, last, first, j, _j3, _j4;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function str$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(shape.length === d)) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                _context3.next = 3;\n                return entries[iEntries++];\n\n              case 3:\n                return _context3.abrupt(\"return\");\n\n              case 4:\n                indent += ' ';\n                prefix = '[ ', infix = ', ', suffix = ' ]';\n\n                if (d < shape.length - 1) {\n                  infix = ',\\n' + indent;\n                  prefix = '[';\n                  suffix = ']';\n                }\n\n                _context3.next = 9;\n                return prefix;\n\n              case 9:\n                max_len = max_len_fn(d, shape), last = max_len >>> 1, first = max_len - last;\n\n                if (!(shape[d] > max_len + 1)) {\n                  _context3.next = 31;\n                  break;\n                }\n\n                j = 0;\n\n              case 12:\n                if (!(j < first)) {\n                  _context3.next = 19;\n                  break;\n                }\n\n                return _context3.delegateYield(str(indent, d + 1, idx + j * strides[d]), \"t0\", 14);\n\n              case 14:\n                _context3.next = 16;\n                return infix;\n\n              case 16:\n                j++;\n                _context3.next = 12;\n                break;\n\n              case 19:\n                _context3.next = 21;\n                return \"...\".concat(shape[d] - max_len, \" more...\");\n\n              case 21:\n                _j3 = shape[d] - last;\n\n              case 22:\n                if (!(_j3 < shape[d])) {\n                  _context3.next = 29;\n                  break;\n                }\n\n                _context3.next = 25;\n                return infix;\n\n              case 25:\n                return _context3.delegateYield(str(indent, d + 1, idx + _j3 * strides[d]), \"t1\", 26);\n\n              case 26:\n                _j3++;\n                _context3.next = 22;\n                break;\n\n              case 29:\n                _context3.next = 40;\n                break;\n\n              case 31:\n                _j4 = 0;\n\n              case 32:\n                if (!(_j4 < shape[d])) {\n                  _context3.next = 40;\n                  break;\n                }\n\n                if (!(_j4 > 0)) {\n                  _context3.next = 36;\n                  break;\n                }\n\n                _context3.next = 36;\n                return infix;\n\n              case 36:\n                return _context3.delegateYield(str(indent, d + 1, idx + _j4 * strides[d]), \"t2\", 37);\n\n              case 37:\n                _j4++;\n                _context3.next = 32;\n                break;\n\n              case 40:\n                _context3.next = 42;\n                return suffix;\n\n              case 42:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _marked3);\n      }\n\n      return _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(str('', 0, 0)).join('');\n    }\n  }, {\n    key: \"toNestedArray\",\n    value: function toNestedArray() {\n      var data = this.data,\n          shape = this.shape;\n      var flat_idx = 0;\n\n      var toNested = function toNested(d) {\n        return d === shape.length ? data[flat_idx++] : Array.from({\n          length: shape[d]\n        }, function () {\n          return toNested(d + 1);\n        });\n      };\n\n      return toNested(0);\n    } //\n    // ITERATION\n    //\n\n  }, {\n    key: Symbol.iterator,\n    value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(function value() {\n      var shape, stride, i;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function value$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              shape = this.shape.slice(1), stride = shape.reduce(function (a, b) {\n                return a * b;\n              }, 1);\n              i = 0;\n\n            case 2:\n              if (!(i < this.data.length)) {\n                _context4.next = 7;\n                break;\n              }\n\n              _context4.next = 5;\n              return new NDArray(shape, this.data.slice(i, i += stride));\n\n            case 5:\n              _context4.next = 2;\n              break;\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, value, this);\n    })\n  }, {\n    key: \"forEach\",\n    value: function forEach(consumer) {\n      var len = this.shape[0],\n          shape = this.shape.slice(1),\n          stride = shape.reduce(function (a, b) {\n        return a * b;\n      }, 1);\n\n      for (var i = 0, idx = 0; i < len; i++, idx += stride) {\n        consumer(new NDArray(shape, this.data.slice(idx, idx + stride)), i);\n      }\n    }\n  }, {\n    key: \"elems\",\n    value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(function elems() {\n      var _marked4, shape, data, multi_idx, flat_idx, elems;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function elems$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              elems = function _elems(d) {\n                return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function elems$(_context5) {\n                  while (1) {\n                    switch (_context5.prev = _context5.next) {\n                      case 0:\n                        if (!(d === shape.length)) {\n                          _context5.next = 5;\n                          break;\n                        }\n\n                        _context5.next = 3;\n                        return [multi_idx.slice(), data[flat_idx++]];\n\n                      case 3:\n                        _context5.next = 11;\n                        break;\n\n                      case 5:\n                        multi_idx[d] = 0;\n\n                      case 6:\n                        if (!(multi_idx[d] < shape[d])) {\n                          _context5.next = 11;\n                          break;\n                        }\n\n                        return _context5.delegateYield(elems(d + 1), \"t0\", 8);\n\n                      case 8:\n                        multi_idx[d]++;\n                        _context5.next = 6;\n                        break;\n\n                      case 11:\n                      case \"end\":\n                        return _context5.stop();\n                    }\n                  }\n                }, _marked4);\n              };\n\n              _marked4 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(elems);\n              shape = this.shape, data = this.data, multi_idx = new Int32Array(shape.length); // <- index in result\n\n              flat_idx = 0;\n              return _context6.delegateYield(elems(0), \"t0\", 5);\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, elems, this);\n    })\n  }, {\n    key: \"forElems\",\n    value: function forElems(consumer) {\n      var shape = this.shape,\n          data = this.data,\n          multi_idx = new Int32Array(shape.length); // <- index in result\n\n      var flat_idx = 0;\n\n      function forEntries(d) {\n        if (d === shape.length) consumer.apply(void 0, [data[flat_idx++]].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(multi_idx)));else for (multi_idx[d] = 0; multi_idx[d] < shape[d]; multi_idx[d]++) {\n          forEntries(d + 1);\n        }\n      }\n\n      forEntries(0);\n    } //\n    // TRANSFORMATION\n    //\n\n  }, {\n    key: \"valueOf\",\n    value: function valueOf() {\n      if (this.shape.length === 0) return this.data[0];\n      return this;\n    }\n  }, {\n    key: \"mapElems\",\n    value: function mapElems(dtype, mapper) {\n      if (null == mapper) {\n        if (dtype == null) return new NDArray(this.shape, this.data.slice());\n\n        if (dtype instanceof Function) {\n          mapper = dtype;\n          dtype = undefined;\n        }\n      }\n\n      if (null == mapper) mapper = function mapper(x) {\n        return x;\n      };\n      return Object(_zip_elems__WEBPACK_IMPORTED_MODULE_10__[\"zip_elems\"])([this], dtype, mapper);\n    }\n  }, {\n    key: \"transpose\",\n    value: function transpose() // <- TODO allow for ellipsis '...' as input\n    {\n      for (var _len2 = arguments.length, axes = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        axes[_key2] = arguments[_key2];\n      }\n\n      axes = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(axes);\n      var newShape = Int32Array.from(this.shape),\n          ndim = newShape.length;\n      var strides = new Int32Array(ndim);\n      if (ndim > 0) strides[ndim - 1] = 1;\n\n      for (var i = ndim; --i > 0;) {\n        strides[i - 1] = newShape[i] * strides[i];\n      } // BY DEFAULT THE LAST 2 AXES ARE SWAPPED\n\n\n      if (axes.length == 0) {\n        if (ndim <= 1) return this.sliceElems();\n        newShape[ndim - 2] = this.shape[ndim - 1];\n        newShape[ndim - 1] = this.shape[ndim - 2];\n        var tmp = strides[ndim - 2];\n        strides[ndim - 2] = strides[ndim - 1];\n        strides[ndim - 1] = tmp;\n      } // \n      else {\n          var set = new Set(axes),\n              _strides = strides;\n          strides = new Int32Array(ndim);\n          if (set.size != axes.length) throw new Error('Duplicate axes are not allowed.');\n\n          for (var _i = axes.length; _i-- > 0;) {\n            var j = axes[_i];\n            if (0 > j || j >= ndim) throw new Error('Axis out of bounds.');\n            newShape[_i] = this.shape[j];\n            strides[_i] = _strides[j];\n          } // COMPLETE WITH REMAINING/MISSING/IMPLIED INDICES\n\n\n          for (var _i2 = 0, _j5 = set.size; _i2 < ndim; _i2++) {\n            if (!set.has(_i2)) {\n              newShape[_j5] = this.shape[_i2];\n              strides[_j5++] = _strides[_i2];\n            }\n          }\n        }\n\n      var oldData = this.data,\n          newData = new oldData.__proto__.constructor(oldData.length);\n      var newI = oldData.length;\n\n      function copy(d, oldI) {\n        if (ndim > d) for (var _i3 = newShape[d]; _i3-- > 0; oldI -= strides[d]) {\n          copy(d + 1, oldI);\n        } else newData[--newI] = oldData[oldI];\n      }\n\n      copy(0, newI - 1);\n      return new NDArray(newShape, newData);\n    }\n  }, {\n    key: \"reshape\",\n    value: function reshape() {\n      for (var _len3 = arguments.length, shape = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        shape[_key3] = arguments[_key3];\n      }\n\n      shape = Int32Array.from(shape);\n      var len = this.data.length;\n      var rest = 1,\n          infer = -1;\n\n      for (var i = shape.length; --i >= 0;) {\n        if (shape[i] < 0) {\n          if (shape[i] !== -1) throw new Error('Invalid dimension: ' + shape[i]);\n          if (infer !== -1) throw new Error('At most on dimension may be -1.');\n          infer = i;\n        } else rest *= shape[i];\n      }\n\n      if (infer !== -1) {\n        if (0 !== len % rest) throw new Error('Shape cannot be inferred.');\n        shape[infer] = len / rest;\n      }\n\n      return new NDArray(shape, this.data);\n    }\n  }, {\n    key: \"reduceElems\",\n    value: function reduceElems(axes, dtype, reducer) {\n      if (null == reducer) {\n        if (null == dtype) return this.data.reduce(axes);\n        if ('string' === typeof axes) return this.data.reduce(dtype);\n        reducer = dtype;\n        dtype = undefined;\n      }\n\n      if (null == dtype) dtype = 'object';\n      if (!Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"is_subdtype\"])(this.dtype, dtype)) throw new Error('New dtype must be a super-dtype.');\n      var oldNDim = this.ndim;\n      if ('number' === typeof axes) axes = [axes];\n\n      if (axes instanceof NDArray) {\n        if (!Object(_dt__WEBPACK_IMPORTED_MODULE_11__[\"is_subdtype\"])(axes.dtype, 'int32')) throw new Error(\"Invalid dtype \".concat(axes.dtype, \" for axes.\"));\n        if (axes.ndim === 1) axes = axes.data;else throw new Error('Only 1D nd.Array allowed for axes.');\n      }\n\n      axes = new Set( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(function _callee() {\n        var _iterator, _step, ax;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function _callee$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _iterator = _createForOfIteratorHelper(axes);\n                _context7.prev = 1;\n\n                _iterator.s();\n\n              case 3:\n                if ((_step = _iterator.n()).done) {\n                  _context7.next = 12;\n                  break;\n                }\n\n                ax = _step.value;\n                if (0 > ax) ax += oldNDim;\n\n                if (!(0 > ax || ax >= oldNDim)) {\n                  _context7.next = 8;\n                  break;\n                }\n\n                throw new Error('Reduction axis ' + ax + ' out of bounds.');\n\n              case 8:\n                _context7.next = 10;\n                return +ax;\n\n              case 10:\n                _context7.next = 3;\n                break;\n\n              case 12:\n                _context7.next = 17;\n                break;\n\n              case 14:\n                _context7.prev = 14;\n                _context7.t0 = _context7[\"catch\"](1);\n\n                _iterator.e(_context7.t0);\n\n              case 17:\n                _context7.prev = 17;\n\n                _iterator.f();\n\n                return _context7.finish(17);\n\n              case 20:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee, null, [[1, 14, 17, 20]]);\n      })());\n      var oldShape = this.shape,\n          newShape = oldShape.filter(function (size, i) {\n        return !axes.has(i);\n      }),\n          newData = new _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][dtype](newShape.reduce(function (a, b) {\n        return a * b;\n      }, 1)),\n          oldData = this.data;\n      var newIdx = 0,\n          oldIdx = 0;\n\n      function fill(d, reduce) {\n        if (oldShape.length === d) {\n          if (reduce) newData[newIdx] = reducer(oldData[oldIdx++], newData[newIdx]);else newData[newIdx] = oldData[oldIdx++];\n          ++newIdx;\n        } else if (axes.has(d)) {\n          var idx = newIdx;\n\n          for (var j = oldShape[d]; j-- > 0; reduce = true) // <- copy over very first value and only then start reduction\n          {\n            newIdx = idx;\n            fill(d + 1, reduce);\n          }\n        } else for (var _j6 = oldShape[d]; _j6-- > 0;) {\n          fill(d + 1, reduce);\n        }\n      }\n\n      fill(0, false);\n      if (newIdx != newData.length) throw new Error([newIdx, newData.length]);\n      if (oldIdx != this.data.length) throw new Error([oldIdx, this.data.length]);\n      return new NDArray(newShape, newData);\n    }\n  }, {\n    key: \"sliceElems\",\n    value: function sliceElems() {\n      for (var _len4 = arguments.length, slices = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        slices[_key4] = arguments[_key4];\n      }\n\n      var oldNdim = this.ndim,\n          oldShape = this.shape;\n      var nEllipses = 0,\n          nNew = 0,\n          nReduced = 0,\n          // <- dimensions of this matrix that to not appear in the sliced one\n      nSliced = 0; // some basic acCOUNTing\n\n      for (var _i4 = 0, _slices = slices; _i4 < _slices.length; _i4++) {\n        var slc = _slices[_i4];\n        if (slc === '...') ++nEllipses;else if (slc === 'new') ++nNew;else if (typeof slc === 'number') {\n          if (!(slc % 1 == 0)) throw new Error('Only integral indices allowed.');else ++nReduced;\n        } else {\n          var len = slc.length;\n          if (typeof len !== 'number' || !(len % 1 == 0) || len > 3 || len == 1) throw new Error('Illegal argument(s).');\n          ++nSliced;\n        }\n      }\n\n      if (nEllipses > 1) throw new Error('Highlander! There can be only one ... (ellipsis).');\n      if (nEllipses == 0) slices.push('...');\n      if (nReduced + nSliced > oldNdim) throw new Error('Cannot sliced more dimensions than available.'); // fill in omitted slice arguments and replace ellipsis\n\n      var off = 0;\n      var strides = [],\n          newShape = Int32Array.from( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.mark(function _callee2() {\n        var d, stride, i, _slc, _i5, _slc2, _slc3, _slc3$, start, _slc3$2, end, _slc3$3, step;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_8___default.a.wrap(function _callee2$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                d = oldNdim, stride = 1;\n                i = slices.length;\n\n              case 2:\n                if (!(--i >= 0)) {\n                  _context8.next = 54;\n                  break;\n                }\n\n                _slc = slices[i];\n                _context8.t0 = _slc;\n                _context8.next = _context8.t0 === 'new' ? 7 : _context8.t0 === '...' ? 11 : 21;\n                break;\n\n              case 7:\n                strides.push(0);\n                _context8.next = 10;\n                return 1;\n\n              case 10:\n                return _context8.abrupt(\"break\", 52);\n\n              case 11:\n                _i5 = nReduced + nSliced;\n\n              case 12:\n                if (!(_i5 < oldNdim)) {\n                  _context8.next = 20;\n                  break;\n                }\n\n                strides.push(stride);\n                stride *= oldShape[--d];\n                _context8.next = 17;\n                return oldShape[d];\n\n              case 17:\n                _i5++;\n                _context8.next = 12;\n                break;\n\n              case 20:\n                return _context8.abrupt(\"break\", 52);\n\n              case 21:\n                --d;\n\n                if (!('number' === typeof _slc)) {\n                  _context8.next = 29;\n                  break;\n                }\n\n                if (0 > _slc) _slc += oldShape[d];\n\n                if (!(0 > _slc || _slc >= oldShape[d])) {\n                  _context8.next = 26;\n                  break;\n                }\n\n                throw new Error('Index out of bounds.');\n\n              case 26:\n                off += stride * _slc;\n                _context8.next = 51;\n                break;\n\n              case 29:\n                _slc2 = _slc, _slc3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_slc2, 3), _slc3$ = _slc3[0], start = _slc3$ === void 0 ? undefined : _slc3$, _slc3$2 = _slc3[1], end = _slc3$2 === void 0 ? undefined : _slc3$2, _slc3$3 = _slc3[2], step = _slc3$3 === void 0 ? 1 : _slc3$3;\n                if (end < 0) end += oldShape[d];\n                if (start < 0) start += oldShape[d];\n\n                if (!(0 > start || start >= oldShape[d])) {\n                  _context8.next = 34;\n                  break;\n                }\n\n                throw new Error('Slice start out of bounds.');\n\n              case 34:\n                if (!(step == 0)) {\n                  _context8.next = 36;\n                  break;\n                }\n\n                throw new Error('Stride/step cannot be zero.');\n\n              case 36:\n                if (!(step < 0)) {\n                  _context8.next = 43;\n                  break;\n                }\n\n                if (start == null) start = oldShape[d] - 1;\n                if (end == null) end = -1;\n\n                if (!(-1 > end || end >= oldShape[d])) {\n                  _context8.next = 41;\n                  break;\n                }\n\n                throw new Error('Slice end out of bounds.');\n\n              case 41:\n                _context8.next = 47;\n                break;\n\n              case 43:\n                if (start == null) start = 0;\n                if (end == null) end = oldShape[d];\n\n                if (!(0 > end || end > oldShape[d])) {\n                  _context8.next = 47;\n                  break;\n                }\n\n                throw new Error('Slice end out of bounds.');\n\n              case 47:\n                strides.push(stride * step);\n                off += stride * start;\n                _context8.next = 51;\n                return 1 + Math.trunc((-Math.sign(step) + end - start) / step);\n\n              case 51:\n                stride *= oldShape[d];\n\n              case 52:\n                _context8.next = 2;\n                break;\n\n              case 54:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee2);\n      })());\n      var oldData = this.data,\n          newData = new _dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"][this.dtype](newShape.reduce(function (a, b) {\n        return a * b;\n      }, 1));\n      var newIdx = 0;\n\n      function fill(d, oldIdx) {\n        if (0 === d) newData[newIdx++] = oldData[oldIdx];else for (var i = newShape[--d]; i-- > 0; oldIdx += strides[d]) {\n          fill(d, oldIdx);\n        }\n      }\n\n      fill(newShape.length, off);\n      newShape.reverse();\n      return new NDArray(newShape, newData);\n    } //    convolve(options, conv_op) // <- IDEA: img.convolve({shape=[4,4,3], paddings=['same','same','none']}, (values, ...indices) => values.sum() )\n\n  }, {\n    key: \"ndim\",\n    get: function get() {\n      return this.shape.length;\n    }\n  }, {\n    key: \"dtype\",\n    get: function get() {\n      for (var _i6 = 0, _Object$entries = Object.entries(_dt__WEBPACK_IMPORTED_MODULE_11__[\"ARRAY_TYPES\"]); _i6 < _Object$entries.length; _i6++) {\n        var _Object$entries$_i = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_Object$entries[_i6], 2),\n            dtype = _Object$entries$_i[0],\n            ArrayType = _Object$entries$_i[1];\n\n        if (this.data instanceof ArrayType) return dtype;\n      }\n\n      throw new Error('Data type could not determined.');\n    }\n  }, {\n    key: \"T\",\n    get: function get() {\n      if (this.ndim == 0) return this.sliceElems(); // <- TODO maybe [[]]\n\n      if (this.ndim == 1) return this.sliceElems([], 'new');\n      return this.transpose();\n    }\n  }, {\n    key: \"H\",\n    get: function get() {\n      var result = this.T;\n      if (this.dtype != 'object' && this.dtype != 'complex128') return result;\n      return result.mapElems(math.conj);\n    }\n  }]);\n\n  return NDArray;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7___default()(Function));\n\n//# sourceURL=webpack://nd/./src/nd_array.js?");

/***/ }),

/***/ "./src/opt/_lbfgs_solver.js":
/*!**********************************!*\
  !*** ./src/opt/_lbfgs_solver.js ***!
  \**********************************/
/*! exports provided: LBFGS_Solver */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LBFGS_Solver\", function() { return LBFGS_Solver; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./line_search/line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar LBFGS_Solver = /*#__PURE__*/function () {\n  function LBFGS_Solver(M, N) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, LBFGS_Solver);\n\n    this.dXdG = new Float64Array(M);\n    this.dX = new Float64Array(M * N);\n    this.dG = new Float64Array(M * N);\n    this.tmp = new Float64Array(M);\n    Object.assign(this, {\n      M: M,\n      N: N\n    });\n    this.m = 0;\n    this.off = 0;\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(LBFGS_Solver, [{\n    key: \"update\",\n    value: function update(dx, dg) {\n      var M = this.M,\n          N = this.N,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dX = this.dX;\n      if (dx.length !== N) throw new Error('Assertion failed.');\n      if (dg.length !== N) throw new Error('Assertion failed.');\n      var dxdg = 0;\n\n      for (var j = N; j-- > 0;) {\n        dxdg += dx[j] * dg[j];\n      }\n\n      if (!(0 < dxdg)) throw new _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_2__[\"LineSearchNoProgressError\"]();\n      if (this.m === M) this.off = (this.off + 1) % M;else this.m++;\n      var i = (this.off + this.m - 1) % M;\n      dXdG[i] = dxdg;\n\n      for (var _j = N; _j-- > 0;) {\n        dX[N * i + _j] = dx[_j];\n      }\n\n      for (var _j2 = N; _j2-- > 0;) {\n        dG[N * i + _j2] = dg[_j2];\n      }\n    }\n  }, {\n    key: \"forget\",\n    value: function forget(k) {\n      if (0 !== k % 1) throw new Error('Assertion failed.');\n      if (!(k >= 0)) throw new Error('Assertion failed.');\n      if (!(k <= this.m)) throw new Error('Assertion failed.');\n      this.off = (this.off + k) % this.M;\n      this.m -= k;\n    }\n  }, {\n    key: \"compute_Hv_phase1\",\n    value: function compute_Hv_phase1(v) {\n      var M = this.M,\n          N = this.N,\n          dG = this.dG,\n          m = this.m,\n          dXdG = this.dXdG,\n          dX = this.dX,\n          off = this.off,\n           = this.tmp;\n      if (v.length !== N) throw new Error(\"Assertion failed.\");\n\n      for (var I = m; I-- > 0;) {\n        var i = off + I;\n        i -= (i >= M) * M;\n        var i = 0;\n\n        for (var j = N; j-- > 0;) {\n          i += dX[N * i + j] * v[j];\n        }\n\n        [i] = i /= dXdG[i];\n\n        for (var _j3 = N; _j3-- > 0;) {\n          v[_j3] -= i * dG[N * i + _j3];\n        }\n      }\n    }\n  }, {\n    key: \"compute_Hv_phase2\",\n    value: function compute_Hv_phase2(v) {\n      var M = this.M,\n          N = this.N,\n          dG = this.dG,\n          m = this.m,\n          dXdG = this.dXdG,\n          dX = this.dX,\n          off = this.off,\n           = this.tmp;\n      if (v.length !== N) throw new Error(\"Assertion failed.\");\n\n      for (var I = 0; I < m; I++) {\n        var i = off + I;\n        i -= (i >= M) * M;\n        var i = 0;\n\n        for (var j = N; j-- > 0;) {\n          i += dG[N * i + j] * v[j];\n        }\n\n        i /= dXdG[i];\n\n        for (var _j4 = N; _j4-- > 0;) {\n          v[_j4] += ([i] - i) * dX[N * i + _j4];\n        }\n      }\n    }\n  }]);\n\n  return LBFGS_Solver;\n}();\n\n//# sourceURL=webpack://nd/./src/opt/_lbfgs_solver.js?");

/***/ }),

/***/ "./src/opt/_lbfgsb_solver.js":
/*!***********************************!*\
  !*** ./src/opt/_lbfgsb_solver.js ***!
  \***********************************/
/*! exports provided: LBFGSB_Solver */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LBFGSB_Solver\", function() { return LBFGSB_Solver; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _arrays_heap_sort_gen__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../arrays/heap_sort_gen */ \"./src/arrays/heap_sort_gen.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _la_cholesky__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../la/cholesky */ \"./src/la/cholesky.js\");\n/* harmony import */ var _la_ldl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../la/ldl */ \"./src/la/ldl.js\");\n/* harmony import */ var _la_pldlp__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../la/pldlp */ \"./src/la/pldlp.js\");\n/* harmony import */ var _la_tri__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../la/tri */ \"./src/la/tri.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\n\n\nvar USE_LDL = false; // References\n// ----------\n// .. [1] \"REPRESENTATIONS OF QUASI-NEWTON MATRICES AND THEIR USE IN LIMITED MEMORY METHODS\"\n//         by Richard H. Byrd, Jorge Nocedal and Robert B. Schnabel\n//         Technical Report NAM-03, June 1992; revised January 21, 1996\n//         http://users.iems.northwestern.edu/~nocedal/PDFfiles/representations.pdf\n//\n// .. [2] \"A LIMITED MEMORY ALGORITHM FOR BOUND CONSTRAINED OPTIMIZATION\"\n//         by Richard H. Byrd, Peihuang Lu, Jorge Nocedal and Ciyou Zhu\n//         Technical Report NAM-08; Revised: May 1994\n//         http://users.iems.northwestern.edu/~nocedal/PDFfiles/limited.pdf\n// Compares to [2], the following symbols have been renamed in the source:\n//\n//   Y -> dG\n//   S -> dX\n//\n// dG is the delta in gradients between iterations. dX is the delta in X.\n// The names dG and dX therefore seemed to be more intuitive.\n\n/** Computes the dot product of two arrays.\n */\n\nvar dot = function dot(u, v) {\n  if (u.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (v.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (u.length !== v.length) throw new Error('Assertion failed.');\n  var uv = 0;\n\n  for (var i = u.length; i-- > 0;) {\n    uv += u[i] * v[i];\n  }\n\n  return uv;\n};\n\nvar LBFGSB_Solver = /*#__PURE__*/function () {\n  function LBFGSB_Solver(M, N) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, LBFGSB_Solver);\n\n    if (M % 1 !== 0) throw new Error('Assertion failed.');\n    if (N % 1 !== 0) throw new Error('Assertion failed.');\n    if (!(0 < M)) throw new Error('Assertion failed.');\n    if (!(0 < N)) throw new Error('Assertion failed.');\n    this.m = 0;\n    this.M = M | 0;\n    this.N = N | 0;\n    this._scale = 1;\n    this.dX = new Float64Array(M * N);\n    this.dG = new Float64Array(M * N);\n    this.dXdX = new Float64Array(M * M);\n    this.dXdG = new Float64Array(M * M);\n    this.dGdG = new Float64Array(M * M);\n    this.D = new Float64Array(M);\n    this._J = new Float64Array(M * M);\n    this._J_invalid = true;\n    this.travels = new Float64Array(N);\n    this.Bdx = new Float64Array(2 * M);\n    this.Bg = new Float64Array(2 * M);\n    this.Bei = new Float64Array(2 * M);\n    this.M_WAAW = new Float64Array(4 * M * M);\n    if (!USE_LDL) this.P = new Int32Array(2 * M);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(LBFGSB_Solver, [{\n    key: \"forget\",\n    value: function forget(k) {\n      // TODO:\n      //   Moving all rows/columns up by just to forget old entries not efficient.\n      //   A better way would be to use the matrix rows/columns like a circular buffer\n      //   restarting in the rop row each time the bottom is reached. That will\n      //   however make the implementation of all the member methods quite a bit\n      //   more complicated.\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dX = this.dX,\n          dXdX = this.dXdX,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dGdG = this.dGdG,\n          D = this.D;\n      if (m > M) throw new Error('Assertion failed.');\n      if (k % 1 !== 0) throw new Error('Assertion failed.');\n      if (!(k > 0)) throw new Error('Assertion failed.');\n      if (!(k <= m)) throw new Error('Assertion failed.'); // MAKE SPACE IN LAST ROW BY OVERWRITING 1ST ROW\n\n      for (var _i = 0, _arr = [dX, dG]; _i < _arr.length; _i++) {\n        var A = _arr[_i];\n\n        for (var i = k; i < m; i++) {\n          for (var j = 0; j < N; j++) {\n            A[N * (i - k) + j] = A[N * i + j];\n          }\n        }\n      }\n\n      for (var _i2 = 0, _arr2 = [dXdX, dXdG, dGdG]; _i2 < _arr2.length; _i2++) {\n        var _A = _arr2[_i2];\n\n        for (var _i3 = k; _i3 < m; _i3++) {\n          for (var _j = k; _j < m; _j++) {\n            _A[M * (_i3 - k) + (_j - k)] = _A[M * _i3 + _j];\n          }\n        }\n      }\n\n      for (var _i4 = k; _i4 < m; _i4++) {\n        D[_i4 - k] = D[_i4];\n      }\n\n      this.m = m - k;\n      this._J_invalid = true;\n    }\n  }, {\n    key: \"update\",\n    value: function update(dx, dg) {\n      var M = this.M,\n          N = this.N,\n          dX = this.dX,\n          dXdX = this.dXdX,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dGdG = this.dGdG,\n          D = this.D;\n      if (N !== dx.length) throw new Error('Assertion failed.');\n      if (N !== dg.length) throw new Error('Assertion failed.');\n      if (this.m >= M) this.forget(1);\n      this.m++;\n      var m = this.m,\n          i = m - 1;\n      if (m > M) throw new Error('Assertion failed.');\n\n      for (var j = 0; j < N; j++) {\n        dX[N * i + j] = dx[j];\n      }\n\n      for (var _j2 = 0; _j2 < N; _j2++) {\n        dG[N * i + _j2] = dg[_j2];\n      } // UPDATE dX @ dX.T\n\n\n      for (var _j3 = 0; _j3 < m; _j3++) {\n        var dxdx = 0;\n\n        for (var k = 0; k < N; k++) {\n          dxdx += dX[N * i + k] * dX[N * _j3 + k];\n        }\n\n        dXdX[M * i + _j3] = dXdX[M * _j3 + i] = dxdx;\n      } // UPDATE dX @ dG.T\n\n\n      for (var _j4 = 0; _j4 < m; _j4++) {\n        dXdG[M * i + _j4] = 0;\n\n        for (var _k = 0; _k < N; _k++) {\n          dXdG[M * i + _j4] += dX[N * i + _k] * dG[N * _j4 + _k];\n        }\n\n        dXdG[M * _j4 + i] = 0;\n\n        for (var _k2 = 0; _k2 < N; _k2++) {\n          dXdG[M * _j4 + i] += dX[N * _j4 + _k2] * dG[N * i + _k2];\n        }\n      } // UPDATE sqrt( diag(dX @ dG.T) )\n\n\n      D[i] = Math.sqrt(dXdG[M * i + i]); // UPDATE dG @ dG.T\n\n      for (var _j5 = 0; _j5 < m; _j5++) {\n        var dgdg = 0;\n\n        for (var _k3 = 0; _k3 < N; _k3++) {\n          dgdg += dG[N * i + _k3] * dG[N * _j5 + _k3];\n        }\n\n        dGdG[M * i + _j5] = dGdG[M * _j5 + i] = dgdg;\n      } // INVALIDATE J\n\n\n      this._J_invalid = true; // <- set J to be recomputed on demand\n    }\n  }, {\n    key: \"_compute_Bv\",\n    value: function _compute_Bv(bv, Bv) {\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dX = this.dX,\n          J = this.J,\n          D = this.D,\n          scale = this.scale;\n      if (bv.length !== M * 2) throw new Error('Assertion failed.');\n      if (Bv.length !== N) throw new Error('Assertion failed.');\n\n      for (var i = 2 * m; i-- > m;) {\n        bv[i] *= -1;\n      }\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_tril_t_solve\"])(m, M, 1, J, 0, bv, m);\n\n      for (var _i5 = 0; _i5 < m; _i5++) {\n        bv[_i5] /= D[_i5];\n      }\n\n      for (var j = 1; j < m; j++) {\n        for (var _i6 = 0; _i6 < j; _i6++) {\n          bv[_i6] += dXdG[M * j + _i6] * bv[m + j] / dXdG[M * _i6 + _i6];\n        }\n      }\n\n      for (var _i7 = N; _i7-- > 0;) {\n        for (var _j6 = m; _j6-- > 0;) {\n          Bv[_i7] += dX[N * _j6 + _i7] * bv[m + _j6] * scale;\n        }\n      }\n\n      for (var _i8 = N; _i8-- > 0;) {\n        for (var _j7 = m; _j7-- > 0;) {\n          Bv[_i8] += dG[N * _j7 + _i8] * bv[_j7];\n        }\n      }\n    }\n  }, {\n    key: \"compute_Bv\",\n    value: function compute_Bv(v, Bv) {\n      var N = this.N,\n          scale = this.scale,\n          bv = this.Bg;\n      if (v.length !== N) throw new Error('Assertion failed.');\n      this.compute_bv(v, bv);\n\n      for (var i = N; i-- > 0;) {\n        Bv[i] = v[i] * scale;\n      }\n\n      this._compute_Bv(bv, Bv);\n    }\n    /** This method \"sort of\" computes half an inner product over B.\n     *  To compute an inner product u.T @ B @ v, You can use:\n     *\n     *    compute_bv(u, ub);\n     *    compute_bv(v, vb);\n     *    compute_ubbv(ub, dot(u,v), bv)\n     */\n\n  }, {\n    key: \"compute_bv\",\n    value: function compute_bv(v, bv) {\n      //                                \n      //                               \n      //                                                  -1                                        -1                           \n      //                                                                                                                      \n      //                                   D   -D \\ L        -I       0         D      0                    dG            \n      //                                                                                                                      \n      // uWMWv = u   dG   B0dX           v\n      //                                                                                                                      \n      //                                    0      J            0       I      -L / D    J                   dXB0          \n      //                                                                                                                      \n      //                                                                                                                         \n      //                               \n      //                                \n      //                                                                      -1                        \n      //                                                                                              \n      //                    -I       0                        D      0                  dG           \n      //                                                                                              \n      //        =: ubbv    =>    b =     \n      //                                                                                              \n      //                     0       I                     -L / D    J                 dXB0         \n      //                                                                                              \n      //                                                                                                \n      //\n      // \n      // B = scaleI - WMW =>  scaleuv - uWMWv\n      //\n      // Where:\n      //   L = tril(dXdG, -1)\n      //   D = diag(dXdG)\n      //   I = eye(m)\n      //   J = cholesky( dXB0dX + (L/D)L )\n      //  B0 = Iscale\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dX = this.dX,\n          J = this.J,\n          D = this.D,\n          scale = this.scale;\n      if (v.length !== N) throw new Error('Assertion failed.');\n      if (bv.length !== 2 * M) throw new Error('Assertion failed.');\n      bv.fill(0.0, 0, 2 * m);\n\n      for (var i = 0; i < m; i++) {\n        for (var j = 0; j < N; j++) {\n          bv[i] += dG[N * i + j] * v[j];\n        }\n      }\n\n      for (var _i9 = 1; _i9 < m; _i9++) {\n        for (var _j8 = 0; _j8 < _i9; _j8++) {\n          bv[m + _i9] += dXdG[M * _i9 + _j8] * bv[_j8] / dXdG[M * _j8 + _j8];\n        }\n      }\n\n      for (var _i10 = 0; _i10 < m; _i10++) {\n        bv[_i10] /= D[_i10];\n      }\n\n      for (var _i11 = 0; _i11 < m; _i11++) {\n        for (var _j9 = 0; _j9 < N; _j9++) {\n          bv[m + _i11] += dX[N * _i11 + _j9] * v[_j9] * scale;\n        }\n      }\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_tril_solve\"])(m, M, 1, J, 0, bv, m);\n    }\n  }, {\n    key: \"compute_be\",\n    value: function compute_be(j, bej) {\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dG = this.dG,\n          dXdG = this.dXdG,\n          dX = this.dX,\n          J = this.J,\n          D = this.D,\n          scale = this.scale;\n      if (j % 1 !== 0) throw new Error('Assertion failed.');\n      j |= 0;\n      if (!(j >= 0)) throw new Error('Assertion failed.');\n      if (!(j < N)) throw new Error('Assertion failed.');\n      if (bej.length !== 2 * M) throw new Error('Assertion failed.');\n      bej.fill(0.0, 0, 2 * m);\n\n      for (var i = 0; i < m; i++) {\n        bej[i] += dG[N * i + j];\n      }\n\n      for (var _i12 = 1; _i12 < m; _i12++) {\n        for (var _j10 = 0; _j10 < _i12; _j10++) {\n          bej[m + _i12] += dXdG[M * _i12 + _j10] * bej[_j10] / dXdG[M * _j10 + _j10];\n        }\n      }\n\n      for (var _i13 = 0; _i13 < m; _i13++) {\n        bej[_i13] /= D[_i13];\n      }\n\n      for (var _i14 = 0; _i14 < m; _i14++) {\n        bej[m + _i14] += dX[N * _i14 + j] * scale;\n      }\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_tril_solve\"])(m, M, 1, J, 0, bej, m);\n    }\n  }, {\n    key: \"compute_ubbv\",\n    value: function compute_ubbv(hu, uv, hv) {\n      var m = this.m,\n          M = this.M,\n          scale = this.scale;\n      uv *= scale;\n      if (isNaN(uv)) throw new Error('Assertion failed.');\n      if (hu.length !== 2 * M) throw new Error('Assertion failed.');\n      if (hv.length !== 2 * M) throw new Error('Assertion failed.');\n      var result = 0;\n\n      for (var i = 2 * m; i-- > m;) {\n        result -= hu[i] * hv[i];\n      }\n\n      for (var _i15 = m; _i15-- > 0;) {\n        result += hu[_i15] * hv[_i15];\n      }\n\n      return result + uv;\n    }\n  }, {\n    key: \"compute_cauchyGeneralized\",\n    value: function compute_cauchyGeneralized(G, X, bounds, indices) {\n      var complete = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      var m = this.m,\n          N = this.N,\n          Bg = this.Bg,\n          Bdx = this.Bdx,\n          Bei = this.Bei,\n          scale = this.scale,\n          travels = this.travels;\n      if (G.length !== N) throw new Error('Assertion failed.');\n      if (X.length !== N) throw new Error('Assertion failed.'); //    if(     dX.length !==  N) throw new Error('Assertion failed.');\n\n      if (bounds.length !== 2 * N) throw new Error('Assertion failed.');\n      if (indices.length !== N) throw new Error('Assertion failed.');\n      /*DEBUG*/\n\n      if (!indices.slice().sort(function (i, j) {\n        return i - j;\n      }).every(function (i, I) {\n        return i === I;\n      }))\n        /*DEBUG*/\n        throw new Error('Assertion failed.');\n\n      for (var i = N; i-- > 0;) {\n        if (!(X[i] >= bounds[2 * i + 0])) throw new Error('Assertion failed.');\n        if (!(X[i] <= bounds[2 * i + 1])) throw new Error('Assertion failed.');\n      }\n\n      for (var _i16 = N; _i16-- > 0;) {\n        if (0 === G[_i16]) travels[_i16] = Infinity;else {\n          var end = bounds[2 * _i16 + (G[_i16] < 0)];\n          travels[_i16] = (X[_i16] - end) / G[_i16];\n          if (!(0 <= travels[_i16])) throw new Error('Assertion failed: ' + travels[_i16]);\n          var n = 0;\n\n          while (Math.sign(G[_i16]) * (X[_i16] - travels[_i16] * G[_i16] - end) < 0) {\n            if (++n > 2) throw new Error('Assertion failed.');\n            travels[_i16] = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__[\"nextDown\"])(travels[_i16]);\n          }\n\n          if (G[_i16] < 0 && X[_i16] - travels[_i16] * G[_i16] > end) throw new Error('Assertion failed.');\n          if (G[_i16] > 0 && X[_i16] - travels[_i16] * G[_i16] < end) throw new Error('Assertion failed.');\n        }\n      }\n\n      var t = 0,\n          n_fix = 0;\n      this.compute_bv(G, Bg);\n      Bdx.fill(0.0, 0, 2 * m);\n      var fp = dot(G, G),\n          fpp = this.compute_ubbv(Bg, fp, Bg),\n          df = 0; // Make sure zero gradient entries are the very last\n      // TODO: entries with travels[i]===0 could be skipped (moved to the back) before heap_sort_gen()\n\n      var order = Object(_arrays_heap_sort_gen__WEBPACK_IMPORTED_MODULE_2__[\"heap_sort_gen\"])(indices, function (i, j) {\n        var ti = travels[i],\n            tj = travels[j];\n        if (ti < tj) return -1;\n        if (ti > tj) return +1;\n        return Math.abs(G[j]) - Math.abs(G[i]); // move entries with G[i] === 0 to the very back\n      });\n\n      var _iterator = _createForOfIteratorHelper(order),\n          _step;\n\n      try {\n        loop: for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _i17 = _step.value;\n\n          if (0 === G[_i17]) {\n            var _iterator3 = _createForOfIteratorHelper(indices.subarray(n_fix)),\n                _step3;\n\n            try {\n              for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                var k = _step3.value;\n                if (!(Number.MAX_VALUE < travels[k])) throw new Error('Assertion failed.');\n                if (0 !== G[k]) throw new Error('Assertion failed.');\n              }\n            } catch (err) {\n              _iterator3.e(err);\n            } finally {\n              _iterator3.f();\n            }\n\n            break loop;\n          }\n\n          var _end = bounds[2 * _i17 + (G[_i17] < 0)],\n              dt = travels[_i17] - t;\n          if (!(0 <= dt)) throw new Error('Assertion failed.');\n\n          if (0 === dt) {\n            // <- TODO: entries with travels[i]===0 could be skipped before this loop and _heap_sort()\n            X[_i17] = _end;\n            t = travels[_i17];\n            ++n_fix;\n            continue loop;\n          } //*DEBUG*/      if( !(0 <= fpp) ) throw new Error('Assertion failed.'); // <- B is supposed to be positive definite\n\n\n          var cp = Math.min(dt, fp / fpp);\n          if (!complete && !(cp >= dt)) // <- handles NaN\n            break loop;\n\n          if (0 < cp) {\n            for (var j = 2 * m; j-- > 0;) {\n              Bdx[j] -= cp * Bg[j];\n            }\n\n            t += cp;\n          }\n\n          if (complete && !(cp >= dt)) // <- handles NaN\n            break loop;\n          t = travels[_i17];\n          this.compute_be(_i17, Bei);\n          var eBx = this.compute_ubbv(Bei, -t * G[_i17], Bdx),\n              eBe = this.compute_ubbv(Bei, 1, Bei),\n              eBg = this.compute_ubbv(Bei, G[_i17], Bg);\n          fp -= G[_i17] * (G[_i17] + eBx) + dt * fpp;\n          fpp += G[_i17] * (G[_i17] * eBe - eBg * 2);\n\n          for (var _j11 = 2 * m; _j11-- > 0;) {\n            Bg[_j11] -= G[_i17] * Bei[_j11];\n          }\n\n          df += G[_i17] * G[_i17] * t * (t * scale / 2 - 1); // df = g.T @ dx + 0.5 * dx.T @ B @ dx = g.T @ dx + 0.5 * scale * dx.T @ dx + compute_ubbv(B @ dx, B @ dx)\n\n          X[_i17] = _end;\n          G[_i17] *= 1 - t * scale;\n          ++n_fix;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var _iterator2 = _createForOfIteratorHelper(indices.subarray(n_fix)),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _i18 = _step2.value;\n          df += G[_i18] * G[_i18] * t * (t * scale / 2 - 1); // df = g.T @ dx + 0.5 * dx.T @ B @ dx = g.T @ dx + 0.5 * scale * dx.T @ dx + compute_ubbv(B @ dx, B @ dx)\n\n          X[_i18] -= t * G[_i18];\n          G[_i18] *= 1 - t * scale;\n          if (!(X[_i18] >= bounds[2 * _i18 + 0])) throw new Error('Assertion failed.');\n          if (!(X[_i18] <= bounds[2 * _i18 + 1])) throw new Error('Assertion failed.');\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      df += 0.5 * this.compute_ubbv(Bdx, 0, Bdx); // compute new gradient (G = G0 + B @ dx)\n\n      this._compute_Bv(Bdx, G); // <- keep in mind this overwrites both Bdx and g\n\n\n      return [n_fix, df];\n    }\n  }, {\n    key: \"compute_subspace_Hv\",\n    value: function compute_subspace_Hv(v, Hv, indices, n_fix) {\n      // For more information, see [2].\n      // The goal is to solve the following subspace_problem:\n      //        _\n      // Hv = ZBZv\n      //       \n      // Where v and Hv are the input and output parameters of\n      // of compute_subspace_Hv (see above).\n      // _\n      // B is the subspace Hessian (approximation):\n      // _\n      // B = ZBZ\n      //                _\n      // The inverse of B can be written as:\n      // _                     _           _       _\n      // B = I/scale + ZW(M + scaleWAAW)WZ\n      //\n      //                                         \n      //                                        \n      //                                        \n      //       -(D+dGdG/scale)       -R       \n      //                                        \n      //                                        \n      // _                                      \n      // M = \n      //                                        \n      //                                        \n      //                                        \n      //              -R               0        \n      //                                        \n      //                                        \n      //                                         \n      //\n      // R = triu(dXdG)\n      // D = diag(dXdG)\n      //\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dX = this.dX,\n          dXdG = this.dXdG,\n          dG = this.dG,\n          dGdG = this.dGdG,\n          M_WAAW = this.M_WAAW,\n          u = this.Bei,\n          scale = this.scale;\n      if (!(indices instanceof Int32Array)) throw new Error('Assertion failed.');\n      if (v.length !== N) throw new Error('Assertion failed.');\n      if (Hv.length !== N) throw new Error('Assertion failed.');\n      if (indices.length !== N) throw new Error('Assertion failed.');\n      if (n_fix % 1 !== 0) throw new Error('Assertion failed.');\n      if (!(n_fix >= 0)) throw new Error('Assertion failed.');\n      if (!(n_fix <= N)) throw new Error('Assertion failed.');\n      /*DEBUG*/\n\n      if (!indices.slice().sort(function (i, j) {\n        return i - j;\n      }).every(function (i, I) {\n        return i === I;\n      }))\n        /*DEBUG*/\n        throw new Error('Assertion failed.'); // /*DEBUG*/    for( let i=0; i < n_fix; i++ )\n      // /*DEBUG*/      if( v[indices[i]] !== 0 ) throw new Error('Assertion failed.');\n      // indices of the inactive bound constraints\n\n      var free_indices = indices.subarray(n_fix); //\n      // RIGHT PART\n      //\n\n      for (var i = 0; i < m; i++) {\n        var sum = 0;\n\n        var _iterator4 = _createForOfIteratorHelper(free_indices),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var j = _step4.value;\n            sum += dG[N * i + j] * v[j];\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n\n        u[i] = sum / scale;\n      }\n\n      for (var _i19 = 0; _i19 < m; _i19++) {\n        var _sum = 0;\n\n        var _iterator5 = _createForOfIteratorHelper(free_indices),\n            _step5;\n\n        try {\n          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n            var _j12 = _step5.value;\n            _sum += dX[N * _i19 + _j12] * v[_j12];\n          }\n        } catch (err) {\n          _iterator5.e(err);\n        } finally {\n          _iterator5.f();\n        }\n\n        u[m + _i19] = _sum;\n      } //              _\n      // MIDDLE PART (M PART)\n      //\n\n\n      if (0 < n_fix) {\n        // indices of the active bound constraints\n        var fix_indices = indices.subarray(0, n_fix); // UPPER LEFT BLOCK\n\n        for (var _i20 = 0; _i20 < m; _i20++) {\n          for (var _j13 = 0; _j13 <= _i20; _j13++) {\n            var _sum2 = 0;\n\n            var _iterator6 = _createForOfIteratorHelper(fix_indices),\n                _step6;\n\n            try {\n              for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n                var k = _step6.value;\n                _sum2 += dG[N * _i20 + k] * dG[N * _j13 + k];\n              }\n            } catch (err) {\n              _iterator6.e(err);\n            } finally {\n              _iterator6.f();\n            }\n\n            M_WAAW[2 * m * _i20 + _j13] = _sum2;\n          }\n        } // LOWER LEFT BLOCK\n\n\n        for (var _i21 = 0; _i21 < m; _i21++) {\n          for (var _j14 = 0; _j14 < m; _j14++) {\n            var _sum3 = 0;\n\n            var _iterator7 = _createForOfIteratorHelper(fix_indices),\n                _step7;\n\n            try {\n              for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                var _k4 = _step7.value;\n                _sum3 += dX[N * _i21 + _k4] * dG[N * _j14 + _k4];\n              }\n            } catch (err) {\n              _iterator7.e(err);\n            } finally {\n              _iterator7.f();\n            }\n\n            M_WAAW[2 * m * (m + _i21) + _j14] = _sum3;\n          }\n        } // LOWER RIGHT BLOCK\n\n\n        for (var _i22 = 0; _i22 < m; _i22++) {\n          for (var _j15 = 0; _j15 <= _i22; _j15++) {\n            var _sum4 = 0;\n\n            var _iterator8 = _createForOfIteratorHelper(fix_indices),\n                _step8;\n\n            try {\n              for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n                var _k5 = _step8.value;\n                _sum4 += dX[N * _i22 + _k5] * dX[N * _j15 + _k5];\n              }\n            } catch (err) {\n              _iterator8.e(err);\n            } finally {\n              _iterator8.f();\n            }\n\n            M_WAAW[2 * m * (m + _i22) + (m + _j15)] = _sum4 * scale;\n          }\n        }\n      } else {\n        for (var _i23 = 0; _i23 < m * 2; _i23++) {\n          for (var _j16 = 0; _j16 <= _i23; _j16++) {\n            M_WAAW[2 * m * _i23 + _j16] = 0;\n          }\n        }\n      } // UPPER LEFT BLOCK\n\n\n      for (var _i24 = 0; _i24 < m; _i24++) {\n        for (var _j17 = 0; _j17 <= _i24; _j17++) {\n          M_WAAW[2 * m * _i24 + _j17] -= dGdG[M * _i24 + _j17];\n          M_WAAW[2 * m * _i24 + _j17] /= scale;\n        }\n      }\n\n      for (var _i25 = 0; _i25 < m; _i25++) {\n        M_WAAW[2 * m * _i25 + _i25] -= dXdG[M * _i25 + _i25];\n      } // LOWER LEFT BLOCK\n\n\n      for (var _i26 = 0; _i26 < m; _i26++) {\n        for (var _j18 = _i26; _j18 < m; _j18++) {\n          M_WAAW[2 * m * (m + _i26) + _j18] -= dXdG[M * _i26 + _j18];\n        }\n      } // FIXME: It remains to be seen whether or not LDL is accurate enough.\n      //        If it isn't, we have to switch to PLDLP (Bunch-Kaufman).\n\n\n      if (0 < m) {\n        if (USE_LDL) {\n          Object(_la_ldl__WEBPACK_IMPORTED_MODULE_5__[\"_ldl_decomp\"])(2 * m, 2 * m, M_WAAW, 0);\n\n          Object(_la_ldl__WEBPACK_IMPORTED_MODULE_5__[\"_ldl_solve\"])(2 * m, 2 * m, 1, M_WAAW, 0, u, 0);\n        } else {\n          var tmp = this.Bdx,\n              P = this.P;\n\n          Object(_la_pldlp__WEBPACK_IMPORTED_MODULE_6__[\"_pldlp_decomp\"])(2 * m, 2 * m, M_WAAW, 0, P, 0);\n\n          Object(_la_pldlp__WEBPACK_IMPORTED_MODULE_6__[\"_pldlp_solve\"])(2 * m, 2 * m, 1, M_WAAW, 0, P, 0, u, 0, tmp);\n        }\n      } //\n      // LEFT PART\n      //\n\n\n      Hv.fill(0.0, 0, N);\n\n      for (var _j19 = 0; _j19 < m; _j19++) {\n        var _iterator9 = _createForOfIteratorHelper(free_indices),\n            _step9;\n\n        try {\n          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n            var _i27 = _step9.value;\n            Hv[_i27] += dG[N * _j19 + _i27] * u[_j19];\n          }\n        } catch (err) {\n          _iterator9.e(err);\n        } finally {\n          _iterator9.f();\n        }\n      }\n\n      var _iterator10 = _createForOfIteratorHelper(free_indices),\n          _step10;\n\n      try {\n        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n          var _i29 = _step10.value;\n          Hv[_i29] /= scale;\n        }\n      } catch (err) {\n        _iterator10.e(err);\n      } finally {\n        _iterator10.f();\n      }\n\n      for (var _j20 = 0; _j20 < m; _j20++) {\n        var _iterator11 = _createForOfIteratorHelper(free_indices),\n            _step11;\n\n        try {\n          for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n            var _i28 = _step11.value;\n            Hv[_i28] += dX[N * _j20 + _i28] * u[m + _j20];\n          }\n        } catch (err) {\n          _iterator11.e(err);\n        } finally {\n          _iterator11.f();\n        }\n      }\n\n      var _iterator12 = _createForOfIteratorHelper(free_indices),\n          _step12;\n\n      try {\n        for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n          var _i30 = _step12.value;\n          Hv[_i30] += v[_i30] / scale;\n        }\n      } catch (err) {\n        _iterator12.e(err);\n      } finally {\n        _iterator12.f();\n      }\n    }\n  }, {\n    key: \"compute_Hv\",\n    value: function compute_Hv(v, Hv) {\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dX = this.dX,\n          dXdG = this.dXdG,\n          dG = this.dG,\n          dGdG = this.dGdG,\n          M_WAAW = this.M_WAAW,\n          u = this.Bei,\n          scale = this.scale;\n      if (v.length !== N) throw new Error('Assertion failed.');\n      if (Hv.length !== N) throw new Error('Assertion failed.'); //\n      // RIGHT PART\n      //\n\n      for (var i = 0; i < m; i++) {\n        var sum = 0;\n\n        for (var j = 0; j < N; j++) {\n          sum += dG[N * i + j] * v[j];\n        }\n\n        u[i] = sum / scale;\n      }\n\n      for (var _i31 = 0; _i31 < m; _i31++) {\n        var _sum5 = 0;\n\n        for (var _j21 = 0; _j21 < N; _j21++) {\n          _sum5 += dX[N * _i31 + _j21] * v[_j21];\n        }\n\n        u[m + _i31] = _sum5;\n      } //              _\n      // MIDDLE PART (M PART)\n      //\n\n\n      for (var _i32 = 0; _i32 < m * 2; _i32++) {\n        for (var _j22 = 0; _j22 <= _i32; _j22++) {\n          M_WAAW[2 * m * _i32 + _j22] = 0;\n        }\n      } // UPPER LEFT BLOCK\n\n\n      for (var _i33 = 0; _i33 < m; _i33++) {\n        for (var _j23 = 0; _j23 <= _i33; _j23++) {\n          M_WAAW[2 * m * _i33 + _j23] -= dGdG[M * _i33 + _j23];\n          M_WAAW[2 * m * _i33 + _j23] /= scale;\n        }\n      }\n\n      for (var _i34 = 0; _i34 < m; _i34++) {\n        M_WAAW[2 * m * _i34 + _i34] -= dXdG[M * _i34 + _i34];\n      } // LOWER LEFT BLOCK\n\n\n      for (var _i35 = 0; _i35 < m; _i35++) {\n        for (var _j24 = _i35; _j24 < m; _j24++) {\n          M_WAAW[2 * m * (m + _i35) + _j24] -= dXdG[M * _i35 + _j24];\n        }\n      } // FIXME: It remains to be seen whether or not LDL is accurate enough.\n      //        If it isn't, we have to switch to PLDLP (Bunch-Kaufman).\n\n\n      if (0 < m) {\n        if (USE_LDL) {\n          Object(_la_ldl__WEBPACK_IMPORTED_MODULE_5__[\"_ldl_decomp\"])(2 * m, 2 * m, M_WAAW, 0);\n\n          Object(_la_ldl__WEBPACK_IMPORTED_MODULE_5__[\"_ldl_solve\"])(2 * m, 2 * m, 1, M_WAAW, 0, u, 0);\n        } else {\n          var tmp = this.Bdx,\n              P = this.P;\n\n          Object(_la_pldlp__WEBPACK_IMPORTED_MODULE_6__[\"_pldlp_decomp\"])(2 * m, 2 * m, M_WAAW, 0, P, 0);\n\n          Object(_la_pldlp__WEBPACK_IMPORTED_MODULE_6__[\"_pldlp_solve\"])(2 * m, 2 * m, 1, M_WAAW, 0, P, 0, u, 0, tmp);\n        }\n      } //\n      // LEFT PART\n      //\n\n\n      Hv.fill(0.0, 0, N);\n\n      for (var _j25 = 0; _j25 < m; _j25++) {\n        for (var _i36 = 0; _i36 < N; _i36++) {\n          Hv[_i36] += dG[N * _j25 + _i36] * u[_j25];\n        }\n      }\n\n      for (var _i37 = 0; _i37 < N; _i37++) {\n        Hv[_i37] /= scale;\n      }\n\n      for (var _j26 = 0; _j26 < m; _j26++) {\n        for (var _i38 = 0; _i38 < N; _i38++) {\n          Hv[_i38] += dX[N * _j26 + _i38] * u[m + _j26];\n        }\n      }\n\n      for (var _i39 = 0; _i39 < N; _i39++) {\n        Hv[_i39] += v[_i39] / scale;\n      }\n    }\n  }, {\n    key: \"J\",\n    get: function get() {\n      var m = this.m,\n          M = this.M,\n          N = this.N,\n          dXdX = this.dXdX,\n          dXdG = this.dXdG,\n          scale = this.scale,\n          J = this._J;\n\n      if (this._J_invalid) {\n        this._J_invalid = false;\n\n        for (var i = 0; i < m; i++) {\n          for (var j = 0; j <= i; j++) {\n            J[M * i + j] = scale * dXdX[M * i + j];\n          }\n        }\n\n        for (var _i40 = 0; _i40 < m; _i40++) {\n          for (var _j27 = 0; _j27 <= _i40; _j27++) {\n            for (var k = 0; k < _j27; k++) {\n              J[M * _i40 + _j27] += dXdG[M * _i40 + k] / dXdG[M * k + k] * dXdG[M * _j27 + k];\n            }\n          }\n        }\n\n        Object(_la_cholesky__WEBPACK_IMPORTED_MODULE_4__[\"_cholesky_decomp\"])(m, M, J, 0);\n      }\n\n      return J;\n    }\n  }, {\n    key: \"scale\",\n    get: function get() {\n      return this._scale;\n    },\n    set: function set(s) {\n      s *= 1;\n      if (isNaN(s)) throw new Error('Assertion failed.');\n      if (!(0 < s)) throw new Error('Assertion failed.');\n\n      if (this._scale !== s) {\n        this._scale = s;\n        this._J_invalid = true;\n      }\n    }\n  }]);\n\n  return LBFGSB_Solver;\n}();\n\n//# sourceURL=webpack://nd/./src/opt/_lbfgsb_solver.js?");

/***/ }),

/***/ "./src/opt/_trust_region_solver_lbfgs.js":
/*!***********************************************!*\
  !*** ./src/opt/_trust_region_solver_lbfgs.js ***!
  \***********************************************/
/*! exports provided: TrustRegionSolverLBFGS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TrustRegionSolverLBFGS\", function() { return TrustRegionSolverLBFGS; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _la_norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../la/norm */ \"./src/la/norm.js\");\n/* harmony import */ var _lbfgsb_solver__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_lbfgsb_solver */ \"./src/opt/_lbfgsb_solver.js\");\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\nvar REPORT_STATE_READY = 1,\n    REPORT_STATE_NA = 2,\n    REPORT_STATE_CONSIDER = 3;\n/** Computes the dot product of two arrays.\n */\n\nvar dot = function dot(u, v) {\n  if (u.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (v.length % 1 !== 0) throw new Error('Assertion failed.');\n  if (u.length !== v.length) throw new Error('Assertion failed.');\n  var uv = 0;\n\n  for (var i = u.length; i-- > 0;) {\n    uv += u[i] * v[i];\n  }\n\n  return uv;\n};\n\nvar TrustRegionSolverLBFGS = /*#__PURE__*/function () {\n  function TrustRegionSolverLBFGS(fg, x0, _ref) {\n    var updateTol = _ref.updateTol,\n        historySize = _ref.historySize,\n        scaleInit = _ref.scaleInit;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, TrustRegionSolverLBFGS);\n\n    if (!(fg instanceof Function)) throw new Error('new TrustRegionSolverLBFGS(fg, x0, updateTol): fg must be Function.');\n    scaleInit *= 1;\n    if (!(0 < scaleInit)) throw new Error('TrustRegionSolverLBFGS(fg,x0,opt): opt.scaleInit must be greater than 0.');\n    if (!isFinite(scaleInit)) throw new Error('TrustRegionSolverLBFGS(fg,x0,opt): opt.scaleInit must be greater than 0.');\n    this.fg = fg;\n    this.report_x = x0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', x0);\n    if (x0.ndim !== 1) throw new Error('new TrustRegionSolverLBFGS(fg, x0, updateTol): x0.ndim must be 1.');\n\n    var _fg = fg(new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](x0.shape, x0.data.slice())),\n        _fg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_fg, 2),\n        f = _fg2[0],\n        g = _fg2[1];\n\n    this.report_loss = f *= 1;\n    this.report_loss_grad = g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', g);\n    if (isNaN(f)) throw new Error('new TrustRegionSolverLBFGS(fg, x0, updateTol): fg must have signature float[N] => [float,float[N]].');\n    if (g.ndim !== 1) throw new Error('new TrustRegionSolverLBFGS(fg, x0, updateTol): fg must have signature float[N] => [float,float[N]].');\n\n    var _x0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(x0.shape, 1),\n        N = _x0$shape[0];\n\n    if (g.shape[0] !== N) throw new Error('new TrustRegionSolverLBFGS(fg, x0, updateTol): fg must have signature float[N] => [float,float[N]].');\n    this.M = historySize;\n    this.N = N;\n    this.scaleInit = scaleInit = 1 / scaleInit;\n    this.lbfgs = new _lbfgsb_solver__WEBPACK_IMPORTED_MODULE_5__[\"LBFGSB_Solver\"](historySize, N);\n    this.lbfgs.scale = scaleInit;\n    this.D = new Float64Array(N);\n    this.D.fill(Math.sqrt(scaleInit)); // <- TODO: improve/rethink ... this scaling is awful\n\n    this.X0 = Float64Array.from(x0);\n    this.G0 = Float64Array.from(g); // the last X,G that was used as LBFGS update\n\n    this.last_X = Float64Array.from(x0);\n    this.last_G = Float64Array.from(g);\n    this.dg = new Float64Array(N);\n    this.loss = f;\n    this.bv = new Float64Array(2 * historySize);\n    this.newton_dX = new Float64Array(N); // this.regularized_dX = new Float64Array(N);\n\n    this.updateTol = updateTol;\n    this._report_state = REPORT_STATE_READY;\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(TrustRegionSolverLBFGS, [{\n    key: \"wiggle\",\n    value: function wiggle() {\n      var lbfgs = this.lbfgs,\n          m = lbfgs.m;\n      if (0 === m) throw new _optimization_error__WEBPACK_IMPORTED_MODULE_6__[\"OptimizationNoProgressError\"]('Too many unsuccessfull iterations.');\n      if (!(0 < m)) throw new Error('Assertion failed.');\n      lbfgs.forget(lbfgs.m + 1 >>> 1); // lbfgs.scale = scaleInit;\n      // D.fill( Math.sqrt(scaleInit) );\n    }\n  }, {\n    key: \"report\",\n    value: function report() {\n      if (this._report_state !== REPORT_STATE_READY) throw new Error('TrustRegionSolverLSQ::report: can only be called once after each makeConsideredMove() but not directly after considerMove(dX).');\n      this._report_state = REPORT_STATE_NA;\n      var result = [this.report_x, this.report_loss, this.report_loss_grad];\n      this.report_x = this.report_loss_grad = null;\n      this.report_loss = NaN;\n      return result;\n    }\n  }, {\n    key: \"considerMove\",\n    value: function considerMove(dX) {\n      var N = this.N,\n          D = this.D,\n          updateTol = this.updateTol,\n          lbfgs = this.lbfgs,\n          loss = this.loss,\n          bv = this.bv,\n          X0 = this.X0,\n          G0 = this.G0,\n          dg = this.dg,\n          last_X = this.last_X,\n          last_G = this.last_G,\n          scaleSharpness = this.scaleSharpness;\n      this._report_state = REPORT_STATE_CONSIDER;\n      if (N !== dX.length) throw new Error('Assertion failed.');\n      var X_shape = Int32Array.of(N),\n          X = new Float64Array(N); // EVALUATE FUNCTION AT CONSIDERED X\n      // compute considered x\n\n      for (var i = N; i-- > 0;) {\n        X[i] = X0[i] + dX[i];\n      } // evaluate function at considered x\n\n\n      var _this$fg = this.fg(new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](X_shape, X.slice())),\n          _this$fg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_this$fg, 2),\n          f = _this$fg2[0],\n          g = _this$fg2[1];\n\n      f *= 1;\n      g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', g);\n      if (isNaN(f)) throw new Error('Assertion failed.');\n      if (g.ndim !== 1) throw new Error('Assertion failed.');\n      if (g.shape[0] !== N) throw new Error('Assertion failed.');\n      this.report_x = new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](X_shape, X);\n      this.report_loss = f;\n      this.report_loss_grad = g;\n      g = g.data; // compute actual deltaX\n\n      for (var _i = N; _i-- > 0;) {\n        X[_i] -= X0[_i];\n      } // COMPUTE PREDICTION\n\n\n      var predict_loss = loss;\n\n      for (var _i2 = N; _i2-- > 0;) {\n        predict_loss += G0[_i2] * X[_i2];\n      }\n\n      lbfgs.compute_bv(X, bv);\n      predict_loss += 0.5 * lbfgs.compute_ubbv(bv, dot(X, X), bv); // UPDATE LBFGSB MODEL\n\n      ;\n      {\n        var dx = X;\n\n        for (var _i3 = N; _i3-- > 0;) {\n          dg[_i3] = g[_i3] - last_G[_i3];\n        }\n\n        for (var _i4 = N; _i4-- > 0;) {\n          dx[_i4] = X0[_i4] + dX[_i4];\n          dx[_i4] -= last_X[_i4];\n        }\n\n        var mx = dg.reduce(function (mx, x) {\n          return Math.max(mx, Math.abs(x));\n        }, 0); // <- avoid underflow\n\n        if (0 < mx) {\n          var gg = 0,\n              gx = 0;\n\n          for (var _i5 = N; _i5-- > 0;) {\n            var xi = dx[_i5] / mx,\n                gi = dg[_i5] / mx;\n            gg += gi * gi;\n            gx += xi * gi;\n          }\n\n          if (1 <= gg) // <- checks NaN\n            {\n              if (!isFinite(gx)) throw new Error('Assertion failed.');\n\n              if (updateTol * gg < gx) {\n                lbfgs.update(dx, dg);\n                lbfgs.scale = gg / gx; // lbfgs.scale = Math.max(lbfgs.scale, gg/gx);\n                // UPDATE SCALING\n\n                for (var _i6 = N; _i6-- > 0;) {\n                  lbfgs.compute_be(_i6, bv);\n                  var B_ii = lbfgs.compute_ubbv(bv, 1, bv);\n                  if (!(0 < B_ii)) throw new Error('Assertion failed: LBFGS model not positive definite.');\n                  D[_i6] = Math.max(D[_i6], Math.sqrt(B_ii)); // <- TODO: improve/rethink ... this scaling is awful\n                }\n\n                for (var _i7 = N; _i7-- > 0;) {\n                  last_X[_i7] = X0[_i7] + dX[_i7];\n                }\n\n                for (var _i8 = N; _i8-- > 0;) {\n                  last_G[_i8] = g[_i8];\n                }\n              }\n            }\n        }\n      } // compute considered x (again)\n\n      for (var _i9 = N; _i9-- > 0;) {\n        X[_i9] = X0[_i9] + dX[_i9];\n      }\n\n      return [predict_loss, this.report_loss];\n    }\n  }, {\n    key: \"makeConsideredMove\",\n    value: function makeConsideredMove() {\n      if (this._report_state !== REPORT_STATE_CONSIDER) throw new Error('Assertion failed.');\n      this._report_state = REPORT_STATE_READY; // discard consideration\n\n      this.loss = this.report_loss;\n      var N = this.N,\n          X0 = this.X0,\n          G0 = this.G0;\n      var x0 = this.report_x.data,\n          g0 = this.report_loss_grad.data;\n\n      for (var i = N; i-- > 0;) {\n        X0[i] = x0[i];\n      }\n\n      for (var _i10 = N; _i10-- > 0;) {\n        G0[_i10] = g0[_i10];\n      }\n    }\n  }, {\n    key: \"scaledNorm\",\n    value: function scaledNorm(X) {\n      var N = this.N,\n          D = this.D;\n      if (X.length !== N) throw new Error('Assertion failed.');\n      var norm = new _la_norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"]();\n\n      for (var i = N; i-- > 0;) {\n        norm.include(D[i] * X[i]);\n      }\n\n      return norm.result;\n    }\n  }, {\n    key: \"cauchyTravel\",\n    value: function cauchyTravel() {\n      var N = this.N,\n          lbfgs = this.lbfgs,\n          G0 = this.G0,\n          bv = this.bv; // polynomial along the gradient const1 + 2ax + bx = const2 + (a/b + x) * b\n\n      var a = 0;\n\n      for (var i = N; i-- > 0;) {\n        a += G0[i] * G0[i];\n      }\n\n      lbfgs.compute_bv(G0, bv);\n      var b = lbfgs.compute_ubbv(bv, dot(G0, G0), bv);\n      if (isNaN(b)) throw new Error('Assertion failed: ' + b);\n      return 0 === a ? 0 : 0 === b ? -Infinity : -a / b;\n    }\n  }, {\n    key: \"computeNewton\",\n    value: function computeNewton() {\n      var N = this.N,\n          lbfgs = this.lbfgs,\n          G0 = this.G0,\n          newton_dX = this.newton_dX;\n      lbfgs.compute_Hv(G0, newton_dX);\n      if (newton_dX.some(isNaN)) throw new Error('Assertion failed.');\n\n      for (var i = N; i-- > 0;) {\n        newton_dX[i] *= -1;\n      }\n    }\n  }]);\n\n  return TrustRegionSolverLBFGS;\n}();\n\n//# sourceURL=webpack://nd/./src/opt/_trust_region_solver_lbfgs.js?");

/***/ }),

/***/ "./src/opt/_trust_region_solver_lsq.js":
/*!*********************************************!*\
  !*** ./src/opt/_trust_region_solver_lsq.js ***!
  \*********************************************/
/*! exports provided: TrustRegionSolverLSQ */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TrustRegionSolverLSQ\", function() { return TrustRegionSolverLSQ; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _la_giv_rot__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../la/_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _la_norm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../la/norm */ \"./src/la/norm.js\");\n/* harmony import */ var _la_rrqr__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../la/rrqr */ \"./src/la/rrqr.js\");\n/* harmony import */ var _la_tri__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../la/tri */ \"./src/la/tri.js\");\n/* harmony import */ var _la_urv__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../la/urv */ \"./src/la/urv.js\");\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\nvar REPORT_STATE_READY = 1,\n    REPORT_STATE_NA = 2,\n    REPORT_STATE_CONSIDER = 3;\n/** \n */\n\nvar TrustRegionSolverLSQ = /*#__PURE__*/function () {\n  function TrustRegionSolverLSQ(fJ, x0) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, TrustRegionSolverLSQ);\n\n    // EVAL fJ(x0)\n    if (!(fJ instanceof Function)) throw new Error('new TrustRegionSolverLSQ(fJ, x0): fJ must be Function.');\n    this.fJ = fJ;\n    this.report_x = x0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', x0);\n    if (x0.ndim !== 1) throw new Error('new TrustRegionSolverLSQ(fJ, x0): x0.ndim must be 1.');\n\n    var _fJ = fJ(new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](x0.shape, x0.data.slice())),\n        _fJ2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_fJ, 2),\n        f = _fJ2[0],\n        J = _fJ2[1];\n\n    this.report_f = f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', f);\n    this.report_J = J = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', J);\n    if (f.ndim !== 1) throw new Error('new TrustRegionSolverLSQ(fJ, x0): fJ(x) returned [f,J] with f.ndim !== 1.');\n    if (J.ndim !== 2) throw new Error('new TrustRegionSolverLSQ(fJ, x0): fJ(x) returned [f,J] with J.ndim !== 2.');\n\n    var _J$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(J.shape, 2),\n        M = _J$shape[0],\n        N = _J$shape[1];\n\n    if (f.shape[0] !== M) throw new Error('new TrustRegionSolverLSQ(fJ, x0): fJ(x) returned [f,J] where J.shape[0] did not match f.shape[0].');\n    if (x0.shape[0] !== N) throw new Error('new TrustRegionSolverLSQ(fJ, x0): fJ(x) returned [f,J] where J.shape[1] did not match x0.shape[0].');\n    this.loss = this.report_loss = NaN;\n    this.report_loss_grad = null; // ALLOCATE MEMORY\n\n    this.M = M;\n    this.N = N;\n    var L = Math.min(M, N),\n        K = Math.max(M, N + 1);\n    this.D = new Float64Array(N), // <- trust region scaling diagonal\n    // STORED FUNCTION INPUT AND OUTPUT AT CURRENT TRUST REGION CENTER\n    this.X0 = new Float64Array(N * 1); // <- center of the current trust radius (point where fJ was last evaluated)\n\n    this.F0 = new Float64Array(M * 1);\n    this.J0 = new Float64Array(M * N);\n    this.G0 = new Float64Array(N); // USED BY computeNewton() and computeNewtonRegularized\n\n    this.tmp = new Float64Array(2 * N); // <- used to compute the column norms of J for the diagonal scaling\n\n    this.TMP = new Float64Array(K * N); // <- stores R of regularized RRQR\n    // USED IN computeNewton()\n\n    this.newton_P = new Int32Array(N); // <- column permutation by RRQR decomp.\n\n    this.newton_Q = new Int32Array(N); // <- column permutation by URV  decomp.\n\n    this.newton_R = new Float64Array(L * L);\n    this.newton_V = new Float64Array(N * N); // <- stores complete orthogonal decomp V TODO: In unlikely case (M < N), economic SRRQR could be used instead of full\n\n    this.newton_UF = new Float64Array(M * 1);\n    this.newton_dX = new Float64Array(N * 1); // <- stores gauss-newton point relative to X0\n    // USED IN computeRegularized()\n\n    this.regularized_R0 = new Float64Array(L * N); // <- stores R of RRQR (backed up from Newton)\n\n    this.regularized_QF = new Float64Array(K * 1);\n    this.regularized_dX = new Float64Array(N * 1);\n    this.rank = -1;\n    this._report_state = REPORT_STATE_CONSIDER;\n    Object.seal(this); // INIT DATA\n\n    this._considerMove_computeLoss();\n\n    this.makeConsideredMove();\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(TrustRegionSolverLSQ, [{\n    key: \"wiggle\",\n    value: function wiggle() {\n      throw new _optimization_error__WEBPACK_IMPORTED_MODULE_9__[\"OptimizationNoProgressError\"]('Too many unsuccessfull iterations.');\n    }\n  }, {\n    key: \"_considerMove_computeLoss\",\n    value: function _considerMove_computeLoss() {\n      var M = this.M,\n          N = this.N,\n          F = this.report_f.data,\n          J = this.report_J.data;\n      var mse = 0.0;\n\n      for (var i = M; i-- > 0;) {\n        var s = F[i];\n        mse += s * s / M;\n      }\n\n      var mse_grad = new Float64Array(N);\n\n      for (var _i = M; _i-- > 0;) {\n        for (var j = N; j-- > 0;) {\n          mse_grad[j] += J[N * _i + j] * F[_i] / M * 2;\n        }\n      }\n\n      this.report_loss = mse;\n      this.report_loss_grad = new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](Int32Array.of(N), mse_grad); // <- TODO: computation of loss_grad could probably be delayed until makeConsideredMove() is called\n    }\n  }, {\n    key: \"scaledNorm\",\n    value: function scaledNorm(X) {\n      var N = this.N,\n          D = this.D;\n      if (X.length !== N) throw new Error('Assertion failed.');\n      var norm = new _la_norm__WEBPACK_IMPORTED_MODULE_5__[\"FrobeniusNorm\"]();\n\n      for (var i = N; i-- > 0;) {\n        norm.include(D[i] * X[i]);\n      }\n\n      return norm.result;\n    }\n  }, {\n    key: \"cauchyTravel\",\n    value: function cauchyTravel() {\n      var M = this.M,\n          N = this.N,\n          J = this.J0,\n          G = this.G0; // polynomial along the gradient const1 + 2ax + bx = const2 + (a/b + x) * b\n\n      var a = 0,\n          b = 0;\n\n      for (var i = N; i-- > 0;) {\n        a += G[i] * G[i];\n      }\n\n      for (var _i2 = M; _i2-- > 0;) {\n        var Jg = 0;\n\n        for (var j = N; j-- > 0;) {\n          Jg += J[N * _i2 + j] * G[j];\n        }\n\n        b += Jg * Jg;\n      }\n\n      return 0 === a ? 0 : 0 === b ? -Infinity : -a / b;\n    }\n  }, {\n    key: \"report\",\n    value: function report() {\n      if (this._report_state !== REPORT_STATE_READY) throw new Error('TrustRegionSolverLSQ::report: can only be called once after each makeConsideredMove() but not directly after considerMove(dX).');\n      this._report_state = REPORT_STATE_NA;\n      var result = [this.report_x, this.report_loss, this.report_loss_grad, this.report_f, this.report_J];\n      this.report_x = this.report_f = this.report_J = this.report_loss_grad = null;\n      this.report_loss = NaN;\n      return result;\n    }\n  }, {\n    key: \"considerMove\",\n    value: function considerMove(dX) {\n      var M = this.M,\n          N = this.N,\n          X0 = this.X0,\n          F0 = this.F0,\n          J0 = this.J0;\n      this._report_state = REPORT_STATE_CONSIDER;\n      if (N !== dX.length) throw new Error('Assertion failed.');\n      var X_shape = Int32Array.of(N),\n          X = new Float64Array(N);\n\n      for (var i = N; i-- > 0;) {\n        X[i] = X0[i] + dX[i];\n      }\n\n      var _this$fJ = this.fJ(new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](X_shape, X.slice())),\n          _this$fJ2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_this$fJ, 2),\n          f = _this$fJ2[0],\n          J = _this$fJ2[1];\n\n      f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', f);\n      J = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', J);\n      if (f.ndim !== 1) throw new Error('Assertion failed.');\n      if (J.ndim !== 2) throw new Error('Assertion failed.');\n      if (f.shape[0] !== M) throw new Error('Assertion failed.');\n      if (J.shape[0] !== M) throw new Error('Assertion failed.');\n      if (J.shape[1] !== N) throw new Error('Assertion failed.');\n      this.report_x = new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](X_shape, X);\n      this.report_f = f;\n      this.report_J = J;\n\n      this._considerMove_computeLoss();\n\n      var predict_loss = 0.0;\n\n      for (var _i3 = M; _i3-- > 0;) {\n        var s = 0;\n\n        for (var j = N; j-- > 0;) {\n          s += J0[N * _i3 + j] * (X[j] - X0[j]);\n        }\n\n        s += F0[_i3];\n        predict_loss += s * s / M;\n      }\n\n      return [predict_loss, this.report_loss];\n    }\n  }, {\n    key: \"makeConsideredMove\",\n    value: function makeConsideredMove() {\n      if (this._report_state !== REPORT_STATE_CONSIDER) throw new Error('Assertion failed.');\n      this._report_state = REPORT_STATE_READY;\n      this.rank = -1;\n      this.loss = this.report_loss;\n      var M = this.M,\n          N = this.N,\n          D = this.D,\n          norm = this.tmp,\n          X0 = this.X0,\n          F0 = this.F0,\n          J0 = this.J0,\n          G0 = this.G0;\n      ;\n      {\n        var f = this.report_f.data,\n            J = this.report_J.data,\n            x0 = this.report_x.data; // COPY (x,f,J)\n\n        for (var i = N; i-- > 0;) {\n          X0[i] = x0[i];\n        }\n\n        for (var _i4 = M; _i4-- > 0;) {\n          F0[_i4] = f[_i4];\n        }\n\n        for (var _i5 = M * N; _i5-- > 0;) {\n          J0[_i5] = J[_i5];\n        }\n      } // COMPUTE GRADIENT OF (HALF) SQUARED ERROR (MIND THE HALF :P)\n\n      G0.fill(0.0);\n\n      for (var _i6 = M; _i6-- > 0;) {\n        for (var j = N; j-- > 0;) {\n          G0[j] += J0[N * _i6 + j] * F0[_i6];\n        }\n      } // UPDATE SCALING\n      // compute column norms of J\n\n\n      if (norm.length !== 2 * N) throw new Error('Assertion failed.');\n      norm.fill(0);\n\n      for (var _i7 = 0; _i7 < M; _i7++) {\n        Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_6__[\"_norm_update\"])(norm, J0, N * _i7, 0);\n      } // use column norms of J to update D\n\n\n      for (var _j = 0; _j < N; _j++) {\n        D[_j] = Math.max(D[_j], Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_6__[\"_norm\"])(norm, _j));\n      }\n    }\n  }, {\n    key: \"computeNewton\",\n    value: function computeNewton() {\n      if (0 <= this.rank) return;\n      var M = this.M,\n          N = this.N,\n          D = this.D,\n          J0 = this.J0,\n          F0 = this.F0,\n          Y = this.tmp,\n          T = this.TMP,\n          P = this.newton_P,\n          Q = this.newton_Q,\n          V = this.newton_V,\n          X = this.newton_dX,\n          UF = this.newton_UF;\n      var L = Math.min(M, N); // INIT\n\n      for (var i = N; i-- > 0;) {\n        P[i] = i;\n      }\n\n      for (var _i8 = M * N; _i8-- > 0;) {\n        T[_i8] = J0[_i8];\n      }\n\n      for (var _i9 = M; _i9-- > 0;) {\n        UF[_i9] = F0[_i9];\n      } // SOLVE GLOBAL MINIMUM\n\n\n      Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_6__[\"_rrqr_decomp_inplace\"])(M, N, 1, T, 0, UF, 0, P, 0, Y); // backup the rrqr decomposition in R (for finding regularized minima)\n\n\n      ;\n      {\n        var R0 = this.regularized_R0;\n\n        for (var _i10 = L * N; _i10-- > 0;) {\n          R0[_i10] = T[_i10];\n        }\n      }\n\n      var rank = this.rank = Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_6__[\"_rrqr_rank\"])(M, N, T, 0, Y);\n\n      if (rank < N) {\n        // RANK DEFICIENT CASE -> USE COMPLETE ORTHOGONAL DECOMPOSITION\n        // factor in scaling\n        for (var j = N; j-- > 0;) {\n          var d = D[P[j]];\n          if (0 !== d) for (var _i11 = rank; _i11-- > 0;) {\n            T[N * _i11 + j] /= d;\n          }\n        } // complete orthogonal decompositon\n\n\n        for (var _i12 = N; _i12-- > 0;) {\n          Q[_i12] = P[_i12];\n        }\n\n        V.fill(0.0);\n\n        Object(_la_urv__WEBPACK_IMPORTED_MODULE_8__[\"_urv_decomp_full\"])(rank, N, T, 0, V, 0, Q, 0); // compute least squares solution\n\n\n        for (var _i13 = rank; _i13-- > 0;) {\n          Y[_i13] = -UF[_i13];\n        }\n\n        ;\n        {\n          var R = this.newton_R; // backup complete orthogonal T to R\n\n          for (var _i14 = rank; _i14-- > 0;) {\n            for (var _j2 = rank; _j2-- > 0;) {\n              R[L * _i14 + _j2] = T[N * _i14 + _j2];\n            }\n          }\n\n          Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_solve\"])(rank, L, 1, R, 0, Y, 0); // Y = S \\ Y\n\n        }\n        X.fill(0.0);\n\n        for (var k = rank; k-- > 0;) {\n          for (var _i15 = N; _i15-- > 0;) {\n            X[_i15] += V[N * k + _i15] * Y[k];\n          }\n        } // X = V.T @ Y\n        // factor out scaling\n\n\n        for (var _i16 = N; _i16-- > 0;) {\n          var _d = D[_i16];\n          if (0 !== _d) X[_i16] /= _d;\n        }\n      } else {\n        // FULL RANK CASE -> SCALING NOT RELEVANT TO GLOBAL SOLUTION\n        for (var _i17 = N; _i17-- > 0;) {\n          Y[_i17] = -UF[_i17];\n        }\n\n        Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_solve\"])(N, N, 1, T, 0, Y, 0);\n\n        for (var _i18 = N; _i18-- > 0;) {\n          X[P[_i18]] = Y[_i18];\n        }\n      }\n    } // Regularized least squares (RLS) solver. Solves the follwing equation system:\n    //\n    //   (JJ + DD)x = Jf\n    //\n    // The equation above can be solved as the following least squares problem:\n    //\n    //   min Ax - z\n    //    x\n    //\n    // where\n    //                                \n    //                                \n    //                                \n    //              J              -f \n    //                                \n    //                                \n    //   A =     z = \n    //        D[0]                0 \n    //                             \n    //            D[N-1]          0 \n    //                                \n    //\n    // On top of that we can utilize the fact that J has already\n    // been RRQR decomposed in computeNewton().\n\n  }, {\n    key: \"computeNewtonRegularized\",\n    value: function computeNewtonRegularized() {\n      this.computeNewton();\n      var M = this.M,\n          N = this.N,\n          D = this.D,\n          rnk = this.rank,\n          Y = this.tmp,\n          T = this.TMP,\n          P = this.newton_P,\n          QF0 = this.newton_UF,\n          newton_R = this.newton_R,\n          V = this.newton_V,\n          newton_dX = this.newton_dX,\n          R0 = this.regularized_R0,\n          X = this.regularized_dX,\n          QF = this.regularized_QF;\n      var L = Math.min(M, N);\n\n      if (0 === ) {\n        for (var i = N; i-- > 0;) {\n          X[i] = newton_dX[i];\n        }\n\n        if (rnk < N) {\n          // UNDER-DETERMINED/RANK-DEFICIENT CASE -> USE COMPLETE ORTHOGONAL DECOMP. FROM computeNewton()\n          // COMPUTE DISTANCE\n          var _r = this.scaledNorm(X); // <- the scaled length\n\n\n          if (0 === _r) return [0, 0]; // COMPUTE DISTANCE DERIVATIVE dr/d, see:\n          //  \"THE LEVENBERG-MARQUARDT ALGORITHM: IMPLEMENTATION AND THEORY\"\n          //   by Jorge J. Mor\n          //   Chapter 5 \"The Levenberg-Marquardt Parameter\", Equation (5.8)\n\n          Y.fill(0.0, 0, rnk);\n\n          for (var _i19 = rnk; _i19-- > 0;) {\n            for (var j = N; j-- > 0;) {\n              Y[_i19] += V[N * _i19 + j] * D[j] * X[j];\n            }\n          }\n\n          Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_t_solve\"])(rnk, L, 1, newton_R, 0, Y, 0);\n\n          var _dr = 0;\n\n          for (var _i20 = rnk; _i20-- > 0;) {\n            var d = Y[_i20];\n            _dr += d * d;\n          }\n\n          _dr /= -_r;\n          return [_r, _dr];\n        }\n      }\n\n      if (!(0 <= )) throw new Error('TrustRegionSolverLSQ.prototype.computeMinRegularized():  must be non-negative.'); // START AT RRQR FROM computeNewton() (by copying R0 -> T)\n\n      for (var _i21 = rnk * N; _i21-- > 0;) {\n        T[_i21] = R0[_i21];\n      } // TODO scale T to norm(T,'fro')=1 to avoid underflow ?\n\n\n      if (0 !== ) {\n        for (var _i22 = rnk; _i22-- > 0;) {\n          QF[_i22] = -QF0[_i22];\n        }\n\n        T.fill(0.0, rnk * N, (N + 1) * N);\n        QF.fill(0.0, rnk, N + 1);\n        var Sqrt = Math.sqrt();\n\n        for (var _j3 = N; _j3-- > 0;) {\n          var D = D[P[_j3]];\n          if (0 === D) D = 1;else D *= Sqrt;\n          if (!(D > 0)) throw new Error('TrustRegionSolverLSQ.prototype.computeMinRegularized():  too small (caused underflow).');\n          if (rnk <= _j3) // fill up the rank-deficient rows with regularization\n            T[N * _j3 + _j3] = D;else {\n            // eliminate remaining regularization entries (using Givens QR)\n            T[N * N + _j3] = D;\n            QF[N] = 0;\n\n            for (var _i23 = _j3; _i23 < N; _i23++) {\n              var ii = N * _i23 + _i23,\n                  Ni = N * N + _i23,\n                  T_Ni = T[Ni];\n              if (0 === T_Ni) continue;\n\n              var T_ii = T[ii],\n                  _giv_rot_qr2 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_qr\"])(T_ii, T_Ni),\n                  _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n                  c = _giv_rot_qr3[0],\n                  s = _giv_rot_qr3[1],\n                  norm = _giv_rot_qr3[2];\n\n              T[Ni] = 0;\n              if (0 === s) continue;\n              T[ii] = norm;\n\n              Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_rows\"])(T, N - 1 - _i23, ii + 1, Ni + 1, c, s);\n\n              Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_4__[\"_giv_rot_rows\"])(QF, 1, _i23, N, c, s);\n            }\n          }\n        }\n\n        for (var _i24 = N; _i24-- > 0;) {\n          Y[_i24] = QF[_i24];\n        }\n\n        Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_solve\"])(N, N, 1, T, 0, Y, 0);\n\n        for (var _i25 = N; _i25-- > 0;) {\n          X[P[_i25]] = Y[_i25];\n        }\n      } else if (rnk !== N) throw new Error('Assertion failed.'); // COMPUTE DISTANCE\n\n\n      var r = this.scaledNorm(X); // <- the scaled length\n\n      if (0 === r) return [0, 0]; // COMPUTE DISTANCE DERIVATIVE dr/d, see:\n      //  \"THE LEVENBERG-MARQUARDT ALGORITHM: IMPLEMENTATION AND THEORY\"\n      //   by Jorge J. Mor\n      //   Chapter 5 \"The Levenberg-Marquardt Parameter\", Equation (5.8)\n\n      for (var _i26 = N; _i26-- > 0;) {\n        var _j4 = P[_i26];\n        Y[_i26] = X[_j4] * D[_j4] * D[_j4];\n      }\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_7__[\"_triu_t_solve\"])(N, N, 1, T, 0, Y, 0);\n\n      var dr = 0;\n\n      for (var _i27 = N; _i27-- > 0;) {\n        var _d2 = Y[_i27];\n        dr += _d2 * _d2;\n      }\n\n      dr /= -r;\n      return [r, dr];\n    }\n  }]);\n\n  return TrustRegionSolverLSQ;\n}();\n\n//# sourceURL=webpack://nd/./src/opt/_trust_region_solver_lsq.js?");

/***/ }),

/***/ "./src/opt/_trust_region_solver_tls.js":
/*!*********************************************!*\
  !*** ./src/opt/_trust_region_solver_tls.js ***!
  \*********************************************/
/*! exports provided: odr_gen, TrustRegionSolverTLS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"odr_gen\", function() { return odr_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TrustRegionSolverTLS\", function() { return TrustRegionSolverTLS; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _la_giv_rot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../la/_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _la_norm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../la/norm */ \"./src/la/norm.js\");\n/* harmony import */ var _la_qr__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../la/qr */ \"./src/la/qr.js\");\n/* harmony import */ var _la_rrqr__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../la/rrqr */ \"./src/la/rrqr.js\");\n/* harmony import */ var _la_tri__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../la/tri */ \"./src/la/tri.js\");\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\nfunction odr_gen(trust_region) {\n  var fit_odr_gen = function fit_odr_gen(x, y, fgg, p0) {\n    var opt = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    if (!(fgg instanceof Function)) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0): fgg must be function.\"));\n    x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', x);\n    y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', y);\n    p0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float64', p0);\n    var dx0 = 'dx0' in opt ? Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', opt.dx0) : x.mapElems('float64', function () {\n      return 0;\n    });\n    var NAME = fit_odr_gen.name;\n    if (p0.ndim !== 1) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0): p0.ndim must be 1.\"));\n    if (x.ndim !== 1 && x.ndim !== 2) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0): x.ndim must be 1 or 2.\"));\n    if (y.ndim !== 1 && y.ndim !== 2) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0): y.ndim must be 1 or 2.\"));\n    if (x.ndim !== dx0.ndim) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0, opt): opt.dx0 and x must have same ndim.\"));\n\n    var _x$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(x.shape, 2),\n        MX = _x$shape[0],\n        _x$shape$ = _x$shape[1],\n        NX = _x$shape$ === void 0 ? 1 : _x$shape$,\n        _y$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(y.shape, 2),\n        MY = _y$shape[0],\n        _y$shape$ = _y$shape[1],\n        NY = _y$shape$ === void 0 ? 1 : _y$shape$,\n        _p0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(p0.shape, 1),\n        NP = _p0$shape[0];\n\n    if (x.ndim == 2 && NX !== dx0.shape[1]) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0, opt): opt.dx0 and x must have same shape.\"));\n    if (MX !== dx0.shape[0]) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0, opt): opt.dx0 and x must have same shape.\"));\n    if (MX !== MY) throw new Error(\"\".concat(NAME, \"(x,y, fgg,p0, opt): x.shape[0] must equal y.shape[0].\"));\n    var x_ndim = x.ndim,\n        y_ndim = y.ndim,\n        xi_shape = x.shape.slice(1);\n    var dy = new Float64Array(MX * NY),\n        dy_dp = new Float64Array(MX * NY * NP),\n        dy_dx = new Float64Array(MX * NY * NX),\n        result_dy = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](y.shape, dy),\n        result_dy_dp = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(y.shape).concat([NP])), dy_dp),\n        result_dy_dx = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(y.shape).concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(x.shape.subarray(1)))), dy_dx);\n    x = x.data;\n    y = y.data;\n\n    var fjj = function fjj(p, dx) {\n      if (!p.dtype.startsWith('float')) throw new Error('Assertion failed.');\n      if (!dx.dtype.startsWith('float')) throw new Error('Assertion failed.');\n      if (p.ndim !== 1) throw new Error('Assertion failed.');\n      if (p.shape[0] !== NP) throw new Error('Assertion failed.');\n      if (x_ndim !== dx.ndim) throw new Error('Assertion failed.');\n      if (x_ndim !== 1 && dx.shape[1] !== NX) throw new Error('Assertion failed.');\n      if (dx.shape[0] !== MX) throw new Error('Assertion failed.');\n      var fgg_p = fgg(p);\n      dx = dx.data;\n\n      for (var i = 0; i < MX; i++) {\n        var xi = dx.slice(NX * i, NX * (i + 1));\n\n        for (var j = NX; j-- > 0;) {\n          xi[j] += x[NX * i + j];\n        }\n\n        var _fgg_p = fgg_p(new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](xi_shape, xi)),\n            _fgg_p2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_fgg_p, 3),\n            dyi = _fgg_p2[0],\n            dyi_dp = _fgg_p2[1],\n            dyi_dx = _fgg_p2[2];\n\n        dyi = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float', dyi);\n        dyi_dp = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float', dyi_dp);\n        dyi_dx = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float', dyi_dx);\n        if (dyi.ndim !== y_ndim - 1) throw new Error('Assertion failed.');\n        if (dyi_dp.ndim !== y_ndim) throw new Error('Assertion failed.');\n        if (dyi_dx.ndim !== y_ndim - 2 + x_ndim) throw new Error('Assertion failed.');\n\n        if (y_ndim !== 1) {\n          if (dyi.shape[0] !== NY) throw new Error('Assertion failed.');\n          if (dyi_dp.shape[0] !== NY) throw new Error('Assertion failed.');\n          if (dyi_dx.shape[0] !== NY) throw new Error('Assertion failed.');\n        }\n\n        if (x_ndim !== 1 && dyi_dx.shape[y_ndim - 1] !== NX) throw new Error('Assertion failed.');\n        if (dyi_dp.shape[y_ndim - 1] !== NP) throw new Error('Assertion failed.');\n        dyi = dyi.data;\n        dyi_dp = dyi_dp.data;\n        dyi_dx = dyi_dx.data;\n\n        for (var _j = NY; _j-- > 0;) {\n          dy[NY * i + _j] = dyi[_j] - y[NY * i + _j];\n        }\n\n        for (var _j2 = NP * NY; _j2-- > 0;) {\n          dy_dp[NP * NY * i + _j2] = dyi_dp[_j2];\n        }\n\n        for (var _j3 = NX * NY; _j3-- > 0;) {\n          dy_dx[NX * NY * i + _j3] = dyi_dx[_j3];\n        }\n      } // we know that the TrustRegionSolverTLS performs protection copies so we can reuse memory\n\n\n      return [result_dy, result_dy_dp, result_dy_dx];\n    };\n\n    return trust_region(new TrustRegionSolverTLS(fjj, p0, dx0), opt);\n  };\n\n  Object.defineProperty(fit_odr_gen, 'name', {\n    value: \"odr\".concat(trust_region.name, \"_gen\")\n  });\n  return fit_odr_gen;\n}\nvar REPORT_STATE_READY = 1,\n    REPORT_STATE_NA = 2,\n    REPORT_STATE_CONSIDER = 3;\nvar TrustRegionSolverTLS = /*#__PURE__*/function () {\n  function TrustRegionSolverTLS(fgg, p0, dx0) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, TrustRegionSolverTLS);\n\n    if (!(fgg instanceof Function)) throw new Error('Assertion failed.');\n    p0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', p0);\n    dx0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', dx0);\n    if (p0.ndim !== 1) throw new Error('Assertion failed.');\n    if (dx0.ndim !== 1 && dx0.ndim !== 2) throw new Error('Assertion failed.');\n\n    var _dx0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(dx0.shape, 2),\n        MX = _dx0$shape[0],\n        _dx0$shape$ = _dx0$shape[1],\n        NX = _dx0$shape$ === void 0 ? 1 : _dx0$shape$,\n        _p0$shape2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(p0.shape, 1),\n        NP = _p0$shape2[0];\n\n    var _fgg = fgg(new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](p0.shape, p0.data.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](dx0.shape, dx0.data.slice())),\n        _fgg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_fgg, 3),\n        dy = _fgg2[0],\n        dy_dp = _fgg2[1],\n        dy_dx = _fgg2[2];\n\n    dy = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', dy);\n    dy_dp = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', dy_dp);\n    dy_dx = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', dy_dx);\n    if (dy.ndim !== 1 && dy.ndim !== 2) throw new Error('Assertion failed.');\n    if (dy_dp.ndim !== dy.ndim + 1) throw new Error('Assertion failed.');\n    if (dy_dx.ndim !== dy.ndim + dx0.ndim - 1) throw new Error('Assertion failed.');\n\n    var _dy$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(dy.shape, 2),\n        MY = _dy$shape[0],\n        _dy$shape$ = _dy$shape[1],\n        NY = _dy$shape$ === void 0 ? 1 : _dy$shape$;\n\n    if (MX !== MY) throw new Error('Assertion failed.');\n    if (dy_dp.shape[0] !== MX) throw new Error('Assertion failed.');\n    if (dy_dx.shape[0] !== MX) throw new Error('Assertion failed.');\n\n    if (dy.ndim === 2) {\n      if (dy_dp.shape[1] !== NY) throw new Error('Assertion failed.');\n      if (dy_dx.shape[1] !== NY) throw new Error('Assertion failed.');\n    }\n\n    if (dx0.ndim === 2 && dy_dx.shape[dy.ndim] !== NX) throw new Error('Assertion failed.');\n    if (dy_dp.shape[dy.ndim] !== NP) throw new Error('Assertion failed.');\n\n    var M = MX * NX + MX * NY,\n        N = MX * NX + NP,\n        L = Math.min(NX, NY),\n        K = Math.min(MX * NX + NP + 1, MX * NY),\n        // <- +1 as temp. memory for QR-decomp.\n    J11 = new Float64Array(MX * NX),\n        J21 = new Float64Array(MX * NY * NX),\n        J22 = new Float64Array(MX * NY * NP),\n        D = new Float64Array(N),\n        X0 = new Float64Array(N),\n        F0 = new Float64Array(M),\n        G0 = new Float64Array(N),\n        tmp = new Float64Array(L * (L + 3) >>> 1),\n        // If NX < NY, we can use the prepare() step to reduce the work computeNewtonRegularized() which should speed up Levenberg-Marquardt\n    prepared_J21 = NY <= NX ? J21 : new Float64Array(MX * NX * NX + NX),\n        // <- +NX as temp. memory for QR decomp.\n    prepared_J22 = NY <= NX ? J22 : new Float64Array(K * NP),\n        prepared_QF = NY <= NX ? F0.subarray(MX * NX) : new Float64Array(K),\n        // Working memory and result of computeNewton()\n    newton_R11 = new Float64Array(MX * NX),\n        // <- after computeNewton(), contains diagonal of R11\n    newton_R21 = new Float64Array(MX * L * NX),\n        // <- after computeNewton(), contains sines of givens rotations used to compute off diagonal entries of R11 and R12\n    newton_R22 = new Float64Array(K * NP),\n        // <- after computeNewton(), contains R22 which is dense\n    newton_P = new Int32Array(NP),\n        newton_dX = new Float64Array(N),\n        // Working memory and result of computeNewtonRegularized()\n    regularized_R11 = new Float64Array(MX * NX),\n        regularized_R21 = new Float64Array(MX * L * NX),\n        regularized_R22 = new Float64Array(Math.max(K, NP + 1) * NP),\n        regularized_P = new Int32Array(NP),\n        regularized_dX = new Float64Array(N),\n        QF = new Float64Array(Math.max(MX * NX + K, N + 1)),\n        norm = new Float64Array(2 * NP),\n        _consider_J11 = J11.slice(),\n        _consider_J21 = dy_dx.data,\n        _consider_J22 = dy_dp.data;\n\n    _consider_J11.fill(1.0);\n\n    Object.assign(this, {\n      MX: MX,\n      NX: NX,\n      NY: NY,\n      NP: NP,\n      M: M,\n      N: N,\n      loss: 0.0,\n      rank: -1,\n      _report_state: REPORT_STATE_NA,\n      fgg: fgg,\n      report_p: p0,\n      report_dx: dx0,\n      report_loss: NaN,\n      report_dloss_dp: null,\n      report_dloss_ddx: null,\n      report_dy: dy,\n      p_shape: p0.shape,\n      x_shape: dx0.shape,\n      y_shape: dy.shape,\n      QF: QF,\n      J11: J11,\n      J21: J21,\n      J22: J22,\n      tmp: tmp,\n      prepared_QF: prepared_QF,\n      prepared_J21: prepared_J21,\n      prepared_J22: prepared_J22,\n      prepared: false,\n      newton_R11: newton_R11,\n      newton_R21: newton_R21,\n      newton_R22: newton_R22,\n      newton_P: newton_P,\n      newton_dX: newton_dX,\n      regularized_R11: regularized_R11,\n      regularized_R21: regularized_R21,\n      regularized_R22: regularized_R22,\n      regularized_P: regularized_P,\n      regularized_dX: regularized_dX,\n      _consider_J11: _consider_J11,\n      _consider_J21: _consider_J21,\n      _consider_J22: _consider_J22,\n      D: D,\n      norm: norm,\n      X0: X0,\n      F0: F0,\n      G0: G0\n    });\n    Object.seal(this);\n\n    this._considerMove_computeLoss();\n\n    this.makeConsideredMove();\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(TrustRegionSolverTLS, [{\n    key: \"_considerMove_computeLoss\",\n    value: function _considerMove_computeLoss() {\n      var M = this.M,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          x_shape = this.x_shape,\n          p_shape = this.p_shape,\n          J11 = this._consider_J11,\n          J21 = this._consider_J21,\n          J22 = this._consider_J22;\n      this._report_state = REPORT_STATE_CONSIDER;\n      var report_dloss_dp = new Float64Array(NP),\n          report_dloss_ddx = new Float64Array(MX * NX),\n          report_dx = this.report_dx.data,\n          report_dy = this.report_dy.data; // COMPUTE LOSS GRADIENT w.r.t. P\n\n      for (var i = MX * NY; i-- > 0;) {\n        for (var j = NP; j-- > 0;) {\n          report_dloss_dp[j] += report_dy[i] * J22[NP * i + j] / M * 2;\n        }\n      } // COMPUTE LOSS GRADIENT w.r.t. X\n\n\n      for (var _i = MX; _i-- > 0;) {\n        for (var _j4 = NX; _j4-- > 0;) {\n          report_dloss_ddx[NX * _i + _j4] = J11[NX * _i + _j4] * report_dx[NX * _i + _j4] / M * 2;\n        }\n      }\n\n      for (var _i2 = MX; _i2-- > 0;) {\n        for (var _j5 = NY; _j5-- > 0;) {\n          for (var k = NX; k-- > 0;) {\n            report_dloss_ddx[NX * _i2 + k] += J21[NX * (NY * _i2 + _j5) + k] * report_dy[NY * _i2 + _j5] / M * 2;\n          }\n        }\n      } // COMPUTE LOSS (mean squared error)\n\n\n      var report_loss = 0.0;\n\n      for (var _i3 = MX * NX; _i3-- > 0;) {\n        var s = report_dx[_i3];\n        report_loss += s * s / M;\n      }\n\n      for (var _i4 = MX * NY; _i4-- > 0;) {\n        var _s = report_dy[_i4];\n        report_loss += _s * _s / M;\n      }\n\n      this.report_dloss_dp = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](p_shape, report_dloss_dp);\n      this.report_dloss_ddx = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](x_shape, report_dloss_ddx);\n      this.report_loss = report_loss;\n    }\n  }, {\n    key: \"considerMove\",\n    value: function considerMove(dX) {\n      var M = this.M,\n          N = this.N,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          x_shape = this.x_shape,\n          y_shape = this.y_shape,\n          p_shape = this.p_shape,\n          _consider_J11 = this._consider_J11,\n          _consider_J21 = this._consider_J21,\n          _consider_J22 = this._consider_J22,\n          J11 = this.J11,\n          J21 = this.J21,\n          J22 = this.J22,\n          F0 = this.F0,\n          X0 = this.X0,\n          fgg = this.fgg;\n      if (dX.length !== N) throw new Error('Assertion failed.');\n      var report_p = new Float64Array(NP),\n          report_dx = new Float64Array(MX * NX);\n      this.report_p = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](p_shape, report_p);\n      this.report_dx = new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](x_shape, report_dx);\n\n      for (var i = NP; i-- > 0;) {\n        var I = MX * NX + i;\n        report_p[i] = X0[I] + dX[I];\n      }\n\n      for (var _i5 = MX * NX; _i5-- > 0;) {\n        report_dx[_i5] = X0[_i5] + dX[_i5];\n      }\n\n      var _fgg3 = fgg(new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](p_shape, report_p.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](x_shape, report_dx.slice())),\n          _fgg4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_fgg3, 3),\n          dy = _fgg4[0],\n          dy_dp = _fgg4[1],\n          dy_dx = _fgg4[2];\n\n      dy = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"array\"])('float64', dy);\n      dy_dp = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float64', dy_dp);\n      dy_dx = Object(_nd_array__WEBPACK_IMPORTED_MODULE_4__[\"asarray\"])('float64', dy_dx);\n      if (dy.ndim !== y_shape.length) throw new Error('Assertion failed.');\n      if (dy_dp.ndim !== y_shape.length + 1) throw new Error('Assertion failed.');\n      if (dy_dx.ndim !== y_shape.length + x_shape.length - 1) throw new Error('Assertion failed.');\n      if (dy.shape[0] !== MX) throw new Error('Assertion failed.');\n      if (dy_dp.shape[0] !== MX) throw new Error('Assertion failed.');\n      if (dy_dx.shape[0] !== MX) throw new Error('Assertion failed.');\n      if (dy_dp.shape[y_shape.length] !== NP) throw new Error('Assertion failed.');\n      if (x_shape.length === 2 && dy_dx.shape[y_shape.length] !== NX) throw new Error('Assertion failed.');\n\n      if (y_shape.length === 2) {\n        if (dy.shape[1] !== NY) throw new Error('Assertion failed.');\n        if (dy_dp.shape[1] !== NY) throw new Error('Assertion failed.');\n        if (dy_dx.shape[1] !== NY) throw new Error('Assertion failed.');\n      }\n\n      this.report_dy = dy;\n      dy_dx = dy_dx.data;\n      dy_dp = dy_dp.data;\n\n      for (var _i6 = MX * NY * NX; _i6-- > 0;) {\n        _consider_J21[_i6] = dy_dx[_i6];\n      }\n\n      for (var _i7 = MX * NY * NP; _i7-- > 0;) {\n        _consider_J22[_i7] = dy_dp[_i7];\n      }\n\n      _consider_J11.fill(1.0);\n\n      this._considerMove_computeLoss();\n\n      var predict_loss = 0.0;\n\n      for (var _i8 = MX * NX; _i8-- > 0;) {\n        var f = F0[_i8] + J11[_i8] * (report_dx[_i8] - X0[_i8]);\n        predict_loss += f * f / M;\n      }\n\n      for (var _i9 = MX; _i9-- > 0;) {\n        for (var j = NY; j-- > 0;) {\n          var _f = F0[MX * NX + NY * _i9 + j];\n\n          for (var k = NX; k-- > 0;) {\n            _f += J21[NX * (NY * _i9 + j) + k] * (report_dx[NX * _i9 + k] - X0[NX * _i9 + k]);\n          }\n\n          for (var _k = NP; _k-- > 0;) {\n            _f += J22[NP * (NY * _i9 + j) + _k] * (report_p[_k] - X0[MX * NX + _k]);\n          }\n\n          predict_loss += _f * _f / M;\n        }\n      }\n\n      return [predict_loss, this.report_loss];\n    }\n  }, {\n    key: \"makeConsideredMove\",\n    value: function makeConsideredMove() {\n      if (this._report_state !== REPORT_STATE_CONSIDER) throw new Error('Assertion failed.');\n      this._report_state = REPORT_STATE_READY;\n      this.loss = this.report_loss;\n      this.rank = -1;\n      this.prepared = false; // swap in consideration\n\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          _consider_J11 = this._consider_J11,\n          J11 = this.J11,\n          _consider_J21 = this._consider_J21,\n          J21 = this.J21,\n          _consider_J22 = this._consider_J22,\n          J22 = this.J22,\n          D = this.D,\n          X0 = this.X0,\n          F0 = this.F0,\n          G0 = this.G0;\n\n      for (var i = MX * NX; i-- > 0;) {\n        J11[i] = _consider_J11[i];\n      }\n\n      for (var _i10 = MX * NY * NX; _i10-- > 0;) {\n        J21[_i10] = _consider_J21[_i10];\n      }\n\n      for (var _i11 = MX * NY * NP; _i11-- > 0;) {\n        J22[_i11] = _consider_J22[_i11];\n      }\n\n      ;\n      {\n        var p = this.report_p.data,\n            dx = this.report_dx.data,\n            dy = this.report_dy.data;\n\n        for (var _i12 = NP; _i12-- > 0;) {\n          X0[MX * NX + _i12] = p[_i12];\n        }\n\n        for (var _i13 = MX * NX; _i13-- > 0;) {\n          X0[_i13] = dx[_i13];\n        }\n\n        for (var _i14 = MX * NY; _i14-- > 0;) {\n          F0[MX * NX + _i14] = dy[_i14];\n        }\n\n        for (var _i15 = MX * NX; _i15-- > 0;) {\n          F0[_i15] = X0[_i15];\n        }\n      } // COMPUTE GRADIENT OF (HALF) SQUARED ERROR (MIND THE HALF :P)\n\n      for (var _i16 = MX * NX; _i16-- > 0;) {\n        G0[_i16] = J11[_i16] * F0[_i16];\n      }\n\n      for (var _i17 = MX; _i17-- > 0;) {\n        for (var j = NY; j-- > 0;) {\n          for (var k = NX; k-- > 0;) {\n            G0[NX * _i17 + k] += J21[NX * (NY * _i17 + j) + k] * F0[MX * NX + NY * _i17 + j];\n          }\n        }\n      }\n\n      G0.fill(0.0, MX * NX, MX * NX + NP);\n\n      for (var _i18 = MX * NY; _i18-- > 0;) {\n        for (var _j6 = NP; _j6-- > 0;) {\n          G0[MX * NX + _j6] += J22[NP * _i18 + _j6] * F0[MX * NX + _i18];\n        }\n      }\n\n      var norm = new _la_norm__WEBPACK_IMPORTED_MODULE_6__[\"FrobeniusNorm\"]();\n\n      for (var _i19 = MX; _i19-- > 0;) {\n        for (var _k2 = NX; _k2-- > 0;) {\n          norm.reset();\n          norm.include(J11[NX * _i19 + _k2]);\n\n          for (var _j7 = NY; _j7-- > 0;) {\n            norm.include(J21[NX * (NY * _i19 + _j7) + _k2]);\n          }\n\n          var I = NX * _i19 + _k2;\n          D[I] = Math.max(D[I], norm.result);\n        }\n      }\n\n      for (var _j8 = NP; _j8-- > 0;) {\n        norm.reset();\n\n        for (var _i20 = MX * NY; _i20-- > 0;) {\n          norm.include(J22[NP * _i20 + _j8]);\n        }\n\n        var J = MX * NX + _j8;\n        D[J] = Math.max(D[J], norm.result);\n      }\n    }\n  }, {\n    key: \"cauchyTravel\",\n    value: function cauchyTravel() {\n      var N = this.N,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          J11 = this.J11,\n          J21 = this.J21,\n          J22 = this.J22,\n          G = this.G0; // polynomial along the gradient const1 + 2ax + bx = const2 + (a/b + x) * b\n\n      var a = 0,\n          b = 0;\n\n      for (var i = N; i-- > 0;) {\n        a += G[i] * G[i];\n      }\n\n      for (var _i21 = MX; _i21-- > 0;) {\n        for (var j = NY; j-- > 0;) {\n          var Jg = 0;\n\n          for (var k = NP; k-- > 0;) {\n            Jg += J22[NP * (NY * _i21 + j) + k] * G[MX * NX + k];\n          }\n\n          for (var _k3 = NX; _k3-- > 0;) {\n            Jg += J21[NX * (NY * _i21 + j) + _k3] * G[NX * _i21 + _k3];\n          }\n\n          b += Jg * Jg;\n        }\n      }\n\n      for (var _i22 = MX * NX; _i22-- > 0;) {\n        var _Jg = J11[_i22] * G[_i22];\n\n        b += _Jg * _Jg;\n      }\n\n      return 0 === a ? 0 : 0 === b ? -Infinity : -a / b;\n    }\n  }, {\n    key: \"report\",\n    value: function report() {\n      if (this._report_state !== REPORT_STATE_READY) throw new Error('TrustRegionSolverLSQ::report: can only be called once after each makeConsideredMove() but not directly after considerMove(dX).');\n      this._report_state = REPORT_STATE_NA;\n      var result = [this.report_p, this.report_dx, this.report_loss, this.report_dloss_dp, this.report_dloss_ddx, this.report_dy];\n      this.report_p = this.report_dx = this.report_dy = this.report_dloss_dp = this.report_dloss_ddx = null;\n      this.report_loss = NaN;\n      return result;\n    }\n  }, {\n    key: \"wiggle\",\n    value: function wiggle() {\n      throw new _optimization_error__WEBPACK_IMPORTED_MODULE_10__[\"OptimizationNoProgressError\"]('Too many unsuccessfull iterations.');\n    }\n  }, {\n    key: \"__DEBUG_J\",\n    value: function __DEBUG_J(i, j) // <- meant for debugging only!\n    {\n      if (i % 1 !== 0) throw new Error('Assertion failed.');\n      if (j % 1 !== 0) throw new Error('Assertion failed.');\n      i |= 0;\n      j |= 0;\n      if (!(0 <= i)) throw new Error('Assertion failed.');\n      if (!(0 <= j)) throw new Error('Assertion failed.');\n      var M = this.M,\n          N = this.N,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          J11 = this.J11,\n          J21 = this.J21,\n          J22 = this.J22;\n      if (!(i < M)) throw new Error('Assertion failed.');\n      if (!(j < N)) throw new Error('Assertion failed.');\n      if (i < MX * NX) return i === j ? J11[i] : 0;\n      i -= MX * NX;\n\n      if (j < MX * NX) {\n        var I = i / NY | 0,\n            J = j / NX | 0;\n        if (I !== J) return 0;\n        i = i % NY;\n        j = j % NX;\n        return J21[NX * (NY * I + i) + j];\n      }\n\n      j -= MX * NX;\n      return J22[NP * i + j];\n    }\n  }, {\n    key: \"scaledNorm\",\n    value: function scaledNorm(X) {\n      var N = this.N,\n          D = this.D;\n      if (X.length !== N) throw new Error('Assertion failed.');\n      var norm = new _la_norm__WEBPACK_IMPORTED_MODULE_6__[\"FrobeniusNorm\"]();\n\n      for (var i = N; i-- > 0;) {\n        norm.include(D[i] * X[i]);\n      }\n\n      return norm.result;\n    } // The (ODR) trust-region solver decomposes J into:\n    //\n    // J = QRVD\n    //\n    // Q: float[M,M], orthogonal\n    // R: float[M,N], upper triangular\n    // V: float[N,N], orthogonal\n    // D: float[N,N], diagonal scaling matrix\n    //\n    // Where Q is only available implicitly via QF which is the product (QF).\n    // This method returns [R,V,D] for debugging purposes, where D is returned\n    // as row vector.\n\n  }, {\n    key: \"_qr_decomp\",\n    value: function _qr_decomp(R11, R21, R22, P, QF) {\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          norm = this.norm,\n          Q = this.tmp,\n          J21 = this.prepared_J21,\n          J22 = this.prepared_J22;\n      var L = Math.min(NX, NY),\n          K = Math.min(MX * NY, MX * NX + NP);\n      if (!(P instanceof Int32Array)) throw new Error('Assertion failed.');\n      if (P.length !== NP) throw new Error('Assertion failed.');\n      if (R11.length !== MX * NX) throw new Error('Assertion failed.');\n      if (R21.length !== MX * L * NX) throw new Error('Assertion failed.');\n      if (R22.length !== (NP + 1) * NP && R22.length !== Math.min(MX * NY, MX * NX + NP + 1) * NP) throw new Error('Assertion failed: ' + JSON.stringify({\n        len: R22.length,\n        MX: MX,\n        NX: NX,\n        NP: NP\n      })); //\n      // STEP 2.1: ELIMINATE R21 USING GIVENS ROTATIONS\n      //           O( MX*(NX+NP) ) operations\n      //\n\n      if (1 === L) {\n        // THIS BRANCH IS PURELY FOR PERFORMANCE REASONS\n        //   - JIT compilers seem to be unable to optimize for L===1\n        //   - With this branch takes half as long as without it for L===1\n        //   - TODO: remove once JIT compilers become better\n        for (var i = 0; i < MX; i++) {\n          var cc = 1;\n\n          for (var j = 0; j < NX; j++) {\n            var ij = NX * i + j,\n                r1 = R11[ij],\n                r2 = J21[ij] * cc,\n                _giv_rot_qr2 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(r1, r2),\n                _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr2, 3),\n                c = _giv_rot_qr3[0],\n                s = _giv_rot_qr3[1],\n                nrm = _giv_rot_qr3[2];\n\n            if (0 === nrm) throw new Error('Assertion failed: Sparse part of J must not be singular.');\n            R21[ij] = cc * s;\n            if (s === 0) continue;\n            cc *= c;\n            R11[ij] = nrm;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, ij, MX * NX + i, c, s);\n          }\n\n          for (var _j9 = 0; _j9 < NP; _j9++) {\n            R22[NP * i + _j9] = cc * J22[NP * i + _j9];\n          }\n        }\n      } else {\n        for (var _i23 = 0; _i23 < MX; _i23++) // <- for each block i\n        {\n          // Q keeps track of rotations in block\n          Q.fill(0.0,\n          /*start=*/\n          L,\n          /*end=*/\n          L * (L + 3) >>> 1); // init Q to:\n          //                       \n          //      0                \n          //      1                \n          //         1             \n          // Q =        .          \n          //               .       \n          //                  .    \n          //                     1 \n          //                       \n          // (Q[1:] is stored sparsly as the upper off-diagonal entries will always be 0)\n\n          for (var _i24 = L; _i24 > 0; _i24--) {\n            Q[L - 1 + (_i24 * (_i24 + 1) >>> 1)] = 1;\n          }\n\n          for (var k = 0; k < NX; k++) // <- for each column in block i\n          {\n            Q.fill(0.0, 0, L);\n            var _r = R11[NX * _i23 + k];\n\n            for (var _j10 = 0; _j10 < L; _j10++) // <- for each entry j in column k of block i\n            {\n              var Q_off = L + (_j10 * (_j10 + 1) >>> 1);\n              var _r2 = 0.0;\n\n              for (var l = -1; l++ < _j10;) {\n                _r2 += Q[Q_off + l] * J21[NX * (L * _i23 + l) + k];\n              }\n\n              if (0 === _r2) continue;\n\n              var _giv_rot_qr4 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(_r, _r2),\n                  _giv_rot_qr5 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr4, 3),\n                  _c = _giv_rot_qr5[0],\n                  _s2 = _giv_rot_qr5[1],\n                  _nrm = _giv_rot_qr5[2];\n\n              _r = _nrm;\n              if (0 === _s2) continue;\n\n              Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Q, _j10 + 1, 0, Q_off, _c, _s2);\n\n              Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, NX * _i23 + k, MX * NX + L * _i23 + _j10, _c, _s2);\n            }\n\n            R11[NX * _i23 + k] = _r; // write finished row of Q to R21\n\n            for (var _j11 = 0; _j11 < L; _j11++) {\n              R21[NX * (L * _i23 + _j11) + k] = Q[_j11];\n            }\n          } // apply Q to J22\n\n\n          R22.fill(0.0, NP * L * _i23, NP * L * (_i23 + 1));\n\n          for (var _j12 = 0; _j12 < L; _j12++) {\n            var _Q_off = L + (_j12 * (_j12 + 1) >>> 1);\n\n            for (var _k4 = 0; _k4 <= _j12; _k4++) {\n              for (var _l = 0; _l < NP; _l++) {\n                R22[NP * (L * _i23 + _j12) + _l] += Q[_Q_off + _k4] * J22[NP * (L * _i23 + _k4) + _l];\n              }\n            }\n          }\n        }\n      } // copy remaining rows of R22\n\n\n      for (var _i25 = MX * L * NP; _i25 < K * NP; _i25++) {\n        R22[_i25] = J22[_i25];\n      } //\n      // STEP 2.3: RRQR-DECOMPOSE R22\n      //           O( min(MX,NP)*NP*MX ) operations\n      //\n\n\n      for (var _i26 = NP; _i26-- > 0;) {\n        P[_i26] = _i26;\n      }\n\n      Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_8__[\"_rrqr_decomp_inplace\"])(K, NP, 1, R22, 0, QF, MX * NX, P, 0, norm);\n\n      var rnk = Object(_la_rrqr__WEBPACK_IMPORTED_MODULE_8__[\"_rrqr_rank\"])(K, NP, R22, 0, norm);\n\n      R22.fill(0.0, NP * rnk, NP * Math.min(K, NP)); // <- zero out the rank-deficient rows after RRQR\n\n      return rnk;\n    }\n  }, {\n    key: \"_qr_solve\",\n    value: function _qr_solve(R11, R21, R22, P, rnk, X) {\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          J21 = this.prepared_J21,\n          J22 = this.prepared_J22,\n          D = this.D,\n          Jx = this.tmp,\n          tmp = this.norm;\n      var L = Math.min(NX, NY);\n      if (!(P instanceof Int32Array)) throw new Error('Assertion failed.');\n      if (P.length !== NP) throw new Error('Assertion failed.');\n      if (R11.length !== MX * NX) throw new Error('Assertion failed.');\n      if (R21.length !== MX * L * NX) throw new Error('Assertion failed.');\n      if (!(R22.length >= MX * L * NP)) throw new Error('Assertion failed.');\n      if (0 !== rnk % 1) throw new Error('Assertion failed.');\n      if (!(0 <= rnk)) throw new Error('Assertion failed.');\n      if (!(NP >= rnk)) throw new Error('Assertion failed.');\n      rnk |= 0; //\n      // STEP 3.1: BACKWARDS SUBSITUTION OF R2-PART\n      //           O( rnk ) operations\n      //\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_9__[\"_triu_solve\"])(rnk, NP, 1, R22, 0, X, MX * NX);\n\n      if (rnk != NP) {\n        //\n        // STEP 3.2: APPLY GIVENS ROTATIONS TO X (UNDO 2.4)\n        //           O( rnk * (NP-rnk) ) operations\n        //\n        for (var i = 0; i < rnk; i++) {\n          for (var j = rnk; j < NP; j++) {\n            var s = R22[NP * i + j];\n            if (s === 0) continue;\n            var c = Math.sqrt(1 - s * s);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(X, 1, MX * NX + j, MX * NX + i, c, s);\n          }\n        }\n      } //\n      // STEP 3.3: APPLY COLUMN PERMUTATIONS P TO X (UNDO 2.3)\n      //           O( NP ) operations\n      //\n\n\n      for (var _i27 = NP; _i27-- > 0;) {\n        tmp[P[_i27]] = X[MX * NX + _i27];\n      }\n\n      for (var _i28 = NP; _i28-- > 0;) {\n        X[MX * NX + _i28] = tmp[_i28];\n      } // factor out scaling\n\n\n      if (rnk !== NP) {\n        for (var _i29 = NP; _i29-- > 0;) {\n          var d = D[MX * NX + _i29];\n          if (0 !== d) X[MX * NX + _i29] /= d;\n        }\n      } //\n      // STEP 3.4: MOVE SOLVED R22-PART TO THE RIGHT\n      //           O( MX*(NX+NP) ) operations\n      // -------------------------------------------\n      // As a result of steps 2.1 and 2.2, each row in R12 can be described as\n      // a scaled row of J22, i.e.:\n      //\n      // R12[MX*j+i,:] = s[i,j] * J22[i,:]\n      //\n      // Where:\n      //\n      // s[i,j] = R21[i,j] * c[i,j-1]\n      // s[i,0] = R21[i,0]\n      // c[i,j] = sqrt( 1 - (s[i,j]) )\n      //\n\n\n      for (var _i30 = MX; _i30-- > 0;) {\n        for (var _j13 = L; _j13-- > 0;) {\n          var xj = 0.0;\n\n          for (var k = NP; k-- > 0;) {\n            xj += J22[NP * (L * _i30 + _j13) + k] * X[MX * NX + k];\n          }\n\n          for (var _k5 = NX; _k5-- > 0;) {\n            X[NX * _i30 + _k5] -= xj * R21[NX * (L * _i30 + _j13) + _k5];\n          }\n        }\n      } // TODO: The following can be done more efficient as the off-diagonal rows of R11 are scaled rows of J21\n      //\n      // STEP 3.5: BACKWARD SUBSTITUTION OF R11\n      //           O( MX*NX ) operations\n\n\n      for (var _i31 = MX; _i31-- > 0;) // <- for each block bottom to top\n      {\n        Jx.fill(0.0, 0, L);\n\n        for (var _k6 = NX; _k6-- > 0;) // <- for each diagonal entry in block bottom to top\n        {\n          var ik = NX * _i31 + _k6;\n\n          for (var _j14 = L; _j14-- > 0;) {\n            X[ik] -= R21[NX * (L * _i31 + _j14) + _k6] * Jx[_j14];\n          } // <- move partial solution to the right side\n\n\n          X[ik] /= R11[ik];\n\n          for (var _j15 = L; _j15-- > 0;) {\n            Jx[_j15] += J21[NX * (L * _i31 + _j15) + _k6] * X[ik];\n          } // <- Jx accumulates the part to be moved to the right side\n\n        }\n      }\n    }\n  }, {\n    key: \"_rt_solve\",\n    value: function _rt_solve(R11, R21, R22, P, rnk, X) {\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          J21 = this.prepared_J21,\n          J22 = this.prepared_J22,\n          D = this.D,\n          sx = this.tmp,\n          tmp = this.norm;\n      var L = Math.min(NX, NY);\n      if (!(P instanceof Int32Array)) throw new Error('Assertion failed.');\n      if (P.length !== NP) throw new Error('Assertion failed.');\n      if (R11.length !== MX * NX) throw new Error('Assertion failed.');\n      if (R21.length !== MX * L * NX) throw new Error('Assertion failed.');\n      if (!(R22.length >= MX * NP)) throw new Error('Assertion failed.');\n      if (!(X.length >= MX * NX + NP)) throw new Error('Assertion failed.');\n      if (0 !== rnk % 1) throw new Error('Assertion failed.');\n      if (!(0 <= rnk)) throw new Error('Assertion failed.');\n      if (!(NP >= rnk)) throw new Error('Assertion failed.');\n      rnk |= 0; //\n      // STEP 4.1: SOLVE SPARSE PART\n      //           O( MX*(NX+NP) ) operations\n      //\n\n      tmp.fill(0.0, 0, NP); // <- accumulates sparse part of solution to be moved to right side (because we have to apply givens rotations to it before moving it to the right side)\n\n      for (var i = 0; i < MX; i++) {\n        sx.fill(0.0, 0, L); // forward substitute block\n\n        for (var k = 0; k < NX; k++) {\n          var ik = NX * i + k;\n\n          for (var j = 0; j < L; j++) {\n            X[ik] -= J21[NX * (L * i + j) + k] * sx[j];\n          }\n\n          X[ik] /= R11[ik];\n\n          for (var _j16 = 0; _j16 < L; _j16++) {\n            sx[_j16] += R21[NX * (L * i + _j16) + k] * X[ik];\n          }\n        } // move solved block to right hand side\n\n\n        for (var _j17 = 0; _j17 < L; _j17++) {\n          for (var _k7 = 0; _k7 < NP; _k7++) {\n            tmp[_k7] += sx[_j17] * J22[NP * (L * i + _j17) + P[_k7]];\n          }\n        }\n      }\n\n      if (rnk < NP) {\n        for (var _i32 = NP; _i32-- > 0;) {\n          var d = D[MX * NX + P[_i32]];\n          if (0 !== d) tmp[_i32] /= d;\n        }\n\n        for (var _i33 = rnk; _i33-- > 0;) {\n          for (var _j18 = NP; _j18-- > rnk;) {\n            var s = R22[NP * _i33 + _j18];\n            if (s === 0) continue;\n            var c = Math.sqrt(1 - s * s);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(tmp, 1, _i33, _j18, c, s);\n          }\n        }\n      }\n\n      for (var _j19 = rnk; _j19-- > 0;) {\n        X[MX * NX + _j19] -= tmp[_j19];\n      }\n\n      Object(_la_tri__WEBPACK_IMPORTED_MODULE_9__[\"_triu_t_solve\"])(rnk, NP, 1, R22, 0, X, MX * NX);\n    }\n  }, {\n    key: \"prepare\",\n    value: function prepare() {\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          J21 = this.prepared_J21,\n          J22 = this.prepared_J22,\n          QF = this.prepared_QF,\n          raw_J21 = this.J21,\n          raw_J22 = this.J22,\n          raw_F = this.F0;\n      this.prepared = this.prepared || NX >= NY; // <- FIXME: NX >= NY\n\n      if (this.prepared) return;\n      this.prepared = true; // IF BLOCKS IN J21 ARE PORTRAIT-SHAPED, WE CAN PRECOMPUTE SOME WORK TO MAKE computeNewtonRegularized() CHEAPER\n      //                                   \n      //                                 \n      //                                 \n      //            0                  0 \n      //                                 \n      //                                 \n      //       \n      //                           \n      //             =>             \n      //                           \n      //                            \n      //                      .      \n      //                       .     \n      //      .                   .    \n      //       .                     \n      //        .                     \n      //                             \n      //                              \n      //                               \n      //                                   \n\n      if (J21.length !== MX * NX * NX + NX) throw new Error('Assertion failed.');\n      if (J22.length !== Math.min(MX * NY, MX * NX + NP + 1) * NP) throw new Error('Assertion failed.');\n      if (QF.length !== Math.min(MX * NY, MX * NX + NP + 1)) throw new Error('Assertion failed.');\n\n      for (var l = -1, i = 0; i < MX; i++) {\n        var J21_off = NX * NX * i,\n            J22_off = NP * NX * i,\n            QF_off = NX * i; // copy upper square region\n\n        for (var j = 0; j < NX * NX; j++) {\n          J21[J21_off + j] = raw_J21[NX * NY * i + j];\n        }\n\n        for (var _j20 = 0; _j20 < NX * NP; _j20++) {\n          J22[J22_off + _j20] = raw_J22[NP * NY * i + _j20];\n        }\n\n        for (var _j21 = 0; _j21 < NX; _j21++) {\n          QF[QF_off + _j21] = raw_F[MX * NX + NY * i + _j21];\n        } // QR decomp. square region\n\n\n        for (var _j22 = 1; _j22 < NX; _j22++) {\n          for (var k = 0; k < _j22; k++) {\n            var jk = J21_off + NX * _j22 + k,\n                R_jk = J21[jk];\n            if (R_jk === 0) continue;\n\n            var kk = J21_off + NX * k + k,\n                R_kk = J21[kk],\n                _giv_rot_qr6 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(R_kk, R_jk),\n                _giv_rot_qr7 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr6, 3),\n                c = _giv_rot_qr7[0],\n                s = _giv_rot_qr7[1],\n                nrm = _giv_rot_qr7[2];\n\n            J21[jk] = 0;\n            if (0 === s) continue;\n            J21[kk] = nrm;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(J21, NX - 1 - k, kk + 1, jk + 1, c, s);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(J22, NP, J22_off + k * NP, J22_off + _j22 * NP, c, s);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, QF_off + k, QF_off + _j22, c, s);\n          }\n        } // QR decomp. remaining rows\n\n\n        for (var _j23 = NX; _j23 < NY; _j23++) {\n          if (++l === NP) // <- more than NP rows at bottom of J22 -> start QR decomp.\n            Object(_la_qr__WEBPACK_IMPORTED_MODULE_7__[\"_qr_decomp_inplace\"])(NP, NP, 1, J22, MX * NX * NP, QF, MX * NX);\n          l = Math.min(l, NP); // copy row\n\n          for (var _k8 = 0; _k8 < NX; _k8++) {\n            J21[J21_off + NX * NX + _k8] = raw_J21[NX * NY * i + NX * _j23 + _k8];\n          }\n\n          for (var _k9 = 0; _k9 < NP; _k9++) {\n            J22[(MX * NX + l) * NP + _k9] = raw_J22[NP * NY * i + NP * _j23 + _k9];\n          }\n\n          QF[MX * NX + l] = raw_F[MX * NX + NY * i + _j23]; // eliminate entries in J21\n\n          for (var _k10 = 0; _k10 < NX; _k10++) {\n            var _jk = J21_off + NX * NX + _k10,\n                _R_jk = J21[_jk];\n\n            if (_R_jk === 0) continue;\n\n            var _kk = J21_off + NX * _k10 + _k10,\n                _R_kk = J21[_kk],\n                _giv_rot_qr8 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(_R_kk, _R_jk),\n                _giv_rot_qr9 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr8, 3),\n                _c2 = _giv_rot_qr9[0],\n                _s3 = _giv_rot_qr9[1],\n                _nrm2 = _giv_rot_qr9[2];\n\n            J21[_jk] = 0;\n            if (0 === _s3) continue;\n            J21[_kk] = _nrm2;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(J21, NX - 1 - _k10, _kk + 1, _jk + 1, _c2, _s3);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(J22, NP, J22_off + NP * _k10, (MX * NX + l) * NP, _c2, _s3);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, QF_off + _k10, MX * NX + l, _c2, _s3);\n          }\n\n          if (!(l <= NP)) throw new Error('Assertion failed.'); // more than NP trailing rows in J22 -> eliminate further rows using QR decomp.\n\n          if (l === NP) for (var _k11 = 0; _k11 < NP; _k11++) {\n            var lk = MX * NX * NP + NP * l + _k11,\n                R_lk = J22[lk];\n            if (R_lk === 0) continue;\n\n            var _kk2 = MX * NX * NP + NP * _k11 + _k11,\n                _R_kk2 = J22[_kk2],\n                _giv_rot_qr10 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(_R_kk2, R_lk),\n                _giv_rot_qr11 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr10, 3),\n                _c3 = _giv_rot_qr11[0],\n                _s4 = _giv_rot_qr11[1],\n                _nrm3 = _giv_rot_qr11[2];\n\n            J22[lk] = 0;\n            if (0 === _s4) continue;\n            J22[_kk2] = _nrm3;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(J22, NP - 1 - _k11, _kk2 + 1, lk + 1, _c3, _s4);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, MX * NX + _k11, MX * NX + l, _c3, _s4);\n          }\n        }\n      }\n    } // The Jacobian of the orthogonal least squares problem is sparse with the following structure:\n    //\n    //                                                        \n    //                                                    \n    //                                                    \n    //                                                    \n    //                        0            J11            \n    // J =                        =                       \n    //                                                    \n    //                                                    \n    //                                                    \n    //        \n    //                                               \n    //                                J21        J22 \n    //               ...                                 \n    //                                               \n    //                                                     \n    //\n    //  J  : float[MX*(NX+NY),MX*NX+NP];\n    //  J11: float[MX*NX    ,MX*NX]; J11 is a Diagonal Matrix; Diag. represent the weights on ; Assumed to NOT be rank-deficient;\n    //  J21: float[MX*NX    ,   NP]; J21 is a diagonal block matrix (possibly non-square).\n    //  J22: float[MX*NY    ,   NP]; J22 is a dense matrix\n    //\n    // If there are no rank deficiencies in the upper left MX*NX columns, J can be sparsely QR decomposed as follows to solve ODR problem:\n    // \n    //                                                     \n    //                                               \n    //                                                \n    //                                                 \n    //                                               \n    //                                                \n    //                                  R11        R21 \n    //              .                                   \n    // J = Q        .        = Q                      \n    //                .                                 \n    //                                               \n    //                                                \n    //                                                 \n    //            \n    //                                                  \n    //              0                                    \n    //                                      0         R22 \n    //                                                     \n    //\n    // R11: float[MX*NX               , MX*NX]; Block diagonal matrix where each block is of size [NX,NX] and upper-triangular. Off-diagonal entries can be computed \"on-demand\".\n    // R21: float[MX*NX               ,    NP]; Dense matrix. Entries can be computed implicitly.\n    // R22: float[min(MX*NY, MX*NX+NP),    NP]; Dense upper triangular matrix.\n    //\n\n  }, {\n    key: \"computeNewton\",\n    value: function computeNewton() {\n      var MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          QF = this.QF,\n          J11 = this.J11,\n          F1 = this.prepared_QF,\n          R11 = this.newton_R11,\n          R21 = this.newton_R21,\n          R22 = this.newton_R22,\n          P = this.newton_P,\n          X = this.newton_dX,\n          F0 = this.F0,\n          D = this.D;\n      if (this.rank >= 0) return;\n      if (this.rank !== -1) throw new Error('Assertion failed.');\n      this.prepare();\n      var K = Math.min(MX * NY, MX * NX + NP); //\n      // STEP 1: MEMORY INITIALIZATION\n      //\n      // for R11, only the diagonal is stored in memory explicitly. Off-diagonal entries are computed \"on-demand\"\n\n      for (var i = MX * NX; i-- > 0;) {\n        R11[i] = J11[i];\n      }\n\n      for (var _i34 = K; _i34-- > 0;) {\n        QF[MX * NX + _i34] = F1[_i34];\n      }\n\n      for (var _i35 = MX * NX; _i35-- > 0;) {\n        QF[_i35] = F0[_i35];\n      }\n\n      var rnk = this._qr_decomp(R11, R21, R22, P, QF);\n\n      this.rank = rnk + MX * NX;\n\n      for (var _i36 = MX * NX + rnk; _i36-- > 0;) {\n        X[_i36] = -QF[_i36];\n      }\n\n      if (rnk !== NP) {\n        //\n        // STEP 2.4: ELIMINATE RANK-DEFICIENT COLUMS\n        //           O( rnk * (NP-rnk) ) operations\n        X.fill(0.0, MX * NX + rnk, MX * NX + NP); // factor in scaling into R22\n\n        for (var j = NP; j-- > 0;) {\n          var d = D[MX * NX + P[j]];\n          if (0 !== d) for (var _i37 = rnk; _i37-- > 0;) {\n            R22[NP * _i37 + j] /= d;\n          }\n        } // eliminate lower part of linear dependent columns of R22\n\n\n        for (var _i38 = rnk; _i38-- > 0;) {\n          var ii = NP * _i38 + _i38;\n\n          for (var _j24 = NP; _j24-- > rnk;) {\n            var ij = NP * _i38 + _j24,\n                R_ij = R22[ij];\n            if (0 === R_ij) continue;\n            var R_ii = R22[ii]; // compute Givens rot.\n\n            var _giv_rot_qr12 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(R_ii, R_ij),\n                _giv_rot_qr13 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr12, 3),\n                c = _giv_rot_qr13[0],\n                s = _giv_rot_qr13[1],\n                nrm = _giv_rot_qr13[2];\n\n            if (s !== 0) {\n              if (c < 0) {\n                c *= -1;\n                s *= -1;\n                nrm *= -1;\n              } // apply Givens rot.\n\n\n              for (var k = _i38; k-- > 0;) {\n                var R_ki = R22[NP * k + _i38],\n                    R_kj = R22[NP * k + _j24];\n                R22[NP * k + _i38] = R_kj * s + c * R_ki;\n                R22[NP * k + _j24] = R_kj * c - s * R_ki;\n              }\n\n              R22[ii] = nrm;\n            }\n\n            R22[ij] = s;\n          }\n        }\n      }\n\n      this._qr_solve(R11, R21, R22, P, rnk, X);\n    }\n  }, {\n    key: \"computeNewtonRegularized\",\n    value: function computeNewtonRegularized() {\n       *= 1;\n      if (!( >= 0)) throw new Error('Assertion failed.');\n      var N = this.N,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          R11 = this.regularized_R11,\n          J11 = this.J11,\n          R21 = this.regularized_R21,\n          R22 = this.regularized_R22,\n          P = this.regularized_P,\n          X = this.regularized_dX,\n          D = this.D,\n          QF = this.QF,\n          F0 = this.F0,\n          F1 = this.prepared_QF;\n      var Y = QF; // <- alias to reuse memory\n\n      var K = Math.min(MX * NY, MX * NX + NP);\n      if (R22.length !== Math.max(Math.min(MX * NY, MX * NX + NP + 1), NP + 1) * NP) throw new Error('Assertion failed.');\n      if (QF.length !== Math.max(Math.min(MX * NY, MX * NX + NP + 1), NP + 1) + MX * NX) throw new Error('Assertion failed.');\n\n      if (0 === ) {\n        this.computeNewton();\n        var _R = this.newton_R11,\n            _R2 = this.newton_R21,\n            _R3 = this.newton_R22,\n            _P = this.newton_P,\n            newton_dX = this.newton_dX,\n            rank = this.rank;\n\n        for (var i = N; i-- > 0;) {\n          X[i] = newton_dX[i];\n        }\n\n        var _r3 = this.scaledNorm(X);\n\n        if (0 === _r3) return [0, 0];\n\n        var _rnk = rank - MX * NX;\n\n        if (rank < N) {\n          for (var _i39 = NP; _i39-- > 0;) {\n            var j = MX * NX + _P[_i39];\n            Y[MX * NX + _i39] = X[j] * D[j];\n          }\n\n          for (var _i40 = _rnk; _i40-- > 0;) {\n            for (var _j25 = NP; _j25-- > _rnk;) {\n              var s = _R3[NP * _i40 + _j25];\n              if (s === 0) continue;\n              var c = Math.sqrt(1 - s * s);\n\n              Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Y, 1, MX * NX + _i40, MX * NX + _j25, c, s);\n            }\n          }\n        } else {\n          for (var _i41 = NP; _i41-- > 0;) {\n            var _j26 = MX * NX + _P[_i41];\n\n            Y[MX * NX + _i41] = X[_j26] * D[_j26] * D[_j26];\n          }\n        }\n\n        for (var _i42 = MX * NX; _i42-- > 0;) {\n          Y[_i42] = X[_i42] * D[_i42] * D[_i42];\n        }\n\n        this._rt_solve(_R, _R2, _R3, _P, _rnk, Y);\n\n        var _dr = 0;\n\n        for (var _i43 = rank; _i43-- > 0;) {\n          var d = Y[_i43];\n          _dr += d * d;\n        }\n\n        _dr /= -_r3;\n        return [_r3, _dr];\n      }\n\n      this.prepare(); //\n      // STEP 4: MEMORY INITIALIZATION\n      //\n      // for R11, only the diagonal is stored in memory explicitly. Off-diagonal entries are computed \"on-demand\"\n\n      for (var _i44 = MX * NX; _i44-- > 0;) {\n        R11[_i44] = J11[_i44];\n      }\n\n      for (var _i45 = K; _i45-- > 0;) {\n        QF[MX * NX + _i45] = F1[_i45];\n      }\n\n      for (var _i46 = MX * NX; _i46-- > 0;) {\n        QF[_i46] = F0[_i46];\n      }\n\n      var Sqrt = Math.sqrt(); // eliminate the upper part of regularization before _qr_decomp\n      // O(MX*NX) operations\n\n      for (var _i47 = MX * NX; _i47-- > 0;) {\n        var D = D[_i47] * Sqrt;\n        if (!(D > 0)) throw new Error('Assertion failed.');\n\n        var _giv_rot_qr14 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(R11[_i47], D),\n            _giv_rot_qr15 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr14, 3),\n            _c4 = _giv_rot_qr15[0],\n            _s5 = _giv_rot_qr15[1],\n            nrm = _giv_rot_qr15[2];\n\n        R11[_i47] = nrm;\n        QF[_i47] *= _c4;\n      }\n\n      var rnk = this._qr_decomp(R11, R21, R22, P, QF),\n          R22_end = NP * NP;\n\n      R22.fill(0.0, K * NP, (NP + 1) * NP); // <- zero out entries from previous calls to computeNewtonRegularized()\n\n      for (var _i48 = NP; _i48-- > 0;) {\n        var _D = D[MX * NX + P[_i48]];\n        if (0 === _D) _D = 1;else _D *= Sqrt;\n        if (!(_D > 0)) throw new Error('Assertion failed.');\n\n        if (rnk <= _i48) {\n          // fill up the rank-deficient rows with regularization\n          R22[NP * _i48 + _i48] = _D;\n          QF[MX * NX + _i48] = 0;\n        } else {\n          // eliminate remaining regularization entries (using Givens QR)\n          R22[R22_end + _i48] = _D;\n          QF[N] = 0;\n\n          for (var _j27 = _i48; _j27 < NP; _j27++) {\n            var jj = NP * _j27 + _j27,\n                ij = R22_end + _j27,\n                R_jj = R22[jj],\n                R_ij = R22[ij],\n                _giv_rot_qr16 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(R_jj, R_ij),\n                _giv_rot_qr17 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_3___default()(_giv_rot_qr16, 3),\n                _c5 = _giv_rot_qr17[0],\n                _s6 = _giv_rot_qr17[1],\n                _nrm4 = _giv_rot_qr17[2];\n\n            R22[ij] = 0;\n            if (_s6 === 0) continue;\n            R22[jj] = _nrm4;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(R22, NP - _j27 - 1, jj + 1, ij + 1, _c5, _s6);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(QF, 1, MX * NX + _j27, N, _c5, _s6);\n          }\n        }\n      }\n\n      for (var _i49 = N; _i49-- > 0;) {\n        X[_i49] = -QF[_i49];\n      }\n\n      this._qr_solve(R11, R21, R22, P, NP, X);\n\n      var r = this.scaledNorm(X);\n      if (0 === r) return [0, 0];\n\n      for (var _i50 = NP; _i50-- > 0;) {\n        var _j28 = MX * NX + P[_i50];\n\n        Y[MX * NX + _i50] = X[_j28] * D[_j28] * D[_j28];\n      }\n\n      for (var _i51 = MX * NX; _i51-- > 0;) {\n        Y[_i51] = X[_i51] * D[_i51] * D[_i51];\n      }\n\n      this._rt_solve(R11, R21, R22, P, NP, Y);\n\n      var dr = 0;\n\n      for (var _i52 = N; _i52-- > 0;) {\n        var _d = Y[_i52];\n        dr += _d * _d;\n      }\n\n      dr /= -r;\n      return [r, dr];\n    }\n  }, {\n    key: \"__DEBUG_RVD\",\n    get: function get() // <- meant for debugging only!\n    {\n      var M = this.M,\n          N = this.N,\n          MX = this.MX,\n          NX = this.NX,\n          NY = this.NY,\n          NP = this.NP,\n          R11 = this.newton_R11,\n          R21 = this.newton_R21,\n          R22 = this.newton_R22,\n          P = this.newton_P,\n          J21 = this.prepared_J21,\n          J22 = this.prepared_J22;\n      if (!(0 <= this.rank)) throw new Error('Assertion failed.');\n      var L = Math.min(NX, NY),\n          rnk = this.rank - MX * NX,\n          R = new Float64Array(M * N),\n          V = new Float64Array(N * N),\n          D = new Float64Array(1 * N);\n      D.fill(1.0);\n\n      for (var i = 0; i < MX * NX; i++) {\n        V[N * i + i] = 1;\n      }\n\n      for (var _i53 = 0; _i53 < NP; _i53++) {\n        V[N * (MX * NX + _i53) + (MX * NX + P[_i53])] = 1;\n      } // diag(R11)\n\n\n      for (var _i54 = 0; _i54 < MX * NX; _i54++) {\n        R[N * _i54 + _i54] = R11[_i54];\n      } // triu(R11,+1)\n\n\n      for (var _i55 = 0; _i55 < MX; _i55++) {\n        for (var j = 0; j < NX; j++) {\n          for (var k = 1 + j; k < NX; k++) {\n            for (var l = 0; l < L; l++) {\n              R[N * (NX * _i55 + j) + (NX * _i55 + k)] += R21[NX * (L * _i55 + l) + j] * J21[NX * (L * _i55 + l) + k];\n            }\n          }\n        }\n      } // R12\n\n\n      for (var _i56 = 0; _i56 < MX; _i56++) {\n        for (var _j29 = 0; _j29 < NX; _j29++) {\n          for (var _k12 = 0; _k12 < NP; _k12++) {\n            for (var _l2 = 0; _l2 < L; _l2++) {\n              R[N * (NX * _i56 + _j29) + (NX * MX + _k12)] += R21[NX * (L * _i56 + _l2) + _j29] * J22[NP * (L * _i56 + _l2) + P[_k12]];\n            }\n          }\n        }\n      } // R22\n\n\n      for (var _i57 = 0; _i57 < rnk; _i57++) {\n        for (var _j30 = 0; _j30 < rnk; _j30++) {\n          R[N * (MX * NX + _i57) + (MX * NX + _j30)] = R22[NP * _i57 + _j30];\n        }\n      }\n\n      if (rnk !== NP) {\n        for (var _i58 = MX * NX + NP; _i58-- > MX * NX;) {\n          D[_i58] = this.D[_i58] || 1;\n        } // APPLY SCALING TO R12 \n\n\n        for (var _j31 = NP; _j31-- > 0;) {\n          var D_j = this.D[MX * NX + P[_j31]];\n          if (0 !== D_j) for (var _i59 = MX * NX; _i59-- > 0;) {\n            R[N * _i59 + (MX * NX + _j31)] /= D_j;\n          }\n        } // APPLY GIVENS ROTATIONS TO R12\n\n\n        for (var _i60 = rnk; _i60-- > 0;) {\n          for (var _j32 = NP; _j32-- > rnk;) {\n            var s = R22[NP * _i60 + _j32];\n            if (s === 0) continue;\n            var c = Math.sqrt(1 - s * s);\n\n            for (var _k13 = MX * NX; _k13-- > 0;) {\n              var ki = N * _k13 + (MX * NX + _i60),\n                  kj = N * _k13 + (MX * NX + _j32),\n                  R_ki = R[ki],\n                  R_kj = R[kj];\n              R[ki] = R_kj * s + c * R_ki;\n              R[kj] = R_kj * c - s * R_ki;\n            }\n          }\n        }\n\n        for (var _i61 = MX * NX; _i61-- > 0;) {\n          for (var _j33 = MX * NX + NP; _j33-- > MX * NX + rnk;) {\n            R[N * _i61 + _j33] = 0;\n          }\n        } // APPLY GIVENS ROTATIONS TO V\n\n\n        for (var _i62 = rnk; _i62-- > 0;) {\n          for (var _j34 = NP; _j34-- > rnk;) {\n            var _s7 = R22[NP * _i62 + _j34];\n            if (0 === _s7) continue;\n\n            var _c6 = Math.sqrt(1 - _s7 * _s7);\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(V, N, N * (MX * NX + _i62), N * (MX * NX + _j34), _c6, _s7);\n          }\n        }\n      }\n\n      return [new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](Int32Array.of(M, N), R), new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](Int32Array.of(N, N), V), new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](Int32Array.of(1, N), D)];\n    }\n  }]);\n\n  return TrustRegionSolverTLS;\n}();\n\n//# sourceURL=webpack://nd/./src/opt/_trust_region_solver_tls.js?");

/***/ }),

/***/ "./src/opt/dogleg.js":
/*!***************************!*\
  !*** ./src/opt/dogleg.js ***!
  \***************************/
/*! exports provided: min_dogleg_gen, lsq_dogleg_gen, tls_dogleg_gen, odr_dogleg_gen, fit_dogleg_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"min_dogleg_gen\", function() { return min_dogleg_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lsq_dogleg_gen\", function() { return lsq_dogleg_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tls_dogleg_gen\", function() { return tls_dogleg_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"odr_dogleg_gen\", function() { return odr_dogleg_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fit_dogleg_gen\", function() { return fit_dogleg_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n/* harmony import */ var _polyquad__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./polyquad */ \"./src/opt/polyquad.js\");\n/* harmony import */ var _trust_region_solver_lbfgs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_trust_region_solver_lbfgs */ \"./src/opt/_trust_region_solver_lbfgs.js\");\n/* harmony import */ var _trust_region_solver_lsq__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./_trust_region_solver_lsq */ \"./src/opt/_trust_region_solver_lsq.js\");\n/* harmony import */ var _trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./_trust_region_solver_tls */ \"./src/opt/_trust_region_solver_tls.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(_dogleg),\n    _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(fit_dogleg_gen);\n\n\n\n\n\n\n\n\nfunction min_dogleg_gen(fg, x0) {\n  var opt = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _opt$updateTol = opt.updateTol,\n      updateTol = _opt$updateTol === void 0 ? 1e-14 : _opt$updateTol,\n      _opt$historySize = opt.historySize,\n      historySize = _opt$historySize === void 0 ? 8 : _opt$historySize,\n      _opt$scaleInit = opt.scaleInit,\n      scaleInit = _opt$scaleInit === void 0 ? 1e-2 : _opt$scaleInit;\n  return _dogleg(new _trust_region_solver_lbfgs__WEBPACK_IMPORTED_MODULE_7__[\"TrustRegionSolverLBFGS\"](fg, x0, {\n    updateTol: updateTol,\n    historySize: historySize,\n    scaleInit: scaleInit\n  }), opt);\n} // References\n// ----------\n// .. [1] \"An Improved Optimization Method for iSAM2\"\n//         Rana Talaei Shahir and Hamid D. Taghirad Senior Member, IEEE\n//         Proceeding of the 2nd RSI/ISM International Conference on Robotics and Mechatronics\n//         October 15-17, 2014, Tehran, Iran\n// .. [2] \"THE LEVENBERG-MARQUARDT ALGORITHM: IMPLEMENTATION AND THEORY\"\n//         Jorge J. Mor.\n// TODO implemented double-dogleg method as well as described in [1]\n// TODO implement dogbox method as well which allows for box-constrained optimization\n\n/** Solves a nonlinear least-squares problem using the dogleg method.\n */\n\nvar lsq_dogleg_gen = function lsq_dogleg_gen(fJ, x0, opt) {\n  return _dogleg(new _trust_region_solver_lsq__WEBPACK_IMPORTED_MODULE_8__[\"TrustRegionSolverLSQ\"](fJ, x0), opt);\n};\n\nfunction _dogleg(solver) {\n  var _ref,\n      _ref$r,\n      r0,\n      _ref$rMin,\n      rMin,\n      _ref$rMax,\n      rMax,\n      _ref$rNewton,\n      rNewton,\n      _ref$shrinkLower,\n      shrinkLower,\n      _ref$shrinkUpper,\n      shrinkUpper,\n      _ref$grow,\n      grow,\n      _ref$expectGainMin,\n      expectGainMin,\n      _ref$expectGainMax,\n      expectGainMax,\n      _ref$stuckLimit,\n      stuckLimit,\n      N,\n      D,\n      newton_dX,\n      G,\n      dX,\n      gNorm,\n      cp,\n      R,\n      loss,\n      stuckometer,\n      t,\n      i,\n      gnInRadius,\n      a,\n      b,\n      c,\n      _i,\n      d,\n      u,\n      v,\n      _t,\n      _i2,\n      _v,\n      _solver$considerMove,\n      _solver$considerMove2,\n      loss_predict,\n      loss_consider,\n      rScale,\n      predict,\n      actual,\n      grad,\n      _i3,\n      shrink,\n      r,\n      distanceToNewton,\n      rs,\n      _args = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _dogleg$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref = _args.length > 1 && _args[1] !== undefined ? _args[1] : {}, _ref$r = _ref.r0, r0 = _ref$r === void 0 ? 1.1 : _ref$r, _ref$rMin = _ref.rMin, rMin = _ref$rMin === void 0 ? 0 : _ref$rMin, _ref$rMax = _ref.rMax, rMax = _ref$rMax === void 0 ? Infinity : _ref$rMax, _ref$rNewton = _ref.rNewton, rNewton = _ref$rNewton === void 0 ? 2 : _ref$rNewton, _ref$shrinkLower = _ref.shrinkLower, shrinkLower = _ref$shrinkLower === void 0 ? 0.05 : _ref$shrinkLower, _ref$shrinkUpper = _ref.shrinkUpper, shrinkUpper = _ref$shrinkUpper === void 0 ? 0.95 : _ref$shrinkUpper, _ref$grow = _ref.grow, grow = _ref$grow === void 0 ? 1.4142135623730951 : _ref$grow, _ref$expectGainMin = _ref.expectGainMin, expectGainMin = _ref$expectGainMin === void 0 ? 0.25 : _ref$expectGainMin, _ref$expectGainMax = _ref.expectGainMax, expectGainMax = _ref$expectGainMax === void 0 ? 0.75 : _ref$expectGainMax, _ref$stuckLimit = _ref.stuckLimit, stuckLimit = _ref$stuckLimit === void 0 ? 64 : _ref$stuckLimit;\n\n          if (0 < r0) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.r0 must be positive number.');\n\n        case 3:\n          if (0 <= rMin) {\n            _context.next = 5;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.rMin must be non-negative.');\n\n        case 5:\n          if (rMin <= rMax) {\n            _context.next = 7;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.rMin must not be greater than opt.rMax.');\n\n        case 7:\n          if (rMin <= r0) {\n            _context.next = 9;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.r0 must not be less than opt.rMin.');\n\n        case 9:\n          if (rMax >= r0) {\n            _context.next = 11;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.r0 must not be greater than opt.rMax.');\n\n        case 11:\n          if (1 < rNewton) {\n            _context.next = 13;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.rGN must be greater than 1.');\n\n        case 13:\n          if (0 < shrinkLower) {\n            _context.next = 15;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.shrinkLower must be positive number.');\n\n        case 15:\n          if (shrinkLower <= shrinkUpper) {\n            _context.next = 17;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.shrinkLower must not be greater than opt.shrinkUpper.');\n\n        case 17:\n          if (shrinkUpper < 1) {\n            _context.next = 19;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.shrinkUpper must be less than 1.');\n\n        case 19:\n          if (1 < grow) {\n            _context.next = 21;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.grow must be number greater than 1.');\n\n        case 21:\n          if (0 < expectGainMin) {\n            _context.next = 23;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.expectGainMin must be positive number.');\n\n        case 23:\n          if (expectGainMin < expectGainMax) {\n            _context.next = 25;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.expectGainMin must be less than expectGainMax.');\n\n        case 25:\n          if (!(expectGainMax < 1)) console.warn('dogleg_gen(fJ, x0, opt): opt.expectGainMax should be less than 1.');\n\n          if (!(0 !== stuckLimit % 1)) {\n            _context.next = 28;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.stuckLimit must be an integer.');\n\n        case 28:\n          if (0 <= stuckLimit) {\n            _context.next = 30;\n            break;\n          }\n\n          throw new Error('dogleg_gen(fJ, x0, opt): opt.stuckLimit must not be negative.');\n\n        case 30:\n          N = solver.N, D = solver.D, newton_dX = solver.newton_dX, G = solver.G0, dX = new Float64Array(N);\n          gNorm = solver.scaledNorm(G), cp = solver.cauchyTravel(), R = r0 * -gNorm * cp, loss = solver.loss, stuckometer = 0; // <- indicates how stuck we are, i.e. counts the number of consecutive operations without progress\n\n        case 32:\n          if (cp <= 0) {\n            _context.next = 34;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 34:\n          if (!(0 === stuckometer)) {\n            _context.next = 37;\n            break;\n          }\n\n          _context.next = 37;\n          return solver.report();\n\n        case 37:\n          t = Math.max(-R / gNorm, cp); // <- don't go beyond trust region radius\n\n          for (i = N; i-- > 0;) {\n            dX[i] = t * G[i];\n          } // <- FIXME: Shouldn't the scaling be used here?!?!\n\n\n          ;\n          gnInRadius = false;\n\n          if (!(-gNorm * cp < R)) {\n            _context.next = 52;\n            break;\n          }\n\n          solver.computeNewton(); // <- computes Gauss-Newton point\n          // TODO In [2], a method is described to adjust trust radius when global min is\n          //      inside trust region. Maybe it could be used in the Dogleg method as well.\n          // let's find the travel t from cauchy point (cp) to gauss-newton point (gp) which intersects\n          // with the trust region boundary. t=0 means cauchy point t=1 mean gauss-newton point.\n          // The travel is the solution to following the quadratic equation:\n          //   R = a + 2bt + ct\n\n          a = 0, b = 0, c = 0;\n\n          for (_i = N; _i-- > 0;) {\n            d = D[_i], u = d * dX[_i], v = d * (newton_dX[_i] - dX[_i]);\n            a += u * u;\n            b += u * v;\n            c += v * v;\n          }\n\n          a -= R * R;\n          b *= 2;\n          _t = Object(_polyquad__WEBPACK_IMPORTED_MODULE_6__[\"roots1d_polyquad\"])(a, b, c)[1];\n          /*DEBUG*/\n\n          if (0 <= _t) {\n            _context.next = 50;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 50:\n          if (_t > 1) {\n            // <- don't go beyond gauss-newton point (i.e. when it lies inside rust region)\n            _t = 1;\n            gnInRadius = true;\n          }\n\n          for (_i2 = N; _i2-- > 0;) {\n            _v = newton_dX[_i2] - dX[_i2];\n            dX[_i2] += _v * _t;\n          }\n\n        case 52:\n          if (gnInRadius) {\n            _context.next = 57;\n            break;\n          }\n\n          if (Math.abs(solver.scaledNorm(dX) - R) <= R * 1e-5 + 1e-8) {\n            _context.next = 55;\n            break;\n          }\n\n          throw new Error('Assertion failed: ' + JSON.stringify({\n            cp: cp,\n            err: Math.abs(solver.scaledNorm(dX) - R),\n            D: _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(D),\n            G: _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(G),\n            dX: _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(dX)\n          }));\n\n        case 55:\n          _context.next = 59;\n          break;\n\n        case 57:\n          if (solver.scaledNorm(dX) <= R * (1 + 1e-5)) {\n            _context.next = 59;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 59:\n          // <- check that solution is in ellipsoid\n          _solver$considerMove = solver.considerMove(dX), _solver$considerMove2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_solver$considerMove, 2), loss_predict = _solver$considerMove2[0], loss_consider = _solver$considerMove2[1]; //*DEBUG*/    if( !(loss_predict <= loss+1e-12) ) throw new Error('Assertion failed: ' + JSON.stringify({loss, loss_consider, loss_predict, gnInRadius}));\n\n          rScale = function rScale() {\n            return 1;\n          }; // const rScale = () => gNorm; // <- TODO: examine scaling alternatives\n\n\n          predict = loss - loss_predict, actual = loss - loss_consider;\n\n          if (!(actual < predict * expectGainMin)) {\n            _context.next = 74;\n            break;\n          }\n\n          // PREDICTION BAD -> REDUCE TRUST RADIUS\n          // (by fitting a quadratic polynomial through err_now, grad_now and err_next)\n          grad = 0;\n\n          for (_i3 = N; _i3-- > 0;) {\n            grad += dX[_i3] * G[_i3];\n          }\n\n          shrink = grad / (2 * grad + loss - loss_consider);\n          if (!(shrink >= shrinkLower)) shrink = shrinkLower;\n          if (!(shrink <= shrinkUpper)) shrink = shrinkUpper;\n          r = Math.max(rMin * rScale(), R * shrink);\n\n          if (!(r === R && !(loss > loss_consider))) {\n            _context.next = 71;\n            break;\n          }\n\n          throw new _optimization_error__WEBPACK_IMPORTED_MODULE_5__[\"OptimizationNoProgressError\"]();\n\n        case 71:\n          R = r;\n          _context.next = 75;\n          break;\n\n        case 74:\n          if (gnInRadius) {\n            // See [2] Algorithm (7.1) (d). If Gauss-Newton point is inside the trust radius and\n            // prediction is not bad, set the radius to rGN times the distance to the Gauss-Newton\n            // point. This also avoids that the trust radius grows uncontrollably while the\n            // Gauss-Newton point is inside the trust region for a few iterations.\n            distanceToNewton = solver.scaledNorm(dX), rs = rScale();\n            R = Math.max(rMin * rs, Math.min(rMax * rs, rNewton * distanceToNewton));\n          } else if (actual > predict * expectGainMax || actual === 0) {\n            // PREDICTION GREAT -> INCREASE TRUST RADIUS\n            R = Math.min(rMax * rScale(), Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_4__[\"nextUp\"])(R), R * grow));\n          }\n\n        case 75:\n          // ONLY ACCEPT NEW X IF BETTER\n          if (loss > loss_consider) {\n            loss = loss_consider;\n            solver.makeConsideredMove();\n            stuckometer = 0;\n          } else if (++stuckometer > stuckLimit) solver.wiggle();\n\n          gNorm = solver.scaledNorm(G);\n          cp = solver.cauchyTravel();\n\n        case 78:\n          _context.next = 32;\n          break;\n\n        case 80:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\nvar tls_dogleg_gen = function tls_dogleg_gen(fjj, p0, dx0, opt) {\n  return _dogleg(new _trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_9__[\"TrustRegionSolverTLS\"](fjj, p0, dx0), opt);\n};\nvar odr_dogleg_gen = Object(_trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_9__[\"odr_gen\"])(_dogleg);\nfunction fit_dogleg_gen(x, //: float[nSamples,nDim]\ny, //: float[nSamples]\nfg, //: (params: float[nParam]) => (x: float[nDim]) => [f: float, g: float[nParam]],\np0, //: float[nParam]\nopt) {\n  var FloatArray, _p0$shape, P, _x$shape, M, N, x_shape, R, J, RJ, fJ;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function fit_dogleg_gen$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          if (fg instanceof Function) {\n            _context2.next = 2;\n            break;\n          }\n\n          throw new Error('fit_dogleg_gen(x,y, fg, p0): fg must be a function.');\n\n        case 2:\n          x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])(x); // <- TODO allow non-ndarray x ?\n\n          y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', y);\n          p0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"array\"])('float64', p0);\n          FloatArray = Float64Array;\n\n          if (!(x.ndim !== 2)) {\n            _context2.next = 8;\n            break;\n          }\n\n          throw new Error('fit_dogleg_gen(x,y, fg, p0): x.ndim must be 2.');\n\n        case 8:\n          if (!(y.ndim !== 1)) {\n            _context2.next = 10;\n            break;\n          }\n\n          throw new Error('fit_dogleg_gen(x,y, fg, p0): y.ndim must be 1.');\n\n        case 10:\n          if (!(p0.ndim !== 1)) {\n            _context2.next = 12;\n            break;\n          }\n\n          throw new Error('fit_dogleg_gen(x,y, fg, p0): p0.ndim must be 1.');\n\n        case 12:\n          _p0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(p0.shape, 1), P = _p0$shape[0], _x$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(x.shape, 2), M = _x$shape[0], N = _x$shape[1], x_shape = Int32Array.of(N);\n\n          if (!(M != y.shape[0])) {\n            _context2.next = 15;\n            break;\n          }\n\n          throw new Error('fit_dogleg_gen(x,y, fg, p0): x.shape[0] must be equal to y.shape[0].');\n\n        case 15:\n          x = x.data.slice(); // <- TODO: TypedArray.subarray could be used here\n\n          y = y.data; // if x is frozen, no protection copies are necessary while passing it to fg\n\n          Object.freeze(x.buffer);\n          x = Array.from({\n            length: M\n          }, function (_, i) {\n            return Object.freeze(new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](x_shape, x.subarray(N * i, N * i + 1)));\n          });\n          Object.freeze(x);\n          R = new FloatArray(M), J = new FloatArray(M * P), RJ = [new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](Int32Array.of(M), R), new _nd_array__WEBPACK_IMPORTED_MODULE_3__[\"NDArray\"](Int32Array.of(M, P), J)];\n\n          fJ = function fJ(p) {\n            var fgp = fg(p);\n            if (!(fgp instanceof Function)) throw new Error();\n\n            for (var i = M; i-- > 0;) {\n              var _fgp = fgp(x[i]),\n                  _fgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fgp, 2),\n                  f = _fgp2[0],\n                  g = _fgp2[1];\n\n              f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(f);\n              g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_3__[\"asarray\"])(g);\n              if (f.ndim !== 0) throw new Error('fit_dogleg_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (g.ndim !== 1) throw new Error('fit_dogleg_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (g.shape[0] !== P) throw new Error('fit_dogleg_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              f = f.data[0];\n              g = g.data;\n              if (isNaN(f)) throw new Error('fit_dogleg_gen(x,y, fg, p0): NaN encountered.');\n              if (g.some(isNaN)) throw new Error('fit_dogleg_gen(x,y, fg, p0): NaN encountered.');\n              R[i] = f - y[i];\n\n              for (var j = P; j-- > 0;) {\n                J[P * i + j] = g[j];\n              }\n            }\n\n            return RJ;\n          };\n\n          return _context2.delegateYield(lsq_dogleg_gen(fJ, p0, opt), \"t0\", 23);\n\n        case 23:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\n\n//# sourceURL=webpack://nd/./src/opt/dogleg.js?");

/***/ }),

/***/ "./src/opt/fit_lin.js":
/*!****************************!*\
  !*** ./src/opt/fit_lin.js ***!
  \****************************/
/*! exports provided: fit_lin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fit_lin\", function() { return fit_lin; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _la_lstsq__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../la/lstsq */ \"./src/la/lstsq.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nfunction fit_lin(x, y, regularization, funcs) {\n  // TODO:\n  //  - Allow weights\n  //  - Allow different norms (e.g. Huber penalty function, see: https://www.youtube.com/watch?v=gH13lxieYFU)\n  //  - Allow diagonal matrix for regularization\n  if (funcs == null) {\n    funcs = regularization;\n    regularization = 0;\n  } else if (null == regularization) regularization = 0;else if (!(0 <= regularization && regularization < Infinity)) throw new Error(\"fit_lin(x,y, regularization, funcs): Invalid regularization: \".concat(regularization, \".\"));\n\n  funcs = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(funcs);\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])('float64', x);\n  y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])('float64', y);\n  if (y.ndim !== 1) throw new Error('fit_lin(x,y, (regularization,) funcs): y.ndim must be 1.');\n  var M = y.shape[0],\n      N = funcs.length;\n  var x_ndim = x.ndim;\n  if (x.ndim !== 1 && x.ndim !== 2) throw new Error('fit_lin(x,y, (regularization,) funcs): x.ndim must be 1 or 2.');\n  if (x.shape[0] !== y.shape[0]) throw new Error('fit_lin(x,y, (regularization,) funcs): x.shape[0] and y.shape[0] must equal.');\n  if (x.ndim === 1) x = x.data;else {\n    var x_shape = x.shape.slice(1),\n        _x_shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(x_shape, 1),\n        L = _x_shape[0];\n\n    x = x.data.slice();\n    Object.freeze(x.buffer);\n    x = Array.from({\n      length: M\n    }, function (_, i) {\n      return Object.freeze(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, x.subarray(L * i, L * (i + 1))));\n    });\n  }\n  var A_shape = Int32Array.of((regularization !== 0) * N + M, N);\n  var A = new Float64Array(A_shape[0] * A_shape[1]),\n      z = y;\n\n  if (regularization !== 0) {\n    regularization = Math.sqrt(regularization);\n\n    for (var i = N; i-- > 0;) {\n      A[M * N + N * i + i] = regularization;\n    }\n  }\n\n  for (var _i = M; _i-- > 0;) {\n    for (var j = N; j-- > 0;) {\n      A[N * _i + j] = funcs[j](x[_i]);\n    }\n  }\n\n  if (regularization !== 0) {\n    y = y.data;\n\n    var _z = new Float64Array(M + N);\n\n    for (var _i2 = M; _i2-- > 0;) {\n      _z[_i2] = y[_i2];\n    }\n\n    y = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M + N, 1), _z);\n  } else y = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M, 1), y.data);\n\n  A = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](A_shape, A);\n\n  var _lstsq = Object(_la_lstsq__WEBPACK_IMPORTED_MODULE_3__[\"lstsq\"])(A, y),\n      coeffs = _lstsq.data;\n\n  var param_lin_func = function param_lin_func(x) {\n    var coeffs = param_lin_func.coeffs,\n        funcs = param_lin_func.funcs;\n    if (coeffs.length !== funcs.length) throw new Error('Assertion failed.');\n    var result = 0;\n\n    for (var _i3 = coeffs.length; _i3-- > 0;) {\n      result += coeffs[_i3] * funcs[_i3](x);\n    }\n\n    return result;\n  };\n\n  param_lin_func.coeffs = coeffs;\n  param_lin_func.funcs = funcs;\n  return param_lin_func;\n}\n\n//# sourceURL=webpack://nd/./src/opt/fit_lin.js?");

/***/ }),

/***/ "./src/opt/gss.js":
/*!************************!*\
  !*** ./src/opt/gss.js ***!
  \************************/
/*! exports provided: min1d_gss */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"min1d_gss\", function() { return min1d_gss; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n// REFERENCES\n// ----------\n// .. [1] https://en.wikipedia.org/wiki/Golden_section_search\n// .. [2] https://github.com/scipy/scipy/blob/master/scipy/optimize/optimize.py#L2306\n\nvar  = 1.5 - Math.sqrt(5 / 4);\nfunction min1d_gss(F, x_min, x_max) {\n  if (x_min > x_max) throw new Error('opt1d_golden(F,x_min,x_max): x_max must not be less than x_min.');\n\n  for (var a = x_min, b = x_max, c = a + (b - a) * , Fc = F(c);;) {\n    var d = b - (b - a) * ;\n    if (d === b) return (b + a) / 2;\n    var Fd = F(d);\n\n    if (Fc < Fd) {\n      b = a;\n      a = d;\n    } else {\n      a = c;\n      c = d;\n      Fc = Fd;\n    }\n  }\n}\n\n//# sourceURL=webpack://nd/./src/opt/gss.js?");

/***/ }),

/***/ "./src/opt/index.js":
/*!**************************!*\
  !*** ./src/opt/index.js ***!
  \**************************/
/*! exports provided: line_search, test_fn, min_dogleg_gen, lsq_dogleg_gen, tls_dogleg_gen, odr_dogleg_gen, fit_dogleg_gen, fit_lin, min1d_gss, min_lbfgs_gen, lsq_lbfgs_gen, fit_lbfgs_gen, min_lbfgsb_gen, LineSearchError, LineSearchNoProgressError, LineSearchBisectionError, LineSearchBoundReachedError, more_thuente_abc, more_thuente_u123, strong_wolfe, lsq_lm_gen, tls_lm_gen, odr_lm_gen, fit_lm_gen, num_grad, num_grad_forward, OptimizationError, OptimizationNoProgressError, root1d_bisect, root1d_brent, root1d_illinois */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _line_search__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./line_search */ \"./src/opt/line_search/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"line_search\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__; });\n/* harmony import */ var _test_fn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./test_fn */ \"./src/opt/test_fn/index.js\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"test_fn\", function() { return _test_fn__WEBPACK_IMPORTED_MODULE_1__; });\n/* harmony import */ var _dogleg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dogleg */ \"./src/opt/dogleg.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"min_dogleg_gen\", function() { return _dogleg__WEBPACK_IMPORTED_MODULE_2__[\"min_dogleg_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lsq_dogleg_gen\", function() { return _dogleg__WEBPACK_IMPORTED_MODULE_2__[\"lsq_dogleg_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tls_dogleg_gen\", function() { return _dogleg__WEBPACK_IMPORTED_MODULE_2__[\"tls_dogleg_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"odr_dogleg_gen\", function() { return _dogleg__WEBPACK_IMPORTED_MODULE_2__[\"odr_dogleg_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fit_dogleg_gen\", function() { return _dogleg__WEBPACK_IMPORTED_MODULE_2__[\"fit_dogleg_gen\"]; });\n\n/* harmony import */ var _fit_lin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./fit_lin */ \"./src/opt/fit_lin.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fit_lin\", function() { return _fit_lin__WEBPACK_IMPORTED_MODULE_3__[\"fit_lin\"]; });\n\n/* harmony import */ var _gss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./gss */ \"./src/opt/gss.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"min1d_gss\", function() { return _gss__WEBPACK_IMPORTED_MODULE_4__[\"min1d_gss\"]; });\n\n/* harmony import */ var _lbfgs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lbfgs */ \"./src/opt/lbfgs.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"min_lbfgs_gen\", function() { return _lbfgs__WEBPACK_IMPORTED_MODULE_5__[\"min_lbfgs_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lsq_lbfgs_gen\", function() { return _lbfgs__WEBPACK_IMPORTED_MODULE_5__[\"lsq_lbfgs_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fit_lbfgs_gen\", function() { return _lbfgs__WEBPACK_IMPORTED_MODULE_5__[\"fit_lbfgs_gen\"]; });\n\n/* harmony import */ var _lbfgsb__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lbfgsb */ \"./src/opt/lbfgsb.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"min_lbfgsb_gen\", function() { return _lbfgsb__WEBPACK_IMPORTED_MODULE_6__[\"min_lbfgsb_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchError\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchNoProgressError\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchNoProgressError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBisectionError\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchBisectionError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBoundReachedError\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchBoundReachedError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_abc\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"more_thuente_abc\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_u123\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"more_thuente_u123\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"strong_wolfe\", function() { return _line_search__WEBPACK_IMPORTED_MODULE_0__[\"strong_wolfe\"]; });\n\n/* harmony import */ var _lm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lm */ \"./src/opt/lm.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lsq_lm_gen\", function() { return _lm__WEBPACK_IMPORTED_MODULE_7__[\"lsq_lm_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"tls_lm_gen\", function() { return _lm__WEBPACK_IMPORTED_MODULE_7__[\"tls_lm_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"odr_lm_gen\", function() { return _lm__WEBPACK_IMPORTED_MODULE_7__[\"odr_lm_gen\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"fit_lm_gen\", function() { return _lm__WEBPACK_IMPORTED_MODULE_7__[\"fit_lm_gen\"]; });\n\n/* harmony import */ var _num_grad__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./num_grad */ \"./src/opt/num_grad.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"num_grad\", function() { return _num_grad__WEBPACK_IMPORTED_MODULE_8__[\"num_grad\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"num_grad_forward\", function() { return _num_grad__WEBPACK_IMPORTED_MODULE_8__[\"num_grad_forward\"]; });\n\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"OptimizationError\", function() { return _optimization_error__WEBPACK_IMPORTED_MODULE_9__[\"OptimizationError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"OptimizationNoProgressError\", function() { return _optimization_error__WEBPACK_IMPORTED_MODULE_9__[\"OptimizationNoProgressError\"]; });\n\n/* harmony import */ var _root1d_bisect__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./root1d_bisect */ \"./src/opt/root1d_bisect.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"root1d_bisect\", function() { return _root1d_bisect__WEBPACK_IMPORTED_MODULE_10__[\"root1d_bisect\"]; });\n\n/* harmony import */ var _root1d_brent__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./root1d_brent */ \"./src/opt/root1d_brent.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"root1d_brent\", function() { return _root1d_brent__WEBPACK_IMPORTED_MODULE_11__[\"root1d_brent\"]; });\n\n/* harmony import */ var _root1d_illinois__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./root1d_illinois */ \"./src/opt/root1d_illinois.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"root1d_illinois\", function() { return _root1d_illinois__WEBPACK_IMPORTED_MODULE_12__[\"root1d_illinois\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n// AGENDA:\n//   - Quadratic Programming\n//   - Orthogonal Distance Regression\n//   - Derivative-Free Multivariate Minimizers\n\n\n\n\n\n\n\n\n\n // <- FIXME: this should not be here remove in next major version\n\n\n\n\n\n\n\n\n//# sourceURL=webpack://nd/./src/opt/index.js?");

/***/ }),

/***/ "./src/opt/lbfgs.js":
/*!**************************!*\
  !*** ./src/opt/lbfgs.js ***!
  \**************************/
/*! exports provided: min_lbfgs_gen, lsq_lbfgs_gen, fit_lbfgs_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"min_lbfgs_gen\", function() { return min_lbfgs_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lsq_lbfgs_gen\", function() { return lsq_lbfgs_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fit_lbfgs_gen\", function() { return fit_lbfgs_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./line_search/line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony import */ var _lbfgs_solver__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_lbfgs_solver */ \"./src/opt/_lbfgs_solver.js\");\n/* harmony import */ var _line_search_more_thuente_abc__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./line_search/more_thuente_abc */ \"./src/opt/line_search/more_thuente_abc.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(min_lbfgs_gen),\n    _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(lsq_lbfgs_gen),\n    _marked3 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(fit_lbfgs_gen);\n\n\n\n\n // REFERENCES\n// ----------\n// .. [1] \"On the Limited Memory BFGS Method for Large Scale Optimization.\"\n//         Dong C. Liu and Jorge Nocedal\n// .. [2] \"Updating Quasi-Newton Matrices with Limited Storage\"\n//         Jorge Nocedal \n//         MATHEMATICS OF COMPUTATION, VOL. 35, NO. 151, JULY 1980, PAGES 773-78\n//         https://courses.engr.illinois.edu/ece544na/fa2014/nocedal80.pdf\n// TODO: Implement scaling as described in [1].\n\nfunction min_lbfgs_gen(fg, x0) {\n  var _ref,\n      _ref$historySize,\n      historySize,\n      _ref$lineSearch,\n      lineSearch,\n      _ref$updateTol,\n      updateTol,\n      _ref$negDir,\n      negDir0,\n      _ref$scaling,\n      scaling,\n      x,\n      _x$shape,\n      L,\n      shape,\n      _fg,\n      _fg2,\n      f,\n      g,\n      solver,\n      dx,\n      dg,\n      step,\n      _args = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function min_lbfgs_gen$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref = _args.length > 2 && _args[2] !== undefined ? _args[2] : {}, _ref$historySize = _ref.historySize, historySize = _ref$historySize === void 0 ? 8 : _ref$historySize, _ref$lineSearch = _ref.lineSearch, lineSearch = _ref$lineSearch === void 0 ? Object(_line_search_more_thuente_abc__WEBPACK_IMPORTED_MODULE_5__[\"more_thuente_abc\"])() : _ref$lineSearch, _ref$updateTol = _ref.updateTol, updateTol = _ref$updateTol === void 0 ? 1e-14 : _ref$updateTol, _ref$negDir = _ref.negDir0, negDir0 = _ref$negDir === void 0 ? function (g) {\n            return g;\n          } : _ref$negDir, _ref$scaling = _ref.scaling, scaling = _ref$scaling === void 0 ? function () {\n            var scale = 1024;\n            return {\n              update: function update(dx, dg) {\n                if (dx.ndim !== 1) throw new Error('Assertion failed.');\n                if (dg.ndim !== 1) throw new Error('Assertion failed.');\n                dx = dx.data;\n                dg = dg.data;\n                var len = dx.length;\n                if (len !== dg.length) throw new Error('Assertion failed.');\n                var mx = dg.reduce(function (mx, x) {\n                  return Math.max(mx, Math.abs(x));\n                }, 0); // <- avoid underflow\n\n                var gg = 0,\n                    gx = 0;\n\n                for (var i = dg.length; i-- > 0;) {\n                  var gi = dg[i] / mx,\n                      xi = dx[i] / mx;\n                  gg += gi * gi;\n                  gx += xi * gi;\n                }\n\n                scale = gg / gx; // scale = Math.max(scale, gg/gx);\n\n                if (!isFinite(scale)) throw new Error('Assertion failed.');\n              },\n              apply: function apply(negDir) {\n                if (negDir.ndim !== 1) throw new Error('Assertion failed.');\n                var d = negDir.data;\n\n                for (var i = d.length; i-- > 0;) {\n                  d[i] /= scale;\n                }\n\n                return negDir;\n              }\n            };\n          }() : _ref$scaling;\n\n          if (!(historySize % 1 !== 0)) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): opt.historySize must be an integer.');\n\n        case 3:\n          if (historySize > 0) {\n            _context.next = 5;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): opt.historySize must be positive.');\n\n        case 5:\n          x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', x0);\n          x0 = undefined;\n\n          if (!(x.ndim !== 1)) {\n            _context.next = 9;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): x0.ndim must be 1.');\n\n        case 9:\n          _x$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(x.shape, 1), L = _x$shape[0], shape = x.shape;\n          _fg = fg(x), _fg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fg, 2), f = _fg2[0], g = _fg2[1];\n          g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', g);\n          f *= 1;\n\n          if (!isNaN(f)) {\n            _context.next = 15;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): fg must return [float,float[]].');\n\n        case 15:\n          if (!(g.ndim !== 1)) {\n            _context.next = 17;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): fg must return [float,float[]].');\n\n        case 17:\n          if (!(g.shape[0] !== L)) {\n            _context.next = 19;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): fg must return [float,float[]].');\n\n        case 19:\n          lineSearch = lineSearch(fg);\n          solver = new _lbfgs_solver__WEBPACK_IMPORTED_MODULE_4__[\"LBFGS_Solver\"](historySize, L);\n          dx = new Float64Array(L), dg = new Float64Array(L);\n\n          step = function step() {\n            var negDir = Float64Array.from(g.data);\n            solver.compute_Hv_phase1(negDir);\n            negDir = negDir0(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, negDir));\n            negDir = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', negDir);\n            negDir = scaling.apply(negDir);\n            negDir = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', negDir);\n            solver.compute_Hv_phase2(negDir.data);\n            var X, F, G;\n            var update = true;\n\n            try {\n              var _lineSearch = lineSearch(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x.data.slice()), f, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, g.data.slice()), negDir);\n\n              var _lineSearch2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_lineSearch, 3);\n\n              X = _lineSearch2[0];\n              F = _lineSearch2[1];\n              G = _lineSearch2[2];\n            } catch (err) {\n              if (!(err instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBisectionError\"])) throw err;\n              X = err.x;\n              F = err.f;\n              G = err.g;\n              update = false;\n            }\n\n            X = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', X);\n            G = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', G);\n            F *= 1;\n            if (X.ndim !== 1) throw new Error('Assertion failed.');\n            if (G.ndim !== 1) throw new Error('Assertion failed.');\n            if (X.shape[0] !== L) throw new Error('Assertion failed.');\n            if (G.shape[0] !== L) throw new Error('Assertion failed.');\n            if (isNaN(F)) throw new Error('Assertion failed.');\n\n            for (var i = L; i-- > 0;) {\n              dg[i] = G.data[i] - g.data[i];\n            }\n\n            for (var _i = L; _i-- > 0;) {\n              dx[_i] = X.data[_i] - x.data[_i];\n            }\n\n            if (dx.every(function (x) {\n              return x === 0;\n            })) throw new _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n\n            update = update || function () {\n              var mx = dg.reduce(function (mx, x) {\n                return Math.max(mx, Math.abs(x));\n              }, 0); // <- avoid underflow\n\n              var gg = 0,\n                  gx = 0;\n\n              for (var _i2 = dg.length; _i2-- > 0;) {\n                var gi = dg[_i2] / mx,\n                    xi = dx[_i2] / mx;\n                gg += gi * gi;\n                gx += xi * gi;\n              }\n\n              return updateTol * gg < gx;\n            }();\n\n            if (update) {\n              solver.update(dx, dg);\n              scaling.update(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, dx.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, dg.slice()));\n            }\n\n            x = X;\n            f = F;\n            g = G;\n          };\n\n        case 23:\n          if (x instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n            _context.next = 25;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 25:\n          if (g instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n            _context.next = 27;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 27:\n          if (!isNaN(f)) {\n            _context.next = 29;\n            break;\n          }\n\n          throw new Error('Assertion#5 failed.');\n\n        case 29:\n          if (!(x.ndim !== 1)) {\n            _context.next = 31;\n            break;\n          }\n\n          throw new Error('Assertion#4 failed.');\n\n        case 31:\n          if (!(g.ndim !== 1)) {\n            _context.next = 33;\n            break;\n          }\n\n          throw new Error('Assertion#6 failed.');\n\n        case 33:\n          if (!(x.shape[0] !== L)) {\n            _context.next = 35;\n            break;\n          }\n\n          throw new Error('Assertion#7 failed.');\n\n        case 35:\n          if (!(g.shape[0] !== L)) {\n            _context.next = 37;\n            break;\n          }\n\n          throw new Error('Assertion#8 failed.');\n\n        case 37:\n          _context.next = 39;\n          return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x.data.slice()), f, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, g.data.slice())];\n\n        case 39:\n          _context.prev = 39;\n          step();\n          return _context.abrupt(\"break\", 53);\n\n        case 44:\n          _context.prev = 44;\n          _context.t0 = _context[\"catch\"](39);\n\n          if (!(_context.t0 instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"] && solver.m > 0)) {\n            _context.next = 50;\n            break;\n          }\n\n          solver.forget(solver.m + 1 >>> 1);\n          _context.next = 51;\n          break;\n\n        case 50:\n          throw _context.t0;\n\n        case 51:\n          _context.next = 39;\n          break;\n\n        case 53:\n          _context.next = 23;\n          break;\n\n        case 55:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[39, 44]]);\n}\nfunction lsq_lbfgs_gen(fJ, //: (x0: float[nInputs]) => [f: float[nSamples], j: float[nSamples,nInputs]] - THE OPTIMIZATION FUNCTION AND ITS JACOBIAN\nx0) {\n  var _ref2,\n      _ref2$historySize,\n      historySize,\n      _ref2$lineSearch,\n      lineSearch,\n      _ref2$updateTol,\n      updateTol,\n      x,\n      _fJ,\n      _fJ2,\n      f,\n      j,\n      _j$shape,\n      K,\n      L,\n      shape_x,\n      shape_f,\n      shape_j,\n      shape_e,\n      eg,\n      last_x,\n      last_f,\n      last_j,\n      negDir0,\n      dx,\n      dg,\n      solver,\n      _eg,\n      _eg2,\n      e,\n      g,\n      step,\n      _args2 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function lsq_lbfgs_gen$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _ref2 = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : {}, _ref2$historySize = _ref2.historySize, historySize = _ref2$historySize === void 0 ? 8 : _ref2$historySize, _ref2$lineSearch = _ref2.lineSearch, lineSearch = _ref2$lineSearch === void 0 ? Object(_line_search_more_thuente_abc__WEBPACK_IMPORTED_MODULE_5__[\"more_thuente_abc\"])() : _ref2$lineSearch, _ref2$updateTol = _ref2.updateTol, updateTol = _ref2$updateTol === void 0 ? 1e-13 : _ref2$updateTol;\n\n          if (!(historySize % 1 !== 0)) {\n            _context2.next = 3;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): opt.historySize must be an integer.');\n\n        case 3:\n          if (historySize > 0) {\n            _context2.next = 5;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): opt.historySize must be positive.');\n\n        case 5:\n          // param | meaning\n          // ------|-------------------------\n          //  x    | function input\n          //  f    | function output f(x)\n          //  j    | jacobian f'(x)\n          //  e    | mean squared error (MSE)\n          //  g    | gradient of MSE\n          x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', x0);\n          x0 = undefined;\n\n          if (!(x.ndim !== 1)) {\n            _context2.next = 9;\n            break;\n          }\n\n          throw new Error('min_lbfgs_gen(fg, x0, opt): x0.ndim must be 1.');\n\n        case 9:\n          _fJ = fJ(x), _fJ2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fJ, 2), f = _fJ2[0], j = _fJ2[1];\n          f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', f);\n          j = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', j);\n\n          if (!(f.ndim !== 1)) {\n            _context2.next = 14;\n            break;\n          }\n\n          throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fg must return [float[K],float[K,L]].');\n\n        case 14:\n          if (!(j.ndim !== 2)) {\n            _context2.next = 16;\n            break;\n          }\n\n          throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fg must return [float[K],float[K,L]].');\n\n        case 16:\n          _j$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(j.shape, 2), K = _j$shape[0], L = _j$shape[1], shape_x = x.shape, shape_f = f.shape, shape_j = j.shape, shape_e = Int32Array.of();\n\n          if (!(f.shape[0] !== K)) {\n            _context2.next = 19;\n            break;\n          }\n\n          throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fg must return [float[K],float[K,L]].');\n\n        case 19:\n          if (!(x.shape[0] !== L)) {\n            _context2.next = 21;\n            break;\n          }\n\n          throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fg must return [float[K],float[K,L]].');\n\n        case 21:\n          fJ = function () {\n            var FJ = fJ;\n            return function (x) {\n              x = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, x.data);\n\n              var _FJ = FJ(x),\n                  _FJ2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_FJ, 2),\n                  f = _FJ2[0],\n                  j = _FJ2[1];\n\n              f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', f);\n              j = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', j);\n              if (f.data.some(isNaN)) throw new Error('Assertion failed.');\n              if (j.data.some(isNaN)) throw new Error('Assertion failed.');\n              if (f.ndim !== 1) throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fJ(x: float[L]) must return [float[K],float[K,L]].');\n              if (j.ndim !== 2) throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fJ(x: float[L]) must return [float[K],float[K,L]].');\n              if (f.shape[0] !== K) throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fJ(x: float[L]) must return [float[K],float[K,L]].');\n              if (j.shape[0] !== K) throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fJ(x: float[L]) must return [float[K],float[K,L]].');\n              if (j.shape[1] !== L) throw new Error('lsq_lbfgs_gen(fg, x0: float[L], opt): fJ(x: float[L]) must return [float[K],float[K,L]].');\n              return [f, j];\n            };\n          }();\n\n          eg = function eg(f, j) {\n            var F = f.data,\n                J = j.data;\n            var e = 0,\n                G = new Float64Array(L);\n\n            for (var i = K; i-- > 0;) {\n              e += F[i] * F[i] / K;\n            }\n\n            for (var _i3 = K; _i3-- > 0;) {\n              for (var _j = L; _j-- > 0;) {\n                G[_j] += 2 * F[_i3] * J[L * _i3 + _j] / K;\n              }\n            }\n\n            return [e, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, G)];\n          };\n\n          lineSearch = lineSearch(function (x) {\n            last_x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', x);\n            x = undefined;\n            if (last_x.ndim !== 1) throw new Error('Assertion failed.');\n            if (last_x.shape[0] !== L) throw new Error('Assertion failed.');\n\n            var _fJ3 = fJ(last_x);\n\n            var _fJ4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fJ3, 2);\n\n            last_f = _fJ4[0];\n            last_j = _fJ4[1];\n            return eg(last_f, last_j);\n          });\n\n          negDir0 = function negDir0(negDir) {\n            // OPTION 1: USE CAUCHY POINT OF THE GAUSS NEWTON APPROXIMATION\n            var G = g.data,\n                J = j.data; // compute the minimum along negDir (similar to cauchy point)\n\n            var a = 0;\n\n            for (var i = L; i-- > 0;) {\n              a += G[i] * negDir[i];\n            }\n\n            if (0 < a) {\n              var b = 0;\n\n              for (var _i4 = K; _i4-- > 0;) {\n                var Jd = 0;\n\n                for (var _j2 = L; _j2-- > 0;) {\n                  Jd += J[L * _i4 + _j2] * negDir[_j2];\n                }\n\n                b += Jd * Jd * 2 / K;\n              }\n\n              if (!(0 < b)) throw new Error('Assertion failed.');\n              a /= b;\n\n              for (var _i5 = L; _i5-- > 0;) {\n                negDir[_i5] *= a;\n              }\n            } // // OPTION 1: USE GAUSS NEWTON APPROXIMATION\n            // const nd = lstsq(\n            //   matmul2(j.T, j),\n            //   new NDArray(Int32Array.of(L,1), negDir)\n            // );\n            // negDir.set(nd.data);\n            // for( let i=L; i-- > 0; )\n            //   negDir[i] *= K/2;\n\n          };\n\n          dx = new Float64Array(L), dg = new Float64Array(L), solver = new _lbfgs_solver__WEBPACK_IMPORTED_MODULE_4__[\"LBFGS_Solver\"](historySize, L);\n          _eg = eg(f, j), _eg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_eg, 2), e = _eg2[0], g = _eg2[1];\n\n          step = function step() {\n            var negDir = Float64Array.from(g.data);\n            solver.compute_Hv_phase1(negDir);\n            negDir0(negDir);\n            solver.compute_Hv_phase2(negDir);\n            var X,\n                E,\n                G,\n                update = true;\n\n            try {\n              var _lineSearch3 = lineSearch(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, x.data.slice()), e, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, g.data.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, negDir));\n\n              var _lineSearch4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_lineSearch3, 3);\n\n              X = _lineSearch4[0];\n              E = _lineSearch4[1];\n              G = _lineSearch4[2];\n            } catch (err) {\n              if (!(err instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBisectionError\"])) throw err;\n              X = err.x;\n              E = err.f;\n              G = err.g;\n              update = false;\n            }\n\n            x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', x);\n            e *= 1;\n            g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', g);\n            if (x.ndim !== 1) throw new Error('Assertion failed.');\n            if (g.ndim !== 1) throw new Error('Assertion failed.');\n            if (x.shape[0] !== L) throw new Error('Assertion failed.');\n            if (g.shape[0] !== L) throw new Error('Assertion failed.');\n            if (isNaN(e)) throw new Error('Assertion failed.');\n            var F = last_f,\n                J = last_j; // only recompute f,j is necessary\n\n            if (last_x.data.some(function (xi, i) {\n              return xi !== X.data[i];\n            })) {\n              var _fJ5 = fJ(X);\n\n              var _fJ6 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fJ5, 2);\n\n              F = _fJ6[0];\n              J = _fJ6[1];\n            }\n\n            for (var i = L; i-- > 0;) {\n              dx[i] = X.data[i] - x.data[i];\n            }\n\n            for (var _i6 = L; _i6-- > 0;) {\n              dg[_i6] = G.data[_i6] - g.data[_i6];\n            }\n\n            if (dx.every(function (x) {\n              return x === 0;\n            })) throw new _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n\n            update = update || function () {\n              var mx = dg.reduce(function (mx, x) {\n                return Math.max(mx, Math.abs(x));\n              }, 0); // <- avoid underflow\n\n              var gg = 0,\n                  gx = 0;\n\n              for (var _i7 = dg.length; _i7-- > 0;) {\n                var gi = dg[_i7] / mx,\n                    xi = dx[_i7] / mx;\n                gg += gi * gi;\n                gx += xi * gi;\n              }\n\n              return updateTol * gg < gx;\n            }();\n\n            if (update) solver.update(dx, dg);\n            x = X;\n            e = E;\n            g = G;\n            f = F;\n            j = J;\n          };\n\n        case 28:\n          _context2.next = 30;\n          return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, x.data.slice()), e, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_x, g.data.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_f, f.data.slice()), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape_j, j.data.slice())];\n\n        case 30:\n          _context2.prev = 30;\n          step();\n          return _context2.abrupt(\"break\", 44);\n\n        case 35:\n          _context2.prev = 35;\n          _context2.t0 = _context2[\"catch\"](30);\n\n          if (!(_context2.t0 instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"] && solver.m > 0)) {\n            _context2.next = 41;\n            break;\n          }\n\n          solver.forget(solver.m + 1 >>> 1);\n          _context2.next = 42;\n          break;\n\n        case 41:\n          throw _context2.t0;\n\n        case 42:\n          _context2.next = 30;\n          break;\n\n        case 44:\n          _context2.next = 28;\n          break;\n\n        case 46:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, null, [[30, 35]]);\n}\nfunction fit_lbfgs_gen(x, //: float[nSamples,nDim]\ny, //: float[nSamples]\nfg, //: (params: float[nParam]) => (x: float[nDim]) => [f: float, g: float[nParam]],\np0, //: float[nParam]\nopt) {\n  var FloatArray, _p0$shape, P, _x$shape2, M, N, x_shape, R, J, RJ, fJ;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function fit_lbfgs_gen$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          if (fg instanceof Function) {\n            _context3.next = 2;\n            break;\n          }\n\n          throw new Error('fit_lbfgs_gen(x,y, fg, p0): fg must be a function.');\n\n        case 2:\n          x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])(x); // <- TODO allow non-ndarray x ?\n\n          y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', y);\n          p0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', p0);\n          FloatArray = Float64Array;\n\n          if (!(x.ndim !== 2)) {\n            _context3.next = 8;\n            break;\n          }\n\n          throw new Error('fit_lbfgs_gen(x,y, fg, p0): x.ndim must be 2.');\n\n        case 8:\n          if (!(y.ndim !== 1)) {\n            _context3.next = 10;\n            break;\n          }\n\n          throw new Error('fit_lbfgs_gen(x,y, fg, p0): y.ndim must be 1.');\n\n        case 10:\n          if (!(p0.ndim !== 1)) {\n            _context3.next = 12;\n            break;\n          }\n\n          throw new Error('fit_lbfgs_gen(x,y, fg, p0): p0.ndim must be 1.');\n\n        case 12:\n          _p0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(p0.shape, 1), P = _p0$shape[0], _x$shape2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(x.shape, 2), M = _x$shape2[0], N = _x$shape2[1], x_shape = Int32Array.of(N);\n\n          if (!(M != y.shape[0])) {\n            _context3.next = 15;\n            break;\n          }\n\n          throw new Error('fit_lbfgs_gen(x,y, fg, p0): x.shape[0] must be equal to y.shape[0].');\n\n        case 15:\n          x = x.data.slice(); // <- TODO: TypedArray.subarray could be used here\n\n          y = y.data; // if x is frozen, no protection copies are necessary while passing it to fg\n\n          Object.freeze(x.buffer);\n          x = Array.from({\n            length: M\n          }, function (_, i) {\n            return Object.freeze(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, x.subarray(N * i, N * i + 1)));\n          });\n          Object.freeze(x);\n          R = new FloatArray(M), J = new FloatArray(M * P), RJ = [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M), R), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M, P), J)];\n\n          fJ = function fJ(p) {\n            var fgp = fg(p);\n            if (!(fgp instanceof Function)) throw new Error();\n\n            for (var i = M; i-- > 0;) {\n              var _fgp = fgp(x[i]),\n                  _fgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fgp, 2),\n                  _f = _fgp2[0],\n                  _g = _fgp2[1];\n\n              _f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(_f);\n              _g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(_g);\n              if (_f.ndim !== 0) throw new Error('fit_lbfgs_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (_g.ndim !== 1) throw new Error('fit_lbfgs_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (_g.shape[0] !== P) throw new Error('fit_lbfgs_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              _f = _f.data[0];\n              _g = _g.data;\n              if (isNaN(_f)) throw new Error('fit_lbfgs_gen(x,y, fg, p0): NaN encountered.');\n              if (_g.some(isNaN)) throw new Error('fit_lbfgs_gen(x,y, fg, p0): NaN encountered.');\n              R[i] = _f - y[i];\n\n              for (var _j3 = P; _j3-- > 0;) {\n                J[P * i + _j3] = _g[_j3];\n              }\n            }\n\n            return RJ;\n          };\n\n          return _context3.delegateYield(lsq_lbfgs_gen(fJ, p0, opt), \"t0\", 23);\n\n        case 23:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3);\n}\n\n//# sourceURL=webpack://nd/./src/opt/lbfgs.js?");

/***/ }),

/***/ "./src/opt/lbfgsb.js":
/*!***************************!*\
  !*** ./src/opt/lbfgsb.js ***!
  \***************************/
/*! exports provided: min_lbfgsb_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"min_lbfgsb_gen\", function() { return min_lbfgsb_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./line_search/line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony import */ var _line_search_more_thuente_u123__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./line_search/more_thuente_u123 */ \"./src/opt/line_search/more_thuente_u123.js\");\n/* harmony import */ var _lbfgsb_solver__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./_lbfgsb_solver */ \"./src/opt/_lbfgsb_solver.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(min_lbfgsb_gen);\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\n // REFERENCES\n// ----------\n// .. [1] \"On the Limited Memory BFGS Method for Large Scale Optimization.\"\n//         Dong C. Liu and Jorge Nocedal\n\nfunction min_lbfgsb_gen(fg, x0, bounds) {\n  var _ref,\n      _ref$historySize,\n      historySize,\n      _ref$lineSearch,\n      lineSearch,\n      _ref$updateTol,\n      updateTol,\n      _ref$scaleInit,\n      scaleInit,\n      _x0$shape,\n      L,\n      shape,\n      i,\n      x,\n      _fg,\n      _fg2,\n      f,\n      g,\n      solver,\n      indices,\n      dx,\n      dg,\n      step,\n      _loop,\n      _args2 = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function min_lbfgsb_gen$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _ref = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : {}, _ref$historySize = _ref.historySize, historySize = _ref$historySize === void 0 ? 8 : _ref$historySize, _ref$lineSearch = _ref.lineSearch, lineSearch = _ref$lineSearch === void 0 ? Object(_line_search_more_thuente_u123__WEBPACK_IMPORTED_MODULE_5__[\"more_thuente_u123\"])({\n            fRed: 1e-3,\n            gRed: 0.8\n          }) : _ref$lineSearch, _ref$updateTol = _ref.updateTol, updateTol = _ref$updateTol === void 0 ? 1e-14 : _ref$updateTol, _ref$scaleInit = _ref.scaleInit, scaleInit = _ref$scaleInit === void 0 ? 1e-3 : _ref$scaleInit;\n\n          if (!(historySize % 1 !== 0)) {\n            _context2.next = 3;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg, x0, opt): opt.historySize must be an integer.');\n\n        case 3:\n          if (historySize > 0) {\n            _context2.next = 5;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg, x0, opt): opt.historySize must be positive.');\n\n        case 5:\n          if (fg instanceof Function) {\n            _context2.next = 7;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds): fg must be a function.');\n\n        case 7:\n          x0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', x0);\n          bounds = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(bounds);\n          _x0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(x0.shape, 1), L = _x0$shape[0], shape = x0.shape;\n\n          if (!(x0.ndim !== 1)) {\n            _context2.next = 12;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds): x0.ndim must be 1.');\n\n        case 12:\n          if (!(bounds.ndim !== 2)) {\n            _context2.next = 14;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds): bounds.ndim must be 2.');\n\n        case 14:\n          if (!(bounds.shape[0] !== L)) {\n            _context2.next = 16;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds): bounds.shape[0] must be x0.shape[0].');\n\n        case 16:\n          if (!(bounds.shape[1] !== 2)) {\n            _context2.next = 18;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds): bounds.shape[1] must be 2.');\n\n        case 18:\n          updateTol *= 1;\n          scaleInit *= 1;\n\n          if (0 <= updateTol) {\n            _context2.next = 22;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds,opt): opt.updateTol most be non-negative.');\n\n        case 22:\n          if (0 < scaleInit) {\n            _context2.next = 24;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg,x0,bounds,opt): opt.scaleInit most be greater than 0.');\n\n        case 24:\n          bounds = bounds.data;\n          updateTol *= 1;\n          i = bounds.length;\n\n        case 27:\n          if (!((i -= 2) >= 0)) {\n            _context2.next = 32;\n            break;\n          }\n\n          if (bounds[i + 0] <= bounds[i + 1]) {\n            _context2.next = 30;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 30:\n          _context2.next = 27;\n          break;\n\n        case 32:\n          x = x0;\n          x0 = undefined;\n          _fg = fg(x), _fg2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fg, 2), f = _fg2[0], g = _fg2[1];\n          f *= 1;\n          g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', g);\n\n          if (isFinite(f)) {\n            _context2.next = 39;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg, x0, bounds): fg must return [float,float[]].');\n\n        case 39:\n          if (g.dtype.startsWith('float')) {\n            _context2.next = 41;\n            break;\n          }\n\n          throw new Error('min_lbfgsb_gen(fg, x0, bounds): fg must return [float,float[]].');\n\n        case 41:\n          lineSearch = lineSearch(fg);\n          solver = new _lbfgsb_solver__WEBPACK_IMPORTED_MODULE_6__[\"LBFGSB_Solver\"](historySize, L);\n          solver.scale = 1 / scaleInit; // TODO: Implement scaling as described in [1]\n\n          indices = Int32Array.from({\n            length: L\n          }, function (_, i) {\n            return i;\n          }), dx = new Float64Array(L), dg = new Float64Array(L);\n\n          step = function step() {\n            var g_arg = g.data.slice(),\n                x_arg = x.data.slice(),\n                n_dir = new Float64Array(L);\n\n            var _solver$compute_cauch = solver.compute_cauchyGeneralized(g_arg, x_arg, bounds, indices,\n            /*complete=*/\n            false),\n                _solver$compute_cauch2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_solver$compute_cauch, 2),\n                n_fix = _solver$compute_cauch2[0],\n                df = _solver$compute_cauch2[1];\n\n            solver.compute_subspace_Hv(g_arg, n_dir, indices, n_fix); //*DEBUG*/    if( 0 !== n_fix ) throw new Error('Not yet tested.');                        \n            //*DEBUG*/    if( 0 !== df ) throw new Error('Not yet tested.');\n            //*DEBUG*/    if( ! g_arg.every( (gi,i) => gi === g.data[i] ) ) throw new Error('Not yet tested.');\n\n            /*DEBUG*/\n\n            if (!indices.subarray(0, n_fix).every(function (i) {\n              return n_dir[i] === 0;\n            }))\n              /*DEBUG*/\n              throw new Error('Assertion failed.');\n\n            var Max = function () {\n              var Max = Infinity;\n\n              var _iterator = _createForOfIteratorHelper(indices.subarray(n_fix)),\n                  _step;\n\n              try {\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                  var _i = _step.value;\n\n                  if (0 !== n_dir[_i]) {\n                    var end = bounds[2 * _i + (n_dir[_i] < 0)];\n                    var travel = (x_arg[_i] - end) / n_dir[_i];\n                    if (!(0 <= travel)) throw new Error('Assertion failed: ' + travel);\n                    var n = 0;\n\n                    while (Math.sign(n_dir[_i]) * (x_arg[_i] - travel * n_dir[_i] - end) < 0) {\n                      if (++n > 2) throw new Error('Assertion failed.');\n                      travel = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__[\"nextDown\"])(travel);\n                    }\n\n                    if (n_dir[_i] < 0 && x_arg[_i] - travel * n_dir[_i] > end) throw new Error('Assertion failed.');\n                    if (n_dir[_i] > 0 && x_arg[_i] - travel * n_dir[_i] < end) throw new Error('Assertion failed.');\n                    Max = Math.min(Max, travel);\n                  }\n                }\n              } catch (err) {\n                _iterator.e(err);\n              } finally {\n                _iterator.f();\n              }\n\n              return Max;\n            }(); // TODO: g_arg is only the quasi newton approximation of the gradient at x_arg.\n            //       Alternatively we could compute the gradient at x_arg insteal which might\n            //       improve robustness.\n\n\n            var X, F, G;\n\n            try {\n              var _lineSearch = lineSearch(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_arg.slice()), f + df, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, g_arg), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, n_dir),\n              /*Min=*/\n              undefined,\n              /*0  =*/\n              undefined,\n              /*Max=*/\n              Max);\n\n              var _lineSearch2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_lineSearch, 3);\n\n              X = _lineSearch2[0];\n              F = _lineSearch2[1];\n              G = _lineSearch2[2];\n            } catch (err) {\n              if (err instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__[\"LineSearchBoundReachedError\"] || err instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__[\"LineSearchBisectionError\"]) {\n                X = err.x;\n                F = err.f;\n                G = err.g;\n              } else if (err instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__[\"LineSearchNoProgressError\"] && df < 0) {\n                X = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_arg);\n\n                var _fg3 = fg(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x_arg.slice()));\n\n                var _fg4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fg3, 2);\n\n                F = _fg4[0];\n                G = _fg4[1];\n              } else throw err;\n            }\n\n            F *= 1;\n            X = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', X);\n            G = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float64', G);\n\n            for (var _i2 = L; _i2-- > 0;) {\n              dx[_i2] = X.data[_i2] - x.data[_i2];\n            }\n\n            for (var _i3 = L; _i3-- > 0;) {\n              dg[_i3] = G.data[_i3] - g.data[_i3];\n            }\n\n            if (dx.every(function (x) {\n              return x === 0;\n            })) throw new _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__[\"LineSearchNoProgressError\"]();\n            var mx = dg.reduce(function (mx, x) {\n              return Math.max(mx, Math.abs(x));\n            }, 0); // <- avoid underflow\n\n            var gg = 0,\n                gx = 0;\n\n            for (var _i4 = dg.length; _i4-- > 0;) {\n              var xi = dx[_i4] / mx,\n                  gi = dg[_i4] / mx;\n              gg += gi * gi;\n              gx += xi * gi;\n            }\n\n            if (updateTol * gg < gx) {\n              solver.update(dx, dg); // solver.scale = Math.max(solver.scale, gg/gx);\n\n              solver.scale = gg / gx;\n            }\n\n            x = X;\n            f = F;\n            g = G;\n          };\n\n          _loop = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _loop() {\n            var ;\n            return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _loop$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    if (x instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n                      _context.next = 2;\n                      break;\n                    }\n\n                    throw new Error('Assertion failed.');\n\n                  case 2:\n                    if (g instanceof _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"]) {\n                      _context.next = 4;\n                      break;\n                    }\n\n                    throw new Error('Assertion failed.');\n\n                  case 4:\n                    if (!(x.shape[0] !== L)) {\n                      _context.next = 6;\n                      break;\n                    }\n\n                    throw new Error('Assertion#7 failed.');\n\n                  case 6:\n                    if (!(g.shape[0] !== L)) {\n                      _context.next = 8;\n                      break;\n                    }\n\n                    throw new Error('Assertion#8 failed.');\n\n                  case 8:\n                    if (!(x.ndim !== 1)) {\n                      _context.next = 10;\n                      break;\n                    }\n\n                    throw new Error('Assertion#4 failed.');\n\n                  case 10:\n                    if (!(g.ndim !== 1)) {\n                      _context.next = 12;\n                      break;\n                    }\n\n                    throw new Error('Assertion#6 failed.');\n\n                  case 12:\n                    if (!isNaN(f)) {\n                      _context.next = 14;\n                      break;\n                    }\n\n                    throw new Error('Assertion#5 failed.');\n\n                  case 14:\n                     = g.data.slice();\n                    x.data.forEach(function (xi, i) {\n                      var _bounds$subarray = bounds.subarray(2 * i, 2 + 2 * i),\n                          _bounds$subarray2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_bounds$subarray, 2),\n                          x_min = _bounds$subarray2[0],\n                          x_max = _bounds$subarray2[1],\n                          gi = [i];\n\n                      if (0 < gi && xi === x_min) [i] = 0;else if (0 > gi && xi === x_max) [i] = 0;\n                    });\n                    _context.next = 18;\n                    return [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x.data.slice()), f, new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, ), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, g.data.slice())];\n\n                  case 18:\n                    _context.prev = 18;\n                    step();\n                    return _context.abrupt(\"break\", 32);\n\n                  case 23:\n                    _context.prev = 23;\n                    _context.t0 = _context[\"catch\"](18);\n\n                    if (!(_context.t0 instanceof _line_search_line_search_error__WEBPACK_IMPORTED_MODULE_4__[\"LineSearchError\"] && solver.m > 0)) {\n                      _context.next = 29;\n                      break;\n                    }\n\n                    solver.forget(solver.m + 1 >>> 1);\n                    _context.next = 30;\n                    break;\n\n                  case 29:\n                    throw _context.t0;\n\n                  case 30:\n                    _context.next = 18;\n                    break;\n\n                  case 32:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _loop, null, [[18, 23]]);\n          });\n\n        case 47:\n          return _context2.delegateYield(_loop(), \"t0\", 48);\n\n        case 48:\n          _context2.next = 47;\n          break;\n\n        case 50:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked);\n}\n\n//# sourceURL=webpack://nd/./src/opt/lbfgsb.js?");

/***/ }),

/***/ "./src/opt/line_search/_line_search_utils.js":
/*!***************************************************!*\
  !*** ./src/opt/line_search/_line_search_utils.js ***!
  \***************************************************/
/*! exports provided: _min1d_interp_gg, _min1d_interp_ffg, _min1d_interp_ffgg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_min1d_interp_gg\", function() { return _min1d_interp_gg; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_min1d_interp_ffg\", function() { return _min1d_interp_ffg; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_min1d_interp_ffgg\", function() { return _min1d_interp_ffgg; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _polyquad__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../polyquad */ \"./src/opt/polyquad.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction _min1d_interp_gg(x1, x2, g1, g2) {\n  x1 *= 1;\n  if (!isFinite(x1)) throw new Error('Assertion failed.');\n  x2 *= 1;\n  if (!isFinite(x2)) throw new Error('Assertion failed.');\n  g1 *= 1;\n  if (!isFinite(g1)) throw new Error('Assertion failed.');\n  g2 *= 1;\n  if (!isFinite(g2)) throw new Error('Assertion failed.');\n  var dx = x2 - x1,\n      dg = g2 - g1;\n  if (!(Math.sign(dx) * dg > 0)) throw new Error('Assertion failed: Bad curvature (i.e. no minimum).'); //           !\n  // g1 + s*dg = 0  =>  s = -g1/dg\n\n  return x1 - dx / dg * g1;\n}\nfunction _min1d_interp_ffg(x1, x2, f1, f2, g1) {\n  x1 *= 1;\n  if (!isFinite(x1)) throw new Error('Assertion failed.');\n  x2 *= 1;\n  if (!isFinite(x2)) throw new Error('Assertion failed.');\n  f1 *= 1;\n  if (!isFinite(f1)) throw new Error('Assertion failed.');\n  f2 *= 1;\n  if (!isFinite(f2)) throw new Error('Assertion failed.');\n  g1 *= 1;\n  if (!isFinite(g1)) throw new Error('Assertion failed.');\n  if (x1 === x2) throw new Error('Assertion failed.'); // polynomial: p(x) = a + b*(x - xMin)\n  //        (A)  p(x1) = f1 (= a + b*(x1 - xMin))\n  //        (B)  p(x2) = f2 (= a + b*(x2 - xMin))\n  //        (C) p'(x1) = g1 (=   2*b*(x1 - xMin) )\n  //\n  // (B)-(A) => f2-f1 = b*( (x2-xMin) - (x1-xMin) )\n  //     (C) => b = g1 / (2*(x1-xMin))\n  //\n  // => (f2-f1)/g1 * 2 * (x1-xMin) = (x2-xMin) - (x1-xMin)\n  //   = x2 - x1 - 2*(x2-x1)*xMin\n  //\n  //            x1*(f2-f1)*2 / g1 - (x2-x1)       x1*(f2-f1) - (x2-x1)*(x2+x1) * g1/2\n  // => xMin =  = \n  //               (f2-f1)*2 / g1 - (x2 -x1 )*2        (f2-f1) - (x2-x1)         * g1\n\n  var dx = x2 - x1,\n      dFdX = (f2 - f1) / dx,\n      xMin = x1 + 0.5 * dx * g1 / (g1 - dFdX); // TODO: maybe check if xMin is a min. or max.\n\n  return xMin;\n}\nfunction _min1d_interp_ffgg(x1, x2, f1, f2, g1, g2) {\n  x1 *= 1;\n  if (!isFinite(x1)) throw new Error('Assertion failed.');\n  x2 *= 1;\n  if (!isFinite(x2)) throw new Error('Assertion failed.');\n  f1 *= 1;\n  if (!isFinite(f1)) throw new Error('Assertion failed.');\n  f2 *= 1;\n  if (!isFinite(f2)) throw new Error('Assertion failed.');\n  g1 *= 1;\n  if (!isFinite(g1)) throw new Error('Assertion failed.');\n  g2 *= 1;\n  if (!isFinite(g2)) throw new Error('Assertion failed.');\n  if (x1 === x2) throw new Error('Assertion failed.');\n  f2 -= f1; // shift such that f1 = 0\n\n  x2 -= x1; // shift such that x1 = 0\n  // f (x) := a*x/3 + b*x/2 + g1*x\n  // f'(x)  = a*x   + b*x    + g1\n  //\n  //      !\n  // f(0) = 0 (check!)\n  //\n  //       !\n  // f'(0) = g1 (check!)\n  //\n  //       !\n  // (A) f(x2) = f2 = a/3*x2*x2*x2 + b/2*x2*x2 + g1*x2\n  //\n  //        !\n  // (B) f'(x2) = g2 = a*x2*x2 + b*x2 + g1\n  //           => a*x2*x2 = g2-g1 - b*x2\n  //\n  // (A+B) => f2 = x2/3*(g2-g1 - b*x2)  +  b/2*x2*x2  +  g1*x2\n  //       => b*x2*x2/6 = f2 - x2*(g2 + g1*2)/3\n  //       => b = ( 6*f1/x2 - 2*g2 - 4*g1 ) / x2\n  // const b = 2*( 3*f2/x2 - g2 - 2*g1 ) / x2,\n  //       a = ((g2-g1)/x2 - b) / x2,\n  // [z1,z2] = roots1d_polyquad(g1,b,a);\n  // return (a < 0 ? z1 : z2) + x1;\n\n  var b = 2 * (3 * f2 / x2 - g2 - 2 * g1),\n      a = (g2 - g1 - b) / x2,\n      _roots1d_polyquad = Object(_polyquad__WEBPACK_IMPORTED_MODULE_1__[\"roots1d_polyquad\"])(g1 * x2, b, a),\n      _roots1d_polyquad2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_roots1d_polyquad, 2),\n      z1 = _roots1d_polyquad2[0],\n      z2 = _roots1d_polyquad2[1];\n\n  return (Math.sign(x2) * a < 0 ? z1 : z2) + x1;\n}\n\n//# sourceURL=webpack://nd/./src/opt/line_search/_line_search_utils.js?");

/***/ }),

/***/ "./src/opt/line_search/albaali_fletcher.js":
/*!*************************************************!*\
  !*** ./src/opt/line_search/albaali_fletcher.js ***!
  \*************************************************/
/*! exports provided: albaali_fletcher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"albaali_fletcher\", function() { return albaali_fletcher; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _line_search_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony import */ var _line_search_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_line_search_utils */ \"./src/opt/line_search/_line_search_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n // References\n// ----------\n// .. [1] \"Numerical Optimization\", 2nd Edition,\n//         Jorge Nocedal & Stephen J. Wright,\n//         Chapter 3. Line Search Methods, page 60f\n// .. [2] \"An Efficient Line Search for Nonlinear Least Squares\",\n//         M. Al-Baali & R. Fletcher\n//         Journal Of Optimization Theory and Applications: Vol. 48, No. 3, MARCH 1986\n// .. [3] \"Line Search Algorithms with Guaranteed Sufficient Decrease\"\n//         Jorge J. Mor and David J. Thuente\n//         ACM Transactions on Mathematical Software,\n//         Vol 20, No. 3, Septermber 1994, Pages 286-307\n// Implementation of Scheme S2 from [2].\n\nvar albaali_fletcher = function albaali_fletcher() {\n  var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _opt = opt,\n      _opt$fRed = _opt.fRed,\n      fRed = _opt$fRed === void 0 ? 0.1 : _opt$fRed,\n      _opt$gRed = _opt.gRed,\n      gRed = _opt$gRed === void 0 ? 0.9 : _opt$gRed,\n      _opt$grow = _opt.grow,\n      grow = _opt$grow === void 0 ? Math.PI / 3 : _opt$grow,\n      _opt$shrinkLeast = _opt.shrinkLeast,\n      shrinkLeast = _opt$shrinkLeast === void 0 ? 0.2 : _opt$shrinkLeast;\n  opt = {\n    fRed: fRed,\n    gRed: gRed,\n    grow: grow,\n    shrinkLeast: shrinkLeast\n  };\n  fRed *= 1; // (1) Wolfe cond. 1: Sufficient decrease of objective.\n\n  gRed *= 1; // (2) Wolfe cond. 2: Sufficient decrease of projected gradient.\n\n  grow *= 1; // (3) Growth factor for 1st phase of line search (bracketing).\n\n  shrinkLeast *= 1; // (4) Minimum reduction of search range during 2nd phase of line search (zoom).\n  // CHECK 0 < fRed < gRed < 1 < c3\n\n  if (!(fRed > 0)) throw new Error('albaali_fletcher(opt): opt.fRed must be positive.');\n  if (!(fRed < gRed)) throw new Error('albaali_fletcher(opt): opt.fRed must less than opt.gRed.');\n  if (!(1 > gRed)) throw new Error('albaali_fletcher(opt): opt.gRed must less than 1.');\n  if (!(1 < grow)) throw new Error('albaali_fletcher(opt): opt.grow must larger than 1.');\n  if (!(fRed < 0.5)) console.warn('albaali_fletcher(opt): opt.fRed should be less than 0.5 to work properly with (quasi-)Newton methods.');\n  if (!(shrinkLeast >= 0.0)) throw new Error('albaali_fletcher(opt): opt.shrinkLeast must be non-negative.');\n  if (!(shrinkLeast <= 0.5)) throw new Error('albaali_fletcher(opt): opt.shrinkLeast must not be greater than 0.5.');\n  var  = 1 / shrinkLeast,\n       =  - 1;\n\n  var line_search = function line_search(fg_raw) {\n    return function (X0, f0, G0, negDir) {\n      var Min = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      var 0 = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n      var Max = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : Infinity;\n      X0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', X0);\n      G0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G0);\n      f0 *= 1;\n      if (!(negDir instanceof _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"])) throw new Error('Assertion failed.');\n\n      var shape = negDir.shape,\n          _shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(shape, 1),\n          L = _shape[0];\n\n      if (X0.ndim !== 1) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): X0.ndim must be 1.');\n      if (G0.ndim !== 1) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): G0.ndim must be 1.');\n      if (negDir.ndim !== 1) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): negDir.ndim must be 1.');\n      if (X0.shape[0] !== L) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): negDir and X0 must have the same shape.');\n      if (G0.shape[0] !== L) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): negDir and G0 must have the same shape.');\n      if (isNaN(f0)) throw new Error('albaali_fletcher()(fg)(X0,f0,G0): f0 is NaN.');\n      if (Min !== 0) throw new Error('albaali_fletcher()(fg)(X0,f0,G0, Min,0,Max): Min !== 0 not (yet) supported.');\n      negDir = negDir.data;\n      if (null == 0) 0 = Math.min(1, Max / 2);\n      if (!(Min <= 0)) throw new Error('albaali_fletcher()(fg)(X0,f0,G0, Min,0,Max): Min !== 0 not (yet) supported.');\n      if (!(Max >= 0)) throw new Error('albaali_fletcher()(fg)(X0,f0,G0, Min,0,Max): Max must not be less than Min.');\n      if (0 === Max) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n\n      var projGrad = function projGrad(g) {\n        return g.data.reduce(function (p, gi, i) {\n          return p - negDir[i] * gi;\n        }, 0);\n      }; // wrap some checks aroung fg_raw\n\n\n      var xfgp = function xfgp() {\n        var X = new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X0.data.map(function (x, i) {\n          return x -  * negDir[i];\n        }));\n\n        var _fg_raw = fg_raw(new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X.data.slice())),\n            _fg_raw2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_fg_raw, 2),\n            f = _fg_raw2[0],\n            G = _fg_raw2[1];\n\n        f *= 1;\n        G = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G);\n        if (isNaN(f)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned NaN.');\n        if (G.ndim !== 1) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        if (G.shape[0] !== L) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        var p = projGrad(G);\n        return [X, f, G, p];\n      };\n\n      var p0 = projGrad(G0); // <- projected gradient\n\n      if (0 === p0) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n      if (0 < p0) throw new Error('albaali_fletcher: Initial projected gradient not negative.');\n      var Lo = 0,\n          Hi = Infinity,\n           = 0,\n          fLo = f0,\n          fHi = NaN,\n          pLo = p0,\n          pHi = NaN; // PHASE 1: BRACKETING PHASE\n      // ------------------------\n      //   Find a range guaranteed to contain an  satisfying strong Wolfe.\n\n      bracketing: for (;;) {\n        if (!isFinite()) throw new Error('Assertion failed.');\n\n        var _xfgp = xfgp(),\n            _xfgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp, 4),\n            _X = _xfgp2[0],\n            _f = _xfgp2[1],\n            _G = _xfgp2[2],\n            p = _xfgp2[3];\n\n        if (_f - f0 > fRed *  * p0 || 0 < Lo && _f >= fLo) {\n          Hi = ;\n          fHi = _f;\n          pHi = p;\n          break bracketing;\n        }\n\n        if (Math.abs(p) <= -gRed * p0) return [_X, _f, _G];\n\n        if (p >= 0) {\n          Hi = Lo;\n          Lo = ;\n          fHi = fLo;\n          fLo = _f;\n          pHi = pLo;\n          pLo = p;\n          break bracketing;\n        }\n\n        if (!( < Max)) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBoundReachedError\"](_X, _f, _G);\n        if (!( < Hi)) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"]('albaali_fletcher: Strong Wolfe condition not satisfiable in range.');\n        Lo = ;\n         = Math.min(Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(),  * grow), Max);\n        fLo = _f;\n        pLo = p;\n      }\n\n      if (Lo === Hi) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"]('albaali_fletcher: bracketing failed.');\n\n      var noProgress = function noProgress() {\n        if (0 === Lo) // <- TODO FIXME\n          throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]('strongWolfeLineSearch(): no progress.');\n        throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBisectionError\"](X, f, G);\n      }; // PHASE 2: ZOOM PHASE\n      // ------------------\n      //   Given a range that is guaranteed to contain a valid\n      //   strong Wolfe  values, this method finds such a value.\n\n\n      for (var run = 1;; run++) {\n        // SELECT A NEW TRIAL VALUE FOR \n        {\n          var Lil = Math.min(Lo, Hi),\n              Big = Math.max(Lo, Hi);\n          var Lst = Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(Lil), (Big +  * Lil) / ),\n              // <- Least\n          Mst = Math.min(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextDown\"])(Big), (Lil +  * Big) / ); // <- Most\n\n          if (2 ===  || !(Lst < Mst) || !isFinite(fHi) || !isFinite(pHi))  = Lo + (Hi - Lo) / 2;else {\n            // TODO: the minimum will satisfy gRed but might not satisfy fRed.\n            //       It might be smarter to use the interpolation to find\n            //       a point that potentially satisfies both.\n             = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffg\"])(Lo, Hi, fLo, fHi, pLo);\n            if (!(Lst <= ))  = Lst; // < handles NaN\n            else if (!(Mst >= ))  = Mst; // < handles NaN\n          }\n          /*DEBUG*/\n\n          if (!(Lil <= )) throw new Error('Assertion failed.');\n          /*DEBUG*/\n\n          if (!(Big >= )) throw new Error('Assertion failed.');\n        }\n\n        var _xfgp3 = xfgp(),\n            _xfgp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp3, 4),\n            _X2 = _xfgp4[0],\n            _f2 = _xfgp4[1],\n            _G2 = _xfgp4[2],\n            _p = _xfgp4[3];\n\n        if (_f2 - f0 > fRed *  * p0 || _f2 >= fLo) {\n          if (Hi === ) noProgress();\n          Hi = ;\n          fHi = _f2;\n          pHi = _p;\n        } else {\n          if (Math.abs(_p) <= -gRed * p0) return [_X2, _f2, _G2];\n\n          if (Math.sign(Hi - Lo) * _p >= 0) {\n            Hi = Lo;\n            fHi = fLo;\n            pHi = pLo;\n          }\n\n          if (Lo === ) noProgress();\n          Lo = ;\n          fLo = _f2;\n          pLo = _p;\n        }\n      }\n    };\n  };\n\n  Object.defineProperty(line_search, 'name', {\n    value: \"albaali_fletcher(\".concat(JSON.stringify(opt), \")\"),\n    writable: false\n  });\n  Object.assign(line_search, opt);\n  Object.freeze(line_search);\n  return line_search;\n};\n\n//# sourceURL=webpack://nd/./src/opt/line_search/albaali_fletcher.js?");

/***/ }),

/***/ "./src/opt/line_search/index.js":
/*!**************************************!*\
  !*** ./src/opt/line_search/index.js ***!
  \**************************************/
/*! exports provided: LineSearchError, LineSearchNoProgressError, LineSearchBisectionError, LineSearchBoundReachedError, more_thuente_abc, more_thuente_u123, strong_wolfe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _line_search_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchError\", function() { return _line_search_error__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchNoProgressError\", function() { return _line_search_error__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchNoProgressError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBisectionError\", function() { return _line_search_error__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchBisectionError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBoundReachedError\", function() { return _line_search_error__WEBPACK_IMPORTED_MODULE_0__[\"LineSearchBoundReachedError\"]; });\n\n/* harmony import */ var _more_thuente_abc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./more_thuente_abc */ \"./src/opt/line_search/more_thuente_abc.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_abc\", function() { return _more_thuente_abc__WEBPACK_IMPORTED_MODULE_1__[\"more_thuente_abc\"]; });\n\n/* harmony import */ var _more_thuente_u123__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./more_thuente_u123 */ \"./src/opt/line_search/more_thuente_u123.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_u123\", function() { return _more_thuente_u123__WEBPACK_IMPORTED_MODULE_2__[\"more_thuente_u123\"]; });\n\n/* harmony import */ var _strong_wolfe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./strong_wolfe */ \"./src/opt/line_search/strong_wolfe.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"strong_wolfe\", function() { return _strong_wolfe__WEBPACK_IMPORTED_MODULE_3__[\"strong_wolfe\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n//# sourceURL=webpack://nd/./src/opt/line_search/index.js?");

/***/ }),

/***/ "./src/opt/line_search/line_search_error.js":
/*!**************************************************!*\
  !*** ./src/opt/line_search/line_search_error.js ***!
  \**************************************************/
/*! exports provided: LineSearchError, LineSearchNoProgressError, LineSearchBisectionError, LineSearchBoundReachedError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LineSearchError\", function() { return LineSearchError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LineSearchNoProgressError\", function() { return LineSearchNoProgressError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBisectionError\", function() { return LineSearchBisectionError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LineSearchBoundReachedError\", function() { return LineSearchBoundReachedError; });\n/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ \"./node_modules/@babel/runtime/helpers/assertThisInitialized.js\");\n/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_5__);\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar LineSearchError = /*#__PURE__*/function (_Error) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(LineSearchError, _Error);\n\n  var _super = _createSuper(LineSearchError);\n\n  function LineSearchError() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, LineSearchError);\n\n    return _super.apply(this, arguments);\n  }\n\n  return LineSearchError;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_5___default()(Error));\nvar LineSearchNoProgressError = /*#__PURE__*/function (_LineSearchError) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(LineSearchNoProgressError, _LineSearchError);\n\n  var _super2 = _createSuper(LineSearchNoProgressError);\n\n  function LineSearchNoProgressError() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, LineSearchNoProgressError);\n\n    return _super2.apply(this, arguments);\n  }\n\n  return LineSearchNoProgressError;\n}(LineSearchError);\nvar LineSearchBisectionError = /*#__PURE__*/function (_LineSearchError2) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(LineSearchBisectionError, _LineSearchError2);\n\n  var _super3 = _createSuper(LineSearchBisectionError);\n\n  function LineSearchBisectionError(x, f, g) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, LineSearchBisectionError);\n\n    _this = _super3.call(this);\n    Object.assign(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0___default()(_this), {\n      x: x,\n      f: f,\n      g: g\n    });\n    return _this;\n  }\n\n  return LineSearchBisectionError;\n}(LineSearchError);\nvar LineSearchBoundReachedError = /*#__PURE__*/function (_LineSearchError3) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(LineSearchBoundReachedError, _LineSearchError3);\n\n  var _super4 = _createSuper(LineSearchBoundReachedError);\n\n  function LineSearchBoundReachedError(x, f, g) {\n    var _this2;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, LineSearchBoundReachedError);\n\n    _this2 = _super4.call(this);\n    Object.assign(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0___default()(_this2), {\n      x: x,\n      f: f,\n      g: g\n    });\n    return _this2;\n  }\n\n  return LineSearchBoundReachedError;\n}(LineSearchError);\n\n//# sourceURL=webpack://nd/./src/opt/line_search/line_search_error.js?");

/***/ }),

/***/ "./src/opt/line_search/more_thuente_abc.js":
/*!*************************************************!*\
  !*** ./src/opt/line_search/more_thuente_abc.js ***!
  \*************************************************/
/*! exports provided: more_thuente_abc */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_abc\", function() { return more_thuente_abc; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _line_search_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony import */ var _line_search_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_line_search_utils */ \"./src/opt/line_search/_line_search_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n // References\n// ----------\n// .. [1] \"Numerical Optimization\", 2nd Edition,\n//         Jorge Nocedal & Stephen J. Wright,\n//         Chapter 3. Line Search Methods, page 60f\n// .. [2] \"Line Search Algorithms with Guaranteed Sufficient Decrease\"\n//         Jorge J. Mor and David J. Thuente\n//         ACM Transactions on Mathematical Software,\n//         Vol 20, No. 3, Septermber 1994, Pages 286-307\n// TODO: study dcsrch.f and dcstep.f from MINPACK2 for possible improvements\n//       https://github.com/scipy/scipy/tree/master/scipy/optimize/minpack2\n\nvar DEFAULT_OPTIONS = Object.freeze({\n  fRed: 1e-2,\n  gRed: 0.9,\n  growMin: Math.PI / 3,\n  growMax: Math.E - 1.5,\n  shrinkLeast: 0.1\n}); // implements the pseudocode lines (a,b,c) from [2].\n\nvar more_thuente_abc = function more_thuente_abc() {\n  var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  for (var _i = 0, _Object$keys = Object.keys(opt); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    if (!(key in DEFAULT_OPTIONS)) console.warn(\"more_thuente_abc(opt): unknown parameter \\\"\".concat(key, \"\\\" in opt.\"));\n  }\n\n  var _opt = opt = Object.assign({}, DEFAULT_OPTIONS, opt),\n      fRed = _opt.fRed,\n      gRed = _opt.gRed,\n      growMin = _opt.growMin,\n      growMax = _opt.growMax,\n      shrinkLeast = _opt.shrinkLeast;\n\n  fRed *= 1; // (1) Wolfe cond. 1: Sufficient decrease of objective.\n\n  gRed *= 1; // (2) Wolfe cond. 2: Sufficient decrease of projected gradient.\n\n  growMin *= 1; // (3) Lower growth factor bound for 1st phase of line search (bracketing).\n\n  growMax *= 1; // (4) Upper growth factor bound for 1st phase of line search (bracketing).\n\n  shrinkLeast *= 1; // (4) Minimum reduction of search range during 2nd phase of line search (zoom).\n  // CHECK 0 < fRed < gRed < 1 < c3\n\n  if (!(fRed > 0)) throw new Error('more_thuente_abc(opt): opt.fRed must be positive.');\n  if (!(fRed < gRed)) throw new Error('more_thuente_abc(opt): opt.fRed must less than opt.gRed.');\n  if (!(1 > gRed)) throw new Error('more_thuente_abc(opt): opt.gRed must less than 1.');\n  if (!(1 < growMin)) throw new Error('more_thuente_abc(opt): opt.growMin must larger than 1.');\n  if (!(growMax >= growMin)) throw new Error('more_thuente_abc(opt): opt.growMax must not be less than opt.growMin.');\n  if (!(fRed < 0.5)) console.warn('more_thuente_abc(opt): opt.fRed should be less than 0.5 to work properly with (quasi-)Newton methods.');\n  if (!(shrinkLeast >= 0.0)) throw new Error('more_thuente_abc(opt): opt.shrinkLeast must be non-negative.');\n  if (!(shrinkLeast <= 0.5)) throw new Error('more_thuente_abc(opt): opt.shrinkLeast must not be greater than 0.5.');\n  var  = 1 / shrinkLeast,\n       =  - 1;\n\n  var line_search = function line_search(fg_raw) {\n    return function (X0, f0, G0, negDir) {\n      var Min = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      var 0 = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n      var Max = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : Infinity;\n      X0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', X0);\n      G0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G0);\n      f0 *= 1;\n      if (!(negDir instanceof _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"])) throw new Error('Assertion failed.');\n\n      var shape = negDir.shape,\n          _shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(shape, 1),\n          L = _shape[0];\n\n      if (X0.ndim !== 1) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): X0.ndim must be 1.');\n      if (G0.ndim !== 1) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): G0.ndim must be 1.');\n      if (negDir.ndim !== 1) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): negDir.ndim must be 1.');\n      if (X0.shape[0] !== L) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): negDir and X0 must have the same shape.');\n      if (G0.shape[0] !== L) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): negDir and G0 must have the same shape.');\n      if (isNaN(f0)) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): f0 is NaN.');\n      if (Min !== 0) throw new Error('more_thuente_abc()(fg)(X0,f0,G0, Min,0,Max): Min !== 0 not (yet) supported.');\n      negDir = negDir.data; // TODO: Instead of a specified Min, we could compute\n      //       the smallest Min that still results in an\n      //       X different from X0, i.e. an Min that\n      //       does not result in complete underflow.\n\n      if (null == 0) 0 = Math.min(1, Max / 2);\n      if (!(Min <= 0)) throw new Error('more_thuente_abc()(fg)(X0,f0,G0, Min,0,Max): Min must not be greater than 0.');\n      if (!(Max >= 0)) throw new Error('more_thuente_abc()(fg)(X0,f0,G0, Min,0,Max): Max must not be less than 0.');\n      if (0 === Max) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n\n      var projGrad = function projGrad(g) {\n        return g.data.reduce(function (p, gi, i) {\n          return p - negDir[i] * gi;\n        }, 0);\n      }; // wrap some checks aroung fg_raw\n\n\n      var xfgp = function xfgp() {\n        var X = new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X0.data.map(function (x, i) {\n          return x -  * negDir[i];\n        }));\n\n        var _fg_raw = fg_raw(new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X.data.slice())),\n            _fg_raw2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_fg_raw, 2),\n            f = _fg_raw2[0],\n            G = _fg_raw2[1];\n\n        f *= 1;\n        G = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G);\n        if (isNaN(f)) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): fg returned NaN.');\n        if (G.ndim !== 1) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        if (G.shape[0] !== L) throw new Error('more_thuente_abc()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        var p = projGrad(G);\n        return [X, f, G, p];\n      };\n\n      var p0 = projGrad(G0); // <- projected gradient\n\n      if (0 === p0) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n      if (0 < p0) throw new Error('more_thuente_abc: Initial projected gradient not negative.');\n      var Lo = 0,\n          Hi = Infinity,\n           = 0,\n          fLo = f0,\n          fHi = NaN,\n          pLo = p0,\n          pHi = NaN; // PHASE 1: BRACKETING PHASE\n      // ------------------------\n      //   Find a range guaranteed to contain an  satisfying strong Wolfe.\n\n      bracketing: for (;;) {\n        if (!isFinite()) throw new Error('Assertion failed: ' + );\n\n        var _xfgp = xfgp(),\n            _xfgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp, 4),\n            X = _xfgp2[0],\n            f = _xfgp2[1],\n            G = _xfgp2[2],\n            p = _xfgp2[3]; // check convergence\n\n\n        if (f - f0 <= fRed *  * p0 && Math.abs(p) <= -gRed * p0) return [X, f, G];\n\n        if (f > fLo) {\n          Hi = ;\n          fHi = f;\n          pHi = p;\n          break bracketing;\n        }\n\n        if (p > 0) {\n          Hi = Lo;\n          Lo = ;\n          fHi = fLo;\n          fLo = f;\n          pHi = pLo;\n          pLo = p;\n          break bracketing;\n        }\n\n        if (!( < Max)) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBoundReachedError\"](X, f, G);\n        if (!( < Number.MAX_VALUE)) throw new Error('more_thuente_abc: Infinity reached.');\n        var Trial = void 0;\n        if (pLo < p) Trial = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_gg\"])(Lo, , pLo, p);else {\n          Trial =  * growMin;\n        }\n        Trial = Math.min(Trial,  * growMax);\n        Trial = Math.max(Trial,  * growMin);\n        if (!( < Trial)) Trial = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(); // <- handles NaN\n\n        if (!(Max >= Trial)) Trial = Max; // <- handles NaN\n\n        Lo = ;\n         = Trial;\n        fLo = f;\n        pLo = p;\n      }\n\n      if (Lo === Hi) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"]('more_thuente_abc: bracketing failed.');\n\n      var noProgress = function noProgress(X, f, G) {\n        if (Lo === 0) // <- TODO FIXME\n          throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]('strongWolfeLineSearch(): no progress.');\n        throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBisectionError\"](X, f, G);\n      }; // PHASE 2: ZOOM PHASE\n      // ------------------\n      //   Given a range that is guaranteed to contain a valid\n      //   strong Wolfe  values, this method finds such a value.\n\n\n      for (var run = 1;; run++) {\n        // SELECT A NEW TRIAL VALUE FOR \n        {\n          var Lil = Math.min(Lo, Hi),\n              Big = Math.max(Lo, Hi);\n          var Lst = Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(Lil), shrinkLeast * Big + (1 - shrinkLeast) * Lil),\n              // <- Least\n          Mst = Math.min(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextDown\"])(Big), shrinkLeast * Lil + (1 - shrinkLeast) * Big); // <- Most\n\n          var Mid = Lo + (Hi - Lo) / 2;\n          if (shrinkLeast === 0.5 || !(Lst < Mst) || !isFinite(fHi) || !isFinite(pHi))  = Mid;else {\n            // TODO: the minimum will satisfy gRed but might not satisfy fRed.\n            //       It might be smarter to use the interpolation to find\n            //       a point that potentially satisfies both.\n            if (fLo < fHi) {\n              // See [2], section \"Trial Value Selection\", Case 1\n              var c = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffgg\"])(Lo, Hi, fLo, fHi, pLo, pHi),\n                  q = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffg\"])(Lo, Hi, fLo, fHi, pLo);\n\n               = Math.abs(c - Lo) < Math.abs(q - Lo) ? c : (c + q) / 2; // <- TODO: Looking for a minimum might not be smart, we should consider trying to find a strong wolfe range instead\n            } else if (Math.sign(pLo) * pHi < 0) {\n              // See [2], section \"Trial Value Selection\", Case 1\n              var _c = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffgg\"])(Lo, Hi, fLo, fHi, pLo, pHi),\n                  s = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_gg\"])(Lo, Hi, pLo, pHi);\n\n               = Math.abs(s - Hi) <= Math.abs(_c - Hi) ? _c : s; // <- TODO: Looking for a minimum might not be smart, we should consider trying to find a strong wolfe range instead\n            } else {\n              //  = Mid;\n               = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffg\"])(Lo, Hi, fLo, fHi, pLo);\n            }\n\n            if (!(Lst <= ))  = Lst; // < handles NaN\n            else if (!(Mst >= ))  = Mst; // < handles NaN\n          }\n        }\n\n        var _xfgp3 = xfgp(),\n            _xfgp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp3, 4),\n            _X = _xfgp4[0],\n            _f = _xfgp4[1],\n            _G = _xfgp4[2],\n            _p = _xfgp4[3]; // check convergence\n\n\n        if (_f - f0 <= fRed *  * p0 && Math.abs(_p) <= -gRed * p0) return [_X, _f, _G];\n\n        if (_f > fLo) {\n          if (Hi === ) noProgress(_X, _f, _G);\n          Hi = ;\n          fHi = _f;\n          pHi = _p;\n        } else {\n          if (Math.sign(Hi - Lo) * _p > 0) {\n            Hi = Lo;\n            fHi = fLo;\n            pHi = pLo;\n          }\n\n          if (Lo === ) noProgress(_X, _f, _G);\n          Lo = ;\n          fLo = _f;\n          pLo = _p;\n        }\n      }\n    };\n  };\n\n  Object.defineProperty(line_search, 'name', {\n    value: \"more_thuente_abc(\".concat(JSON.stringify(opt), \")\"),\n    writable: false\n  });\n  Object.assign(line_search, opt);\n  Object.freeze(line_search);\n  return line_search;\n};\n\n//# sourceURL=webpack://nd/./src/opt/line_search/more_thuente_abc.js?");

/***/ }),

/***/ "./src/opt/line_search/more_thuente_u123.js":
/*!**************************************************!*\
  !*** ./src/opt/line_search/more_thuente_u123.js ***!
  \**************************************************/
/*! exports provided: more_thuente_u123 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"more_thuente_u123\", function() { return more_thuente_u123; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _line_search_error__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./line_search_error */ \"./src/opt/line_search/line_search_error.js\");\n/* harmony import */ var _line_search_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_line_search_utils */ \"./src/opt/line_search/_line_search_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n // References\n// ----------\n// .. [1] \"Numerical Optimization\", 2nd Edition,\n//         Jorge Nocedal & Stephen J. Wright,\n//         Chapter 3. Line Search Methods, page 60f\n// .. [2] \"Line Search Algorithms with Guaranteed Sufficient Decrease\"\n//         Jorge J. Mor and David J. Thuente\n//         ACM Transactions on Mathematical Software,\n//         Vol 20, No. 3, Septermber 1994, Pages 286-307\n// TODO: study dcsrch.f and dcstep.f from MINPACK2 for possible improvements\n//       https://github.com/scipy/scipy/tree/master/scipy/optimize/minpack2\n\nvar DEFAULT_OPTIONS = Object.freeze({\n  fRed: 1e-2,\n  gRed: 0.9,\n  growMin: Math.PI / 3,\n  growMax: Math.E - 1.5,\n  shrinkLeast: 0.1\n}); // implements the pseudocode lines (U1,U2,U3) from [2].\n\nvar more_thuente_u123 = function more_thuente_u123() {\n  var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  for (var _i = 0, _Object$keys = Object.keys(opt); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    if (!(key in DEFAULT_OPTIONS)) console.warn(\"more_thuente_u123(opt): unknown parameter \\\"\".concat(key, \"\\\" in opt.\"));\n  }\n\n  var _opt = opt = Object.assign({}, DEFAULT_OPTIONS, opt),\n      fRed = _opt.fRed,\n      gRed = _opt.gRed,\n      growMin = _opt.growMin,\n      growMax = _opt.growMax,\n      shrinkLeast = _opt.shrinkLeast;\n\n  fRed *= 1; // (1) Wolfe cond. 1: Sufficient decrease of objective.\n\n  gRed *= 1; // (2) Wolfe cond. 2: Sufficient decrease of projected gradient.\n\n  growMin *= 1; // (3) Lower growth factor bound for 1st phase of line search (bracketing).\n\n  growMax *= 1; // (4) Upper growth factor bound for 1st phase of line search (bracketing).\n\n  shrinkLeast *= 1; // (5) Minimum reduction of search range during 2nd phase of line search (zoom).\n  // CHECK 0 < fRed < gRed < 1 < c3\n\n  if (!(fRed > 0)) throw new Error('more_thuente_u123(opt): opt.fRed must be positive.');\n  if (!(fRed < gRed)) throw new Error('more_thuente_u123(opt): opt.fRed must less than opt.gRed.');\n  if (!(1 > gRed)) throw new Error('more_thuente_u123(opt): opt.gRed must less than 1.');\n  if (!(1 < growMin)) throw new Error('more_thuente_u123(opt): opt.growMin must larger than 1.');\n  if (!(growMax >= growMin)) throw new Error('more_thuente_u123(opt): opt.growMax must not be less than opt.growMin.');\n  if (!(fRed < 0.5)) console.warn('more_thuente_u123(opt): opt.fRed should be less than 0.5 to work properly with (quasi-)Newton methods.');\n  if (!(shrinkLeast >= 0.0)) throw new Error('more_thuente_u123(opt): opt.shrinkLeast must be non-negative.');\n  if (!(shrinkLeast <= 0.5)) throw new Error('more_thuente_u123(opt): opt.shrinkLeast must not be greater than 0.5.');\n\n  var line_search = function line_search(fg_raw) {\n    return function (X0, f0, G0, negDir) {\n      var Min = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      var 0 = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n      var Max = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : Infinity;\n      X0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', X0);\n      G0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G0);\n      f0 *= 1;\n      if (!(negDir instanceof _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"])) throw new Error('Assertion failed.');\n\n      var shape = negDir.shape,\n          _shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(shape, 1),\n          L = _shape[0];\n\n      if (X0.ndim !== 1) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): X0.ndim must be 1.');\n      if (G0.ndim !== 1) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): G0.ndim must be 1.');\n      if (negDir.ndim !== 1) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): negDir.ndim must be 1.');\n      if (X0.shape[0] !== L) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): negDir and X0 must have the same shape.');\n      if (G0.shape[0] !== L) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): negDir and G0 must have the same shape.');\n      if (Min !== 0) throw new Error('more_thuente_u123()(fg)(X0,f0,G0, Min,0,Max): Min !== 0 not (yet) supported.');\n      if (isNaN(f0)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): f0 is NaN.');\n      if (X0.data.some(isNaN)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): X0 contains NaN.');\n      if (G0.data.some(isNaN)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): G0 contains NaN.');\n      negDir = negDir.data;\n      if (negDir.some(isNaN)) throw new Error('Assertion failed.'); // TODO: Instead of a specified Min, we could compute\n      //       the smallest Min that still results in an\n      //       X different from X0, i.e. an Min that\n      //       does not result in complete underflow.\n\n      if (null == 0) 0 = Math.min(1, Max / 2);\n      if (!(Min <= 0)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0, Min,0,Max): Min must not be greater than 0.');\n      if (!(Max >= 0)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0, Min,0,Max): Max must not be less than 0.');\n      if (0 === Max) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n\n      var projGrad = function projGrad(g) {\n        return g.data.reduce(function (p, gi, i) {\n          return p - negDir[i] * gi;\n        }, 0);\n      }; // wrap some checks aroung fg_raw\n\n\n      var xfgp = function xfgp() {\n        var X = new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X0.data.map(function (x, i) {\n          return x -  * negDir[i];\n        }));\n\n        var _fg_raw = fg_raw(new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, X.data.slice())),\n            _fg_raw2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_fg_raw, 2),\n            f = _fg_raw2[0],\n            G = _fg_raw2[1];\n\n        f *= 1;\n        G = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"array\"])('float64', G);\n        if (isNaN(f)) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned NaN.');\n        if (G.ndim !== 1) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        if (G.shape[0] !== L) throw new Error('more_thuente_u123()(fg)(X0,f0,G0): fg returned gradient with invalid shape.');\n        var p = projGrad(G);\n        return [X, f, G, p];\n      };\n\n      var p0 = projGrad(G0); // <- projected gradient\n\n      if (0 === p0) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]();\n      if (0 < p0) throw new Error('more_thuente_u123: Initial projected gradient not negative.');\n      var Lo = 0,\n          Hi = Infinity,\n           = 0,\n          fLo = f0,\n          fHi = NaN,\n          pLo = p0,\n          pHi = NaN; // PHASE 1: BRACKETING PHASE\n      // ------------------------\n      //   Find a range guaranteed to contain an  satisfying strong Wolfe.\n\n      bracketing: for (;;) {\n        if (!isFinite()) throw new Error('Assertion failed.');\n\n        var _xfgp = xfgp(),\n            _xfgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp, 4),\n            X = _xfgp2[0],\n            f = _xfgp2[1],\n            G = _xfgp2[2],\n            p = _xfgp2[3]; // check convergence\n\n\n        if (f - f0 <= fRed *  * p0 && Math.abs(p) <= -gRed * p0) return [X, f, G];\n\n        if (f - fLo > fRed * ( - Lo) * p0) {\n          Hi = ;\n          fHi = f;\n          pHi = p;\n          break bracketing;\n        }\n\n        if (p > 0) {\n          Hi = Lo;\n          Lo = ;\n          fHi = fLo;\n          fLo = f;\n          pHi = pLo;\n          pLo = p;\n          break bracketing;\n        }\n\n        if (!( < Max)) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBoundReachedError\"](X, f, G);\n        if (!( < Number.MAX_VALUE)) throw new Error('more_thuente_u123: Infinity reached.');\n        var Trial = void 0;\n        if (pLo < p) Trial = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_gg\"])(Lo, , pLo, p);else {\n          Trial =  * growMin;\n        }\n        Trial = Math.min(Trial,  * growMax);\n        Trial = Math.max(Trial,  * growMin);\n        if (!( < Trial)) Trial = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(); // <- handles NaN\n\n        if (!(Max >= Trial)) Trial = Max; // <- handles NaN\n\n        Lo = ;\n         = Trial;\n        fLo = f;\n        pLo = p;\n      }\n\n      if (Lo === Hi) throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchError\"]('more_thuente_u123: bracketing failed.');\n\n      var noProgress = function noProgress(X, f, G) {\n        if (Lo === 0) // <- TODO FIXME\n          throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchNoProgressError\"]('strongWolfeLineSearch(): no progress.');\n        throw new _line_search_error__WEBPACK_IMPORTED_MODULE_3__[\"LineSearchBisectionError\"](X, f, G);\n      }; // PHASE 2: ZOOM PHASE\n      // ------------------\n      //   Given a range that is guaranteed to contain a valid\n      //   strong Wolfe  values, this method finds such a value.\n\n\n      for (var run = 1;; run++) {\n        // SELECT A NEW TRIAL VALUE FOR \n        {\n          var Lil = Math.min(Lo, Hi),\n              Big = Math.max(Lo, Hi);\n          var Lst = Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextUp\"])(Lil), shrinkLeast * Big + (1 - shrinkLeast) * Lil),\n              // <- Least\n          Mst = Math.min(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_2__[\"nextDown\"])(Big), shrinkLeast * Lil + (1 - shrinkLeast) * Big); // <- Most\n\n          var Mid = Lo + (Hi - Lo) / 2;\n          if (shrinkLeast === 0.5 || !(Lst < Mst) || !isFinite(fHi) || !isFinite(pHi))  = Mid;else {\n            // TODO: the minimum will satisfy gRed but might not satisfy fRed.\n            //       It might be smarter to use the interpolation to find\n            //       a point that potentially satisfies both.\n            if (fLo < fHi) {\n              // See [2], section \"Trial Value Selection\", Case 1\n              var c = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffgg\"])(Lo, Hi, fLo, fHi, pLo, pHi),\n                  q = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffg\"])(Lo, Hi, fLo, fHi, pLo);\n\n               = Math.abs(c - Lo) < Math.abs(q - Lo) ? c : (c + q) / 2; // <- TODO: Looking for a minimum might not be smart, we should consider trying to find a strong wolfe range instead\n            } else if (Math.sign(pLo) * pHi < 0) {\n              // See [2], section \"Trial Value Selection\", Case 1\n              var _c = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffgg\"])(Lo, Hi, fLo, fHi, pLo, pHi),\n                  s = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_gg\"])(Lo, Hi, pLo, pHi);\n\n               = Math.abs(s - Hi) <= Math.abs(_c - Hi) ? _c : s; // <- TODO: Looking for a minimum might not be smart, we should consider trying to find a strong wolfe range instead\n            } else {\n              //  = Mid;\n               = Object(_line_search_utils__WEBPACK_IMPORTED_MODULE_4__[\"_min1d_interp_ffg\"])(Lo, Hi, fLo, fHi, pLo);\n            }\n\n            if (!(Lst <= ))  = Lst; // < handles NaN\n            else if (!(Mst >= ))  = Mst; // < handles NaN\n          }\n          /*DEBUG*/\n\n          if (!(Lil <= )) throw new Error('Assertion failed.');\n          /*DEBUG*/\n\n          if (!(Big >= )) throw new Error('Assertion failed.');\n        }\n\n        var _xfgp3 = xfgp(),\n            _xfgp4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_xfgp3, 4),\n            _X = _xfgp4[0],\n            _f = _xfgp4[1],\n            _G = _xfgp4[2],\n            _p = _xfgp4[3]; // check convergence\n\n\n        if (_f - f0 <= fRed *  * p0 && Math.abs(_p) <= -gRed * p0) return [_X, _f, _G];\n\n        if (_f - fLo > fRed * ( - Lo) * p0) {\n          if (Hi === ) noProgress(_X, _f, _G);\n          Hi = ;\n          fHi = _f;\n          pHi = _p;\n        } else {\n          if (Math.sign(Hi - Lo) * _p > 0) {\n            Hi = Lo;\n            fHi = fLo;\n            pHi = pLo;\n          }\n\n          if (Lo === ) noProgress(_X, _f, _G);\n          Lo = ;\n          fLo = _f;\n          pLo = _p;\n        }\n      }\n    };\n  };\n\n  Object.defineProperty(line_search, 'name', {\n    value: \"more_thuente_u123(\".concat(JSON.stringify(opt), \")\"),\n    writable: false\n  });\n  Object.assign(line_search, opt);\n  Object.freeze(line_search);\n  return line_search;\n};\n\n//# sourceURL=webpack://nd/./src/opt/line_search/more_thuente_u123.js?");

/***/ }),

/***/ "./src/opt/line_search/strong_wolfe.js":
/*!*********************************************!*\
  !*** ./src/opt/line_search/strong_wolfe.js ***!
  \*********************************************/
/*! exports provided: strong_wolfe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"strong_wolfe\", function() { return strong_wolfe; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _albaali_fletcher__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./albaali_fletcher */ \"./src/opt/line_search/albaali_fletcher.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\nvar strong_wolfe = function strong_wolfe() {\n  var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  opt = _objectSpread({}, opt);\n\n  for (var _i = 0, _arr = ['c1', 'fRed', 'c2', 'gRed', 'c3', 'grow']; _i < _arr.length; _i++) {\n    var _arr$_i = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_arr[_i], 2),\n        old_name = _arr$_i[0],\n        new_name = _arr$_i[1];\n\n    if (!(new_name in opt) && old_name in opt) {\n      console.warn(\"strong_wolfe(opt): opt.\".concat(old_name, \" is deprecated, use opt.\").concat(new_name, \" instead.\"));\n      opt[new_name] = opt[old_name];\n      delete opt[old_name];\n    }\n  }\n\n  return Object(_albaali_fletcher__WEBPACK_IMPORTED_MODULE_2__[\"albaali_fletcher\"])(opt);\n};\n\n//# sourceURL=webpack://nd/./src/opt/line_search/strong_wolfe.js?");

/***/ }),

/***/ "./src/opt/lm.js":
/*!***********************!*\
  !*** ./src/opt/lm.js ***!
  \***********************/
/*! exports provided: lsq_lm_gen, tls_lm_gen, odr_lm_gen, fit_lm_gen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lsq_lm_gen\", function() { return lsq_lm_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tls_lm_gen\", function() { return tls_lm_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"odr_lm_gen\", function() { return odr_lm_gen; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fit_lm_gen\", function() { return fit_lm_gen; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n/* harmony import */ var _la_norm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../la/norm */ \"./src/la/norm.js\");\n/* harmony import */ var _optimization_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./optimization_error */ \"./src/opt/optimization_error.js\");\n/* harmony import */ var _trust_region_solver_lsq__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./_trust_region_solver_lsq */ \"./src/opt/_trust_region_solver_lsq.js\");\n/* harmony import */ var _trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_trust_region_solver_tls */ \"./src/opt/_trust_region_solver_tls.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar _marked = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(_lm),\n    _marked2 = /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(fit_lm_gen);\n\n\n\n\n\n\n // References\n// ----------\n// .. [1] \"THE LEVENBERG-MARQUARDT ALGORITHM: IMPLEMENTATION AND THEORY\"\n//         Jorge J. Mor.\n\n/** Solves a nonlinear least-squares problem using a\n *  trust-region variant Levenberg-Marquard algorithm\n *  as described in:\n *\n *    \"THE LEVENBERG-MARQUARDT ALGORITHM: IMPLEMENTATION AND THEORY\"\n *    by Jorge J. Mor.\n */\n\nvar lsq_lm_gen = function lsq_lm_gen(fJ, x0, opt) {\n  return _lm(new _trust_region_solver_lsq__WEBPACK_IMPORTED_MODULE_6__[\"TrustRegionSolverLSQ\"](fJ, x0), opt);\n};\n\nfunction _lm(solver) {\n  var _ref,\n      _ref$r,\n      r0,\n      _ref$rMin,\n      rMin,\n      _ref$rMax,\n      rMax,\n      _ref$rNewton,\n      rNewton,\n      _ref$rTol,\n      rTol,\n      _ref$lmLower,\n      lmLower,\n      _ref$shrinkLower,\n      shrinkLower,\n      _ref$shrinkUpper,\n      shrinkUpper,\n      _ref$grow,\n      grow,\n      _ref$expectGainMin,\n      expectGainMin,\n      _ref$expectGainMax,\n      expectGainMax,\n      _ref$stuckLimit,\n      stuckLimit,\n      N,\n      D,\n      dX,\n      G,\n      NORM,\n      R,\n      loss,\n      stuckometer,\n      _solver$computeNewton,\n      _solver$computeNewton2,\n      r,\n      dr,\n      gnInRadius,\n      i,\n      d,\n      g,\n      Min,\n      Max,\n      ,\n      nIter,\n      _solver$computeNewton3,\n      _solver$computeNewton4,\n      _solver$considerMove,\n      _solver$considerMove2,\n      loss_predict,\n      loss_consider,\n      rScale,\n      predict,\n      actual,\n      grad,\n      _i,\n      shrink,\n      _r,\n      rs,\n      _args = arguments;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _lm$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref = _args.length > 1 && _args[1] !== undefined ? _args[1] : {}, _ref$r = _ref.r0, r0 = _ref$r === void 0 ? 1.1 : _ref$r, _ref$rMin = _ref.rMin, rMin = _ref$rMin === void 0 ? 0 : _ref$rMin, _ref$rMax = _ref.rMax, rMax = _ref$rMax === void 0 ? Infinity : _ref$rMax, _ref$rNewton = _ref.rNewton, rNewton = _ref$rNewton === void 0 ? 2 : _ref$rNewton, _ref$rTol = _ref.rTol, rTol = _ref$rTol === void 0 ? 0.05 : _ref$rTol, _ref$lmLower = _ref.lmLower, lmLower = _ref$lmLower === void 0 ? 0.001 : _ref$lmLower, _ref$shrinkLower = _ref.shrinkLower, shrinkLower = _ref$shrinkLower === void 0 ? 0.05 : _ref$shrinkLower, _ref$shrinkUpper = _ref.shrinkUpper, shrinkUpper = _ref$shrinkUpper === void 0 ? 0.95 : _ref$shrinkUpper, _ref$grow = _ref.grow, grow = _ref$grow === void 0 ? 1.4142135623730951 : _ref$grow, _ref$expectGainMin = _ref.expectGainMin, expectGainMin = _ref$expectGainMin === void 0 ? 0.25 : _ref$expectGainMin, _ref$expectGainMax = _ref.expectGainMax, expectGainMax = _ref$expectGainMax === void 0 ? 0.75 : _ref$expectGainMax, _ref$stuckLimit = _ref.stuckLimit, stuckLimit = _ref$stuckLimit === void 0 ? 64 : _ref$stuckLimit;\n\n          if (0 <= lmLower) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.lmLower must be within [0,1).');\n\n        case 3:\n          if (lmLower < 1) {\n            _context.next = 5;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.lmLower must be within [0,1).');\n\n        case 5:\n          if (1 > rTol) {\n            _context.next = 7;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.rTol must be less than 1.');\n\n        case 7:\n          if (0 < rTol) {\n            _context.next = 9;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.rTol must be positive number.');\n\n        case 9:\n          if (0 < r0) {\n            _context.next = 11;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.r0 must be positive number.');\n\n        case 11:\n          if (0 <= rMin) {\n            _context.next = 13;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.rMin must be non-negative.');\n\n        case 13:\n          if (rMin <= rMax) {\n            _context.next = 15;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.rMin must not be greater than opt.rMax.');\n\n        case 15:\n          if (rMin <= r0) {\n            _context.next = 17;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.r0 must not be less than opt.rMin.');\n\n        case 17:\n          if (rMax >= r0) {\n            _context.next = 19;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.r0 must not be greater than opt.rMax.');\n\n        case 19:\n          if (1 / (1 + rTol) < rNewton) {\n            _context.next = 21;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.rGN must be greater than 1/(1+rTol).');\n\n        case 21:\n          if (0 < shrinkLower) {\n            _context.next = 23;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.shrinkLower must be positive number.');\n\n        case 23:\n          if (shrinkLower <= shrinkUpper) {\n            _context.next = 25;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.shrinkLower must not be greater than opt.shrinkUpper.');\n\n        case 25:\n          if (shrinkUpper < 1) {\n            _context.next = 27;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.shrinkUpper must be less than 1.');\n\n        case 27:\n          if (1 < grow) {\n            _context.next = 29;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.grow must be number greater than 1.');\n\n        case 29:\n          if (0 < expectGainMin) {\n            _context.next = 31;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.expectGainMin must be positive number.');\n\n        case 31:\n          if (expectGainMin < expectGainMax) {\n            _context.next = 33;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.expectGainMin must be less than expectGainMax.');\n\n        case 33:\n          if (!(expectGainMax < 1)) console.warn('lsq_lm_gen(fJ, x0, opt): opt.expectGainMax should be less than 1.');\n\n          if (!(0 !== stuckLimit % 1)) {\n            _context.next = 36;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.stuckLimit must be an integer.');\n\n        case 36:\n          if (0 <= stuckLimit) {\n            _context.next = 38;\n            break;\n          }\n\n          throw new Error('lsq_lm_gen(fJ, x0, opt): opt.stuckLimit must not be negative.');\n\n        case 38:\n          N = solver.N, D = solver.D, dX = solver.regularized_dX, G = solver.G0, NORM = new _la_norm__WEBPACK_IMPORTED_MODULE_4__[\"FrobeniusNorm\"](); //  let R = r0; // <- TODO maybe there is a better starting value for R0 like r0*solver.scaledNorm(G) order something like that\n\n          R = -r0 * solver.cauchyTravel() * solver.scaledNorm(G), loss = solver.loss, stuckometer = 0;\n\n        case 40:\n          if (!(0 === stuckometer)) {\n            _context.next = 43;\n            break;\n          }\n\n          _context.next = 43;\n          return solver.report();\n\n        case 43:\n          _solver$computeNewton = solver.computeNewtonRegularized(0), _solver$computeNewton2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_solver$computeNewton, 2), r = _solver$computeNewton2[0], dr = _solver$computeNewton2[1];\n\n          if (isFinite(r)) {\n            _context.next = 46;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 46:\n          gnInRadius = r <= R * (1 + rTol);\n\n          if (gnInRadius) {\n            _context.next = 85;\n            break;\n          }\n\n          NORM.reset();\n\n          for (i = N; i-- > 0;) {\n            d = D[i];\n            g = G[i];\n            if (0 !== d) g /= d;\n            NORM.include(g);\n          }\n\n          r -= R;\n\n          if (isFinite(r)) {\n            _context.next = 53;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 53:\n          if (0 < r) {\n            _context.next = 55;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 55:\n          if (0 > dr) {\n            _context.next = 57;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 57:\n          Min = -r / dr, Max = NORM.result / R,  = 0;\n          /*DEBUG*/\n\n          nIter = -1;\n\n        case 59:\n          if (!(64 < ++nIter)) {\n            _context.next = 61;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 61:\n          if (Min >= 0) {\n            _context.next = 63;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 63:\n          if (0 <= Max) {\n            _context.next = 65;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 65:\n          if (Min < Max) {\n            _context.next = 67;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 67:\n          // Algorithm (5.5) (a)\n          if (!(Min <  &&  < Max))  = Math.max(lmLower * Max, Math.sqrt(Min * Max));\n          /*DEBUG*/\n\n          if (Min <  &&  < Max) {\n            _context.next = 70;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 70:\n          _solver$computeNewton3 = solver.computeNewtonRegularized();\n          _solver$computeNewton4 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_solver$computeNewton3, 2);\n          r = _solver$computeNewton4[0];\n          dr = _solver$computeNewton4[1];\n\n          if (isFinite(r)) {\n            _context.next = 76;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 76:\n          if (!(Math.abs(R - r) <= R * rTol)) {\n            _context.next = 78;\n            break;\n          }\n\n          return _context.abrupt(\"break\", 83);\n\n        case 78:\n          if (r < R) Max = ;\n          Min = Math.max(Min,  + (R - r) / dr); // Algorithm (5.5) (c)\n\n           += (R - r) / dr * (r / R);\n\n        case 81:\n          _context.next = 59;\n          break;\n\n        case 83:\n          if (Math.abs(solver.scaledNorm(dX) - R) <= R * rTol) {\n            _context.next = 85;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 85:\n          if (solver.scaledNorm(dX) <= R * (1 + rTol)) {\n            _context.next = 87;\n            break;\n          }\n\n          throw new Error('Assertion failed.');\n\n        case 87:\n          _solver$considerMove = solver.considerMove(dX), _solver$considerMove2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_solver$considerMove, 2), loss_predict = _solver$considerMove2[0], loss_consider = _solver$considerMove2[1]; //*DEBUG*/    if( !(loss_predict <= loss+1e-6) ) throw new Error('Assertion failed.');\n\n          rScale = function rScale() {\n            return 1;\n          }; // const rScale = () => solver.scaledNorm(G); // <- TODO: examine scaling alternatives for the radius limits\n\n\n          predict = loss - loss_predict, actual = loss - loss_consider;\n\n          if (!(actual < predict * expectGainMin)) {\n            _context.next = 103;\n            break;\n          }\n\n          // PREDICTION BAD -> REDUCE TRUST RADIUS\n          // (by fitting a quadratic polynomial through err_now, grad_now and err_next)\n          grad = 0;\n\n          for (_i = N; _i-- > 0;) {\n            grad += dX[_i] * G[_i];\n          }\n\n          grad *= 2;\n          shrink = grad / (2 * grad + loss - loss_consider);\n          if (!(shrink >= shrinkLower)) shrink = shrinkLower;\n          if (!(shrink <= shrinkUpper)) shrink = shrinkUpper;\n          _r = Math.max(rMin * rScale(), R * shrink);\n\n          if (!(_r === R && !(loss > loss_consider))) {\n            _context.next = 100;\n            break;\n          }\n\n          throw new _optimization_error__WEBPACK_IMPORTED_MODULE_5__[\"OptimizationNoProgressError\"]();\n\n        case 100:\n          R = _r;\n          _context.next = 104;\n          break;\n\n        case 103:\n          if (gnInRadius) {\n            // See [1] Algorithm (7.1) (d). If Gauss-Newton point is inside the trust radius and\n            // prediction is not bad, set the radius to rGN times the distance to the Gauss-Newton\n            // point. This also avoids that the trust radius grows uncontrollably while the\n            // Gauss-Newton point is inside the trust region for a few iterations.\n            rs = rScale();\n            R = Math.max(rs * rMin, Math.min(rs * rMax, rNewton * r));\n          } else if (actual > predict * expectGainMax || actual === 0) {\n            // PREDICTION GREAT -> INCREASE TRUST RADIUS\n            R = Math.min(rMax * rScale(), Math.max(Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_3__[\"nextUp\"])(R), R * grow));\n          }\n\n        case 104:\n          if (!(loss > loss_consider)) {\n            _context.next = 110;\n            break;\n          }\n\n          loss = loss_consider;\n          solver.makeConsideredMove();\n          stuckometer = 0;\n          _context.next = 112;\n          break;\n\n        case 110:\n          if (!(++stuckometer > stuckLimit)) {\n            _context.next = 112;\n            break;\n          }\n\n          throw new _optimization_error__WEBPACK_IMPORTED_MODULE_5__[\"OptimizationNoProgressError\"]('Too many unsuccessfull iterations.');\n\n        case 112:\n          _context.next = 40;\n          break;\n\n        case 114:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked);\n}\n\nvar tls_lm_gen = function tls_lm_gen(fjj, p0, dx0, opt) {\n  return _lm(new _trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_7__[\"TrustRegionSolverTLS\"](fjj, p0, dx0), opt);\n};\nvar odr_lm_gen = Object(_trust_region_solver_tls__WEBPACK_IMPORTED_MODULE_7__[\"odr_gen\"])(_lm);\nfunction fit_lm_gen(x, //: float[nSamples,nDim]\ny, //: float[nSamples]\nfg, //: (params: float[nParam]) => (x: float[nDim]) => [f: float, g: float[nParam]],\np0, //: float[nParam]\nopt) {\n  var FloatArray, _p0$shape, P, _x$shape, M, N, x_shape, R, J, RJ, fJ;\n\n  return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function fit_lm_gen$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          if (fg instanceof Function) {\n            _context2.next = 2;\n            break;\n          }\n\n          throw new Error('fit_lm_gen(x,y, fg, p0): fg must be a function.');\n\n        case 2:\n          x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(x); // <- TODO allow non-ndarray x ?\n\n          y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])('float64', y);\n          p0 = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])('float64', p0);\n          FloatArray = Float64Array;\n\n          if (!(x.ndim !== 2)) {\n            _context2.next = 8;\n            break;\n          }\n\n          throw new Error('fit_lm_gen(x,y, fg, p0): x.ndim must be 2.');\n\n        case 8:\n          if (!(y.ndim !== 1)) {\n            _context2.next = 10;\n            break;\n          }\n\n          throw new Error('fit_lm_gen(x,y, fg, p0): y.ndim must be 1.');\n\n        case 10:\n          if (!(p0.ndim !== 1)) {\n            _context2.next = 12;\n            break;\n          }\n\n          throw new Error('fit_lm_gen(x,y, fg, p0): p0.ndim must be 1.');\n\n        case 12:\n          _p0$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(p0.shape, 1), P = _p0$shape[0], _x$shape = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(x.shape, 2), M = _x$shape[0], N = _x$shape[1], x_shape = Int32Array.of(N);\n\n          if (!(M != y.shape[0])) {\n            _context2.next = 15;\n            break;\n          }\n\n          throw new Error('fit_lm_gen(x,y, fg, p0): x.shape[0] must be equal to y.shape[0].');\n\n        case 15:\n          x = x.data.slice(); // <- TODO: TypedArray.subarray could be used here\n\n          y = y.data; // if x is frozen, no protection copies are necessary while passing it to fg\n\n          Object.freeze(x.buffer);\n          x = Array.from({\n            length: M\n          }, function (_, i) {\n            return Object.freeze(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, x.subarray(N * i, N * i + 1)));\n          });\n          Object.freeze(x);\n          R = new FloatArray(M), J = new FloatArray(M * P), RJ = [new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M), R), new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](Int32Array.of(M, P), J)];\n\n          fJ = function fJ(p) {\n            var fgp = fg(p);\n            if (!(fgp instanceof Function)) throw new Error();\n\n            for (var i = M; i-- > 0;) {\n              var _fgp = fgp(x[i]),\n                  _fgp2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_fgp, 2),\n                  f = _fgp2[0],\n                  g = _fgp2[1];\n\n              f = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(f);\n              g = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(g);\n              if (f.ndim !== 0) throw new Error('fit_lm_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (g.ndim !== 1) throw new Error('fit_lm_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              if (g.shape[0] !== P) throw new Error('fit_lm_gen(x,y, fg, p0): fg must have signature float[nParams] => float[nDim] => [float, float[nParams]].');\n              f = f.data[0];\n              g = g.data;\n              if (isNaN(f)) throw new Error('fit_lm_gen(x,y, fg, p0): NaN encountered.');\n              if (g.some(isNaN)) throw new Error('fit_lm_gen(x,y, fg, p0): NaN encountered.');\n              R[i] = f - y[i];\n\n              for (var j = P; j-- > 0;) {\n                J[P * i + j] = g[j];\n              }\n            }\n\n            return RJ;\n          };\n\n          return _context2.delegateYield(lsq_lm_gen(fJ, p0, opt), \"t0\", 23);\n\n        case 23:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2);\n}\n\n//# sourceURL=webpack://nd/./src/opt/lm.js?");

/***/ }),

/***/ "./src/opt/num_grad.js":
/*!*****************************!*\
  !*** ./src/opt/num_grad.js ***!
  \*****************************/
/*! exports provided: num_grad, num_grad_forward */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"num_grad\", function() { return num_grad; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"num_grad_forward\", function() { return num_grad_forward; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n // https://en.wikipedia.org/wiki/Finite_difference#Forward,_backward,_and_central_differences\n// https://www.geometrictools.com/Documentation/FiniteDifferences.pdf\n\nvar NUM_GRAD_D = Float64Array.of(+2, +1, -1, -2),\n    NUM_GRAD_W = Float64Array.of(-1, 8, -8, +1),\n    NUM_GRAD_S = 12;\nvar num_grad = function num_grad(f) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref$h_rel = _ref.h_rel,\n      h_rel = _ref$h_rel === void 0 ? undefined : _ref$h_rel,\n      _ref$h_abs = _ref.h_abs,\n      h_abs = _ref$h_abs === void 0 ? undefined : _ref$h_abs;\n\n  return function (x) {\n    x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float', x);\n    var dtype = x.dtype === 'float32' ? 'float32' : 'float64',\n        DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][dtype],\n        x_shape = x.shape;\n    x = x.data;\n    var g = null,\n        g_shape = null;\n    var epsRel = null != h_rel ? h_rel : Math.pow(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(dtype), 1 / 3),\n        epsAbs = null != h_abs ? h_abs : Math.pow(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(dtype), 1 / 3);\n    var h = Math.max(Math.abs(x[0]) * epsRel, epsAbs); // first function evaluation to determine output shape\n\n    var y = function () {\n      var X = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, DTypeArray.from(x));\n      X.data[0] += h * NUM_GRAD_D[0];\n      return f(X);\n    }();\n\n    if ('number' === typeof y) {\n      // SCALAR OUTPUT\n      // -------------\n      g_shape = x_shape;\n      g = new Float64Array(x.length);\n      g[0] = y * NUM_GRAD_W[0];\n\n      outer_loop: for (var i = 0, j = 1;; j = 0) {\n        for (; j < NUM_GRAD_D.length; j++) {\n          var X = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, DTypeArray.from(x));\n          X.data[i] += h * NUM_GRAD_D[j];\n          y = f(X);\n          g[i] += y * NUM_GRAD_W[j];\n        }\n\n        g[i] /= h * NUM_GRAD_S;\n        if (!(++i < x.length)) break outer_loop;\n        h = Math.max(Math.abs(x[i]) * epsRel, epsAbs);\n      }\n    } else {\n      // ND-ARRAY OUTPUT\n      // ---------------\n      y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float', y);\n      var y_shape = y.shape;\n      y = y.data;\n      var M = y.length,\n          N = x.length;\n      g_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(y_shape).concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(x_shape)));\n      g = new Float64Array(y.length * x.length);\n\n      for (var k = 0; k < M; k++) {\n        g[N * k] = y[k] * NUM_GRAD_W[0];\n      }\n\n      outer_loop: for (var _i = 0, _j = 1;; _j = 0) {\n        for (; _j < NUM_GRAD_D.length; _j++) {\n          var _X = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](x_shape, DTypeArray.from(x));\n\n          _X.data[_i] += h * NUM_GRAD_D[_j];\n          y = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])('float', f(_X));\n          if (y.ndim !== y_shape.length) throw new Error('num_grad(f)(x): return shape of f must be consistent.');\n\n          for (var _i2 = y_shape.length; _i2-- > 0;) {\n            if (y.shape[_i2] !== y_shape[_i2]) throw new Error('num_grad(f)(x): return shape of f must be consistent.');\n          }\n\n          y = y.data;\n\n          for (var _k = 0; _k < M; _k++) {\n            g[N * _k + _i] += y[_k] * NUM_GRAD_W[_j];\n          }\n        }\n\n        for (var _k2 = 0; _k2 < M; _k2++) {\n          g[N * _k2 + _i] /= h * NUM_GRAD_S;\n        }\n\n        if (!(++_i < N)) break outer_loop;\n        h = Math.max(Math.abs(x[_i]) * epsRel, epsAbs);\n      }\n    }\n\n    return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](g_shape, g);\n  };\n};\nvar num_grad_forward = function num_grad_forward(f) {\n  var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref2$h_rel = _ref2.h_rel,\n      h_rel = _ref2$h_rel === void 0 ? undefined : _ref2$h_rel,\n      _ref2$h_abs = _ref2.h_abs,\n      h_abs = _ref2$h_abs === void 0 ? undefined : _ref2$h_abs;\n\n  return function (x) {\n    x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"array\"])(x);\n    var dtype = x.dtype === 'float32' ? 'float32' : 'float64',\n        DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][dtype],\n        shape = x.shape;\n    x = x.data;\n    var g = new DTypeArray(x.length),\n        epsRel = null != h_rel ? h_rel : Math.pow(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(dtype), 1 / 3),\n        epsAbs = null != h_abs ? h_abs : Math.pow(Object(_dt__WEBPACK_IMPORTED_MODULE_3__[\"eps\"])(dtype), 1 / 3);\n    var f0 = f(new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, x.slice()));\n    g.fill(-1.5 * f0); // http://macs.citadel.edu/chenm/344.dir/temp.dir/lect4_1.pdf\n\n    for (var i = x.length; i-- > 0;) {\n      var h = Math.max(Math.abs(x[i]) * epsRel, epsAbs); // TODO maybe a check for h===0 might be sensible\n\n      for (var _i3 = 0, _arr = [[1 * h, +2.0], [2 * h, -0.5]]; _i3 < _arr.length; _i3++) {\n        var _arr$_i = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_arr[_i3], 2),\n            d = _arr$_i[0],\n            w = _arr$_i[1];\n\n        var X = new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, DTypeArray.from(x));\n        X.data[i] += d;\n        g[i] += f(X) * w;\n      }\n\n      g[i] /= h;\n    }\n\n    return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, g);\n  };\n};\n\n//# sourceURL=webpack://nd/./src/opt/num_grad.js?");

/***/ }),

/***/ "./src/opt/optimization_error.js":
/*!***************************************!*\
  !*** ./src/opt/optimization_error.js ***!
  \***************************************/
/*! exports provided: OptimizationError, OptimizationNoProgressError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OptimizationError\", function() { return OptimizationError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OptimizationNoProgressError\", function() { return OptimizationNoProgressError; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__);\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar OptimizationError = /*#__PURE__*/function (_Error) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default()(OptimizationError, _Error);\n\n  var _super = _createSuper(OptimizationError);\n\n  function OptimizationError() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, OptimizationError);\n\n    return _super.apply(this, arguments);\n  }\n\n  return OptimizationError;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default()(Error));\nvar OptimizationNoProgressError = /*#__PURE__*/function (_OptimizationError) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default()(OptimizationNoProgressError, _OptimizationError);\n\n  var _super2 = _createSuper(OptimizationNoProgressError);\n\n  function OptimizationNoProgressError() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, OptimizationNoProgressError);\n\n    return _super2.apply(this, arguments);\n  }\n\n  return OptimizationNoProgressError;\n}(OptimizationError);\n\n//# sourceURL=webpack://nd/./src/opt/optimization_error.js?");

/***/ }),

/***/ "./src/opt/polyquad.js":
/*!*****************************!*\
  !*** ./src/opt/polyquad.js ***!
  \*****************************/
/*! exports provided: roots1d_polyquad */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"roots1d_polyquad\", function() { return roots1d_polyquad; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n// TODO implemented double-dogleg method as well as described in\n// \"An Improved Optimization Method for iSAM2\"\n// Rana Talaei Shahir and Hamid D. Taghirad Senior Member, IEEE\n// Proceeding of the 2nd\n// RSI/ISM International Conference on Robotics and Mechatronics\n// October 15-17, 2014, Tehran, Iran\n// TODO implement dogbox method as well which allows for box-constrained optimization\n\n/* Returns the more positive root of a + bx + cx\n */\n\nfunction roots1d_polyquad(a, b, c) {\n  // https://arxiv.org/abs/1409.8072\n  if (isNaN(a)) throw new Error('roots_quad_poly(a,b,c): a must be number.');\n  if (isNaN(b)) throw new Error('roots_quad_poly(a,b,c): b must be number.');\n  if (isNaN(c)) throw new Error('roots_quad_poly(a,b,c): c must be number.');\n\n  if (0 === c) {\n    var x = -a / b;\n    return [x, x];\n  }\n\n  a /= c;\n  b /= c; // a + bx + x\n\n  if (0 === b) {\n    var _x = Math.sqrt(-a);\n\n    return [-_x, +_x];\n  }\n\n  if (0 === a) return 0 <= b ? [-b, 0] : [0, -b];\n  c = Math.sqrt(Math.abs(a)) * Math.sign(b);\n  b /= 2 * c;\n  var TOL = Number.EPSILON * 1024 * 64;\n  var x1, x2;\n\n  if (0 < a) {\n    if (b < 1 - TOL) throw new Error('Complex roots not yet supported: ' + b); // <- TODO: this should be a custom error\n\n    if (b < 1) b = 1;\n    x1 = -b - Math.sqrt((b + 1) * (b - 1));\n    x2 = +1 / x1;\n  } else {\n    x1 = -b - Math.sqrt(b * b + 1);\n    x2 = -1 / x1;\n  }\n\n  x1 *= c;\n  x2 *= c;\n  return x1 <= x2 ? [x1, x2] : [x2, x1];\n}\n\n//# sourceURL=webpack://nd/./src/opt/polyquad.js?");

/***/ }),

/***/ "./src/opt/root1d_bisect.js":
/*!**********************************!*\
  !*** ./src/opt/root1d_bisect.js ***!
  \**********************************/
/*! exports provided: root1d_bisect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"root1d_bisect\", function() { return root1d_bisect; });\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n // REFERENCES\n// ----------\n// .. [1] https://en.wikipedia.org/wiki/Bisection_method\n\nfunction root1d_bisect(F, x1, x2) {\n  x1 *= 1;\n  x2 *= 1;\n  if (isNaN(x1)) throw new Error('root1d_bisect(F,x1,x2): x1 must be a number.');\n  if (isNaN(x2)) throw new Error('root1d_bisect(F,x1,x2): x2 must be a number.');\n  if (!(F instanceof Function)) throw new Error('root1d_bisect(F,x1,x2): F must be a function.');\n  var f1 = F(x1),\n      f2 = F(x2);\n  if (0 === f1) return x1;\n  if (0 === f2) return x2;\n\n  if (f1 > f2) {\n    var _ref = [f2, f1];\n    f1 = _ref[0];\n    f2 = _ref[1];\n    var _ref2 = [x2, x1];\n    x1 = _ref2[0];\n    x2 = _ref2[1];\n  }\n\n  if (!(f1 < 0)) throw new Error('root1d_bisect(F,x1,x2): F(x1) and F(x2) must have opposite signs.');\n  if (!(f2 > 0)) throw new Error('root1d_bisect(F,x1,x2): F(x1) and F(x2) must have opposite signs.');\n\n  for (;;) {\n    var x = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__[\"midl\"])(x1, x2),\n        f = F(x);\n    if (f === 0) return x;\n    if (x1 === x) break;\n    if (isNaN(f)) throw new Error('NaN encountered.');\n\n    if (f < 0) {\n      x1 = x;\n      f1 = f;\n    }\n\n    if (f > 0) {\n      x2 = x;\n      f2 = f;\n    }\n  }\n\n  return Math.abs(f1) <= Math.abs(f2) ? x1 : x2;\n}\n\n//# sourceURL=webpack://nd/./src/opt/root1d_bisect.js?");

/***/ }),

/***/ "./src/opt/root1d_brent.js":
/*!*********************************!*\
  !*** ./src/opt/root1d_brent.js ***!
  \*********************************/
/*! exports provided: root1d_brent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"root1d_brent\", function() { return root1d_brent; });\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n // REFERENCES\n// ----------\n// .. [1] https://en.wikipedia.org/wiki/Brent's_method\n// .. [2] http://www.netlib.no/netlib/go/zeroin.f\n// .. [3] https://blogs.mathworks.com/cleve/2015/10/26/zeroin-part-2-brents-version/?s_tid=blogs_rc_1\n\nvar min = function min(x, y) {\n  return Math.min(x, y);\n},\n    max = function max(x, y) {\n  return Math.max(x, y);\n},\n    abs = function abs(x) {\n  return Math.abs(x);\n},\n    sign = function sign(x) {\n  return Math.sign(x);\n};\n\nfunction root1d_brent(F, a, b) {\n  a *= 1;\n  b *= 1;\n  if (isNaN(a)) throw new Error('root1d_bisect(F,a,b): a must be a number.');\n  if (isNaN(b)) throw new Error('root1d_bisect(F,a,b): b must be a number.');\n  if (!(F instanceof Function)) throw new Error('root1d_bisect(F,a,b): F must be a function.');\n  var fa = F(a),\n      fb = F(b);\n  if (!(sign(fa) * fb <= 0)) throw new Error('root1d_falsi(F,a,b): F(a) and F(b) must have opposite signs.');\n\n  loop: for (;;) {\n    // interval [b,c] contains the root, where a is a previous iterate or c\n    var c = a,\n        fc = fa,\n        b = b - a,\n        b_old = b;\n\n    do {\n      // fb should be the better than fa (b as in better)\n      if (abs(fc) < abs(fb)) {\n        a = b;\n        b = c;\n        c = a;\n        fa = fb;\n        fb = fc;\n        fc = fa;\n      } // [l,r] = (b,c) is the interval in which we are looking for a new iterate\n\n\n      var l = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__[\"nextUp\"])(min(b, c)),\n          r = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__[\"nextDown\"])(max(b, c));\n      if (r < l || fb === 0) break loop;\n      var bc = c - b; // <- b+xm would be the bisection point, i.e. mid point of [b,c]\n      // see if a bisection is forced (either if no progress or interpolation bad)\n\n      if (abs(b_old) < Number.EPSILON * abs(b) || abs(fa) <= abs(fb)) b_old = b = bc / 2;else {\n        var p = void 0,\n            q = void 0,\n            s = fb / fa;\n\n        if (a === c) {\n          // LINEAR INTERPOLATION\n          p = bc * s;\n          q = 1 - s;\n        } else {\n          // INVERSE QUADRATIC INTERPOLATION\n          var _r = fb / fc;\n\n          q = fa / fc;\n          p = s * (bc * q * (q - _r) - (b - a) * (_r - 1));\n          q = (q - 1) * (_r - 1) * (s - 1);\n        }\n\n        if (p <= 0) p = -p;else q = -q;\n        s = b_old;\n        b_old = b; // same as: if( |b_new| >= 3/4*|c-b|  OR  |b_new| >= |0.5*s| )\n\n        if (4 * p >= 3 * bc * q || p >= abs(0.5 * s * q)) b_old = b = bc / 2;else b = p / q;\n      }\n      a = b;\n      fa = fb;\n      b += b;\n      if (!(b >= l)) b = l;\n      if (!(b <= r)) b = r;\n      fb = F(b);\n    } while (sign(fb) * fc <= 0);\n  }\n\n  return b;\n}\n\n//# sourceURL=webpack://nd/./src/opt/root1d_brent.js?");

/***/ }),

/***/ "./src/opt/root1d_illinois.js":
/*!************************************!*\
  !*** ./src/opt/root1d_illinois.js ***!
  \************************************/
/*! exports provided: root1d_illinois */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"root1d_illinois\", function() { return root1d_illinois; });\n/* harmony import */ var _dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../dt/float64_utils */ \"./src/dt/float64_utils.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n // REFERENCES\n// ----------\n// .. [1] https://en.wikipedia.org/wiki/False_position_method\n// .. [2] \"Improved Algorithms Of Illinois-Type For The Numerical Solution Of Nonlinear Equations\"\n//         J. A. Ford\n//\n\nfunction root1d_illinois(F, x1, x2) {\n  x1 *= 1;\n  x2 *= 1;\n  if (isNaN(x1)) throw new Error('root1d_falsi(F,x1,x2): x1 must be a number.');\n  if (isNaN(x2)) throw new Error('root1d_falsi(F,x1,x2): x2 must be a number.');\n  if (!(F instanceof Function)) throw new Error('root1d_falsi(F,x1,x2): F must be a function.');\n  var f1 = F(x1),\n      f2 = F(x2),\n      F1 = f1;\n  if (0 === f1) return x1;\n  if (0 === f2) return x2;\n  if (!(Math.sign(f1) * f2 < 0)) throw new Error('root1d_falsi(F,x1,x2): F(x1) and F(x2) must have opposite signs.');\n\n  for (;;) {\n    var l = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__[\"nextUp\"])(Math.min(x1, x2)),\n        r = Object(_dt_float64_utils__WEBPACK_IMPORTED_MODULE_0__[\"nextDown\"])(Math.max(x1, x2));\n    if (r < l) break;\n    var x = (x1 * f2 - x2 * f1) / (f2 - f1);\n    if (!(x >= l)) x = l;\n    if (!(x <= r)) x = r;\n    var f = F(x);\n    if (0 === f) return x;\n    if (isNaN(f)) throw new Error('NaN encountered.');\n\n    if (Math.sign(f2) * f < 0) {\n      x1 = x2;\n      x2 = x;\n      f1 = f2;\n      f2 = f;\n      F1 = f1;\n    } else {\n      // const scale = 0.5; // <- ILLINOIS METHOD\n      // let scale = 1 - f/f2; if( scale <= 0 ) scale = 0.5; // <- ANDERSON & BJRK\n      var scale = 1 - f / f2 / (1 - f / f1); // FORD's METHOD 3 (see [2])\n\n      if (!(scale > 0)) // <- handles NaN\n        scale = 0.5;\n      f1 *= scale;\n      x2 = x;\n      f2 = f;\n    }\n  }\n\n  return Math.abs(F1) <= Math.abs(f2) ? x1 : x2;\n}\n\n//# sourceURL=webpack://nd/./src/opt/root1d_illinois.js?");

/***/ }),

/***/ "./src/opt/test_fn/beale.js":
/*!**********************************!*\
  !*** ./src/opt/test_fn/beale.js ***!
  \**********************************/
/*! exports provided: beale */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"beale\", function() { return beale; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n// .. [2] \"A Hybrid Method for Nonlinear Equations\"\n//         M.J.D. Powell\n//         In \"Numerical Methods for Nonlinear Algebratic Equations\", Gordon & Breach, New York, 1970, pp. 87-114\n\nvar beale = function beale(x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('beale(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('beale(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(0, -1),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2);\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = 1.5 - x1 * (1 - x2),\n        f2 = 2.25 - x1 * (1 - x2 * x2),\n        f3 = 2.625 - x1 * (1 - x2 * x2 * x2);\n    F[F_off] = f1 * f1 + f2 * f2 + f3 * f3;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\nbeale.nIn = 2;\nbeale.nOut = 3;\nbeale.minima = beale.minima_global = beale.roots = [[3, 0.5]];\n\nbeale.grad = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('beale.grad(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('beale.grad(x): x.shape[-1] must be 2.');\n  var G_shape = x.shape,\n      G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1];\n    var f1 = 1.5 - x1 * (1 - x2),\n        f2 = 2.25 - x1 * (1 - x2 * x2),\n        f3 = 2.625 - x1 * (1 - x2 * x2 * x2);\n    G[off + 0] = 2 * (f1 * (x2 - 1) + f2 * (x2 * x2 - 1) + f3 * (x2 * x2 * x2 - 1));\n    G[off + 1] = 2 * x1 * (f1 * 1 + x2 * (f2 * 2 + f3 * 3 * x2));\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](G_shape, G);\n};\n\nbeale.hess = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('beale.hess(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('beale.hess(x): x.shape[-1] must be 2.');\n  var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n  x = x.data;\n\n  for (var H_off = H.length, x_off = x.length; (x_off -= 2) >= 0;) {\n    H_off -= 4;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = 1.5 - x1 * (1 - x2),\n        f2 = 2.25 - x1 * (1 - x2 * x2),\n        f3 = 2.625 - x1 * (1 - x2 * x2 * x2);\n    H[H_off + 0] = 2 * ((1 - x2) * (1 - x2) + (1 - x2 * x2) * (1 - x2 * x2) + (1 - x2 * x2 * x2) * (1 - x2 * x2 * x2));\n    H[H_off + 1] = H[H_off + 2] = 2 * (1.5 - (1 - x2) * 2 * x1 + 4.5 * x2 - (1 - x2 * x2) * 4 * x1 * x2 + 7.875 * x2 * x2 - (1 - x2 * x2 * x2) * 6 * x1 * x2 * x2);\n    H[H_off + 3] = 2 * (1 * x1 * x1 + 4 * x1 * x1 * x2 * x2 + f2 * 2 * x1 + 9 * x1 * x1 * x2 * x2 * x2 * x2 + f3 * 6 * x1 * x2);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](H_shape, H);\n};\n\nbeale.lsq = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('beale.lsq(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('beale.lsq(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2 * 3);\n  F_shape[F_shape.length - 1] = 3;\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; (x_off -= 2) >= 0;) {\n    F_off -= 3;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    F[F_off + 0] = 1.5 - x1 * (1 - x2);\n    F[F_off + 1] = 2.25 - x1 * (1 - x2 * x2);\n    F[F_off + 2] = 2.625 - x1 * (1 - x2 * x2 * x2);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\n\nbeale.lsq_jac = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('beale.lsq_jac(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('beale.lsq_jac(x): x.shape[-1] must be 2.');\n  var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape.slice(0, -1)).concat([3, 2])),\n      J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 3);\n  x = x.data;\n\n  for (var x_off = x.length, J_off = J.length; (x_off -= 2) >= 0;) {\n    J_off -= 6;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    J[J_off + 0] = x2 - 1;\n    J[J_off + 1] = 1 * x1;\n    J[J_off + 2] = x2 * x2 - 1;\n    J[J_off + 3] = 2 * x1 * x2;\n    J[J_off + 4] = x2 * x2 * x2 - 1;\n    J[J_off + 5] = 3 * x1 * x2 * x2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](J_shape, J);\n};\n\nObject.freeze(beale);\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/beale.js?");

/***/ }),

/***/ "./src/opt/test_fn/brown_badscale.js":
/*!*******************************************!*\
  !*** ./src/opt/test_fn/brown_badscale.js ***!
  \*******************************************/
/*! exports provided: brown_badscale */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"brown_badscale\", function() { return brown_badscale; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n\nvar brown_badscale = function brown_badscale(x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('brown_badscale(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('brown_badscale(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(0, -1),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2);\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = x1 - 1e+6,\n        f2 = x2 - 2e-6,\n        f3 = x1 * x2 - 2;\n    F[F_off] = f1 * f1 + f2 * f2 + f3 * f3;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\nbrown_badscale.nIn = 2;\nbrown_badscale.nOut = 3;\nbrown_badscale.minima = brown_badscale.minima_global = brown_badscale.roots = [[1e+6, 2e-6]];\n\nbrown_badscale.grad = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('brown_badscale.grad(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('brown_badscale.grad(x): x.shape[-1] must be 2.');\n  var G_shape = x.shape,\n      G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1];\n    var f1 = x1 - 1e+6,\n        f2 = x2 - 2e-6,\n        f3 = x1 * x2 - 2;\n    G[off + 0] = 2 * (f1 + f3 * x2);\n    G[off + 1] = 2 * (f2 + f3 * x1);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](G_shape, G);\n};\n\nbrown_badscale.hess = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('brown_badscale.hess(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('brown_badscale.hess(x): x.shape[-1] must be 2.');\n  var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n  x = x.data;\n\n  for (var H_off = H.length, x_off = x.length; (x_off -= 2) >= 0;) {\n    H_off -= 4;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = x1 - 1e+6,\n        f2 = x2 - 2e-6,\n        f3 = x1 * x2 - 2;\n    H[H_off + 0] = 2 * (1 + x2 * x2);\n    H[H_off + 1] = H[H_off + 2] = 2 * (f3 + x1 * x2);\n    H[H_off + 3] = 2 * (1 + x1 * x1);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](H_shape, H);\n};\n\nbrown_badscale.lsq = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('brown_badscale.lsq(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('brown_badscale.lsq(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2 * 3);\n  F_shape[F_shape.length - 1] = 3;\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; (x_off -= 2) >= 0;) {\n    F_off -= 3;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    F[F_off + 0] = x1 - 1e+6;\n    F[F_off + 1] = x2 - 2e-6;\n    F[F_off + 2] = x1 * x2 - 2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\n\nbrown_badscale.lsq_jac = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('brown_badscale.lsq_jac(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('brown_badscale.lsq_jac(x): x.shape[-1] must be 2.');\n  var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape.slice(0, -1)).concat([3, 2])),\n      J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 3);\n  x = x.data;\n\n  for (var x_off = x.length, J_off = J.length; (x_off -= 2) >= 0;) {\n    J_off -= 6;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    J[J_off + 0] = 1;\n    J[J_off + 1] = 0;\n    J[J_off + 2] = 0;\n    J[J_off + 3] = 1;\n    J[J_off + 4] = x2;\n    J[J_off + 5] = x1;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](J_shape, J);\n};\n\nObject.freeze(brown_badscale);\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/brown_badscale.js?");

/***/ }),

/***/ "./src/opt/test_fn/freudenstein_roth.js":
/*!**********************************************!*\
  !*** ./src/opt/test_fn/freudenstein_roth.js ***!
  \**********************************************/
/*! exports provided: freudenstein_roth */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"freudenstein_roth\", function() { return freudenstein_roth; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n// .. [2] \"Numerical solutions of systems of nonlinear equations\"\n//         F. Freudenstein, B. Roth,\n//         ACM 10, 4 (Oct. 1963), pp. 550-556\n\nvar freudenstein_roth = function freudenstein_roth(x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('freudenstein_roth(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('freudenstein_roth(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(0, -1),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2);\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = -13 + x1 + ((5 - x2) * x2 - 2) * x2,\n        f2 = -29 + x1 + ((1 + x2) * x2 - 14) * x2;\n    F[F_off] = f1 * f1 + f2 * f2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\nfreudenstein_roth.nIn = freudenstein_roth.nOut = 2;\nfreudenstein_roth.roots = [[5, 4]];\nfreudenstein_roth.minima_global = [[5, 4]];\nfreudenstein_roth.minima = [[5, 4], [(53 - Math.sqrt(352)) / 3, (2 - Math.sqrt(22)) / 3]];\n\nfreudenstein_roth.grad = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('freudenstein_roth.grad(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('freudenstein_roth.grad(x): x.shape[-1] must be 2.');\n  var G_shape = x.shape,\n      G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1]; //    const f1 = -13 + x1 + ((5-x2)*x2 - 2)*x2,\n    //          f2 = -29 + x1 + ((1+x2)*x2 -14)*x2,\n    //          d1 = (10-3*x2)*x2 - 2,\n    //          d2 = ( 2+3*x2)*x2 -14\n    //    G[off+0] = 2*(f1+f2);\n    //    G[off+1] = 2*(f1*d1 + f2*d2);\n\n    G[off + 0] = -84 + 4 * x1 + (-32 + 12 * x2) * x2;\n    G[off + 1] = 864 - (32 - 24 * x2) * x1 + (24 + (-240 + (8 + (-40 + 12 * x2) * x2) * x2) * x2) * x2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](G_shape, G);\n};\n\nfreudenstein_roth.hess = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('freudenstein_roth.hess(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('freudenstein_roth.hess(x): x.shape[-1] must be 2.');\n  var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n  x = x.data;\n\n  for (var H_off = H.length, x_off = x.length; (x_off -= 2) >= 0;) {\n    H_off -= 4;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = -13 + x1 + ((5 - x2) * x2 - 2) * x2,\n        f2 = -29 + x1 + ((1 + x2) * x2 - 14) * x2,\n        d1 = (10 - 3 * x2) * x2 - 2,\n        d2 = (2 + 3 * x2) * x2 - 14;\n    H[H_off + 0] = 4;\n    H[H_off + 1] = H[H_off + 2] = -32 + 24 * x2;\n    H[H_off + 3] = f1 * (20 - 12 * x2) + 2 * d1 * d1 + f2 * (4 + 12 * x2) + 2 * d2 * d2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](H_shape, H);\n};\n\nfreudenstein_roth.lsq = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('freudenstein_roth.lsq(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('freudenstein_roth.lsq(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1];\n    F[off + 0] = -13 + x1 + ((5 - x2) * x2 - 2) * x2;\n    F[off + 1] = -29 + x1 + ((1 + x2) * x2 - 14) * x2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\n\nfreudenstein_roth.lsq_jac = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('freudenstein_roth.lsq_jac(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] < 2) throw new Error('freudenstein_roth.lsq_jac(x): x.shape[-1] must be 2.');\n  var N = x.shape[x.ndim - 1],\n      M = (N - 1) * 2;\n  var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * M);\n  x = x.data;\n\n  for (var x_off = x.length, J_off = J.length; (J_off -= 4) >= 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    J[J_off + 0] = 1;\n    J[J_off + 1] = (10 - 3 * x2) * x2 - 2;\n    J[J_off + 2] = 1;\n    J[J_off + 3] = (2 + 3 * x2) * x2 - 14;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](J_shape, J);\n};\n\nObject.freeze(freudenstein_roth);\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/freudenstein_roth.js?");

/***/ }),

/***/ "./src/opt/test_fn/helical_valley.js":
/*!*******************************************!*\
  !*** ./src/opt/test_fn/helical_valley.js ***!
  \*******************************************/
/*! exports provided: helical_valley */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"helical_valley\", function() { return helical_valley; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n// .. [2] \"A rapidly convergent descent method for minimization\"\n//         R. Fletcher, M.J.D. Powell\n//         Comput. J. 6 (1963), 163-168\n\nvar atan2 = function atan2(y, x) {\n  return Math.atan2(y * (x < 0 || Object.is(x, -0) ? -1 : +1), Math.abs(x));\n};\n\nvar helical_valley = function helical_valley(x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('helical_valley(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 3) throw new Error('helical_valley(x): x.shape[-1] must be 3.');\n  var F_shape = x.shape.slice(0, -1),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 3);\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n    x_off -= 3;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1],\n        x3 = x[x_off + 2];\n    var f1 = x3 * 10 - 50 * (atan2(x2, x1) / Math.PI + (x1 < 0)),\n        f2 = 10 * Math.hypot(x2, x1) - 10,\n        f3 = x3;\n    F[F_off] = f1 * f1 + f2 * f2 + f3 * f3;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\nhelical_valley.nIn = helical_valley.nOut = 3;\nhelical_valley.minima = helical_valley.minima_global = helical_valley.roots = [[1, 0, 0]];\n\nhelical_valley.grad = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('helical_valley.grad(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 3) throw new Error('helical_valley.grad(x): x.shape[-1] must be 3.');\n  var G_shape = x.shape,\n      G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 3) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1],\n        x3 = x[off + 2];\n    var f1 = x3 * 10 - 50 * (atan2(x2, x1) / Math.PI + (x1 < 0));\n    G[off + 0] = 100 * (x1 * (2 - 2 / Math.hypot(x2, x1)) + x2 * f1 / (Math.PI * (x2 * x2 + x1 * x1)));\n    G[off + 1] = 100 * (x2 * (2 - 2 / Math.hypot(x2, x1)) - x1 * f1 / (Math.PI * (x2 * x2 + x1 * x1)));\n    G[off + 2] = f1 * 20 + x3 * 2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](G_shape, G);\n};\n\nhelical_valley.hess = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('helical_valley.hess(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 3) throw new Error('helical_valley.hess(x): x.shape[-1] must be 2.');\n  var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([3])),\n      H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 3);\n  x = x.data;\n\n  for (var H_off = H.length, x_off = x.length; (x_off -= 3) >= 0;) {\n    H_off -= 9;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1],\n        x3 = x[x_off + 2];\n    var f1 = x3 * 10 - 50 * (atan2(x2, x1) / Math.PI + (x1 < 0));\n    var dot = x1 * x1 + x2 * x2;\n    H[H_off + 0] = 200 * (1 - x2 * x2 / Math.pow(dot, 1.5) + (25 * x2 / Math.PI - x1 * f1) * x2 / (Math.PI * dot * dot));\n    H[H_off + 1] = 100 / Math.PI * f1 / dot + 200 * x1 * x2 / Math.pow(dot, 1.5) - (5000 * x1 / Math.PI + 200 * x2 * f1) * x2 / (Math.PI * dot * dot);\n    H[H_off + 2] = +1000 / Math.PI * x2 / dot;\n    H[H_off + 3] = H[H_off + 1];\n    H[H_off + 4] = 200 * (1 - x1 * x1 / Math.pow(dot, 1.5) + (25 * x1 / Math.PI + x2 * f1) * x1 / (Math.PI * dot * dot));\n    H[H_off + 5] = -1000 / Math.PI * x1 / dot;\n    H[H_off + 6] = H[H_off + 2];\n    H[H_off + 7] = H[H_off + 5];\n    H[H_off + 8] = 200 + 2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](H_shape, H);\n};\n\nhelical_valley.lsq = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('helical_valley.lsq(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 3) throw new Error('helical_valley.lsq(x): x.shape[-1] must be 3.');\n  var F_shape = x.shape.slice(),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 3) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1],\n        x3 = x[off + 2];\n    F[off + 0] = x3 * 10 - 50 * (atan2(x2, x1) / Math.PI + (x1 < 0));\n    F[off + 1] = 10 * Math.hypot(x2, x1) - 10;\n    F[off + 2] = x3;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\n\nhelical_valley.lsq_jac = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('helical_valley.lsq_jac(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 3) throw new Error('helical_valley.lsq_jac(x): x.shape[-1] must be 3.');\n  var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([3])),\n      J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 3);\n  x = x.data;\n\n  for (var x_off = x.length, J_off = J.length; (x_off -= 3) >= 0;) {\n    J_off -= 9;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    J[J_off + 0] = +50 / Math.PI * x2 / (x2 * x2 + x1 * x1);\n    J[J_off + 1] = -50 / Math.PI * x1 / (x2 * x2 + x1 * x1);\n    J[J_off + 2] = 10;\n    J[J_off + 3] = 10 * x1 / Math.hypot(x2, x1);\n    J[J_off + 4] = 10 * x2 / Math.hypot(x2, x1);\n    J[J_off + 5] = 0;\n    J[J_off + 6] = 0;\n    J[J_off + 7] = 0;\n    J[J_off + 8] = 1;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](J_shape, J);\n};\n\nObject.freeze(helical_valley);\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/helical_valley.js?");

/***/ }),

/***/ "./src/opt/test_fn/index.js":
/*!**********************************!*\
  !*** ./src/opt/test_fn/index.js ***!
  \**********************************/
/*! exports provided: beale, brown_badscale, freudenstein_roth, helical_valley, JennrichSampson, powell_badscale, Rastrigin, Rosenbrock */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _beale__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./beale */ \"./src/opt/test_fn/beale.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"beale\", function() { return _beale__WEBPACK_IMPORTED_MODULE_0__[\"beale\"]; });\n\n/* harmony import */ var _brown_badscale__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brown_badscale */ \"./src/opt/test_fn/brown_badscale.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"brown_badscale\", function() { return _brown_badscale__WEBPACK_IMPORTED_MODULE_1__[\"brown_badscale\"]; });\n\n/* harmony import */ var _freudenstein_roth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./freudenstein_roth */ \"./src/opt/test_fn/freudenstein_roth.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"freudenstein_roth\", function() { return _freudenstein_roth__WEBPACK_IMPORTED_MODULE_2__[\"freudenstein_roth\"]; });\n\n/* harmony import */ var _helical_valley__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helical_valley */ \"./src/opt/test_fn/helical_valley.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"helical_valley\", function() { return _helical_valley__WEBPACK_IMPORTED_MODULE_3__[\"helical_valley\"]; });\n\n/* harmony import */ var _jennrich_sampson__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./jennrich_sampson */ \"./src/opt/test_fn/jennrich_sampson.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JennrichSampson\", function() { return _jennrich_sampson__WEBPACK_IMPORTED_MODULE_4__[\"JennrichSampson\"]; });\n\n/* harmony import */ var _powell_badscale__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./powell_badscale */ \"./src/opt/test_fn/powell_badscale.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"powell_badscale\", function() { return _powell_badscale__WEBPACK_IMPORTED_MODULE_5__[\"powell_badscale\"]; });\n\n/* harmony import */ var _rastrigin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./rastrigin */ \"./src/opt/test_fn/rastrigin.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Rastrigin\", function() { return _rastrigin__WEBPACK_IMPORTED_MODULE_6__[\"Rastrigin\"]; });\n\n/* harmony import */ var _rosenbrock__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./rosenbrock */ \"./src/opt/test_fn/rosenbrock.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Rosenbrock\", function() { return _rosenbrock__WEBPACK_IMPORTED_MODULE_7__[\"Rosenbrock\"]; });\n\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/index.js?");

/***/ }),

/***/ "./src/opt/test_fn/jennrich_sampson.js":
/*!*********************************************!*\
  !*** ./src/opt/test_fn/jennrich_sampson.js ***!
  \*********************************************/
/*! exports provided: JennrichSampson */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JennrichSampson\", function() { return JennrichSampson; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n// .. [2] \"Application of stepwise regression to nonlinear estimation\"\n//         R. I. Jennrich, P. F. Sampson\n//         Technometrics 10 (1968), pp. 64-72\n\nvar JennrichSampson = /*#__PURE__*/function (_Function) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default()(JennrichSampson, _Function);\n\n  var _super = _createSuper(JennrichSampson);\n\n  function JennrichSampson(m) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, JennrichSampson);\n\n    _this = _super.call(this);\n    if (0 !== m % 1) throw new Error(\"new JennrichSampson(m): m not a valid integer.\");\n    if (!(1 < m)) throw new Error(\"new JennrichSampson(m): m must be greater than 1.\");\n\n    var jennrich_sampson_fn = function jennrich_sampson_fn(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      if (x.ndim < 1) throw new Error(\"\".concat(jennrich_sampson_fn.name, \"(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== 2) throw new Error(\"\".concat(jennrich_sampson_fn.name, \"(x): x.shape[-1] must be 2.\"));\n      var F_shape = x.shape.slice(0, -1),\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2);\n      x = x.data;\n      var M = jennrich_sampson_fn.nOut;\n\n      for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n        x_off -= 2;\n        var x1 = x[x_off + 0],\n            x2 = x[x_off + 1];\n        var sum = 0;\n\n        for (var i = M; i-- > 0;) {\n          var fi = 4 + 2 * i - Math.exp((i + 1) * x1) - Math.exp((i + 1) * x2);\n          sum += fi * fi;\n        }\n\n        F[F_off] = sum;\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](F_shape, F);\n    };\n\n    if (m === 10) {\n      jennrich_sampson_fn.minima_global = jennrich_sampson_fn.minima = [[0.25782521321500883, 0.25782521321500883]];\n    }\n\n    jennrich_sampson_fn.roots = [];\n    jennrich_sampson_fn.nOut = m;\n    Object.defineProperty(jennrich_sampson_fn, 'name', {\n      value: \"jennrich_sampson\".concat(m, \"d\"),\n      writable: false\n    });\n    Object.setPrototypeOf(jennrich_sampson_fn, JennrichSampson.prototype);\n    return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(_this, Object.freeze(jennrich_sampson_fn));\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(JennrichSampson, [{\n    key: \"grad\",\n    value: function grad(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".grad(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== 2) throw new Error(\"\".concat(this.name, \".grad(x): x.shape[-1] must be 2.\"));\n      var G_shape = x.shape,\n          G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n      x = x.data;\n      var M = this.nOut;\n\n      for (var off = x.length; off >= 0;) {\n        off -= 2;\n        var x1 = x[off + 0],\n            x2 = x[off + 1];\n        var sum = 0;\n\n        for (var i = M; i-- > 0;) {\n          var fi = 4 + 2 * i - Math.exp((i + 1) * x1) - Math.exp((i + 1) * x2);\n          G[off + 0] -= 2 * fi * (i + 1) * Math.exp((i + 1) * x1);\n          G[off + 1] -= 2 * fi * (i + 1) * Math.exp((i + 1) * x2);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](G_shape, G);\n    }\n  }, {\n    key: \"hess\",\n    value: function hess(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".hess(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== 2) throw new Error(\"\".concat(this.name, \".hess(x): x.shape[-1] must be 2.\"));\n      var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n          H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n      x = x.data;\n      var M = this.nOut;\n\n      for (var H_off = H.length, x_off = x.length; (x_off -= 2) >= 0;) {\n        H_off -= 2 * 2;\n        var x1 = x[x_off + 0],\n            x2 = x[x_off + 1];\n        var sum = 0;\n\n        for (var i = M; i-- > 0;) {\n          var fi = 4 + 2 * i - Math.exp((i + 1) * x1) - Math.exp((i + 1) * x2);\n          H[H_off + 0] += 2 * (i + 1) * (i + 1) * (Math.exp((i + 1) * x1 * 2) - fi * Math.exp((i + 1) * x1));\n          H[H_off + 3] += 2 * (i + 1) * (i + 1) * (Math.exp((i + 1) * x2 * 2) - fi * Math.exp((i + 1) * x2));\n          H[H_off + 1] += 2 * (i + 1) * (i + 1) * Math.exp((i + 1) * (x1 + x2));\n        }\n\n        H[H_off + 2] = H[H_off + 1];\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](H_shape, H);\n    }\n  }, {\n    key: \"lsq\",\n    value: function lsq(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== 2) throw new Error(\"\".concat(this.name, \".lsq(x): x.shape[-1] must be 2.\"));\n      var M = this.nOut;\n      var F_shape = x.shape.slice(),\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2 * M);\n      F_shape[F_shape.length - 1] = M;\n      x = x.data;\n\n      for (var x_off = x.length, F_off = F.length; (F_off -= M) >= 0;) {\n        x_off -= 2;\n        var x1 = x[x_off + 0],\n            x2 = x[x_off + 1];\n\n        for (var i = M; i-- > 0;) {\n          F[F_off + i] = 4 + 2 * i - Math.exp((i + 1) * x1) - Math.exp((i + 1) * x2);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](F_shape, F);\n    }\n  }, {\n    key: \"lsq_jac\",\n    value: function lsq_jac(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var M = this.nOut;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== 2) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.shape[-1] must be 2.\"));\n      var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape.slice(0, -1)).concat([M, 2])),\n          J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * M);\n      x = x.data;\n\n      for (var x_off = x.length, J_off = J.length; (J_off -= M * 2) >= 0;) {\n        x_off -= 2;\n        var x1 = x[x_off + 0],\n            x2 = x[x_off + 1];\n\n        for (var i = M; i-- > 0;) {\n          J[J_off + 2 * i + 0] = -(i + 1) * Math.exp((i + 1) * x1);\n          J[J_off + 2 * i + 1] = -(i + 1) * Math.exp((i + 1) * x2);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](J_shape, J);\n    }\n  }, {\n    key: \"nIn\",\n    get: function get() {\n      return 2;\n    }\n  }]);\n\n  return JennrichSampson;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6___default()(Function));\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/jennrich_sampson.js?");

/***/ }),

/***/ "./src/opt/test_fn/powell_badscale.js":
/*!********************************************!*\
  !*** ./src/opt/test_fn/powell_badscale.js ***!
  \********************************************/
/*! exports provided: powell_badscale */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"powell_badscale\", function() { return powell_badscale; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _root1d_bisect__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../root1d_bisect */ \"./src/opt/root1d_bisect.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n // REFERENCES\n// ----------\n// .. [1] \"Testing Unconstrained Optimization Software\"\n//         Jorge J. Mor, Burton S. Garbow, Kenneth E. Hillstrom\n//         ACM Transactions on Mathematical Software, Vol 7, No. 1, March 1982, pp. 17-41\n// .. [2] \"A Hybrid Method for Nonlinear Equations\"\n//         M.J.D. Powell\n//         In \"Numerical Methods for Nonlinear Algebratic Equations\", Gordon & Breach, New York, 1970, pp. 87-114\n\nvar powell_badscale = function powell_badscale(x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('powell_badscale(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('powell_badscale(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(0, -1),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / 2);\n  x = x.data;\n\n  for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = 1e4 * x1 * x2 - 1,\n        f2 = Math.exp(-x1) + Math.exp(-x2) - 1.0001;\n    F[F_off] = f1 * f1 + f2 * f2;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\npowell_badscale.nIn = powell_badscale.nOut = 2;\n\npowell_badscale.minima_global = powell_badscale.roots = function () {\n  var x1 = 0.0000109815932969981745569,\n      x2 = 9.1061467398665240109;\n  return [[x1, x2], [x2, x1]];\n}();\n\npowell_badscale.minima = function () {\n  var x = Object(_root1d_bisect__WEBPACK_IMPORTED_MODULE_2__[\"root1d_bisect\"])( //    x => 1e4*(1e4*x*x - 1)*x - 2*Math.exp(-2*x) + 1.0001*Math.exp(-x),\n  //    x => 1e4*(1e4*x*x - 1)*x - Math.exp(-x) * (2*Math.exp(-x) - 1.0001),\n  function (x) {\n    return 1e4 * (1e4 * x * x - 1) * x + Math.exp(-x) * (0.0001 - Math.expm1(-x) - Math.exp(-x));\n  }, -0.02, -0.0005);\n  return [].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(powell_badscale.minima_global), [[x, x]]);\n}();\n\npowell_badscale.grad = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('powell_badscale.grad(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('powell_badscale.grad(x): x.shape[-1] must be 2.');\n  var G_shape = x.shape,\n      G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1];\n    var f1 = 1e4 * x1 * x2 - 1,\n        f2 = Math.exp(-x1) + Math.exp(-x2) - 1.0001;\n    G[off + 0] = 2 * (f1 * 1e4 * x2 - f2 * Math.exp(-x1));\n    G[off + 1] = 2 * (f1 * 1e4 * x1 - f2 * Math.exp(-x2));\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](G_shape, G);\n};\n\npowell_badscale.hess = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('powell_badscale.hess(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('powell_badscale.hess(x): x.shape[-1] must be 2.');\n  var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n  x = x.data;\n\n  for (var H_off = H.length, x_off = x.length; (x_off -= 2) >= 0;) {\n    H_off -= 4;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    var f1 = 1e4 * x1 * x2 - 1,\n        f2 = Math.exp(-x1) + Math.exp(-x2) - 1.0001;\n    H[H_off + 0] = 2 * (1e8 * x2 * x2 + f2 * Math.exp(-x1) + Math.exp(-2 * x1));\n    H[H_off + 1] = H[H_off + 2] = 2 * (f1 * 1e4 + 1e8 * x1 * x2 + Math.exp(-x1 - x2));\n    H[H_off + 3] = 2 * (1e8 * x1 * x1 + f2 * Math.exp(-x2) + Math.exp(-2 * x2));\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](H_shape, H);\n};\n\npowell_badscale.lsq = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('powell_badscale.lsq(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('powell_badscale.lsq(x): x.shape[-1] must be 2.');\n  var F_shape = x.shape.slice(),\n      F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n  x = x.data;\n\n  for (var off = x.length; (off -= 2) >= 0;) {\n    var x1 = x[off + 0],\n        x2 = x[off + 1];\n    F[off + 0] = 1e4 * x1 * x2 - 1;\n    F[off + 1] = Math.exp(-x1) + Math.exp(-x2) - 1.0001;\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](F_shape, F);\n};\n\npowell_badscale.lsq_jac = function (x) {\n  x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_1__[\"asarray\"])(x);\n  if (x.ndim < 1) throw new Error('powell_badscale.lsq_jac(x): x.ndim must be at least 1.');\n  if (x.shape[x.ndim - 1] !== 2) throw new Error('powell_badscale.lsq_jac(x): x.shape[-1] must be 2.');\n  var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([2])),\n      J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * 2);\n  x = x.data;\n\n  for (var x_off = x.length, J_off = J.length; (J_off -= 4) >= 0;) {\n    x_off -= 2;\n    var x1 = x[x_off + 0],\n        x2 = x[x_off + 1];\n    J[J_off + 0] = 1e4 * x2;\n    J[J_off + 1] = 1e4 * x1;\n    J[J_off + 2] = -Math.exp(-x1);\n    J[J_off + 3] = -Math.exp(-x2);\n  }\n\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](J_shape, J);\n};\n\nObject.freeze(powell_badscale);\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/powell_badscale.js?");

/***/ }),

/***/ "./src/opt/test_fn/rastrigin.js":
/*!**************************************!*\
  !*** ./src/opt/test_fn/rastrigin.js ***!
  \**************************************/
/*! exports provided: Rastrigin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Rastrigin\", function() { return Rastrigin; });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _iter__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../iter */ \"./src/iter/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _root1d_bisect__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../root1d_bisect */ \"./src/opt/root1d_bisect.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n\n\n // REFERENCES\n// ----------\n// .. [1] https://en.wikipedia.org/wiki/Rastrigin_function\n\nvar NONGLOBAL_MINIMA = function () {\n  var g = function g(x) {\n    return x + Math.PI * 10 * Math.sin(Math.PI * 2 * x);\n  };\n\n  var minima = [];\n\n  for (var x = 1; x < 32; x++) {\n    if (!(g(x - 0.25) < 0)) throw new Error('Assertion failed.');\n    if (!(g(x + 0.25) > 0)) throw new Error('Assertion failed.');\n    minima.push(Object(_root1d_bisect__WEBPACK_IMPORTED_MODULE_11__[\"root1d_bisect\"])(g, x - 0.25, x + 0.25));\n  }\n\n  Object.freeze(minima);\n  return minima;\n}();\n\nvar Rastrigin = /*#__PURE__*/function (_Function) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(Rastrigin, _Function);\n\n  var _super = _createSuper(Rastrigin);\n\n  function Rastrigin(n) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, Rastrigin);\n\n    _this = _super.call(this);\n    if (0 !== n % 1) throw new Error(\"new Rastrigin(n): n not a valid integer.\");\n    if (!(0 < n)) throw new Error(\"new Rastrigin(n): n must be positive.\");\n\n    var rastrigin_fn = function rastrigin_fn(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_10__[\"asarray\"])(x);\n      var N = rastrigin_fn.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(rastrigin_fn.name, \"(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(rastrigin_fn.name, \"(x): x.shape[-1] must be \").concat(N, \".\"));\n      var F_shape = x.shape.slice(0, -1),\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / N);\n      x = x.data;\n\n      for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n        x_off -= N;\n\n        for (var i = N; i-- > 0;) {\n          var xi = x[x_off + i];\n          F[F_off] += xi * xi + 10 * (1 - Math.cos(Math.PI * 2 * xi));\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_10__[\"NDArray\"](F_shape, F);\n    };\n\n    rastrigin_fn.nIn = n;\n    rastrigin_fn.roots = rastrigin_fn.minima_global = [Array.from({\n      length: n\n    }, function () {\n      return 0;\n    })];\n    rastrigin_fn.minima = _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()({}, Symbol.iterator, /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee() {\n      var inner, outer, layer, min, ranges, i;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return Array.from({\n                length: n\n              }, function () {\n                return 0;\n              });\n\n            case 2:\n              outer = [0]; // grow the minima in a hypercube from the inside out\n\n              layer = 0;\n\n            case 4:\n              if (!(layer < NONGLOBAL_MINIMA.length)) {\n                _context.next = 20;\n                break;\n              }\n\n              min = NONGLOBAL_MINIMA[layer];\n              inner = outer;\n              outer = [-min].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(inner), [+min]);\n              ranges = Array.from({\n                length: n\n              }, function () {\n                return outer;\n              });\n              i = 0;\n\n            case 10:\n              if (!(i < n)) {\n                _context.next = 17;\n                break;\n              }\n\n              ranges[i] = [-min, +min];\n              return _context.delegateYield(_iter__WEBPACK_IMPORTED_MODULE_9__[\"cartesian_prod\"].apply(void 0, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(ranges)), \"t0\", 13);\n\n            case 13:\n              ranges[i] = inner;\n\n            case 14:\n              i++;\n              _context.next = 10;\n              break;\n\n            case 17:\n              layer++;\n              _context.next = 4;\n              break;\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    Object.defineProperty(rastrigin_fn, 'name', {\n      value: \"rastrigin\".concat(n, \"d\"),\n      writable: false\n    });\n    Object.setPrototypeOf(rastrigin_fn, Rastrigin.prototype);\n    return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default()(_this, Object.freeze(rastrigin_fn));\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default()(Rastrigin, [{\n    key: \"grad\",\n    value: function grad(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_10__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".grad(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".grad(x): x.shape[-1] must be \").concat(N, \".\"));\n      var G_shape = x.shape,\n          G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n      x = x.data;\n\n      for (var off = x.length; off >= 0;) {\n        off -= N;\n\n        for (var i = N; i-- > 0;) {\n          var xi = x[off + i];\n          G[off + i] = 2 * xi + Math.PI * 20 * Math.sin(Math.PI * 2 * xi);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_10__[\"NDArray\"](G_shape, G);\n    }\n  }, {\n    key: \"hess\",\n    value: function hess(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_10__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".hess(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".hess(x): x.shape[-1] must be \").concat(N, \".\"));\n      var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(x.shape).concat([N])),\n          H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * N);\n      x = x.data;\n\n      for (var H_off = H.length, x_off = x.length; (x_off -= N) >= 0;) {\n        H_off -= N * N;\n\n        for (var i = N; i-- > 0;) {\n          var xi = x[x_off + i];\n          H[H_off + N * i + i] += 2 + Math.PI * Math.PI * 40 * Math.cos(Math.PI * 2 * xi);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_10__[\"NDArray\"](H_shape, H);\n    }\n  }, {\n    key: \"lsq\",\n    value: function lsq(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_10__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".lsq(x): x.shape[-1] must be \").concat(N, \".\"));\n      var F_shape = x.shape,\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n      x = x.data;\n\n      for (var x_off = x.length, F_off = F.length; (F_off -= N) >= 0;) {\n        x_off -= N;\n\n        for (var i = N; i-- > 0;) {\n          var xi = x[x_off + i];\n          F[F_off + i] = Math.sqrt(xi * xi + 10 * (1 - Math.cos(Math.PI * 2 * xi)));\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_10__[\"NDArray\"](F_shape, F);\n    }\n  }, {\n    key: \"lsq_jac\",\n    value: function lsq_jac(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_10__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.shape[-1] must be \").concat(N, \".\"));\n      var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2___default()(x.shape).concat([N])),\n          J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * N);\n      x = x.data;\n\n      for (var x_off = x.length, J_off = J.length; (J_off -= N * N) >= 0;) {\n        x_off -= N;\n\n        for (var i = N; i-- > 0;) {\n          var xi = x[x_off + i];\n          var denom = Math.sqrt(xi * xi + 10 * (1 - Math.cos(Math.PI * 2 * xi)));\n          if (0 !== denom) J[J_off + N * i + i] = (xi + Math.PI * 10 * Math.sin(Math.PI * 2 * xi)) / denom;\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_10__[\"NDArray\"](J_shape, J);\n    }\n  }, {\n    key: \"nOut\",\n    get: function get() {\n      return this.nIn;\n    }\n  }]);\n\n  return Rastrigin;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8___default()(Function));\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/rastrigin.js?");

/***/ }),

/***/ "./src/opt/test_fn/rosenbrock.js":
/*!***************************************!*\
  !*** ./src/opt/test_fn/rosenbrock.js ***!
  \***************************************/
/*! exports provided: Rosenbrock */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Rosenbrock\", function() { return Rosenbrock; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ \"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js\");\n/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/getPrototypeOf.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ \"./node_modules/@babel/runtime/helpers/wrapNativeSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n\nvar Rosenbrock = /*#__PURE__*/function (_Function) {\n  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default()(Rosenbrock, _Function);\n\n  var _super = _createSuper(Rosenbrock);\n\n  function Rosenbrock(n) {\n    var _this;\n\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, Rosenbrock);\n\n    _this = _super.call(this);\n    if (0 !== n % 1) throw new Error(\"new Rosenbrock(n): n not a valid integer.\");\n    if (!(1 < n)) throw new Error(\"new Rosenbrock(n): n must be greater than 1.\");\n\n    var rosenbrock_fn = function rosenbrock_fn(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var N = rosenbrock_fn.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(rosenbrock_fn.name, \"(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(rosenbrock_fn.name, \"(x): x.shape[-1] must be \").concat(N, \".\"));\n      var F_shape = x.shape.slice(0, -1),\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / N);\n      x = x.data;\n\n      for (var x_off = x.length, F_off = F.length; F_off-- > 0;) {\n        x_off -= N;\n\n        for (var i = N - 1; i-- > 0;) {\n          var xj = x[x_off + i + 1],\n              xi = x[x_off + i],\n              u = xj - xi * xi,\n              v = 1 - xi;\n          F[F_off] += 100 * u * u + v * v;\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](F_shape, F);\n    };\n\n    if (n == 2) rosenbrock_fn.minima = [[1, 1]];else if (n == 3) rosenbrock_fn.minima = [[1, 1, 1]];\n    if (n <= 7) rosenbrock_fn.roots = [Array.from({\n      length: n\n    }, function () {\n      return 1;\n    })];\n    if (n <= 7) rosenbrock_fn.minima_global = [Array.from({\n      length: n\n    }, function () {\n      return 1;\n    })];\n    rosenbrock_fn.nIn = n;\n    Object.defineProperty(rosenbrock_fn, 'name', {\n      value: \"rosenbrock\".concat(n, \"d\"),\n      writable: false\n    });\n    Object.setPrototypeOf(rosenbrock_fn, Rosenbrock.prototype);\n    return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(_this, Object.freeze(rosenbrock_fn));\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(Rosenbrock, [{\n    key: \"grad\",\n    value: function grad(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".grad(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".grad(x): x.shape[-1] must be \").concat(N, \".\"));\n      var G_shape = x.shape,\n          G = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length);\n      x = x.data;\n\n      for (var off = x.length; off >= 0;) {\n        off -= N;\n\n        for (var i = N; i-- > 0;) {\n          var xh = x[off + i - 1],\n              xi = x[off + i],\n              xj = x[off + i + 1];\n          if (i < N - 1) G[off + i] = 400 * (xi * xi - xj) * xi - 2 * (1 - xi);\n          if (0 < i) G[off + i] += 200 * (xi - xh * xh);\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](G_shape, G);\n    }\n  }, {\n    key: \"hess\",\n    value: function hess(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var N = this.nIn;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".hess(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".hess(x): x.shape[-1] must be \").concat(N, \".\"));\n      var H_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape).concat([N])),\n          H = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * N);\n      x = x.data;\n\n      for (var H_off = H.length, x_off = x.length; (x_off -= N) >= 0;) {\n        H_off -= N * N;\n\n        for (var i = N; i-- > 0;) {\n          if (0 < i) {\n            H[H_off + N * i + i] = 200;\n            H[H_off + N * (i - 1) + i] = H[H_off + N * i + (i - 1)] = -400 * x[x_off + i - 1];\n          }\n\n          if (i < N - 1) {\n            var xi = x[x_off + i];\n            H[H_off + N * i + i] -= 400 * x[x_off + i + 1] - 1200 * xi * xi - 2;\n          }\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](H_shape, H);\n    }\n  }, {\n    key: \"lsq\",\n    value: function lsq(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var N = this.nIn,\n          M = this.nOut;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".lsq(x): x.shape[-1] must be \").concat(N, \".\"));\n      var F_shape = x.shape.slice(),\n          F = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length / N * M);\n      F_shape[F_shape.length - 1] = M;\n      x = x.data;\n\n      for (var x_off = x.length, F_off = F.length; (F_off -= M) >= 0;) {\n        x_off -= N;\n\n        for (var i = N - 1; i-- > 0;) {\n          var xj = x[x_off + i + 1],\n              xi = x[x_off + i],\n              u = xj - xi * xi,\n              v = 1 - xi;\n          F[F_off + 2 * i + 0] = u * 10;\n          F[F_off + 2 * i + 1] = v;\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](F_shape, F);\n    }\n  }, {\n    key: \"lsq_jac\",\n    value: function lsq_jac(x) {\n      x = Object(_nd_array__WEBPACK_IMPORTED_MODULE_7__[\"asarray\"])(x);\n      var N = this.nIn,\n          M = this.nOut;\n      if (x.ndim < 1) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.ndim must be at least 1.\"));\n      if (x.shape[x.ndim - 1] !== N) throw new Error(\"\".concat(this.name, \".lsq_jac(x): x.shape[-1] must be \").concat(N, \".\"));\n      var J_shape = Int32Array.of.apply(Int32Array, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(x.shape.slice(0, -1)).concat([M, N])),\n          J = new (x.dtype === 'float32' ? Float32Array : Float64Array)(x.data.length * M);\n      x = x.data;\n\n      for (var x_off = x.length, J_off = J.length; (J_off -= M * N) >= 0;) {\n        x_off -= N;\n\n        for (var i = N - 1; i-- > 0;) {\n          var j = i + 1,\n              xj = x[x_off + j],\n              xi = x[x_off + i];\n          J[J_off + N * (2 * i + 0) + i] += -20 * xi;\n          J[J_off + N * (2 * i + 0) + j] += 10;\n          J[J_off + N * (2 * i + 1) + i] -= 1;\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_7__[\"NDArray\"](J_shape, J);\n    }\n  }, {\n    key: \"nOut\",\n    get: function get() {\n      return this.nIn * 2 - 2;\n    }\n  }]);\n\n  return Rosenbrock;\n}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6___default()(Function));\n\n//# sourceURL=webpack://nd/./src/opt/test_fn/rosenbrock.js?");

/***/ }),

/***/ "./src/rand/alea_rng.js":
/*!******************************!*\
  !*** ./src/rand/alea_rng.js ***!
  \******************************/
/*! exports provided: AleaRNG */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AleaRNG\", function() { return AleaRNG; });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _la_giv_rot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../la/_giv_rot */ \"./src/la/_giv_rot.js\");\n/* harmony import */ var _test_data_generators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../_test_data_generators */ \"./src/_test_data_generators.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\nvar mul32 = Math.pow(2, +32),\n    div32 = Math.pow(2, -32),\n    div53 = Math.pow(2, -53); // Slightly modified version of the Mash hashing algorithm as implemented by Johanne Baage.\n// Sadly Baagoe's original blog posts (http://baagoe.com/en/RandomMusings/hash/avalanche.xhtml)\n// are not available anymore. This hashing algorithm has the desireable \"Avalanche Effect\" property\n// which mean each change in an input bit on average changes 50% of the output (hash value) bits.\n// See: https://en.wikipedia.org/wiki/Avalanche_effect.\n\nfunction mash(str, seed) {\n  str = str.toString();\n\n  for (var i = 0; i < str.length; i++) {\n    seed += str.charCodeAt(i);\n    var temp = 0.02519603282416938 * seed;\n    seed = temp >>> 0;\n    temp -= seed;\n    temp *= seed;\n    seed = temp >>> 0;\n    temp -= seed;\n    seed += temp * mul32;\n  }\n\n  return seed;\n} // Slightly modernized version of the Alea pseudo-random number generator by Johanne Baage.\n// Sadly Baagoe's original blog posts (http://baagoe.com/en/RandomMusings/javascript/) are not\n// available anymore. There is however a partial mirror of his site on GitHub:\n//\n//   https://github.com/nquinlan/better-random-numbers-for-javascript-mirror\n//\n\n\nvar AleaRNG = /*#__PURE__*/function () {\n  function AleaRNG(seed) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, AleaRNG);\n\n    if (seed == null) throw new Error('Assertion failed.');\n    seed = seed.toString();\n    var s0 = mash(' ', 0xefc8249d),\n        s1 = mash(' ', s0),\n        s2 = mash(' ', s1),\n        t0 = mash(seed, s2),\n        t1 = mash(seed, t0),\n        t2 = mash(seed, t1);\n    s0 >>>= 0;\n    s0 -= t0 >>> 0;\n    s0 *= div32;\n    s0 += s0 < 0;\n    s1 >>>= 0;\n    s1 -= t1 >>> 0;\n    s1 *= div32;\n    s1 += s1 < 0;\n    s2 >>>= 0;\n    s2 -= t2 >>> 0;\n    s2 *= div32;\n    s2 += s2 < 0; // this#nextNormal = NaN;\n\n    Object.assign(this, {\n      s0: s0,\n      s1: s1,\n      s2: s2,\n      c: 1,\n      __nextNormal: NaN\n    });\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(AleaRNG, [{\n    key: \"__next\",\n    value: function __next() {\n      var t = 2091639 * this.s0 + this.c * div32;\n      this.s0 = this.s1;\n      this.s1 = this.s2;\n      return this.s2 = t - (this.c = t | 0);\n    }\n  }, {\n    key: \"bool\",\n    value: function bool() {\n      return this.uniform() < 0.0;\n    }\n  }, {\n    key: \"int\",\n    value: function int(from, until) {\n      if (until === undefined) {\n        until = from;\n        from = 0;\n      }\n\n      if (from % 1 !== 0) throw new Error('AlreaRNG::int(from,until): from must be a valid int.');\n      if (until % 1 !== 0) throw new Error('AlreaRNG::int(from,until): until must be a valid int.');\n      if (!(from < until)) throw new Error('AlreaRNG::int(from,until): from must be less than until.');\n      return Math.floor(this.uniform(from, until));\n    }\n  }, {\n    key: \"shuffle\",\n    value: function shuffle(array, from, until) {\n      if (array.length % 1 !== 0) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): array must be Array-like.');\n      if (!(array.length >= 0)) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): array must be Array-like.');\n      if (null == from) from = 0;\n      if (null == until) until = array.length;\n      if (0 !== from % 1) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): from must be int.');\n      if (0 !== until % 1) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): until must be int.');\n      if (!(from >= 0)) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): from must be non-negative.');\n      if (!(from <= until)) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): from must not be greater than until.');\n      if (!(array.length >= until)) throw new Error('AlreaRNG::normal(array,from=0,until=array.length): until must not be greater than array.length.'); // https://en.wikipedia.org/wiki/Fisher-Yates_shuffle\n\n      for (var i = from; i < until - 1; i++) {\n        var j = this[\"int\"](i, until),\n            aj = array[j];\n        array[j] = array[i];\n        array[i] = aj;\n      }\n    }\n  }, {\n    key: \"uniform\",\n    value: function uniform() {\n      var lo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n      var hi = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : +1;\n      lo *= 1;\n      if (!isFinite(lo)) throw new Error('Assertion failed.');\n      hi *= 1;\n      if (!isFinite(hi)) throw new Error('Assertion failed.');\n      var s = this.__next() + (this.__next() * 0x200000 | 0) * div53;\n      return lo * (1 - s) + s * hi;\n    }\n  }, {\n    key: \"normal\",\n    value: function normal() {\n      var mean = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var sigma = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      mean *= 1;\n      if (!isFinite(mean)) throw new Error('AlreaRNG::normal(mean,sigma): mean must be valid number.');\n      sigma *= 1;\n      if (!isFinite(sigma)) throw new Error('AlreaRNG::normal(mean,sigma): sigma must be valid number.');\n      var nxt = this.__nextNormal;\n\n      if (!isNaN(nxt)) {\n        this.__nextNormal = NaN;\n        return nxt * sigma + mean;\n      } // https://en.wikipedia.org/wiki/Marsaglia_polar_method\n\n\n      var x, y, r;\n\n      do {\n        x = this.uniform();\n        y = this.uniform();\n        r = x * x + y * y;\n      } while (r > 1 || r == 0);\n\n      var z = Math.sqrt(-2 * Math.log(r) / r);\n      this.__nextNormal = z * x;\n      return mean + z * y * sigma;\n    }\n  }, {\n    key: \"ortho\",\n    value: function ortho(dtype) {\n      for (var _len = arguments.length, shape = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        shape[_key - 1] = arguments[_key];\n      }\n\n      // REFERENCES:\n      //   - https://blogs.sas.com/content/iml/2012/03/28/generating-a-random-orthogonal-matrix.html\n      if (!(dtype in _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"])) {\n        shape.unshift(dtype);\n        dtype = 'float64';\n      }\n\n      if (shape.length < 1) throw new Error(\"AlreaRNG::orthogonal([dtype,] ...shape): shape.length must be at least 1.\");\n      if (shape.length === 1) shape.push(shape[0]);\n\n      for (var i = shape.length; i-- > 0;) {\n        if (shape[i] % 1 !== 0 || shape[i] < 1) throw new Error(\"AlreaRNG::orthogonal([dtype,] ...shape): shape[\".concat(i, \"] = \").concat(shape[i], \" not a positive integer.\"));\n      }\n\n      shape = Int32Array.from(shape);\n\n      var _shape$subarray = shape.subarray(-2),\n          _shape$subarray2 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_shape$subarray, 2),\n          M = _shape$subarray2[0],\n          N = _shape$subarray2[1],\n          K = Math.max(M, N),\n          L = Math.min(M, N);\n\n      var DTypeArray = _dt__WEBPACK_IMPORTED_MODULE_3__[\"ARRAY_TYPES\"][dtype],\n          U = new DTypeArray(shape.reduce(function (x, y) {\n        return x * y;\n      })),\n          Q = new Float64Array(K * L);\n\n      for (var U_off = U.length; (U_off -= M * N) >= 0;) {\n        // INIT Q TO IDENTITY\n        for (var _i = K; _i-- > 0;) {\n          for (var j = L; j-- > 0;) {\n            Q[L * _i + j] = _i !== j ? 0 : this.bool() ? -1 : +1;\n          }\n        } // <- randomly flips sign of det(Q)\n        // PSEUDO QR DECOMPOSITION\n        // -----------------------\n        // A vector with random entries drawn from a normal distribution multiplied by\n        // an orthogonal matrix results in another vector with random normal entries.\n        // This fact allows us to draw the entries of the QR decomposed matrix \"on-the-fly\",\n        // avoiding the memory and computation overhead of the decomposed matrix.\n\n\n        for (var _j = 0; _j < K; _j++) {\n          var A_jj = this.normal();\n\n          for (var _i2 = _j; ++_i2 < K;) {\n            var A_ij = this.normal(),\n                _giv_rot_qr2 = Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_qr\"])(A_jj, A_ij),\n                _giv_rot_qr3 = _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_giv_rot_qr2, 3),\n                c = _giv_rot_qr3[0],\n                s = _giv_rot_qr3[1],\n                norm = _giv_rot_qr3[2];\n\n            if (0 === s) continue;\n            A_jj = norm;\n\n            Object(_la_giv_rot__WEBPACK_IMPORTED_MODULE_5__[\"_giv_rot_rows\"])(Q, Math.min(_i2 + 1, L), L * _j, L * _i2, c, s);\n          }\n        } // COPY Q -> U (potentially transposing the entries)\n\n\n        for (var _i3 = K; _i3-- > 0;) {\n          for (var _j2 = L; _j2-- > 0;) {\n            U[U_off + (M < N ? N * _j2 + _i3 : N * _i3 + _j2)] = Q[L * _i3 + _j2];\n          }\n        }\n      }\n\n      return new _nd_array__WEBPACK_IMPORTED_MODULE_4__[\"NDArray\"](shape, U);\n    }\n  }]);\n\n  return AleaRNG;\n}();\n\n//# sourceURL=webpack://nd/./src/rand/alea_rng.js?");

/***/ }),

/***/ "./src/rand/index.js":
/*!***************************!*\
  !*** ./src/rand/index.js ***!
  \***************************/
/*! exports provided: AleaRNG */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _alea_rng__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./alea_rng */ \"./src/rand/alea_rng.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AleaRNG\", function() { return _alea_rng__WEBPACK_IMPORTED_MODULE_0__[\"AleaRNG\"]; });\n\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n//# sourceURL=webpack://nd/./src/rand/index.js?");

/***/ }),

/***/ "./src/rand_normal.js":
/*!****************************!*\
  !*** ./src/rand_normal.js ***!
  \****************************/
/*! exports provided: rand_normal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rand_normal\", function() { return rand_normal; });\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n//export function rand_normal()\n//{\n//  // https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform\n//  const x = Math.random() / (1 - Number.EPSILON) + Number.MIN_VALUE,\n//        y = Math.random();\n//\n//  return Math.sqrt(-2 * Math.log(x)) * Math.cos(Math.PI*2 * y);\n//}\n\nvar WARN = true;\nvar rand_normal = function () {\n  var next = NaN;\n  return function () {\n    if (WARN) {\n      WARN = false;\n      console.warn(new Error('nd.rand_normal is deprecated, use nd.rand.AleaRNG instead.'));\n    }\n\n    if (!isNaN(next)) {\n      var nxt = next;\n      next = NaN;\n      return nxt;\n    } // https://en.wikipedia.org/wiki/Marsaglia_polar_method\n\n\n    var x, y, r;\n\n    do {\n      x = Math.random() * 2 - 1;\n      y = Math.random() * 2 - 1;\n      r = x * x + y * y;\n    } while (r > 1 || r == 0);\n\n    var z = Math.sqrt(-2 * Math.log(r) / r);\n    next = z * x;\n    return z * y;\n  };\n}();\n\n//# sourceURL=webpack://nd/./src/rand_normal.js?");

/***/ }),

/***/ "./src/spatial/_nary_heap.js":
/*!***********************************!*\
  !*** ./src/spatial/_nary_heap.js ***!
  \***********************************/
/*! exports provided: NAryHeap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NAryHeap\", function() { return NAryHeap; });\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nvar ARITY = 8,\n    child = function child(parent) {\n  return 1 + parent * ARITY;\n},\n    parent = function parent(child) {\n  return (child - 1) / ARITY | 0;\n};\n\nvar NAryHeap = /*#__PURE__*/function () {\n  function NAryHeap() {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, NAryHeap);\n\n    this._heap = [];\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(NAryHeap, [{\n    key: \"add\",\n    value: function add(item) {\n      if (!('key' in item)) throw new Error('Assertion failed.');\n      var heap = this._heap;\n      heap.push(item); // SIFT UP\n\n      var i = heap.length - 1;\n\n      for (;;) {\n        var p = parent(i);\n        if (i === 0 || item.key >= heap[p].key) break;\n        heap[i] = heap[p];\n        i = p;\n      }\n\n      heap[i] = item;\n    }\n  }, {\n    key: \"popMin\",\n    value: function popMin() {\n      var heap = this._heap,\n          result = heap[0],\n          filler = heap.pop(); // <- fill the root with the rightmost entry (then we sift it down again)\n      // SIFT DOWN\n\n      if (0 < heap.length) for (var i = 0;;) {\n        var p = i;\n        heap[i] = filler;\n        var c = child(i); // find largest child that is larger than the filler\n\n        var C = Math.min(c + ARITY, heap.length);\n\n        for (; c < C; c++) {\n          if (heap[c].key < heap[i].key) i = c;\n        }\n\n        if (i === p) break;\n        heap[p] = heap[i]; // <- move smallest value to root/parent\n      }\n      return result;\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return this._heap.length;\n    }\n  }, {\n    key: \"min\",\n    get: function get() {\n      return this._heap[0];\n    }\n  }]);\n\n  return NAryHeap;\n}();\n\n//# sourceURL=webpack://nd/./src/spatial/_nary_heap.js?");

/***/ }),

/***/ "./src/spatial/index.js":
/*!******************************!*\
  !*** ./src/spatial/index.js ***!
  \******************************/
/*! exports provided: KDTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _kd_tree__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kd_tree */ \"./src/spatial/kd_tree.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"KDTree\", function() { return _kd_tree__WEBPACK_IMPORTED_MODULE_0__[\"KDTree\"]; });\n\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n//# sourceURL=webpack://nd/./src/spatial/index.js?");

/***/ }),

/***/ "./src/spatial/kd_tree.js":
/*!********************************!*\
  !*** ./src/spatial/kd_tree.js ***!
  \********************************/
/*! exports provided: KDTree */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KDTree\", function() { return KDTree; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _test_data_generators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../_test_data_generators */ \"./src/_test_data_generators.js\");\n/* harmony import */ var _arrays_is_array__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../arrays/is_array */ \"./src/arrays/is_array.js\");\n/* harmony import */ var _la_norm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../la/norm */ \"./src/la/norm.js\");\n/* harmony import */ var _nary_heap__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_nary_heap */ \"./src/spatial/_nary_heap.js\");\n\n/* This file is part of ND4JS.\n *\n * ND4JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND4JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND4JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n // TODO:\n//   - Add NDArray support\n\nvar EUCLIDEAN_DISTANCE = function EUCLIDEAN_DISTANCE(x, y) {\n  var len = x.length;\n  if (len !== y.length) throw new Error('Assertion failed.');\n  var norm = new _la_norm__WEBPACK_IMPORTED_MODULE_6__[\"FrobeniusNorm\"]();\n\n  for (var i = len; i-- > 0;) {\n    norm.include(x[i] - y[i]);\n  }\n\n  return norm.result;\n};\n\nvar Branch = function Branch(axis, threshold, c0, c1) {\n  _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, Branch);\n\n  Object.assign(this, {\n    axis: axis,\n    threshold: threshold,\n    c0: c0,\n    c1: c1\n  });\n  Object.seal(this);\n};\n\nvar Leaf = function Leaf(point) {\n  _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, Leaf);\n\n  this.point = point;\n  Object.seal(this);\n};\n\nvar HeapedBranch = function HeapedBranch(distance, branch, nearest) {\n  _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, HeapedBranch);\n\n  this.key = distance;\n  this.nearest = nearest;\n  Object.assign(this, branch);\n  Object.seal(this);\n};\n\nvar HeapedLeaf = function HeapedLeaf(distance, leaf) {\n  _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, HeapedLeaf);\n\n  this.key = distance;\n  this.point = leaf.point;\n  Object.seal(this);\n};\n\nvar KDTree = /*#__PURE__*/function () {\n  function KDTree(points) {\n    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this, KDTree);\n\n    points = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(points);\n    var ndim = points[0].length;\n    if (points.some(function (pt) {\n      return pt.length !== ndim;\n    })) throw new Error('new KDTree(points): points must be iterable of (typed) arrays of same length (NDArrays are not yet supported).');\n    if (points.some(function (pt) {\n      return !Object(_arrays_is_array__WEBPACK_IMPORTED_MODULE_5__[\"is_array\"])(pt);\n    })) throw new Error('new KDTree(points): points must be iterable of (typed) arrays of same length (NDArrays are not yet supported).');\n\n    var swap = function swap(i, j) {\n      //*DEBUG*/      if( !(i >= start) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(j >= start) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(i <  stop ) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(j <  stop ) ) throw new Error('Assertion failed.');\n      var magnum_pi = points[i];\n      points[i] = points[j];\n      points[j] = magnum_pi;\n    };\n\n    this.root = function build_tree(axis, start, stop) {\n      //*DEBUG*/      if( !(start >= 0            ) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(start <  points.length) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(stop  >  start        ) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(stop  <= points.length) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(axis >= 0  ) ) throw new Error('Assertion failed.');\n      //*DEBUG*/      if( !(axis < ndim) ) throw new Error('Assertion failed.');\n      if (1 === stop - start) return new Leaf(points[start]);\n\n      for (;;) {\n        // random split very similar to the quick select algorithm\n        var threshold = points[Object(_test_data_generators__WEBPACK_IMPORTED_MODULE_4__[\"_rand_int\"])(start, stop)][axis]; // partition using the threshold\n\n\n        var l = start,\n            r = start;\n\n        for (var i = start; i < stop; i++) {\n          var pi = points[i][axis];\n\n          if (pi <= threshold) {\n            swap(i, r);\n            if (pi < threshold) swap(l++, r);\n            r++;\n          }\n        } //*DEBUG*/        if( !(l >= start) ) throw new Error('Assertion failed.');\n        //*DEBUG*/        if( !(l <= r    ) ) throw new Error('Assertion failed.');\n        //*DEBUG*/        if( !(r <= stop ) ) throw new Error('Assertion failed.');\n        //*DEBUG*/        for( let i=start; i <  l   ; i++ ) if( ! (points[i][axis] < threshold) ) throw new Error('Assertion failed.');\n        //*DEBUG*/        for( let i=r    ; i <  stop; i++ ) if( ! (points[i][axis] > threshold) ) throw new Error('Assertion failed.');\n        //*DEBUG*/        for( let i=l    ; i <  r   ; i++ ) if( ! (points[i][axis]===threshold) ) throw new Error('Assertion failed.');\n\n\n        var mid = start + stop >>> 1;\n        mid = Math.max(mid, l);\n        mid = Math.min(mid, r);\n        var ax = (axis + 1) % ndim;\n        return new Branch(axis, threshold, build_tree(ax, start, mid), build_tree(ax, mid, stop));\n      }\n    }(0, 0, points.length);\n\n    Object.seal(this);\n  }\n\n  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(KDTree, [{\n    key: \"nearest_gen\",\n    value: /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function nearest_gen(queryPoint) {\n      var heap, enqueue, item, nearest, axis, threshold, c0, c1, n0, n1;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function nearest_gen$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              heap = new _nary_heap__WEBPACK_IMPORTED_MODULE_7__[\"NAryHeap\"]();\n\n              enqueue = function enqueue(nearest, node) {\n                return heap.add(node instanceof Branch ? new HeapedBranch(EUCLIDEAN_DISTANCE(queryPoint, nearest), node, nearest) : new HeapedLeaf(EUCLIDEAN_DISTANCE(queryPoint, node.point), node));\n              };\n\n              enqueue(queryPoint, this.root);\n\n            case 3:\n              if (!(heap.size > 0)) {\n                _context.next = 18;\n                break;\n              }\n\n              item = heap.popMin();\n\n              if (!(item instanceof HeapedBranch)) {\n                _context.next = 14;\n                break;\n              }\n\n              nearest = item.nearest, axis = item.axis, threshold = item.threshold, c0 = item.c0, c1 = item.c1;\n              n0 = nearest, n1 = nearest;\n\n              if (nearest[axis] > threshold) {\n                n0 = n0.slice();\n                n0[axis] = threshold;\n              }\n\n              if (nearest[axis] < threshold) {\n                n1 = n1.slice();\n                n1[axis] = threshold;\n              }\n\n              enqueue(n0, c0);\n              enqueue(n1, c1);\n              _context.next = 16;\n              break;\n\n            case 14:\n              _context.next = 16;\n              return item.point;\n\n            case 16:\n              _context.next = 3;\n              break;\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, nearest_gen, this);\n    })\n  }]);\n\n  return KDTree;\n}();\n\n//# sourceURL=webpack://nd/./src/spatial/kd_tree.js?");

/***/ }),

/***/ "./src/stack.js":
/*!**********************!*\
  !*** ./src/stack.js ***!
  \**********************/
/*! exports provided: stack */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"stack\", function() { return stack; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _concat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./concat */ \"./src/concat.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction stack(axis, dtype, ndarrays) {\n  if (null == ndarrays) {\n    if (null == dtype) {\n      ndarrays = axis;\n      axis = undefined;\n    } else {\n      ndarrays = dtype;\n      dtype = undefined;\n\n      if ('string' === typeof axis) {\n        dtype = axis;\n        axis = undefined;\n      }\n    }\n  }\n\n  ndarrays = Array.from(ndarrays, function (arr) {\n    return Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(dtype, arr);\n  });\n  if (null == axis) axis = 0;\n  if (0 > axis) axis += ndarrays[0].shape.length + 1;\n  if (0 > axis || axis > ndarrays[0].shape.length) throw new Error('Axis out of bounds.');\n  ndarrays = ndarrays.map(function (arr) {\n    return arr.reshape.apply(arr, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(arr.shape.slice(0, axis)).concat([1], _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(arr.shape.slice(axis))));\n  });\n  return Object(_concat__WEBPACK_IMPORTED_MODULE_1__[\"concat\"])(axis, dtype, ndarrays);\n}\n\n//# sourceURL=webpack://nd/./src/stack.js?");

/***/ }),

/***/ "./src/tabulate.js":
/*!*************************!*\
  !*** ./src/tabulate.js ***!
  \*************************/
/*! exports provided: tabulate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tabulate\", function() { return tabulate; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./nd_array */ \"./src/nd_array.js\");\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dt */ \"./src/dt/index.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\nfunction tabulate(shape, dtype, idx2val) {\n  shape = Int32Array.from(shape, function (s) {\n    if (s % 1 !== 0) throw new Error(\"tabulate(shape, dtype='object', idx2val): Invalid shape [\".concat(shape, \"].\"));\n    return s;\n  });\n\n  if (null == idx2val) {\n    idx2val = dtype;\n    dtype = undefined;\n  }\n\n  if (null == idx2val) throw new Error(\"tabulate(shape, dtype='object', idx2val): idx2val missing.\");\n  if (null == dtype) dtype = 'object';\n\n  Object(_dt__WEBPACK_IMPORTED_MODULE_2__[\"_check_dtype\"])(dtype);\n\n  var multi_idx = new Int32Array(shape.length),\n      // <- index in result\n  data = new _dt__WEBPACK_IMPORTED_MODULE_2__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1));\n  var flat_idx = 0;\n\n  function write(d) {\n    if (d === shape.length) data[flat_idx++] = idx2val.apply(void 0, _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(multi_idx));else for (multi_idx[d] = 0; multi_idx[d] < shape[d]; multi_idx[d]++) {\n      write(d + 1);\n    }\n  }\n\n  write(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_1__[\"NDArray\"](shape, data);\n}\n\n//# sourceURL=webpack://nd/./src/tabulate.js?");

/***/ }),

/***/ "./src/zip_elems.js":
/*!**************************!*\
  !*** ./src/zip_elems.js ***!
  \**************************/
/*! exports provided: zip_elems */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"zip_elems\", function() { return zip_elems; });\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dt */ \"./src/dt/index.js\");\n/* harmony import */ var _nd_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./nd_array */ \"./src/nd_array.js\");\n\n/* This file is part of ND.JS.\n *\n * ND.JS is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ND.JS is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\nfunction zip_elems(ndarrays, dtype, zip_fn) {\n  // PREPROCESS ARGUMENTS\n  if (null == zip_fn && dtype instanceof Function) {\n    zip_fn = dtype;\n    dtype = undefined;\n  }\n\n  if (!(ndarrays instanceof Array)) ndarrays = _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(ndarrays);\n  ndarrays = ndarrays.map(function (a) {\n    return Object(_nd_array__WEBPACK_IMPORTED_MODULE_2__[\"asarray\"])(a);\n  });\n  if (null == dtype) dtype = 'object';\n\n  if (null == zip_fn) {\n    if ('object' !== dtype) throw new Error('If zip_fn is undefined, dtype must be \"object\" or undefined.');\n    var L = ndarrays.length;\n\n    zip_fn = function zip_fn() {\n      for (var _len = arguments.length, x = new Array(_len), _key = 0; _key < _len; _key++) {\n        x[_key] = arguments[_key];\n      }\n\n      return x.slice(0, L);\n    };\n  }\n\n  Object(_dt__WEBPACK_IMPORTED_MODULE_1__[\"_check_dtype\"])(dtype);\n\n  var ndim = ndarrays.reduce(function (ndim, arr) {\n    return Math.max(ndim, arr.ndim);\n  }, 0),\n      shape = Int32Array.from({\n    length: ndim\n  }, function () {\n    return 1;\n  }); // FIND COMMON (BROADCASTED) SHAPE\n\n  var _iterator = _createForOfIteratorHelper(ndarrays),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var arr = _step.value;\n\n      for (var i = ndim, j = arr.ndim; i-- > 0 && j-- > 0;) {\n        if (1 === shape[i]) shape[i] = arr.shape[j];else if (shape[i] != arr.shape[j] && arr.shape[j] != 1) throw new Error('Shapes are not broadcast-compatible.');\n      }\n    } // GENERATE RESULT DATA\n\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  var multi_idx = new Int32Array(ndim),\n      // <- index in result\n  data = new _dt__WEBPACK_IMPORTED_MODULE_1__[\"ARRAY_TYPES\"][dtype](shape.reduce(function (a, b) {\n    return a * b;\n  }, 1)),\n      values = new Array(ndarrays.length),\n      // <- cache of ndarrays[indices]\n  indices = new Int32Array(ndarrays.length),\n      // <- indices in ndarrays(s)\n  strides = new Int32Array(ndarrays.length);\n  var flat_idx = 0;\n\n  function write(d) {\n    if (d === ndim) {\n      strides.fill(1);\n\n      for (var i = ndarrays.length; i-- > 0;) {\n        values[i] = ndarrays[i].data[indices[i]++];\n      }\n\n      data[flat_idx++] = zip_fn.apply(void 0, values.concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(multi_idx)));\n      return;\n    }\n\n    for (multi_idx[d] = 0;;) {\n      write(d + 1);\n      if (++multi_idx[d] >= shape[d]) break;\n\n      for (var _i = ndarrays.length; _i-- > 0;) {\n        if (!(ndarrays[_i].shape[d - ndim + ndarrays[_i].ndim] > 1)) // <- handles undefined (index out of bounds)\n          indices[_i] -= strides[_i];\n      }\n    }\n\n    for (var _i2 = ndarrays.length; _i2-- > 0;) {\n      strides[_i2] *= ndarrays[_i2].shape[d - ndim + ndarrays[_i2].ndim] || 1;\n    }\n  }\n\n  write(0);\n  return new _nd_array__WEBPACK_IMPORTED_MODULE_2__[\"NDArray\"](shape, data);\n}\n\n//# sourceURL=webpack://nd/./src/zip_elems.js?");

/***/ })

/******/ });
});