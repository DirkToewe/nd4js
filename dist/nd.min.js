/* ND.JS v1.0.1
 *
 * ND.JS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * ND.JS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with ND.JS. If not, see <http://www.gnu.org/licenses/>.
 */
 !function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.nd=e():r.nd=e()}(this,(function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var a in r)t.d(n,a,function(e){return r[e]}.bind(null,a));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=25)}([function(r,e,t){var n=t(19),a=t(20),o=t(21);r.exports=function(r,e){return n(r)||a(r,e)||o()}},function(r,e,t){r.exports=t(14)},function(r,e,t){var n=t(11),a=t(12),o=t(13);r.exports=function(r){return n(r)||a(r)||o()}},function(r,e){r.exports=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}},function(r,e){function t(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}r.exports=function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}},function(r,e){function t(r){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function n(e){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?r.exports=n=function(r){return t(r)}:r.exports=n=function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":t(r)},n(e)}r.exports=n},function(r,e,t){var n=t(5),a=t(22);r.exports=function(r,e){return!e||"object"!==n(e)&&"function"!=typeof e?a(r):e}},function(r,e,t){var n=t(10);r.exports=function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&n(r,e)}},function(r,e,t){var n=t(9),a=t(10),o=t(23),i=t(24);function f(e){var t="function"==typeof Map?new Map:void 0;return r.exports=f=function(r){if(null===r||!o(r))return r;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(r))return t.get(r);t.set(r,e)}function e(){return i(r,arguments,n(this).constructor)}return e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a(e,r)},f(e)}r.exports=f},function(r,e){function t(e){return r.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},t(e)}r.exports=t},function(r,e){function t(e,n){return r.exports=t=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r},t(e,n)}r.exports=t},function(r,e){r.exports=function(r){if(Array.isArray(r)){for(var e=0,t=new Array(r.length);e<r.length;e++)t[e]=r[e];return t}}},function(r,e){r.exports=function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}},function(r,e){r.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(r,e,t){var n=function(r){"use strict";var e,t=Object.prototype,n=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function s(r,e,t,n){var a=e&&e.prototype instanceof p?e:p,o=Object.create(a.prototype),i=new S(n||[]);return o._invoke=function(r,e,t){var n=c;return function(a,o){if(n===h)throw new Error("Generator is already running");if(n===v){if("throw"===a)throw o;return I()}for(t.method=a,t.arg=o;;){var i=t.delegate;if(i){var f=A(i,t);if(f){if(f===d)continue;return f}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(n===c)throw n=v,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n=h;var s=u(r,e,t);if("normal"===s.type){if(n=t.done?v:l,s.arg===d)continue;return{value:s.arg,done:t.done}}"throw"===s.type&&(n=v,t.method="throw",t.arg=s.arg)}}}(r,t,i),o}function u(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(r){return{type:"throw",arg:r}}}r.wrap=s;var c="suspendedStart",l="suspendedYield",h="executing",v="completed",d={};function p(){}function w(){}function m(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,g=b&&b(b(P([])));g&&g!==t&&n.call(g,o)&&(y=g);var x=m.prototype=p.prototype=Object.create(y);function E(r){["next","throw","return"].forEach((function(e){r[e]=function(r){return this._invoke(e,r)}}))}function _(r){var e;this._invoke=function(t,a){function o(){return new Promise((function(e,o){!function e(t,a,o,i){var f=u(r[t],r,a);if("throw"!==f.type){var s=f.arg,c=s.value;return c&&"object"==typeof c&&n.call(c,"__await")?Promise.resolve(c.__await).then((function(r){e("next",r,o,i)}),(function(r){e("throw",r,o,i)})):Promise.resolve(c).then((function(r){s.value=r,o(s)}),(function(r){return e("throw",r,o,i)}))}i(f.arg)}(t,a,e,o)}))}return e=e?e.then(o,o):o()}}function A(r,t){var n=r.iterator[t.method];if(n===e){if(t.delegate=null,"throw"===t.method){if(r.iterator.return&&(t.method="return",t.arg=e,A(r,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var a=u(n,r.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var o=a.arg;return o?o.done?(t[r.resultName]=o.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function M(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function S(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(k,this),this.reset(!0)}function P(r){if(r){var t=r[o];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function t(){for(;++a<r.length;)if(n.call(r,a))return t.value=r[a],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:e,done:!0}}return w.prototype=x.constructor=m,m.constructor=w,m[f]=w.displayName="GeneratorFunction",r.isGeneratorFunction=function(r){var e="function"==typeof r&&r.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,m):(r.__proto__=m,f in r||(r[f]="GeneratorFunction")),r.prototype=Object.create(x),r},r.awrap=function(r){return{__await:r}},E(_.prototype),_.prototype[i]=function(){return this},r.AsyncIterator=_,r.async=function(e,t,n,a){var o=new _(s(e,t,n,a));return r.isGeneratorFunction(t)?o:o.next().then((function(r){return r.done?r.value:o.next()}))},E(x),x[f]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},r.keys=function(r){var e=[];for(var t in r)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=P,S.prototype={constructor:S,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!r)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function a(n,a){return f.type="throw",f.arg=r,t.next=n,a&&(t.method="next",t.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],f=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(r,e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===r||"continue"===r)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=r,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(r,e){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&e&&(this.next=e),d},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),M(t),d}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===r){var n=t.completion;if("throw"===n.type){var a=n.arg;M(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(r,t,n){return this.delegate={iterator:P(r),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=e),d}},r}(r.exports);try{regeneratorRuntime=n}catch(r){Function("r","regeneratorRuntime = r")(n)}},function(r,e,t){(function(r){var n=Object.getOwnPropertyDescriptors||function(r){for(var e=Object.keys(r),t={},n=0;n<e.length;n++)t[e[n]]=Object.getOwnPropertyDescriptor(r,e[n]);return t},a=/%[sdj%]/g;e.format=function(r){if(!m(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(f(arguments[t]));return e.join(" ")}t=1;for(var n=arguments,o=n.length,i=String(r).replace(a,(function(r){if("%%"===r)return"%";if(t>=o)return r;switch(r){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(r){return"[Circular]"}default:return r}})),s=n[t];t<o;s=n[++t])p(s)||!g(s)?i+=" "+s:i+=" "+f(s);return i},e.deprecate=function(t,n){if(void 0!==r&&!0===r.noDeprecation)return t;if(void 0===r)return function(){return e.deprecate(t,n).apply(this,arguments)};var a=!1;return function(){if(!a){if(r.throwDeprecation)throw new Error(n);r.traceDeprecation?console.trace(n):console.error(n),a=!0}return t.apply(this,arguments)}};var o,i={};function f(r,t){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(t)?n.showHidden=t:t&&e._extend(n,t),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,r,n.depth)}function s(r,e){var t=f.styles[e];return t?"["+f.colors[t][0]+"m"+r+"["+f.colors[t][1]+"m":r}function u(r,e){return r}function c(r,t,n){if(r.customInspect&&t&&_(t.inspect)&&t.inspect!==e.inspect&&(!t.constructor||t.constructor.prototype!==t)){var a=t.inspect(n,r);return m(a)||(a=c(r,a,n)),a}var o=function(r,e){if(y(e))return r.stylize("undefined","undefined");if(m(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(w(e))return r.stylize(""+e,"number");if(d(e))return r.stylize(""+e,"boolean");if(p(e))return r.stylize("null","null")}(r,t);if(o)return o;var i=Object.keys(t),f=function(r){var e={};return r.forEach((function(r,t){e[r]=!0})),e}(i);if(r.showHidden&&(i=Object.getOwnPropertyNames(t)),E(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return l(t);if(0===i.length){if(_(t)){var s=t.name?": "+t.name:"";return r.stylize("[Function"+s+"]","special")}if(b(t))return r.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return r.stylize(Date.prototype.toString.call(t),"date");if(E(t))return l(t)}var u,g="",A=!1,k=["{","}"];(v(t)&&(A=!0,k=["[","]"]),_(t))&&(g=" [Function"+(t.name?": "+t.name:"")+"]");return b(t)&&(g=" "+RegExp.prototype.toString.call(t)),x(t)&&(g=" "+Date.prototype.toUTCString.call(t)),E(t)&&(g=" "+l(t)),0!==i.length||A&&0!=t.length?n<0?b(t)?r.stylize(RegExp.prototype.toString.call(t),"regexp"):r.stylize("[Object]","special"):(r.seen.push(t),u=A?function(r,e,t,n,a){for(var o=[],i=0,f=e.length;i<f;++i)P(e,String(i))?o.push(h(r,e,t,n,String(i),!0)):o.push("");return a.forEach((function(a){a.match(/^\d+$/)||o.push(h(r,e,t,n,a,!0))})),o}(r,t,n,f,i):i.map((function(e){return h(r,t,n,f,e,A)})),r.seen.pop(),function(r,e,t){if(r.reduce((function(r,e){return e.indexOf("\n")>=0&&0,r+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return t[0]+(""===e?"":e+"\n ")+" "+r.join(",\n  ")+" "+t[1];return t[0]+e+" "+r.join(", ")+" "+t[1]}(u,g,k)):k[0]+g+k[1]}function l(r){return"["+Error.prototype.toString.call(r)+"]"}function h(r,e,t,n,a,o){var i,f,s;if((s=Object.getOwnPropertyDescriptor(e,a)||{value:e[a]}).get?f=s.set?r.stylize("[Getter/Setter]","special"):r.stylize("[Getter]","special"):s.set&&(f=r.stylize("[Setter]","special")),P(n,a)||(i="["+a+"]"),f||(r.seen.indexOf(s.value)<0?(f=p(t)?c(r,s.value,null):c(r,s.value,t-1)).indexOf("\n")>-1&&(f=o?f.split("\n").map((function(r){return"  "+r})).join("\n").substr(2):"\n"+f.split("\n").map((function(r){return"   "+r})).join("\n")):f=r.stylize("[Circular]","special")),y(i)){if(o&&a.match(/^\d+$/))return f;(i=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=r.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=r.stylize(i,"string"))}return i+": "+f}function v(r){return Array.isArray(r)}function d(r){return"boolean"==typeof r}function p(r){return null===r}function w(r){return"number"==typeof r}function m(r){return"string"==typeof r}function y(r){return void 0===r}function b(r){return g(r)&&"[object RegExp]"===A(r)}function g(r){return"object"==typeof r&&null!==r}function x(r){return g(r)&&"[object Date]"===A(r)}function E(r){return g(r)&&("[object Error]"===A(r)||r instanceof Error)}function _(r){return"function"==typeof r}function A(r){return Object.prototype.toString.call(r)}function k(r){return r<10?"0"+r.toString(10):r.toString(10)}e.debuglog=function(t){if(y(o)&&(o=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!i[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=r.pid;i[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else i[t]=function(){};return i[t]},e.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=v,e.isBoolean=d,e.isNull=p,e.isNullOrUndefined=function(r){return null==r},e.isNumber=w,e.isString=m,e.isSymbol=function(r){return"symbol"==typeof r},e.isUndefined=y,e.isRegExp=b,e.isObject=g,e.isDate=x,e.isError=E,e.isFunction=_,e.isPrimitive=function(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r},e.isBuffer=t(17);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var r=new Date,e=[k(r.getHours()),k(r.getMinutes()),k(r.getSeconds())].join(":");return[r.getDate(),M[r.getMonth()],e].join(" ")}function P(r,e){return Object.prototype.hasOwnProperty.call(r,e)}e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=t(18),e._extend=function(r,e){if(!e||!g(e))return r;for(var t=Object.keys(e),n=t.length;n--;)r[t[n]]=e[t[n]];return r};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function N(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}e.promisify=function(r){if("function"!=typeof r)throw new TypeError('The "original" argument must be of type Function');if(I&&r[I]){var e;if("function"!=typeof(e=r[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,t,n=new Promise((function(r,n){e=r,t=n})),a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);a.push((function(r,n){r?t(r):e(n)}));try{r.apply(this,a)}catch(r){t(r)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),I&&Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,n(r))},e.promisify.custom=I,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var a=t.pop();if("function"!=typeof a)throw new TypeError("The last argument must be of type Function");var o=this,i=function(){return a.apply(o,arguments)};e.apply(this,t).then((function(e){r.nextTick(i,null,e)}),(function(e){r.nextTick(N,e,i)}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}}).call(this,t(16))},function(r,e){var t,n,a=r.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function f(r){if(t===setTimeout)return setTimeout(r,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(r,0);try{return t(r,0)}catch(e){try{return t.call(null,r,0)}catch(e){return t.call(this,r,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(r){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(r){n=i}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&v())}function v(){if(!c){var r=f(h);c=!0;for(var e=u.length;e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,function(r){if(n===clearTimeout)return clearTimeout(r);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(r);try{n(r)}catch(e){try{return n.call(null,r)}catch(e){return n.call(this,r)}}}(r)}}function d(r,e){this.fun=r,this.array=e}function p(){}a.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];u.push(new d(r,e)),1!==u.length||c||f(v)},d.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(r){return[]},a.binding=function(r){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(r){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(r,e){r.exports=function(r){return r&&"object"==typeof r&&"function"==typeof r.copy&&"function"==typeof r.fill&&"function"==typeof r.readUInt8}},function(r,e){"function"==typeof Object.create?r.exports=function(r,e){r.super_=e,r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(r,e){r.super_=e;var t=function(){};t.prototype=e.prototype,r.prototype=new t,r.prototype.constructor=r}},function(r,e){r.exports=function(r){if(Array.isArray(r))return r}},function(r,e){r.exports=function(r,e){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r)){var t=[],n=!0,a=!1,o=void 0;try{for(var i,f=r[Symbol.iterator]();!(n=(i=f.next()).done)&&(t.push(i.value),!e||t.length!==e);n=!0);}catch(r){a=!0,o=r}finally{try{n||null==f.return||f.return()}finally{if(a)throw o}}return t}}},function(r,e){r.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(r,e){r.exports=function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}},function(r,e){r.exports=function(r){return-1!==Function.toString.call(r).indexOf("[native code]")}},function(r,e,t){var n=t(10);function a(e,t,o){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(r){return!1}}()?r.exports=a=function(r,e,t){var a=[null];a.push.apply(a,e);var o=new(Function.bind.apply(r,a));return t&&n(o,t.prototype),o}:r.exports=a=Reflect.construct,a.apply(null,arguments)}r.exports=a},function(r,e,t){"use strict";t.r(e);var n={};t.r(n),t.d(n,"ARRAY_TYPES",(function(){return A})),t.d(n,"eps",(function(){return k})),t.d(n,"cast_scalar",(function(){return M})),t.d(n,"_check_dtype",(function(){return S})),t.d(n,"dtypeof",(function(){return P})),t.d(n,"super_dtype",(function(){return I})),t.d(n,"is_subdtype",(function(){return N})),t.d(n,"Complex",(function(){return d})),t.d(n,"Complex128Array",(function(){return _}));var a={};t.r(a),t.d(a,"strong_wolfe",(function(){return rr}));var o={};t.r(o),t.d(o,"line_search",(function(){return a})),t.d(o,"min_lbfgs_gen",(function(){return nr})),t.d(o,"num_grad",(function(){return ar})),t.d(o,"root1d_bisect",(function(){return or})),t.d(o,"strong_wolfe",(function(){return rr}));var i={};t.r(i),t.d(i,"hessenberg_decomp",(function(){return Pr})),t.d(i,"norm",(function(){return ur})),t.d(i,"rrqr_decomp",(function(){return me})),t.d(i,"rrqr_decomp_full",(function(){return we})),t.d(i,"rrqr_rank",(function(){return ye})),t.d(i,"rrqr_lstsq",(function(){return ge})),t.d(i,"rrqr_solve",(function(){return be})),t.d(i,"svd_dc",(function(){return ee})),t.d(i,"_bidiag_decomp_horiz",(function(){return dr})),t.d(i,"bidiag_decomp",(function(){return pr})),t.d(i,"cholesky_decomp",(function(){return wr})),t.d(i,"cholesky_solve",(function(){return mr})),t.d(i,"diag_mat",(function(){return yr})),t.d(i,"diag",(function(){return br})),t.d(i,"det_tri",(function(){return _r})),t.d(i,"slogdet_tri",(function(){return Ar})),t.d(i,"det",(function(){return kr})),t.d(i,"slogdet",(function(){return Mr})),t.d(i,"eigen",(function(){return Br})),t.d(i,"eigenvals",(function(){return zr})),t.d(i,"eigen_balance_pre",(function(){return Yr})),t.d(i,"eigen_balance_post",(function(){return Vr})),t.d(i,"eye",(function(){return Gr})),t.d(i,"lstsq",(function(){return oe})),t.d(i,"lu_decomp",(function(){return ie})),t.d(i,"lu_solve",(function(){return fe})),t.d(i,"matmul2",(function(){return Fr})),t.d(i,"matmul",(function(){return Rr})),t.d(i,"permute_rows",(function(){return se})),t.d(i,"permute_cols",(function(){return ue})),t.d(i,"unpermute_rows",(function(){return ce})),t.d(i,"unpermute_cols",(function(){return le})),t.d(i,"qr_decomp_full",(function(){return gr})),t.d(i,"qr_decomp",(function(){return xr})),t.d(i,"qr_lstsq",(function(){return Er})),t.d(i,"rank",(function(){return he})),t.d(i,"schur_eigenvals",(function(){return Qr})),t.d(i,"schur_eigen",(function(){return Dr})),t.d(i,"schur_decomp",(function(){return Cr})),t.d(i,"SingularMatrixSolveError",(function(){return Jr})),t.d(i,"solve",(function(){return xe})),t.d(i,"svd_decomp",(function(){return ee})),t.d(i,"svd_rank",(function(){return te})),t.d(i,"svd_solve",(function(){return ne})),t.d(i,"svd_lstsq",(function(){return ae})),t.d(i,"svd_jac_2sided",(function(){return Ee})),t.d(i,"svd_jac_2sided_blocked",(function(){return ke})),t.d(i,"svd_jac_classic",(function(){return Me})),t.d(i,"tril",(function(){return Se})),t.d(i,"triu",(function(){return Pe})),t.d(i,"tril_solve",(function(){return Ie})),t.d(i,"triu_solve",(function(){return Ne})),t.d(i,"rand_ortho",(function(){return je}));var f={};t.r(f),t.d(f,"IS_LITTLE_ENDIAN",(function(){return $e})),t.d(f,"WHITESPACES",(function(){return Ze})),t.d(f,"b64_decode",(function(){return Ue})),t.d(f,"b64_decode_gen",(function(){return Qe})),t.d(f,"b64_encode",(function(){return De})),t.d(f,"b64_encode_gen",(function(){return Ce})),t.d(f,"istr_parse",(function(){return ze})),t.d(f,"istr_stringify",(function(){return Ye})),t.d(f,"istr_stringify_gen",(function(){return Ve})),t.d(f,"npy_serialize",(function(){return We})),t.d(f,"npy_serialize_gen",(function(){return Xe})),t.d(f,"npy_deserialize",(function(){return Ke}));var s=t(3),u=t.n(s),c=t(4),l=t.n(c),h={nextUp:function(r){var e=Number.EPSILON,t=Number.MIN_VALUE,n=r*(r<0?1-e/2:1+e);if(!isFinite(r))throw new Error("Assertion failed!");if(!isFinite(n))throw new Error("Assertion failed!");n===r&&(n+=t);var a=r+(n-r)/2;r<a&&a<n&&(n=a);var o=(n+r)/2;return r<o&&o<n&&(n=o),0===n?-0:n},add:function(r,e){return r instanceof d?r.add(e):e instanceof d?e.add(r):r+e},sub:function(r,e){return r instanceof d?r.sub(e):e instanceof d?new d(r).sub(e):r-e},mul:function(r,e){return r instanceof d?r.mul(e):e instanceof d?e.mul(r):r*e},div:function(r,e){return r instanceof d?r.div(e):e instanceof d?new d(r).div(e):r/e},zero:function(r){return h.cast(0,r)},one:function(r){return h.cast(1,r)},neg:function(r){return r instanceof d?r.neg():-r},abs:function(r){return r instanceof d?r.abs():Math.abs(r)},sqrt:function(r){return r instanceof d?r.sqrt():r>=0?Math.sqrt(r):new d(r).sqrt()},exp:function(r){return r instanceof d?r.exp():Math.exp(r)},min:function(r,e){return Math.min(r,e)},max:function(r,e){return Math.max(r,e)},hypot:function(r,e){return Math.hypot(r,e)},atan2:function(r,e){return Math.atan2(r,e)},conj:function(r){return r instanceof d?r.conj():r},is_equal:function(r,e){return r instanceof d?r.equals(e):e instanceof d?e.equals(r):r==e},is_close:function(r,e){var t=1e-8+1e-5*h.max(h.abs(r),h.abs(e));return h.abs(h.sub(r,e))<=t}},v=h,d=function(){function r(e,t){if(u()(this,r),null==e&&(e=0),null==t&&(t=0),null==e.re&&null==e.im||(t=e.im||0,e=e.re||0),this.re=1*e,this.im=1*t,isNaN(e))throw new Error("Real value is NaN.");if(isNaN(t))throw new Error("Imaginary value is NaN.");Object.freeze(this)}return l()(r,[{key:"add",value:function(e,t){return null==e&&(e=0),null==t&&(t=0),null==e.re&&null==e.im||(t=e.im||0,e=e.re||0),new r(this.re+e,this.im+t)}},{key:"sub",value:function(e,t){return null==e&&(e=0),null==t&&(t=0),null==e.re&&null==e.im||(t=e.im||0,e=e.re||0),new r(this.re-e,this.im-t)}},{key:"mul",value:function(e,t){return null==e&&(e=0),null==t&&(t=0),null==e.re&&null==e.im||(t=e.im||0,e=e.re||0),new r(this.re*e-this.im*t,this.re*t+this.im*e)}},{key:"div",value:function(e,t){if(null==e&&(e=0),null==t&&(t=0),null==e.re&&null==e.im||(t=e.im||0,e=e.re||0),0==t)return new r(this.re/e,this.im/e);if(Math.abs(e)>=Math.abs(t)){var n=t/e;return new r((this.re+this.im*n)/(e+t*n),(this.im-this.re*n)/(e+t*n))}var a=e/t;return new r((this.re*a+this.im)/(e*a+t),(this.im*a-this.re)/(e*a+t))}},{key:"equals",value:function(r,e){return null==r&&(r=0),null==e&&(e=0),null==r.re&&null==r.im||(e=r.im||0,r=r.re||0),this.re==r&&this.im==e}},{key:"abs",value:function(){return Math.hypot(this.re,this.im)}},{key:"arg",value:function(){return Math.atan2(this.im,this.re)}},{key:"conj",value:function(){return new r(this.re,-this.im)}},{key:"toFixed",value:function(e){return new r(this.re.toFixed(e),this.im.toFixed(e))}},{key:"sqrt",value:function(){var e=this.abs();return new r(v.sqrt(v.mul(v.add(e,this.re),.5)),v.sqrt(v.mul(v.sub(e,this.re),.5)))}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(){return this.toString()}},{key:"toString",value:function(){return 0==this.im?this.re.toString():0==this.re?"".concat(this.im,"j"):this.im<0?"".concat(this.re," - ").concat(-this.im,"j"):"".concat(this.re," + ").concat(this.im,"j")}},{key:"valueOf",value:function(){return 0==this.im?this.re:this}}]),r}(),p=t(2),w=t.n(p),m=t(1),y=t.n(m),b=t(5),g=t.n(b);t(15);var x,E,_=(x=Float64Array,E={get:function(r,e){return"symbol"!==g()(e)&&e%1==0?r.get(e):r[e]},set:function(r,e,t){return"symbol"!==g()(e)&&e%1==0?(r.set(e,t),!0):(r[e]=t,!0)}},function(){function r(e,t,n){return u()(this,r),e%1==0?(n=e,this._array=new x(2*n)):(null!=n&&(n*=2),this._array=new x(e,t,n)),Object.seal(this),new Proxy(this,E)}return l()(r,null,[{key:"BYTES_PER_ELEMENT",get:function(){return 2*x.BYTES_PER_ELEMENT}},{key:"name",get:function(){return"Complex".concat(8*r.BYTES_PER_ELEMENT,"Array")}}]),l()(r,[{key:Symbol.iterator,value:y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=0;case 1:if(!(e<this.length)){r.next=7;break}return r.next=4,this[e];case 4:e++,r.next=1;break;case 7:case"end":return r.stop()}}),r,this)}))},{key:"keys",value:y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=0;case 1:if(!(e<this.length)){r.next=7;break}return r.next=4,e;case 4:e++,r.next=1;break;case 7:case"end":return r.stop()}}),r,this)}))},{key:"values",value:y.a.mark((function r(){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(this[Symbol.iterator](),"t0",1);case 1:case"end":return r.stop()}}),r,this)}))},{key:"entries",value:y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=0;case 1:if(!(e<this.length)){r.next=7;break}return r.next=4,[e,this[e]];case 4:e++,r.next=1;break;case 7:case"end":return r.stop()}}),r,this)}))},{key:"forEach",value:function(r,e){for(var t=0;t<source.length;t++)r.call(e,source[t],t)}},{key:"map",value:function(e,t){return r.from(this,e,t)}},{key:"reduce",value:function(r,e){var t=0;if(null==e){if(0==this.length)throw new TypeError("TypeError: Reduce of empty array with no initial value.");e=this[t++]}for(;t<this.length;t++)e=r(e,this[t],t,this);return e}},{key:"slice",value:function(e,t){return null!=e&&(e*=2),null!=t&&(t*=2),new r(this._array.slice(e,t).buffer)}},{key:"subarray",value:function(e,t){null!=e&&(e*=2),null!=t&&(t*=2);var n=this._array.subarray(e,t);return new r(n.buffer,n.byteOffset,n.length/2)}},{key:"join",value:function(r){null==r&&(r=", ");for(var e="",t=0;t<this.length;t++)t>0&&(e+=r),e+=this[t].toString();return e}},{key:"fill",value:function(r,e,t){r instanceof d||(r=new d(r)),null==e&&(e=0),null==t&&(t=this.length),0>t&&(t+=this.length),0>e&&(e+=this.length);for(var n=this._array.length;(n-=2)>=0;)this._array[n+1]=r.im,this._array[n+0]=r.re;return this}},{key:"get",value:function(r){return new d(this._array[2*r+0],this._array[2*r+1])}},{key:"set",value:function(r,e){if(r*=2,"number"==typeof e||!isNaN(e))return this._array[r+0]=e,void(this._array[r+1]=isNaN(e)?NaN:0);"re"in e&&"im"in e||(e=new d(e)),this._array[r+0]=e.re,this._array[r+1]=e.im}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(r){return"Complex128Array "+util.inspect(Array.from(this),r)}},{key:"toString",value:function(r){return this.join(",")}},{key:"buffer",get:function(){return this._array.buffer}},{key:"byteOffset",get:function(){return this._array.byteOffset}},{key:"byteLength",get:function(){return this._array.byteLength}},{key:"length",get:function(){return this._array.length>>>1}},{key:Symbol.toStringTag,get:function(){throw new Error("not yet implemented.")}}],[{key:"from",value:function(e,t,n){if(e.hasOwnProperty("length")||(e=w()(e)),null==t){if(e instanceof r)return new r(x.from(e._array).buffer,0,e.length);if(e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array){for(var a=new x(2*e.length),o=e.length;o-- >0;)a[o<<1]=e[o];return new r(a.buffer,0,e.length)}}var i=new r(e.length);t=t||function(r){return r};for(var f=0;f<e.length;f++)i[f]=t.call(n,e[f],f);return i}},{key:"of",value:function(){for(var e=new r(arguments.length),t=0;t<arguments.length;t++)e[t]=t<0||arguments.length<=t?void 0:arguments[t];return e}}]),r}()),A={int32:Int32Array,float32:Float32Array,float64:Float64Array,complex128:_,object:Array};function k(r){switch(S(r),r){case"complex128":return new d(Number.EPSILON);case"float32":return 1.1920928955078125e-7;default:return Number.EPSILON}}function M(r,e){return"int32"===e?4294967295&r:"float32"===e?Math.fround(r):"complex128"===e?r instanceof d?r:new d(r):1*r}function S(r){if(!A.hasOwnProperty(r))throw new Error("Invalid dtype '"+r+"'. Must be one of {'"+Object.getOwnPropertyNames(A).join("', '")+"'}.")}function P(r){return r%1==0?r<=~(1<<31)&&r>=1<<31?"int32":"object":1*r==r?"float64":r instanceof d?"complex128":"object"}var I=function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return e.reduce((function(r,e){return S(r),S(e),"object"===r||"object"===e?"object":"complex128"===r||"complex128"===e?"complex128":"float64"===r||"float64"===e?"float64":"float32"===r||"float32"===e?"float32":"int32"}))};function N(r,e){S(r),S(e);var t={int32:0,float32:1,float64:2,complex128:3,object:4};return t[r]<=t[e]}var j=t(0),q=t.n(j),O=t(6),T=t.n(O),L=t(7),F=t.n(L),U=t(8),D=t.n(U);function C(r,e,t){if(null==t&&e instanceof Function&&(t=e,e=void 0),r instanceof Array||(r=w()(r)),r=r.map(z),null==e&&(e="object"),null==t){if("object"!==e)throw new Error('If zip_fn is undefined, dtype must be "object" or undefined.');var n=r.length;t=function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return e.slice(0,n)}}S(e);var a=r.reduce((function(r,e){return Math.max(r,e.ndim)}),0),o=Int32Array.from({length:a},(function(){return 1})),i=!0,f=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0)for(var l=u.value,h=a,v=l.ndim;h-- >0&&v-- >0;)if(1===o[h])o[h]=l.shape[v];else if(o[h]!=l.shape[v]&&1!=l.shape[v])throw new Error("Shapes are not broadcast-compatible.")}catch(r){f=!0,s=r}finally{try{i||null==c.return||c.return()}finally{if(f)throw s}}var d=new Int32Array(a),p=new A[e](o.reduce((function(r,e){return r*e}),1)),m=new Array(r.length),y=new Int32Array(r.length),b=new Int32Array(r.length),g=0;return function e(n){if(n!==a){for(d[n]=0;e(n+1),!(++d[n]>=o[n]);)for(var i=r.length;i-- >0;)r[i].shape[n-a+r[i].ndim]>1||(y[i]-=b[i]);for(var f=r.length;f-- >0;)b[f]*=r[f].shape[n-a+r[f].ndim]||1}else{b.fill(1);for(var s=r.length;s-- >0;)m[s]=r[s].data[y[s]++];p[g++]=t.apply(void 0,m.concat(w()(d)))}}(0),new V(o,p)}function B(r,e){var t=y.a.mark(a);if(null==e&&(e=r,r=void 0),"object"==g()(e)&&"shape"in e&&"data"in e){var n=e.data;return null==r||n instanceof A[r]||(n=A[r].from(n)),new V(e.shape,n.slice())}function a(r){var e;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("object"===g()(r)&&"length"in r)){t.next=7;break}if("number"==typeof(e=r.length)&&e%1==0&&0!==e){t.next=4;break}throw"Illegal argument(s).";case 4:return t.next=6,e;case 6:return t.delegateYield(a(r[0]),"t0",7);case 7:case"end":return t.stop()}}),t)}a=Int32Array.from(a(e)),null==r&&(r=function r(e,t){if(e===a.length)return P(t);for(var n=a[e]-1,o=r(e+1,t[n]);n>=0;n--)o=I(o,r(e+1,t[n]));return o}(0,e)),S(r);var o=new A[r](a.reduce((function(r,e){return r*e}),1)),i=0;return function r(e,t){if(e===a.length)o[i++]=t;else{if(t.length!==a[e])throw new Error("Nested array not axis-aligned.");for(var n=0;n<a[e];n++)r(e+1,t[n])}}(0,e),new V(a,o)}function z(r){return r instanceof V?r:B(r)}var Y,V=function(r){function e(r,t){if(u()(this,e),!(r instanceof Int32Array))throw new Error("Shape must be Int32Array.");if(r.some((function(r){return r<1})))throw new Error("Invalid shape: ".concat(r,"."));if(t.length!=r.reduce((function(r,e){return r*e}),1))throw new Error("Shape [".concat(r,"] does not match array length of ").concat(t.length,"."));var n=function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.data[r._flat_idx(t)]};return Object.setPrototypeOf(n,e.prototype),Object.freeze(r.buffer),n.shape=r,n.data=t,Object.seal(n),T()(void 0,n)}return F()(e,r),l()(e,null,[{key:"name",get:function(){return"nd.Array"}}]),l()(e,[{key:"set",value:function(r,e){this.data[this._flat_idx(r)]=e}},{key:"modify",value:function(r,e){var t=this._flat_idx(r);this.data[t]=e.apply(void 0,[this.data[t]].concat(w()(r)))}},{key:"_flat_idx",value:function(r){var e=this.shape;if(r.length!=e.length)throw new Error("Multi-index [".concat(r,"] does not have expected length of ").concat(e.length,"."));for(var t=0,n=1,a=e.length;a-- >0;n*=e[a]){var o=r[a];if(o%1!=0)throw new Error("Multi-index [".concat(r,"] contains non-integer entries."));if(o<0&&(o+=e[a]),o<0||o>=e[a])throw new Error("Multi-index [".concat(r,"] out of bounds [").concat(e,"]."));t+=o*n}return t}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(r,e){return this.toString()}},{key:"toString",value:function(){var r=y.a.mark(s),e=y.a.mark(l),t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(r,e){return e.length,6};if(!(t instanceof Function)){var n=1*t;t=function(){return n}}var a=this.shape,o=this.data,i=new Int32Array(a.length);i[i.length-1]=1;for(var f=i.length;--f>0;)i[f-1]=i[f]*a[f];function s(e,n){var f,u,c,l,h,v,d;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(f=t(e,a),c=f-(u=f>>>1),a.length!==e){r.next=16;break}l=o[n],r.t0=l,r.next=null===r.t0?6:void 0===r.t0?9:12;break;case 6:return r.next=8,"null";case 8:return r.abrupt("break",14);case 9:return r.next=11,"undefined";case 11:return r.abrupt("break",14);case 12:return r.next=14,l.toString();case 14:r.next=37;break;case 16:if(!(a[e]>f+1)){r.next=31;break}h=0;case 18:if(!(h<c)){r.next=23;break}return r.delegateYield(s(e+1,n+h*i[e]),"t1",20);case 20:h++,r.next=18;break;case 23:v=a[e]-u;case 24:if(!(v<a[e])){r.next=29;break}return r.delegateYield(s(e+1,n+v*i[e]),"t2",26);case 26:v++,r.next=24;break;case 29:r.next=37;break;case 31:d=0;case 32:if(!(d<a[e])){r.next=37;break}return r.delegateYield(s(e+1,n+d*i[e]),"t3",34);case 34:d++,r.next=32;break;case 37:case"end":return r.stop()}}),r)}if(s=w()(s(0,0)),this.ndim>1){var u=s.reduce((function(r,e){return Math.max(r,e.length)}),0);s=s.map((function(r){return r.padStart(u)}))}var c=0;function l(r,n,o){var f,u,h,v,d,p,w,m,b;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.length!==n){e.next=4;break}return e.next=3,s[c++];case 3:return e.abrupt("return");case 4:return r+=" ",f="[ ",u=", ",h=" ]",n<a.length-1&&(u=",\n"+r,f="[",h="]"),e.next=9,f;case 9:if(v=t(n,a),p=v-(d=v>>>1),!(a[n]>v+1)){e.next=31;break}w=0;case 12:if(!(w<p)){e.next=19;break}return e.delegateYield(l(r,n+1,o+w*i[n]),"t0",14);case 14:return e.next=16,u;case 16:w++,e.next=12;break;case 19:return e.next=21,"...".concat(a[n]-v," more...");case 21:m=a[n]-d;case 22:if(!(m<a[n])){e.next=29;break}return e.next=25,u;case 25:return e.delegateYield(l(r,n+1,o+m*i[n]),"t1",26);case 26:m++,e.next=22;break;case 29:e.next=40;break;case 31:b=0;case 32:if(!(b<a[n])){e.next=40;break}if(!(b>0)){e.next=36;break}return e.next=36,u;case 36:return e.delegateYield(l(r,n+1,o+b*i[n]),"t2",37);case 37:b++,e.next=32;break;case 40:return e.next=42,h;case 42:case"end":return e.stop()}}),e)}return w()(l("",0,0)).join("")}},{key:"toNestedArray",value:function(){var r=this.data,e=this.shape,t=0;return function n(a){return a===e.length?r[t++]:Array.from({length:e[a]},(function(){return n(a+1)}))}(0)}},{key:Symbol.iterator,value:y.a.mark((function r(){var t,n,a;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=this.shape.slice(1),n=t.reduce((function(r,e){return r*e}),1),a=0;case 2:if(!(a<this.data.length)){r.next=7;break}return r.next=5,new e(t,this.data.slice(a,a+=n));case 5:r.next=2;break;case 7:case"end":return r.stop()}}),r,this)}))},{key:"forEach",value:function(r){for(var t=this.shape[0],n=this.shape.slice(1),a=n.reduce((function(r,e){return r*e}),1),o=0,i=0;o<t;o++,i+=a)r(new e(n,this.data.slice(i,i+a)),o)}},{key:"elems",value:y.a.mark((function(){var r,e,t,n,a,o;return y.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=function(i){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i!==e.length){r.next=5;break}return r.next=3,[n.slice(),t[a++]];case 3:r.next=11;break;case 5:n[i]=0;case 6:if(!(n[i]<e[i])){r.next=11;break}return r.delegateYield(o(i+1),"t0",8);case 8:n[i]++,r.next=6;break;case 11:case"end":return r.stop()}}),r)},r=y.a.mark(o),e=this.shape,t=this.data,n=new Int32Array(e.length),a=0,i.delegateYield(o(0),"t0",5);case 5:case"end":return i.stop()}}),o,this)}))},{key:"forElems",value:function(r){var e=this.shape,t=this.data,n=new Int32Array(e.length),a=0;!function o(i){if(i===e.length)r.apply(void 0,[t[a++]].concat(w()(n)));else for(n[i]=0;n[i]<e[i];n[i]++)o(i+1)}(0)}},{key:"valueOf",value:function(){return 0===this.shape.length?this.data[0]:this}},{key:"mapElems",value:function(r,t){if(null==t){if(null==r)return new e(this.shape,this.data.slice());r instanceof Function&&(t=r,r=void 0)}return null==t&&(t=function(r){return r}),C([this],r,t)}},{key:"transpose",value:function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];t=w()(t);var a=Int32Array.from(this.shape),o=a.length,i=new Int32Array(o);o>0&&(i[o-1]=1);for(var f=o;--f>0;)i[f-1]=a[f]*i[f];if(0==t.length){if(o<=1)return this.sliceElems();a[o-2]=this.shape[o-1],a[o-1]=this.shape[o-2];var s=i[o-2];i[o-2]=i[o-1],i[o-1]=s}else{var u=new Set(t),c=i;if(i=new Int32Array(o),u.size!=t.length)throw new Error("Duplicate axes are not allowed.");for(var l=t.length;l-- >0;){var h=t[l];if(0>h||h>=o)throw new Error("Axis out of bounds.");a[l]=this.shape[h],i[l]=c[h]}for(var v=0,d=u.size;v<o;v++)u.has(v)||(a[d]=this.shape[v],i[d++]=c[v])}var p=this.data,m=new p.__proto__.constructor(p.length),y=p.length;function b(r,e){if(o>r)for(var t=a[r];t-- >0;e-=i[r])b(r+1,e);else m[--y]=p[e]}return b(0,y-1),new e(a,m)}},{key:"reshape",value:function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];t=Int32Array.from(t);for(var a=this.data.length,o=1,i=-1,f=t.length;--f>=0;)if(t[f]<0){if(-1!==t[f])throw new Error("Invalid dimension: "+t[f]);if(-1!==i)throw new Error("At most on dimension may be -1.");i=f}else o*=t[f];if(-1!==i){if(0!=a%o)throw new Error("Shape cannot be inferred.");t[i]=a/o}return new e(t,this.data)}},{key:"reduceElems",value:function(r,t,n){if(null==n){if(null==t)return this.data.reduce(r);if("string"==typeof r)return this.data.reduce(t);n=t,t=void 0}if(null==t&&(t="object"),!N(this.dtype,t))throw new Error("New dtype must be a super-dtype.");var a=this.ndim;if("number"==typeof r&&(r=[r]),r instanceof e){if(!N(r.dtype,"int32"))throw new Error("Invalid dtype ".concat(r.dtype," for axes."));if(1!==r.ndim)throw new Error("Only 1D nd.Array allowed for axes.");r=r.data}r=new Set(y.a.mark((function e(){var t,n,o,i,f,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,o=void 0,e.prev=3,i=r[Symbol.iterator]();case 5:if(t=(f=i.next()).done){e.next=15;break}if(0>(s=f.value)&&(s+=a),!(0>s||s>=a)){e.next=10;break}throw new Error("Reduction axis "+s+" out of bounds.");case 10:return e.next=12,+s;case 12:t=!0,e.next=5;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),n=!0,o=e.t0;case 21:e.prev=21,e.prev=22,t||null==i.return||i.return();case 24:if(e.prev=24,!n){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),e,null,[[3,17,21,29],[22,,24,28]])}))());var o=this.shape,i=o.filter((function(e,t){return!r.has(t)})),f=new A[t](i.reduce((function(r,e){return r*e}),1)),s=this.data,u=0,c=0;if(function e(t,a){if(o.length===t)f[u]=a?n(s[c++],f[u]):s[c++],++u;else if(r.has(t))for(var i=u,l=o[t];l-- >0;a=!0)u=i,e(t+1,a);else for(var h=o[t];h-- >0;)e(t+1,a)}(0,!1),u!=f.length)throw new Error([u,f.length]);if(c!=this.data.length)throw new Error([c,this.data.length]);return new e(i,f)}},{key:"sliceElems",value:function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];for(var a=this.ndim,o=this.shape,i=0,f=0,s=0,u=0,c=t;u<c.length;u++){var l=c[u];if("..."===l)++i;else if("new"===l)0;else if("number"==typeof l){if(l%1!=0)throw new Error("Only integral indices allowed.");++f}else{var h=l.length;if("number"!=typeof h||h%1!=0||h>3||1==h)throw new Error("Illegal argument(s).");++s}}if(i>1)throw new Error("Highlander! There can be only one ... (ellipsis).");if(0==i&&t.push("..."),f+s>a)throw new Error("Cannot sliced more dimensions than available.");var v=0,d=[],p=Int32Array.from(y.a.mark((function r(){var e,n,i,u,c,l,h,p,w,m,b,g,x;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=a,n=1,i=t.length;case 2:if(!(--i>=0)){r.next=54;break}u=t[i],r.t0=u,r.next="new"===r.t0?7:"..."===r.t0?11:21;break;case 7:return d.push(0),r.next=10,1;case 10:return r.abrupt("break",52);case 11:c=f+s;case 12:if(!(c<a)){r.next=20;break}return d.push(n),n*=o[--e],r.next=17,o[e];case 17:c++,r.next=12;break;case 20:return r.abrupt("break",52);case 21:if(--e,"number"!=typeof u){r.next=29;break}if(0>u&&(u+=o[e]),!(0>u||u>=o[e])){r.next=26;break}throw new Error("Index out of bounds.");case 26:v+=n*u,r.next=51;break;case 29:if(l=u,h=q()(l,3),p=h[0],w=void 0===p?void 0:p,m=h[1],b=void 0===m?void 0:m,g=h[2],x=void 0===g?1:g,b<0&&(b+=o[e]),w<0&&(w+=o[e]),!(0>w||w>=o[e])){r.next=34;break}throw new Error("Slice start out of bounds.");case 34:if(0!=x){r.next=36;break}throw new Error("Stride/step cannot be zero.");case 36:if(!(x<0)){r.next=43;break}if(null==w&&(w=o[e]-1),null==b&&(b=-1),!(-1>b||b>=o[e])){r.next=41;break}throw new Error("Slice end out of bounds.");case 41:r.next=47;break;case 43:if(null==w&&(w=0),null==b&&(b=o[e]),!(0>b||b>o[e])){r.next=47;break}throw new Error("Slice end out of bounds.");case 47:return d.push(n*x),v+=n*w,r.next=51,1+Math.trunc((-Math.sign(x)+b-w)/x);case 51:n*=o[e];case 52:r.next=2;break;case 54:case"end":return r.stop()}}),r)}))()),w=this.data,m=new A[this.dtype](p.reduce((function(r,e){return r*e}),1)),b=0;function g(r,e){if(0===r)m[b++]=w[e];else for(var t=p[--r];t-- >0;e+=d[r])g(r,e)}return g(p.length,v),p.reverse(),new e(p,m)}},{key:"ndim",get:function(){return this.shape.length}},{key:"dtype",get:function(){for(var r=0,e=Object.entries(A);r<e.length;r++){var t=q()(e[r],2),n=t[0],a=t[1];if(this.data instanceof a)return n}throw new Error("Data type could not determined.")}},{key:"T",get:function(){return 0==this.ndim?this.sliceElems():1==this.ndim?this.sliceElems([],"new"):this.transpose()}},{key:"H",get:function(){var r=this.T;return"object"!=this.dtype&&"complex128"!=this.dtype?r:r.mapElems(math.conj)}}]),e}(D()(Function)),G=(Y=NaN,function(){if(!isNaN(Y)){var r=Y;return Y=NaN,r}var e,t,n;do{n=(e=2*Math.random()-1)*e+(t=2*Math.random()-1)*t}while(n>1||0==n);var a=Math.sqrt(-2*Math.log(n)/n);return Y=a*e,a*t});function J(r,e,t){if(r=Int32Array.from(r,(function(e){if(e%1!=0)throw new Error("tabulate(shape, dtype='object', idx2val): Invalid shape [".concat(r,"]."));return e})),null==t&&(t=e,e=void 0),null==t)throw new Error("tabulate(shape, dtype='object', idx2val): idx2val missing.");null==e&&(e="object"),S(e);var n=new Int32Array(r.length),a=new A[e](r.reduce((function(r,e){return r*e}),1)),o=0;return function e(i){if(i===r.length)a[o++]=t.apply(void 0,w()(n));else for(n[i]=0;n[i]<r[i];n[i]++)e(i+1)}(0),new V(r,a)}function H(r,e,t){if(null==t&&(null==e?(t=r,r=void 0):(t=e,e=void 0,"string"==typeof r&&(e=r,r=void 0))),"length"in t||(t=w()(t)),null==r&&(r=0),null==e&&(e=I.apply(void 0,w()(t.map((function(r){return r.dtype}))))),0>r&&(r+=t[0].shape.length),0>r||r>=t[0].shape.length)throw new Error("Axis out of bounds.");for(var n=Int32Array.from(t[0].shape),a=function(e){var a=t[e].shape;if(n.length!=a.length)throw new Error("All shapes must have the same length.");if(!n.every((function(e,t){return n[t]===a[t]||r===t})))throw new Error("Shape along all axes but the concatentation axis must match.");n[r]+=a[r]},o=t.length;--o>0;)a(o);var i=n.slice(r+1).reduce((function(r,e){return r*e}),1),f=Int32Array.from(t,(function(r){return r.data.length})),s=new A[e](n.reduce((function(r,e){return r*e}),1)),u=s.length;return function e(a){if(a===r)for(var o=t.length;o-- >0;)for(var c=t[o].shape[a]*i;c-- >0;)s[--u]=t[o].data[--f[o]];else for(var l=n[a];l-- >0;)e(a+1)}(0),new V(n,s)}function W(r,e,t){if(null==t&&(null==e?(t=r,r=void 0):(t=e,e=void 0,"string"==typeof r&&(e=r,r=void 0))),"length"in t||(t=w()(t)),null==r&&(r=0),0>r&&(r+=t[0].shape.length+1),0>r||r>t[0].shape.length)throw new Error("Axis out of bounds.");return t=t.map((function(e){return e.reshape.apply(e,w()(e.shape.slice(0,r)).concat([1],w()(e.shape.slice(r))))})),H(r,e,t)}var X=t(9),K=t.n(X),$=function(r){function e(){return u()(this,e),T()(this,K()(e).apply(this,arguments))}return F()(e,r),e}(D()(Error)),Z=function(r){function e(){return u()(this,e),T()(this,K()(e).apply(this,arguments))}return F()(e,r),e}($),rr=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.c1,t=void 0===e?.4:e,n=r.c2,a=void 0===n?.8:n,o=r.c3,i=void 0===o?1.6:o;if(t<=0)throw new Error("strong_wolfe({c1,c2,c3}): c1 must be positive.");if(t>=a)throw new Error("strong_wolfe({c1,c2,c3}): c1 must less than c2.");if(1<=a)throw new Error("strong_wolfe({c1,c2,c3}): c2 must less than 1.");if(1>=i)throw new Error("strong_wolfe({c1,c2,c3}): c3 must larger than 1.");return function(r){return function(e,n,o,f){if(e=z(e),o=z(o),1!==e.ndim)throw new Error("strong_wolfe()(fg)(X0,f0,G0): X0.ndim must be 1.");if(1!==o.ndim)throw new Error("strong_wolfe()(fg)(X0,f0,G0): G0.ndim must be 1.");if(e.shape[0]!==o.shape[0])throw new Error("strong_wolfe()(fg)(X0,f0,G0): X0 and G0 must have the same shape.");if(isNaN(n))throw new Error("strong_wolfe()(fg)(X0,f0,G0): f0 is NaN.");var s=[e,o].every((function(r){return"float32"===r.dtype}))?"float32":"float64",u=function(r){for(var e=0,t=q()(f.shape,1)[0];t-- >0;)e-=f.data[t]*r.data[t];return e},c=u(o);if(c>=0)throw new Error("strong_wolfe: Initial projected gradient not negative.");var l=0,h=1,v=1/0,d=n;r:for(;;){var p=C([e,f],s,(function(r,e){return r-h*e})),w=r(p),m=q()(w,2),y=m[0],b=m[1],g=u(b);if(y-n>t*h*c||0<l&&y>=d){v=h;break r}if(Math.abs(g)<=-a*c)return[p,y,b];if(g>=0){v=l,l=h,d=y;break r}if(!(h<v))throw new $("strong_wolfe: Strong Wolfe condition not satisfiable in range.");l=h,h*=i,d=y}if(l===v)throw new $("strong_wolfe: bracketing failed.");for(var x=function(){if(0===l)throw new Z("strongWolfeLineSearch(): no progress.");throw new $("strong_wolfe: bisection failed ".concat(JSON.stringify({"αMin":l,"α":h,"αMax":v}),"."))};;){h=(l+v)/2;var E=C([e,f],s,(function(r,e){return r-h*e})),_=r(E),A=q()(_,2),k=A[0],M=A[1],S=u(M);if(k-n>t*h*c||k>=d)v===h&&x(),v=h;else{if(Math.abs(S)<=-a*c)return[E,k,M];S*(v-l)>=0&&(v=l),l===h&&x(),l=h,d=k}}}}},er=y.a.mark(nr);function tr(r,e){if(r.length!==e.length)throw new Error;for(var t=0,n=r.length;n-- >0;)t+=r[n]*e[n];return t}function nr(r,e){var t,n,a,o,i,f,s,u,c,l,h,v,d,p,w,m,b,g,x,E,_=arguments;return y.a.wrap((function(y){for(;;)switch(y.prev=y.next){case 0:t=_.length>2&&void 0!==_[2]?_[2]:{},n=t.historySize,a=void 0===n?8:n,o=t.lineSearch,i=void 0===o?rr():o,f=t.negDir0,s=void 0===f?function(r){return r}:f,u=z(e),c=r(u),l=q()(c,2),h=l[0],v=l[1],d=q()(u.shape,1),p=d[0],w=u.shape,i=i(r),m=[],b=[],g=[],x=function(r){r=Float64Array.from(r.data);for(var e=new Float64Array(m.length),t=b.length;t-- >0;){e[t]=tr(m[t],r)/b[t];for(var n=p;n-- >0;)r[n]-=e[t]*g[t][n]}r=s(new V(w,r)),r=Float64Array.from(r.data);for(var a=0;a<b.length;a++)for(var o=tr(g[a],r)/b[a],i=p;i-- >0;)r[i]+=(e[a]-o)*m[a][i];return new V(w,r)},E=function(){var r=i(u,h,v,x(v)),e=q()(r,3),t=e[0],n=e[1],o=e[2];u=u.data,v=v.data;var f=Float64Array.from(o.data,(function(r,e){return r-v[e]})),s=Float64Array.from(t.data,(function(r,e){return r-u[e]}));if(g.push(f),b.push(tr(f,s)),m.push(s),m.length>a&&(m.shift(),b.shift(),g.shift()),m.length>a)throw new Error("Assertion#1 failed.");if(m.length!==b.length)throw new Error("Assertion#2 failed.");if(m.length!==g.length)throw new Error("Assertion#3 failed.");u=t,h=n,v=o};case 8:if(1===u.ndim){y.next=10;break}throw new Error("Assertion#4 failed.");case 10:if(0===h.ndim){y.next=12;break}throw new Error("Assertion#5 failed.");case 12:if(1===v.ndim){y.next=14;break}throw new Error("Assertion#6 failed.");case 14:if(u.shape[0]===p){y.next=16;break}throw new Error("Assertion#7 failed.");case 16:if(v.shape[0]===p){y.next=18;break}throw new Error("Assertion#8 failed.");case 18:return y.next=20,[u,h,v].map((function(r){return new V(r.shape,r.data.slice())}));case 20:y.prev=20,E(),y.next=32;break;case 24:if(y.prev=24,y.t0=y.catch(20),!(y.t0 instanceof Z)){y.next=31;break}m=[],b=[],g=[],E(),y.next=32;break;case 31:throw y.t0;case 32:y.next=8;break;case 34:case"end":return y.stop()}}),er,null,[[20,24]])}var ar=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.h_rel,n=void 0===t?void 0:t,a=e.h_abs,o=void 0===a?void 0:a;return function(e){var t="float32"===(e=z(e)).dtype?"float32":"float64",a=A[t],i=e.shape;e=e.data;for(var f=new a(e.length),s=null!=n?n:Math.pow(k(t),1/3),u=null!=o?o:Math.pow(k(t),1/3),c=function(t){for(var n=Math.max(Math.abs(e[t])*s,u),o=function(){var n=q()(l[c],2),o=n[0],s=n[1],u=new V(i,a.from(e,(function(r,e){return r+o*(t===e)})));f[t]+=s*r(u)},c=0,l=[[2*n,-1],[1*n,8],[-1*n,-8],[-2*n,1]];c<l.length;c++)o();f[t]/=12*n},l=e.length;l-- >0;)c(l);return new V(i,f)}};function or(r,e,t){var n=r(e),a=r(t);if(n>a){var o=[a,n,t,e];n=o[0],a=o[1],e=o[2],t=o[3]}if(n>0){if(n<=a*Number.EPSILON)return e;throw new Error("root1d_bisect(F,x_min,x_max): Both F(x_min) and F(x_max) positive.")}if(a<0){if(a>=n*Number.EPSILON)return t;throw new Error("root1d_bisect(F,x_min,x_max): Both F(x_min) and F(x_max) negaitive.")}if(n>0)return e;if(a<0)return t;for(;;){var i=(e+t)/2;if(e==i||t==i)break;var f=r(i);if(isNaN(f))throw new Error("NaN encountered.");f<=0&&(e=i,n=f),f>=0&&(t=i,a=f)}return Math.abs(n)<=Math.abs(a)?e:t}function ir(r,e,t,n,a,o){t|=0,n|=0,a=+a,o=+o;for(var i=0|e;i-- >0;){var f=r[t],s=r[n];r[t]=a*f+o*s,r[n]=a*s-o*f,t=t+1|0,n=n+1|0}}function fr(r,e,t,n,a,o){t|=0,n|=0,a=+a,o=+o;for(var i=0|e;i-- >0;){var f=r[t],s=r[n];r[t]=a*f-o*s,r[n]=a*s+o*f,t=t+e|0,n=n+e|0}}var sr=function(){function r(){u()(this,r),this.sum=0,this.max=0,Object.seal(this)}return l()(r,[{key:"reset",value:function(){this.sum=this.max=0}},{key:"include",value:function(r){if(0!==(r=Math.abs(r))){if(this.max<r){var e=this.max/r;this.sum*=e*e,this.max=r}r/=this.max,this.sum+=r*r}}},{key:"resultIncl",value:function(r){r=Math.abs(r);var e=this.sum,t=this.max;if(0!==r){if(t<r){var n=t/r;e*=n*n,t=r}e+=(r/=t)*r}return isFinite(t)?Math.sqrt(e)*t:t}},{key:"result",get:function(){return isFinite(this.max)?Math.sqrt(this.sum)*this.max:this.max}}]),r}();function ur(r){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fro",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;switch(t){case"fro":e=new sr;break;default:throw new Error("norm(A,ord,axis): Unsupported ord: ".concat(t,"."))}if(null==n){var a=!0,o=!1,i=void 0;try{for(var f,s=r.data[Symbol.iterator]();!(a=(f=s.next()).done);a=!0){var u=f.value;e.include(u)}}catch(r){o=!0,i=r}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return e.result}throw new Error("norm(A,ord,axis): axis argument not yet supported.")}function cr(r,e,t){for(var n=r;--n>0;)for(var a=n;a-- >0;){var o=t+r*n+a,i=t+r*a+n,f=e[o];e[o]=e[i],e[i]=f}}function lr(r){var e=r.shape.slice(-2),t=q()(e,2),n=t[0];if(n!=t[1])throw new Error("In-place transposition is only supported for square matrices.");r=r.data;for(var a=0;a<r.length;a+=n*n)cr(n,r,a)}function hr(r,e,t,n,a,o,i){r|=0,e|=0,n|=0,i|=0;var f=new sr;if(r<e)throw new Error("Assertion failed.");for(var s=e;s-- >0;)o[i+e*s+s]=1;for(var u=0;u<e;u++){for(var c=n+e*u+u,l=u;++l<r;){var h=n+e*l+u,v=t[h];if(0!==v){var d=t[c],p=Math.hypot(d,v),w=d/p,m=v/p;0!==m&&(w<0&&(w*=-1,m*=-1,p*=-1),ir(t,e-1-u,c+1,h+1,w,m),t[c]=p),t[h]=m}}if(u<e-2){f.reset();for(var y=e;--y>u+1;)f.include(t[n+e*u+y]);if(0===f.max)continue;for(var b=f.resultIncl(t[c+1])*(t[c+1]>0?-1:1),g=f.resultIncl(t[c+1]-=b),x=u;++x<e;)t[n+e*u+x]/=g;for(var E=0;E<e;E++){for(var _=0,A=u;++A<e;)_+=o[i+e*E+A]*t[n+e*u+A];_*=2;for(var k=u;++k<e;)o[i+e*E+k]-=t[n+e*u+k]*_}for(var M=u;++M<r;){for(var S=0,P=u;++P<e;)S+=t[n+e*M+P]*t[n+e*u+P];S*=2;for(var I=u;++I<e;)t[n+e*M+I]-=t[n+e*u+I]*S}t[c+1]=b,t.fill(0,c+2,n+e*(u+1))}}cr(e,o,i);for(var N=e;--N>0;)a[i+e*N+N]=t[n+e*N+N],a[i+e*(N-1)+N]=t[n+e*(N-1)+N];a[i]=t[n];for(var j=0;j<e;j++)for(var q=j;q<e;q++)t[n+e*j+q]=+(j===q);for(var O=e;O-- >0;)for(var T=r;--T>O;){var L=t[n+e*T+O];if(0!==L)t[n+e*T+O]=0,ir(t,e-O,n+e*T+O,n+e*O+O,Math.sqrt((1+L)*(1-L)),L)}}function vr(r,e,t,n,a){r|=0,a|=0;for(var o=new sr,i=r;i-- >0;)e[a+r*i+i]=1;for(var f=r;f-- >0;)n[a+r*f+f]=1;for(var s=0;s<r-1;s++){for(var u=a+r*s+s,c=s;++c<r;){var l=a+r*c+s,h=t[l];if(0!==h){var v=t[u],d=Math.hypot(v,h),p=v/d,w=h/d;0!==w&&(t[u]=d,t[l]=0,ir(t,r-1-s,u+1,l+1,p,w),ir(e,1+c,a+r*s,a+r*c,p,w))}}o.reset();for(var m=r;--m>s+1;)o.include(t[a+r*s+m]);if(0!==o.max){for(var y=o.resultIncl(t[u+1])*(t[u+1]>0?-1:1),b=o.resultIncl(t[u+1]-=y),g=s;++g<r;)t[a+r*s+g]/=b;for(var x=0;x<r;x++){for(var E=0,_=s;++_<r;)E+=n[a+r*x+_]*t[a+r*s+_];E*=2;for(var A=s;++A<r;)n[a+r*x+A]-=t[a+r*s+A]*E}for(var k=s;++k<r;){for(var M=0,S=s;++S<r;)M+=t[a+r*k+S]*t[a+r*s+S];M*=2;for(var P=s;++P<r;)t[a+r*k+P]-=t[a+r*s+P]*M}t[u+1]=y,t.fill(0,u+2,a+r*(s+1))}}cr(r,n,a),cr(r,e,a)}function dr(r,e,t,n,a,o,i,f){if(n|=0,o|=0,f=f+(e|=0)|0,(r|=0)>e)throw Error("Assertion failed.");for(var s=new sr,u=r;u-- >0;)t[n+r*u+u]=1;for(var c=0;c<r&&c<e-1;c++){for(var l=f+e*c+c,h=c;++h<r;){var v=f+e*h+c,d=i[v];if(0!==d){var p=i[l],w=Math.hypot(p,d),m=p/w,y=d/w;i[v]=0,0!==y&&(i[l]=w,ir(i,e-1-c,l+1,v+1,m,y),ir(t,1+h,n+r*c,n+r*h,m,y))}}var b=f+e*(c-1);s.reset();for(var g=e-1;;){var x=i[b+g]=i[f+e*c+g];if(--g<=c)break;s.include(x)}if(0!==s.max){for(var E=s.resultIncl(i[b+(c+1)])*(i[b+(c+1)]>0?-1:1),_=s.resultIncl(i[b+(c+1)]-=E),A=c;++A<e;)i[b+A]/=_;if(0!==s.max){for(var k=c;++k<r;){for(var M=0,S=c;++S<e;)M+=i[f+e*k+S]*i[b+S];M*=2;for(var P=c;++P<e;)i[f+e*k+P]-=i[b+P]*M}i[l+1]=E}}else i[b+(c+1)]=0}cr(r,t,n);for(var I=r;I-- >0;)a[o+(r+1)*I+(I+1)]=I<e-1?i[f+e*I+(I+1)]:0,a[o+(r+1)*I+I]=i[f+e*I+I];for(var N=Math.min(r,e-1);--N,i.fill(0,f+e*N,f+e*(N+1)),i[f+e*N+(N+1)]=1,!(0>N);)for(var j=f+e*(N-1),q=N;q<r;q++){for(var O=0,T=N;++T<e;)O+=i[f+e*q+T]*i[j+T];O*=2;for(var L=N;++L<e;)i[f+e*q+L]-=i[j+L]*O}}function pr(r){if((r=z(r)).ndim<2)throw new Error("bidiag_decomp(A): A must be at least 2D.");if(r.dtype.startsWith("complex"))throw new Error("bidiag_decomp(A): complex A not yet supported.");var e="float32"===r.dtype?"float32":"float64",t=A[e],n=Int32Array.from(r.shape),a=Int32Array.from(n),o=Int32Array.from(n),i=r.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1],c=r.data.length/(u*s)|0,l=0|Math.min(s,u),h=0|(s>=u?l:l+1);n[n.length-1]=l,a[a.length-2]=l,a[a.length-1]=h,o[o.length-2]=h;var v=function(){if(u===s){for(var e=t.from(r.data),n=new t(e.length),a=new t(e.length),o=0;o<e.length;o+=s*s)vr(s,n,e,a,o);return[n,e,a]}if(s>u){var i=t.from(r.data);r=void 0;for(var f=new t(c*u*u),l=new t(c*u*u),h=0,v=0;v<f.length;h+=s*u,v+=u*u)hr(s,u,i,h,f,l,v);return[i,f,l]}var d=new t(c*(s+1)*u);r=r.data;for(var p=0,w=u;w<d.length;w+=u)for(var m=w+s*u;w<m;p++,w++)d[w]=r[p];r=void 0;for(var y=new t(c*s*s),b=new t(c*s*(s+1)),g=0,x=0,E=0;x<b.length;g+=s*s,x+=s*(s+1),E+=(s+1)*u)dr(s,u,y,g,b,x,d,E);return[y,b,d]}(),d=q()(v,3),p=d[0],w=d[1],m=d[2];return[new V(n,p),new V(a,w),new V(o,m)]}function wr(r){var e="float32"===(r=z(r)).dtype?"float32":"float64",t=r.shape,n=t.slice(-2),a=q()(n,2),o=a[0],i=a[1],f=A[e].from(r.data);if(r=void 0,o!=i)throw new Error("Last two dimensions must be quadratic.");for(var s=0;s<f.length;s+=o*o)for(var u=0;u<o;u++)for(var c=0;c<o;c++)if(u<c)f[s+o*u+c]=0;else{for(var l=f[s+o*u+c],h=0,v=0;v<c;v++){var d=h+f[s+o*u+v]*f[s+o*c+v],p=l-d;h=p-l+d,l=p}if(u>c)f[s+o*u+c]=l/f[s+o*c+c];else if(f[s+o*u+u]=Math.sqrt(l),isNaN(f[s+o*u+u]))throw new Error("Matrix contains NaNs or is (near) singular.")}return new V(t,f)}function mr(r,e){if(r=z(r),e=z(e),r.ndim<2)throw new Error("L must be at least 2D.");if(e.ndim<2)throw new Error("y must be at least 2D.");var t=r.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=e.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1];if(a!=o)throw new Error("Last two dimensions of L must be quadratic.");if(s!=o)throw new Error("L and y don't match.");var c=Math.max(r.ndim,e.ndim),l=Int32Array.from({length:c},(function(){return 1}));l[c-2]=s,l[c-1]=u;for(var h=0,v=[r,e];h<v.length;h++)for(var d=v[h],p=c-2,w=d.ndim-2;p-- >0&&w-- >0;)if(1===l[p])l[p]=d.shape[w];else if(l[p]!=d.shape[w]&&1!=d.shape[w])throw new Error("Shapes are not broadcast-compatible.");var m="float32"===r.dtype&&"float32"===e.dtype?"float32":"float64",y=new A[m](l.reduce((function(r,e){return r*e}),1)),b=r.data,g=e.data,x=0,E=1,_=0,k=1,M=0;return function t(n){if(n===c-2){E=a*a,k=a*u;for(var o=0;o<k;o++)y[M+o]=g[_+o];for(var i=0;i<s;i++)for(var f=0;f<u;f++){for(var h=0;h<i;h++)y[M+i*u+f]-=b[x+a*i+h]*y[M+h*u+f];y[M+i*u+f]/=b[x+a*i+i]}for(var v=s;v-- >0;)for(var d=u;d-- >0;){y[M+v*u+d]/=b[x+a*v+v];for(var p=v;p-- >0;)y[M+p*u+d]-=b[x+a*v+p]*y[M+v*u+d]}return x+=E,_+=k,void(M+=k)}for(var w=l[n];t(n+1),1!=w;w--)r.shape[n-c+r.ndim]>1||(x-=E),e.shape[n-c+e.ndim]>1||(_-=k);E*=r.shape[n-c+r.ndim]||1,k*=e.shape[n-c+e.ndim]||1}(0),new V(l,y)}function yr(r){if(r.ndim<1)throw new Error("diag_mat(diag): diag.ndim=".concat(r.ndim," is less than 1."));var e=(r=z(r)).shape,t=e[e.length-1],n=r.data,a=A[r.dtype].from({length:e.reduce((function(r,e){return r*e}))*t},(function(){return 0}));if(r=void 0,e.length<1)throw new Error("diag_mat(diag): diag must be at least 1d.");if(t<=0)throw new Error("Assertion Failed!");for(var o=0,i=0;;){for(var f=o+t;a[i]=n[o],++o!==f;)i+=t+1;if(++i==a.length)break}return new V(Int32Array.of.apply(Int32Array,w()(e).concat([t])),a)}function br(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(r.ndim<2)throw new Error("diag(A, offset): A.ndim=".concat(r.ndim," is less than 2."));var t=(r=z(r)).shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=r.shape.slice(0,-1),f=A[r.dtype];if(r=r.data,!(e>-a&&e<+o))throw new Error("diag(A, offset): offset=".concat(e," out of A.shape=[").concat(r.shape,"]."));var s=Math.min(a,a+e,o,o-e);i[i.length-1]=s;for(var u=new f(i.reduce((function(r,e){return r*e}))),c=Math.max(0,e,-e*o),l=0,h=0;h<r.length;l+=s,h+=a*o)for(var v=0;v<s;v++)u[l+v]=r[h+c+o*v+v];return new V(i,u)}function gr(r){if((r=z(r)).ndim<2)throw new Error("A must be at least 2D.");var e="float32"===r.dtype?"float32":"float64",t=A[e],n="float32"===e?16:8,a=r.shape,o=Int32Array.from(a),i=a.slice(-2),f=q()(i,2),s=f[0],u=f[1],c=t.from(r.data);r=void 0,o[o.length-1]=s;for(var l=new t(c.length/u*s),h=0,v=0;h<l.length;h+=s*s,v+=s*u){for(var d=0;d<s;d++)l[h+s*d+d]=1;for(var p=0;p<u;p+=n)for(var w=p;w<s;w+=n)for(var m=w;m<w+n&&m<s;m++)for(var y=p;y<p+n&&y<u&&y<m;y++){var b=v+u*m+y,g=c[b];if(0!==g){var x=v+u*y+y,E=c[x],_=Math.hypot(E,g),k=E/_,M=g/_;c[b]=0,0!==M&&(c[x]=_,ir(c,u-1-y,x+1,b+1,k,M),ir(l,1+m,h+s*y,h+s*m,k,M))}}cr(s,l,h)}return[new V(o,l),new V(a,c)]}function xr(r){if((r=z(r)).ndim<2)throw new Error("qr_decomp(A): A.ndim must be at least 2.");var e=A["float32"===r.dtype?"float32":"float64"],t=r.shape,n=Int32Array.from(t),a=t.slice(-2),o=q()(a,2),i=o[0],f=o[1];if(n[n.length-2]=f,i<=f)return gr(r);var s=e.from(r.data);r=void 0;for(var u=new e(s.length/i*f),c=0,l=0;l<s.length;l+=i*f,c+=f*f){for(var h=1;h<i;h++)for(var v=Math.min(h,f),d=0;d<v;d++){var p=l+f*h+d,w=s[p];if(0!==w){var m=l+f*d+d,y=s[m],b=Math.hypot(y,w),g=y/b,x=w/b;0!==x&&(g<0&&(g*=-1,x*=-1,b*=-1),ir(s,f-1-d,l+f*d+(d+1),l+f*h+(d+1),g,x),s[m]=b),s[p]=x}}for(var E=0;E<f;E++)for(var _=E;_<f;_++)u[c+f*E+_]=s[l+f*E+_],s[l+f*E+_]=+(E===_);for(var k=i;--k>0;)for(var M=Math.min(k,f);M-- >0;){var S=s[l+f*k+M];if(0!==S)s[l+f*k+M]=0,ir(s,f-M,l+f*k+M,l+f*M+M,Math.sqrt((1-S)*(1+S)),S)}}return[new V(t,s),new V(n,u)]}function Er(r,e,t){if(null==t){t=e;var n=r,a=q()(n,2);r=a[0],e=a[1]}if((r=z(r)).ndim<2)throw new Error("qr_lstsq(Q,R,y): Q.ndim must be at least 2.");if((e=z(e)).ndim<2)throw new Error("qr_lstsq(Q,R,y): R.ndim must be at least 2.");if((t=z(t)).ndim<2)throw new Error("qr_lstsq(Q,R,y): y.ndim must be at least 2.");var o=r.shape.slice(-2),i=q()(o,2),f=i[0],s=i[1],u=e.shape.slice(-1),c=q()(u,1)[0],l=t.shape.slice(-1),h=q()(l,1)[0],v=Math.min(s,c);if(f!=t.shape[t.ndim-2])throw new Error("qr_lstsq(Q,R,y): Q and y don't match.");if(s!=e.shape[e.ndim-2])throw new Error("qr_lstsq(Q,R,y): Q and R don't match.");if(c>f)throw new Error("qr_lstsq(Q,R,y): Under-determined systems not supported. Use rrqr instead.");var d=Math.max(r.ndim,e.ndim,t.ndim),p=Int32Array.from({length:d},(function(){return 1}));p[d-2]=c,p[d-1]=h;for(var w=0,m=[r,e,t];w<m.length;w++)for(var y=m[w],b=d-2,g=y.ndim-2;b-- >0&&g-- >0;)if(1===p[b])p[b]=y.shape[g];else if(p[b]!=y.shape[g]&&1!=y.shape[g])throw new Error("Q, R, y are not broadcast-compatible.");var x=new(0,A[[r,e,t].every((function(r){return"float32"===r.dtype}))?"float32":"float64"])(p.reduce((function(r,e){return r*e}),1)),E=r.data,_=e.data,k=t.data,M=0,S=1,P=0,I=1,N=0,j=1,O=0;return function n(a){if(a===d-2){S=f*s,I=s*c,j=f*h;for(var o=0;o<v;o++)for(var i=0;i<h;i++)for(var u=0;u<f;u++)x[O+o*h+i]+=E[M+u*s+o]*k[N+u*h+i];for(var l=v;l-- >0;)for(var w=h;w-- >0;){for(var m=v;--m>l;)x[O+l*h+w]-=_[P+c*l+m]*x[O+m*h+w];x[O+l*h+w]/=_[P+c*l+l]}return M+=S,P+=I,N+=j,void(O+=c*h)}for(var y=p[a];n(a+1),1!=y;y--)r.shape[a-d+r.ndim]>1||(M-=S),e.shape[a-d+e.ndim]>1||(P-=I),t.shape[a-d+t.ndim]>1||(N-=j);S*=r.shape[a-d+r.ndim]||1,I*=e.shape[a-d+e.ndim]||1,j*=t.shape[a-d+t.ndim]||1}(0),new V(p,x)}var _r=function(r){if((r=z(r)).ndim<2)throw new Error("det_tri(a): a.shape=[".concat(r.shape,"]; a.ndim must be at least 2."));var e=r.shape,t=e.slice(-2),n=q()(t,2),a=n[0],o=n[1];if(a!==o)throw new Error("det_tri(a): a must be square matrices.");var i=A[r.dtype],f=r.data;r=void 0;for(var s=new i(f.length/(o*o)),u=0,c=0;u<s.length;u++){var l=c;c+=o*o;for(var h=1;l<c;l+=o+1)h*=f[l];s[u]=h}return new V(e.slice(0,-2),s)},Ar=function(r){if((r=z(r)).ndim<2)throw new Error("det_tri(A): A.ndim must be at least 2.");var e=r.shape,t=e.slice(-2),n=q()(t,2),a=n[0],o=n[1];if(a!==o)throw new Error("det_tri(A): A must be square matrices.");for(var i=A["float32"===r.dtype?"float32":"float64"],f=new i((r=r.data).length/(o*o)),s=new i(f.length),u=0,c=0;u<s.length;u++){var l=c;c+=o*o;for(var h=1,v=0;l<c;l+=o+1)h*=Math.sign(r[l]),v+=Math.log(Math.abs(r[l]));f[u]=h,s[u]=v}var d=e.slice(0,-2);return[new V(d,f),new V(d,s)]},kr=function(r){var e=xr(r),t=q()(e,2),n=(t[0],t[1]);return _r(n)},Mr=function(r){var e=xr(r),t=q()(e,2),n=(t[0],t[1]);return Ar(n)};function Sr(r,e,t,n){n|=0;for(var a=(r|=0)-1;a-- >0;)e[n+r*a+a]=1;for(var o=new sr,i=n+r*(r-1),f=r;--f>1;){var s=n+r*f,u=s+(f-1);o.reset();for(var c=f-1;c-- >0;)o.include(t[s+c]);if(0!==o.max){for(var l=o.resultIncl(t[u])*(t[u]>0?-1:1),h=o.resultIncl(t[u]-=l),v=f;v-- >0;)t[s+v]=t[s+v]*Math.SQRT2/h;for(var d=f;d-- >0;){for(var p=0,w=f;w-- >0;)p+=t[n+r*d+w]*t[s+w];for(var m=f;m-- >0;)t[n+r*d+m]-=t[s+m]*p}e.fill(0,i,n+r*r);for(var y=f;y-- >0;)for(var b=r;b-- >0;)e[i+b]+=t[n+r*y+b]*t[s+y];for(var g=f;g-- >0;)for(var x=r;x-- >0;)t[n+r*g+x]-=t[s+g]*e[i+x];for(var E=r-1;E-- >0;){for(var _=0,A=f;A-- >0;)_+=e[n+r*E+A]*t[s+A];for(var k=f;k-- >0;)e[n+r*E+k]-=t[s+k]*_}t.fill(0,s,u),t[u]=l}}e.fill(0,i,n+r*r-1),e[n+r*r-1]=1}function Pr(r){if((r=z(r)).ndim<2)throw new Error("hessenberg_decomp(A): A must at least be 2D.");r.dtype;var e=A["float32"===r.dtype?"float32":"float64"],t=r.shape,n=0|t[t.length-1];if(n!=t[t.length-2])throw new Error("hessenberg_decomp(A): A must be square.");var a=e.from(r.data);r=void 0;for(var o=new e(a.length),i=a.length;(i-=n*n)>=0;)Sr(n,o,a,i);return[new V(t,o),new V(t,a)]}var Ir=y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=function(r){return new Function("A_shape","A","B_shape","B","C_shape","C","\n      const I = A_shape[A_shape.length-2],\n            K = A_shape[A_shape.length-1],\n            J = B_shape[B_shape.length-1]; \n      let\n        a = 0, aStride = 1,\n        b = 0, bStride = 1,\n        c = 0;\n\n      const loops = new Int32Array(C_shape.length-2);\n      for( let d=0; d >= 0; )\n        if( d === C_shape.length-2 ) {\n          aStride = I*K;\n          bStride = K*J;\n          for( const cEnd = c + I*J; c < cEnd; c += J, b -= bStride ) {\n          for( const aEnd = a + K  ; a < aEnd; c -= J, a++ ) {\n          for( const bEnd = b +   J; b < bEnd; c += 1, b++ ) {\n            ".concat(r,"\n          }}}\n          b += bStride;\n          d -= 1;\n        }\n        else\n        {\n          if( loops[d]++ > 0 ) {\n            if( loops[d] > C_shape[d] ) {\n              aStride *= A_shape[ d - C_shape.length + A_shape.length ] || 1;\n              bStride *= B_shape[ d - C_shape.length + B_shape.length ] || 1;\n              loops[d--] = 0;\n              continue;\n            }\n            if( ! (A_shape[ d - C_shape.length + A_shape.length ] > 1) ) a -= aStride;\n            if( ! (B_shape[ d - C_shape.length + B_shape.length ] > 1) ) b -= bStride;\n          }\n          ++d;\n        }\n    "))},r.next=3,e("C[c] += A[a]*B[b];");case 3:return r.next=5,e("\n    C[2*c+0] += A[a] * B[2*b+0];\n    C[2*c+1] += A[a] * B[2*b+1];\n  ");case 5:return r.next=7,e("\n    C[2*c+0] += B[b] * A[2*a+0];\n    C[2*c+1] += B[b] * A[2*a+1];\n  ");case 7:return r.next=9,e("\n    C[2*c+0] += B[2*b+0] * A[2*a+0]  -  B[2*b+1] * A[2*a+1];\n    C[2*c+1] += B[2*b+0] * A[2*a+1]  +  B[2*b+1] * A[2*a+0];\n  ");case 9:return r.next=11,e("C[c] = this.add(C[c], this.mul(A[a],B[b]));").bind(v);case 11:case"end":return r.stop()}}),r)}))(),Nr=q()(Ir,5),jr=Nr[0],qr=Nr[1],Or=Nr[2],Tr=Nr[3],Lr=Nr[4];function Fr(r,e){if(r=z(r),e=z(e),r.ndim<2)throw new Error("A must be at least 2D.");if(e.ndim<2)throw new Error("B must be at least 2D.");var t=r.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=e.shape[e.ndim-1];if(e.shape[e.ndim-2]!=o)throw new Error("The last dimension of A and the 2nd to last dimension of B do not match.");var f=Math.max(r.ndim,e.ndim),s=Int32Array.from({length:f},(function(){return 1}));s[f-2]=a,s[f-1]=i;for(var u=0,c=[r,e];u<c.length;u++)for(var l=c[u],h=f-2,v=l.ndim-2;h-- >0&&v-- >0;)if(1===s[h])s[h]=l.shape[v];else if(s[h]!=l.shape[v]&&1!=l.shape[v])throw new Error("Shapes are not broadcast-compatible.");var d=new(0,A[I(r.dtype,e.dtype)])(s.reduce((function(r,e){return r*e}),1));d instanceof Array&&d.fill(0);for(var p=0,w=0,m=[r,e];w<m.length;w++){switch(p*=3,m[w].dtype){default:p+=1;case"complex128":p+=1;case"int32":case"float32":case"float64":}}switch(p){case 0:jr(r.shape,r.data,e.shape,e.data,s,d);break;case 1:qr(r.shape,r.data,e.shape,e.data._array,s,d._array);break;case 3:Or(r.shape,r.data._array,e.shape,e.data,s,d._array);break;case 4:Tr(r.shape,r.data._array,e.shape,e.data._array,s,d._array);break;default:Lr(r.shape,r.data,e.shape,e.data,s,d)}return new V(s,d)}function Rr(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];if(1==(e=e.map(z)).length)return e[0];if(2==e.length)return Fr.apply(void 0,w()(e));function n(r,e){var t=r.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=e[e.length-1];if(e[e.length-2]!=o)throw new Error("Shape mismatch.");var f=Math.max(r.length,e.length),s=Int32Array.from({length:f},(function(){return 1}));s[f-2]=a,s[f-1]=i;for(var u=0,c=[r,e];u<c.length;u++)for(var l=c[u],h=f-2,v=l.length-2;h-- >0&&v-- >0;)if(1===s[h])s[h]=l[v];else if(s[h]!=l[v]&&1!=l[v])throw new Error("Shapes are not broadcast-compatible.");return[s.reduce((function(r,e){return r*e}),1)*o,s]}for(var a=Array.from({length:e.length},(function(){return[]})),o=0;o<e.length;o++)a[o][o]=[0,e[o].shape];for(var i=2;i<=e.length;i++)for(var f=0;f<=e.length-i;f++){for(var s=1/0,u=void 0,c=1;c<i;c++){var l=q()(a[f][f+c-1],2),h=l[0],v=l[1],d=q()(a[f+c][f+i-1],2),p=d[0],m=n(v,d[1]),y=q()(m,2),b=y[0],g=y[1];(b+=h+p)<s&&(s=b,u=g)}if(void 0===u)throw new Error("Integer overflow (too many FLOPs).");a[f][f+i-1]=[s,u]}return function r(t,o){if(t==o)return e[t];for(var i,f=1/0,s=t;s<o;s++){var u=q()(a[t][s],2),c=u[0],l=u[1],h=q()(a[s+1][o],2),v=h[0],d=n(l,h[1]),p=q()(d,2),w=p[0];p[1];(w+=c+v)<f&&(f=w,i=s)}return Fr(r(t,i),r(i+1,o))}(0,e.length-1)}var Ur=function(){function r(e,t){u()(this,r),this.re=1*e,this.im=1*t}return l()(r,[{key:"abs",value:function(){return Math.hypot(this.re,this.im)}},{key:"/=",value:function(r,e){if(0===e)this.re/=r,this.im/=r;else{var t=this.re;if(Math.abs(r)>=Math.abs(e)){var n=e/r;this.re=(t+this.im*n)/(r+e*n),this.im=(this.im-t*n)/(r+e*n)}else{var a=r/e;this.re=(t*a+this.im)/(r*a+e),this.im=(this.im*a-t)/(r*a+e)}}}},{key:"= c0*c1",value:function(r,e,t,n){this.re=r*t-e*n,this.im=r*n+e*t}},{key:"-= c0*c1",value:function(r,e,t,n){this.re-=r*t-e*n,this.im-=r*n+e*t}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(){return this.toString()}},{key:"toString",value:function(){return 0==this.im?this.re.toString():0==this.re?"".concat(this.im,"j"):this.im<0?"".concat(this.re," - ").concat(-this.im,"j"):"".concat(this.re," + ").concat(this.im,"j")}}]),r}();function Qr(r){var e=(r=z(r)).shape.slice(-1),t=q()(e,1)[0],n=r.shape.slice(0,-1),a=new A.complex128(r.data.length/t);if(r.shape[r.ndim-2]!=t)throw new Error("T is not square.");r=r.data;for(var o=0,i=function(e,n){return r[o+t*e+n]},f=0;o<r.length;o+=t*t,f+=t)for(var s=t-1;s>=0;s--){var u=s-1;if(0===s||0==i(s,u))a[f+s]=i(s,s);else{var c=i(u,u),l=i(u,s),v=i(s,u),d=i(s,s),p=h.add(c,d),w=h.sub(h.mul(c,d),h.mul(l,v)),m=void 0,y=void 0,b=h.sqrt(h.sub(h.mul(p,p),h.mul(w,4)));if(p*p>=4*w)throw new Error("schur_eigenvals(T): T must not contain real eigenvalued 2x2 blocks.");m=h.mul(h.add(p,b),.5),y=h.mul(h.sub(p,b),.5),a[f+u]=m,a[f+s]=y,s--}}return new V(n,a)}function Dr(r,e){if(r=z(r),e=z(e),r.ndim!=e.ndim)throw new Error("Q.ndim != T.ndim.");for(var t=e.ndim;t-- >0;)if(r.shape[t]!=e.shape[t])throw new Error("Q.shape != T.shape.");var n=e.shape.slice(-1),a=q()(n,1)[0],o=e.shape,i=o.slice(0,-1);if(e.shape[e.ndim-2]!=a)throw new Error("Q is not square.");var f=A.complex128,s=f.from(e.data);e=void 0;var u=new f(s.length/a),c=s._array,l=(u._array,new f(a)),v=l._array,d=new f(a),p=d._array,w=l._array.subarray(0,a),m=d._array.subarray(a),y=new Ur(NaN,NaN),b=new Ur(NaN,NaN),g=new Ur(NaN,NaN),x=NaN;function E(r,e,t){for(var n=Math.min(a,t+2),o=e._array,i=t;i-- >0;){for(var f=n;--f>i;){var s=o[2*f+0],u=c[2*(_+a*i+f)+0],l=o[2*f+1],h=c[2*(_+a*i+f)+1];o[2*i+0]-=s*u-l*h,o[2*i+1]-=s*h+l*u}if(0==i||0==k(i,i-1)){var v=c[2*(_+a*i+i)+0]-r.re,d=c[2*(_+a*i+i)+1]-r.im;b.re=o[2*i+0],b.im=o[2*i+1],Math.hypot(v,d)<=x?b.abs()<=x?(o[2*i+0]=0,o[2*i+1]=0):(o[2*i]=1,o.fill(0,2*i+1,2*n)):(b["/="](v,d),o[2*i+0]=b.re,o[2*i+1]=b.im)}else{for(var p=i-1,w=n;--w>i;){var m=o[2*w+0],E=c[2*(_+a*p+w)+0],A=o[2*w+1],M=c[2*(_+a*p+w)+1];o[2*p+0]-=m*E-A*M,o[2*p+1]-=m*M+A*E}var S=c[2*(_+a*p+p)+0]-r.re,P=c[2*(_+a*p+p)+1]-r.im,I=c[2*(_+a*i+i)+0]-r.re,N=c[2*(_+a*i+i)+1]-r.im,j=c[2*(_+a*p+i)+0],q=c[2*(_+a*p+i)+1],O=c[2*(_+a*i+p)+0],T=c[2*(_+a*i+p)+1];if(g["= c0*c1"](S,P,I,N),g["-= c0*c1"](j,q,O,T),0===g.re&&0===g.im)throw new Error("Assertion failed.");b["= c0*c1"](S,P,o[2*i+0],o[2*i+1]),b["-= c0*c1"](O,T,o[2*p+0],o[2*p+1]),b["/="](g.re,g.im),y["= c0*c1"](I,N,o[2*p+0],o[2*p+1]),y["-= c0*c1"](j,q,o[2*i+0],o[2*i+1]),y["/="](g.re,g.im),o[2*p+0]=y.re,o[2*p+1]=y.im,o[2*i+0]=b.re,o[2*i+1]=b.im,i--}}}for(var _=0,k=function(r,e){return s[_+a*r+e]},M=0;_<s.length;_+=a*a,M+=a){if(!((x=Math.sqrt(Number.EPSILON)*function(){for(var r=0,e=0,t=_+a*a,n=_;n<t;n++){var o=h.abs(s[n]);0!=o&&(o>e&&(r*=Math.pow(e/o,2),e=o),r+=Math.pow(o/e,2))}return Math.sqrt(r)*e}())>=0))throw new Error("Assertion failed.");for(var S=a-1;S>=0;S--){var P=S-1;if(0==S||0==k(S,P)){var I=k(S,S);u[M+S]=I,l.fill(0,0,S+2),l[S]=1,E(I,l,S);for(var N=Math.min(a,S+2);N-- >0;)c[2*(_+a*N+S)+0]=v[2*N+0],c[2*(_+a*N+S)+1]=v[2*N+1]}else{var j=k(P,P),O=k(P,S),T=k(S,P),L=k(S,S),F=h.add(j,L),R=h.sub(h.mul(j,L),h.mul(O,T)),U=void 0,Q=void 0,D=h.sqrt(h.sub(h.mul(F,F),h.mul(R,4)));if(F*F>=4*R)throw new Error("The given Schur decomposition must not contain 2x2 diagonal blocks with real eigenvalues.");U=h.mul(h.add(F,D),.5),Q=h.mul(h.sub(F,D),.5),v.fill(0,0,2*(S+1)),p.fill(0,0,2*(S+1)),h.abs(O)>=h.abs(T)?(l[P]=O,l[S]=h.sub(U,j),d[P]=O,d[S]=h.sub(Q,j)):(l[S]=T,l[P]=h.sub(U,L),d[S]=T,d[P]=h.sub(Q,L)),E(U,l,P),E(Q,d,P);for(var C=S+1;C-- >0;)c[2*(_+a*C+P)+0]=v[2*C+0],c[2*(_+a*C+P)+1]=v[2*C+1],c[2*(_+a*C+S)+0]=p[2*C+0],c[2*(_+a*C+S)+1]=p[2*C+1];u[M+P]=U,u[M+S]=Q,--S}}w.fill(0),m.fill(0);for(var B=0;B<a;B++)for(var Y=0;Y<2*a;Y++){var G=Y>>>1,J=Math.abs(c[2*(_+a*B)+Y]);if(J>0){if(J>m[G]){var H=m[G]/J;m[G]=J,w[G]*=H*H}var W=J/m[G];w[G]+=W*W}}for(var X=w,K=0;K<a;K++){var $=m[K];X[K]=isFinite($)?Math.sqrt(w[K])*$:$}for(var Z=0;Z<a;Z++)for(var rr=0;rr<a;rr++)s[_+a*Z+rr]=h.div(s[_+a*Z+rr],X[rr])}return[new V(i,u),Fr(r,new V(o,s))]}function Cr(r){(r=z(r)).shape[r.ndim-1];var e=Pr(r),t=q()(e,2),n=t[0],a=t[1];return r=void 0,function(r,e){var t=r.shape[r.ndim-1],n=A[r.dtype],a=new n(t);if(r.shape[r.ndim-2]!=t)throw new Error("Q is not square.");if(r.ndim!=e.ndim)throw new Error("Q.ndim != H.ndim.");for(var o=r.ndim;o-- >0;)if(r.shape[o]!=e.shape[o])throw new Error("Q.shape != H.shape.");r=r.data,e=e.data;for(var i=Number.EPSILON,f=function r(o,f,s,u){for(var c=function(r,n){return e[u+t*r+n]},l=function(r){return!(Math.abs(c(r,r-1))>i*(Math.abs(c(r-1,r-1))+Math.abs(c(r,r))))&&(e[u+t*r+r-1]*=0,!0)},h=function(r,n,a,i){if(n<=r)throw new Error("Assertion failed.");for(var c=Math.max(0,r-1);c<s;c++){var l=e[u+t*r+c],h=e[u+t*n+c];e[u+t*r+c]=i*h+a*l,e[u+t*n+c]=a*h-i*l}for(var v=Math.min(s,n+2);v-- >0;){var d=e[u+t*v+r],p=e[u+t*v+n];e[u+t*v+r]=i*p+a*d,e[u+t*v+n]=a*p-i*d}for(var w=s;w-- >0;){var m=o[f+s*r+w],y=o[f+s*n+w];o[f+s*r+w]=i*y+a*m,o[f+s*n+w]=a*y-i*m}},v=function(i,c){if(c-i>s>>>1)throw new Error("Assertion failed.");var l=c-i;if(l<3)throw new Error("Assertion failed.");for(var h=new n(l*l),v=0;v<l;v++)h[l*v+v]=1;r(h,0,l,u+t*i+i);for(var d=0;d<l;d++)for(var p=0;p<d;p++){var w=h[l*d+p];h[l*d+p]=h[l*p+d],h[l*p+d]=w}for(var m=0;m<s;m++){a.fill(0,0,l);for(var y=0;y<l;y++)for(var b=0;b<l;b++)a[b]+=h[l*y+b]*o[f+s*(i+y)+m];for(var g=0;g<l;g++)o[f+s*(i+g)+m]=a[g]}for(var x=c;x<s;x++){a.fill(0,0,l);for(var E=0;E<l;E++)for(var _=0;_<l;_++)a[_]+=h[l*E+_]*e[u+t*(i+E)+x];for(var A=0;A<l;A++)e[u+t*(i+A)+x]=a[A]}for(var k=0;k<i;k++){a.fill(0,0,l);for(var M=0;M<l;M++)for(var S=0;S<l;S++)a[S]+=h[l*M+S]*e[u+t*k+(i+M)];for(var P=0;P<l;P++)e[u+t*k+(i+P)]=a[P]}},d=0,p=0,w=s;;){for(var m=!1;!m;){if(w-p<3)return;if(w-p<s>>>4)return v(p,w);m=!1,l(p+1)?p+=1:l(w-1)?w-=1:l(p+2)?p+=2:l(w-2)?w-=2:m=!0;for(var y=p+w>>>1,b=p+2;m&&++b<w-2;)l(b)&&(m=!1,b>y?(v(b,w),w=b):(v(p,b),p=b));m||(d=0)}d+=1;var g=w-2,x=w-1,E=c(g,g)+c(x,x),_=c(g,g)*c(x,x)-c(g,x)*c(x,g);if(E*E>4*_){var A=E>=0?1:-1,k=.5*(E+A*Math.sqrt(E*E-4*_)),M=2*_/(E+A*Math.sqrt(E*E-4*_));Math.abs(c(x,x)-k)>Math.abs(c(x,x)-M)&&(k=M),E=2*k,_=k*k}if(d%16==0){if(d>1e9)throw new Error("Too many iterations for a single eigenvalue.");_=(E=Math.abs(c(x,g))+Math.abs(c(g,w-3)))*E,E*=.5*Math.random()+1.25}x=p+1;for(var S=p+2,P=c(g=p+0,g)*c(g,g)+c(g,x)*c(x,g)-E*c(g,g)+_,I=c(x,g)*(c(g,g)+c(x,x)-E),N=c(x,g)*c(S,x),j=2;j-- >0;x=S,I=N)if(0!=I){var q=Math.hypot(P,I),O=P/q,T=I/q;h(g,x,O,T),P=O*P+T*I}for(var L=p;L<w-2;L++){g=L+1;var F=Math.min(w,L+4);for(x=L+2;x<F;x++){var R=c(g,L),U=c(x,L);if(0!=U){var Q=Math.hypot(R,U);h(g,x,R/Q,U/Q),e[u+t*x+L]*=0}}}}},s=0;s<r.length;s+=t*t){for(var u=0;u<t;u++)for(var c=0;c<u;c++){var l=r[s+t*u+c];r[s+t*u+c]=r[s+t*c+u],r[s+t*c+u]=l}f(r,s,t,s);for(var h=1;h<t;h++){var v=h-1;if(0!=e[s+t*h+v])if("continue"===function(){var n=e[s+t*v+v],a=e[s+t*v+h],o=e[s+t*h+v],i=e[s+t*h+h],f=n+i;if(f*f<4*(n*i-a*o))return"continue";for(var u=Math.atan2(i-n,a+o)/2,c=or((function(r){return(o*Math.cos(r)-n*Math.sin(r))*Math.cos(r)+(i*Math.cos(r)-a*Math.sin(r))*Math.sin(r)}),u,u+Math.PI/2*(u<=0?1:-1)),l=Math.cos(c),d=Math.sin(c),p=v;p<t;p++){var w=e[s+t*v+p],m=e[s+t*h+p];e[s+t*v+p]=d*m+l*w,e[s+t*h+p]=l*m-d*w}for(var y=h+1;y-- >0;){var b=e[s+t*y+v],g=e[s+t*y+h];e[s+t*y+v]=d*g+l*b,e[s+t*y+h]=l*g-d*b}for(var x=t;x-- >0;){var E=r[s+t*v+x],_=r[s+t*h+x];r[s+t*v+x]=d*_+l*E,r[s+t*h+x]=l*_-d*E}e[s+t*h+v]*=0}())continue}for(var d=0;d<t;d++)for(var p=0;p<d;p++){var w=r[s+t*d+p];r[s+t*d+p]=r[s+t*p+d],r[s+t*p+d]=w}}}(n,a),[n,a]}function Br(r){var e=Yr(r,2),t=q()(e,2),n=t[0],a=Cr(t[1]),o=q()(a,2),i=Dr(o[0],o[1]),f=q()(i,2),s=f[0],u=f[1];if(!u.dtype.startsWith("complex"))throw new Error("Assertion failed.");if(!n.dtype.startsWith("float"))throw new Error("Assertion failed.");for(var c=r.shape[r.ndim-1],l=new Float64Array(c),h=new Float64Array(c),v=u.data._array,d=n.data,p=0,w=0;w<v.length;p+=c,w+=2*c*c){l.fill(0),h.fill(0);for(var m=0;m<c;m++)for(var y=d[p+m],b=0;b<2*c;b++){var g=Math.abs(v[w+2*c*m+b]*=y);if(g>0){var x=b>>1;g>h[x]&&(l[x]*=Math.pow(h[x]/g,2),h[x]=g),l[x]+=Math.pow(g/h[x],2)}}for(var E=0;E<c;E++){var _=h[E];l[E]=isFinite(_)?Math.sqrt(l[E])*_:_}for(var A=0;A<c;A++)for(var k=0;k<2*c;k++)v[w+2*c*A+k]/=l[k>>1]}return[s,u]}function zr(r){var e=Yr(r,2),t=q()(e,2),n=(t[0],Cr(t[1])),a=q()(n,2);a[0];return Qr(a[1])}function Yr(r,e){if(null==e&&(e=2),e>Number.MAX_VALUE)return function(r){var e=r.shape[r.ndim-1],t=A["float32"===r.dtype?"float32":"float64"],n=r.shape,a=n.slice(0,-1);if(r.shape[r.ndim-2]!=e)throw new Error("A is not square");r=t.from(r.data);var o=new t(r.length/e);o.fill(1);for(var i=r.length,f=o.length;i>0;){i-=e*e,f-=e;for(var s,u=!1;!u;)for(s=0,u=!0;s<e;s++){for(var c=0,l=0,h=0;h<e;h++)if(s!==h){var v=Math.abs(r[i+e*s+h]);l=Math.max(l,v);var d=Math.abs(r[i+e*h+s]);c=Math.max(c,d)}if(l*c!=0){var p=Math.max(c,l);if(0!=p){if(!isFinite(p))throw new Error("NaN encountered.");for(var w=1;l>=2*c;)c*=2,l/=2,w*=2;for(;c>=2*l;)c/=2,l*=2,w/=2;if(!(Math.max(c,l)>=p)){u=!1,o[f+s]*=w;for(var m=0;m<e;m++)r[i+e*s+m]/=w,r[i+e*m+s]*=w}}}}}return[new V(a,o),new V(n,r)]}(r);var t=r.shape[r.ndim-1],n=A["float32"===r.dtype?"float32":"float64"],a=r.shape,o=a.slice(0,-1);if(!(e>=1))throw new Error("Invalid norm p=".concat(e,";"));if(r.shape[r.ndim-2]!=t)throw new Error("A is not square");r=n.from(r.data);var i=new n(r.length/t),f=Math.pow(.95,1/e);i.fill(1);for(var s=r.length,u=i.length;s>0;){s-=t*t,u-=t;for(var c,l=!1;!l;)for(c=0,l=!0;c<t;c++){for(var h=0,v=0,d=0,p=0,w=0;w<t;w++)if(c!==w){var m=Math.abs(r[s+t*c+w]);if(m>0){if(m>p){var y=p/m;p=m,d*=Math.pow(y,e)}var b=m/p;d+=Math.pow(b,e)}var g=Math.abs(r[s+t*w+c]);if(g>0){if(g>v){var x=v/g;v=g,h*=Math.pow(x,e)}var E=g/v;h+=Math.pow(E,e)}}if((d=isFinite(d)?Math.pow(d,1/e)*p:d)*(h=isFinite(h)?Math.pow(h,1/e)*v:h)!=0){if(!isFinite(d*h))throw new Error("NaN encountered.");for(var _=h>=d?Math.pow(1+Math.pow(d/h,e),1/e)*h:Math.pow(1+Math.pow(h/d,e),1/e)*d,k=1;d>=2*h;)h*=2,d/=2,k*=2;for(;h>=2*d;)h/=2,d*=2,k/=2;if(!((h>=d?Math.pow(1+Math.pow(d/h,e),1/e)*h:Math.pow(1+Math.pow(h/d,e),1/e)*d)>=f*_)){l=!1,i[u+c]*=k;for(var M=0;M<t;M++)r[s+t*c+M]/=k,r[s+t*M+c]*=k}}}}return[new V(o,i),new V(a,r)]}function Vr(r,e){if(e.ndim<2)throw new Error("eigen_balance_post(D,V): V.ndim must be at least 2.");var t=e.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1];if(a!==o)throw new Error("eigen_balance_post(D,V): V must be square.");var i=A.float64,f=C([e,r.reshape.apply(r,w()(r.shape).concat([1]))],"complex128",v.mul);e=f.data;for(var s=new i(o),u=new i(o),c=0;c<e.length;c+=a*o){s.fill(0),u.fill(0);for(var l=0;l<o;l++)for(var h=0;h<o;h++){var d=v.abs(e[c+o*l+h]);d>0&&(d>u[h]&&(s[h]*=Math.pow(u[h]/d,2),u[h]=d),s[h]+=Math.pow(d/u[h],2))}for(var p=0;p<o;p++){var m=u[p];s[p]=isFinite(m)?Math.sqrt(s[p])*m:m}for(var y=0;y<o;y++)for(var b=0;b<o;b++)e[c+o*y+b]=v.div(e[c+o*y+b],s[b])}return f}function Gr(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=e[0]in A?e.shift():"float64";if(e.length<1)throw new Error("Size parameter missing.");1==e.length&&e.push(e[e.length-1]),e=Int32Array.from(e,(function(r){if(0!=r%1)throw new Error("eye(): Invalid shape [".concat(e,"]."));return r}));for(var a=new A[n](e.reduce((function(r,e){return r*e}))),o=e.slice(-2),i=q()(o,2),f=i[0],s=i[1],u=a.length;(u-=f*s)>=0;)for(var c=Math.min(f,s);c-- >0;)a[u+s*c+c]=1;return new V(e,a)}var Jr=function(r){function e(r){var t,n;u()(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];if(n=T()(this,(t=K()(e)).call.apply(t,[this].concat(o))),!(r instanceof V))throw new Error("Assertion failed.");return n.x=r,n}return F()(e,r),e}(D()(Error));function Hr(r,e,t,n){var a=Math.atan2(t-e,n+r),o=Math.atan2(t+e,n-r),i=(a-o)/2,f=(a+o)/2,s=Math.cos(i),u=Math.sin(i),c=Math.cos(f),l=Math.sin(f);if(a=c*(u*t+s*r)-l*(u*n+s*e),o=l*(s*t-u*r)+c*(s*n-u*e),Math.abs(a)<Math.abs(o)){var h=[s,-u];u=h[0],s=h[1];var v=[l,-c];c=v[0],l=v[1],a=o}return a<0&&(c=-c,l=-l),[s,u,c,l]}function Wr(r,e,t,n,a,o,i,f){r|=0,a|=0,i|=0;for(var s=0;s<r;s++)o[i+s]=t[r*s+s];Xr(r,e,n,a,o,i,f)}function Xr(r,e,t,n,a,o,i){n|=0,o|=0;for(var f=r|=0;f-- >0;){var s=a[o+f];if(s<0||Object.is(s,-0)){a[o+f]=-s;for(var u=0;u<r;u++)e[n+r*f+u]*=-1}}i.sort((function(r,e){return a[o+e]-a[o+r]}));for(var c=0;c<r;++c)for(var l=c;;){var h=i[l];if(i[l]=l,(l=h)<=c)break;for(var v=n+i[l]*r,d=n+l*r,p=0;p<r;p++){var w=e[v+p];e[v+p]=e[d+p],e[d+p]=w}for(var m=0;m<r;m++){var y=t[v+m];t[v+m]=t[d+m],t[d+m]=y}h=a[o+i[l]],a[o+i[l]]=a[o+l],a[o+l]=h}for(var b=0;b<r-1;b++)for(var g=b;++g<r;){var x=n+r*b+g,E=n+r*g+b,_=e[x];e[x]=e[E],e[E]=_}}var Kr=function(r,e,t,n,a,o){r|=0,t|=0,o|=0;var i=n[a|=0],f=n[a+1],s=Math.hypot(i,f);0!==s?(i/=s,f/=s,n[a]=s,n[a+1]=NaN,n[o]=i,n[o+1]=-f,n[o+1*r]=f,n[o+1*r+1]=i):(n[o]=1,n[o+1*r+1]=1),e[t]=1},$r=function(r,e,t,n,a,o){t|=0,o|=0;var i=(r|=0)-1|0,f=n[a|=0],s=n[a+1],u=n[a+2],c=n[a+3];if(0!==c){var l=Math.hypot(u,c),h=u/l,v=c/l;if(n[o+1*r+1]=h,n[o+2*r+1]=v,u=l,c=-v*s,s*=h,0!==c){var d=Math.hypot(f,c),p=f/d,w=c/d;f=d,n[o]=p,n[o+1*r]=w*-v,n[o+2*r]=w*h,n[o+2]=-w,n[o+1*r+2]=p*-v,n[o+2*r+2]=p*h}else n[o]=1,n[o+1*r+2]=-v,n[o+2*r+2]=h}else n[o]=1,n[o+1*r+1]=1,n[o+2*r+2]=1;var m=Hr(f,s,0,u),y=q()(m,4),b=y[0],g=y[1],x=y[2],E=y[3];n[a+1]=NaN,n[a+3]=NaN,n[a]=b*f*x-(b*s+g*u)*E;var _=(u=(-g*s+b*u)*x-g*f*E)<0?-1:1;n[a+2]=_*u,e[t]=b,e[t+1]=-g*_,e[t+1*i]=g,e[t+1*i+1]=b*_,n[o+1]=E*n[o],n[o]*=x;var A=n[o+1*r]*x-n[o+1*r+1]*E;n[o+1*r+1]=n[o+1*r]*E+n[o+1*r+1]*x,n[o+1*r]=A;var k=n[o+2*r]*x-n[o+2*r+1]*E;n[o+2*r+1]=n[o+2*r]*E+n[o+2*r+1]*x,n[o+2*r]=k},Zr=function(r,e,t,n,a,o,i,f){n|=0,o|=0,i|=0;var s=(r|=0)-1|0,u=(e|=0)-1|0;if(f.length<3*s)throw new Error("Assertion failed: Integer work matrix I too small.");if(a.length<s*(s+2)+2*s+(s+1)*(s+1))throw new Error("Assertion failed: Scalar work matrix F too small.");var c=s*(s+2)-u,l=s*(s+2)-2*u,h=s*(s+2)-u*(u+2),v=2*u,d=u;if(e<2)throw new Error("Assertion failed.");if(0!==a[o+2*u-2])throw new Error("Assertion failed.");for(var p=1;p<u;p++)if(a[o+2*(p-1)]<a[o+2*p])throw new Error("Assertion failed.");for(var w=new sr,m=function(){for(var r=0;r<u;r++)w.include(a[o+2*r+1]);for(var e=w.result,t=0;t<u;t++)w.include(a[o+2*t]);var n=w.result;return 0===n&&(n=1),[e/n,n]}(),y=q()(m,2),b=y[0],g=y[1],x=0;x<2*u;x++)a[o+x]/=g;for(var E=k(t instanceof Float32Array?"float32":"float64"),_=function(){for(var r=0,e=u-1,t=u-1;t-- >0;){var n=a[o+2*t],i=a[o+2*t+1],s=f[0+t];Math.abs(i)/E<=n?(a[c+r]=n,f[d+r]=s,++r):(--e,a[o+2*e]=n,a[o+2*e+1]=a[o+2*t+1],f[d+e]=s)}return r}(),A=0;A<_;A++)f[0+A]=f[d+A];for(var M=function(){for(var r=_,e=u-1,t=u-1;t-- >_;){var n=a[o+2*t],i=a[o+2*e],s=f[d+t],l=a[o+2*t+1],p=a[o+2*e+1],w=Math.hypot(l,p);if((n-i)/E<=n||!isFinite(Math.sqrt(u)/(n-i))){var m=p/w,y=l/w;a[h+2*r]=m,a[h+2*r+1]=y,a[o+2*e+1]=w,a[o+2*e]=a[c+r]=n,f[0+r]=s,f[v+r]=e,++r}else--e,a[o+2*e]=n,a[o+2*e+1]=a[o+2*t+1],f[0+e]=s}return r}(),S=2*_;S<2*M;S++)a[o+S]=a[h+S],a[h+S]=0;for(var P=function(r){var e=a[o+2*r],t=M<r?a[o+2*r-2]:e+b;if(e>t)throw new Error("Assertion failed.");for(var n=function(){if(r>M){for(var n=(e+t)/2,i=1,f=M;f<u;f++){var s=a[o+2*f],c=a[o+2*f+1];i+=c/(s-n)*(c/(s+n))}if(!isFinite(i))throw new Error("Assertion failed.");if(i<0){var l=t;return e-=t,t=-Number.MIN_VALUE,l}}var h=e;return t-=e,e=+Number.MIN_VALUE,h}();;){var i=(e+t)/2;if(i===e||i===t){a[c+r]=i;break}for(var f=1,s=M;s<u;s++){var l=a[o+2*s],h=a[o+2*s+1];f+=h/(l-n-i)*(h/(l+n+i))}if(!isFinite(f))throw new Error("Assertion failed.");f<=0&&(e=i),f>=0&&(t=i)}},I=M;I<u;I++)P(I);0===Math.abs(a[o+2*u-1])&&(a[o+2*u-2]=0,a[o+2*u-1]=0,a[c+u-1]=0);for(var N=a[c+u-1],j=a[o+2*(u-1-(N<0))],O=M;O<u;O++){for(var T=a[o+2*O],L=(j-T+N)*(j+T+N),F=M;F<O;F++){var R=a[c+F],U=a[o+2*(F-(R<0))],Q=a[o+2*F];L*=(U-T+R)/(Q-T)*((U+T+R)/(Q+T))}for(var D=O;D<u-1;D++){var C=a[c+D],B=a[o+2*(D-(C<0))],z=a[o+2*D+2];L*=(B-T+C)/(z-T)*((B+T+C)/(z+T))}a[o+2*O+1]=Math.sign(a[o+2*O+1])*Math.sqrt(L)}for(var Y=_-1,V=M-1,G=M,J=0;J<u;J++){var H=-1/0,W=3;if(G<u){var X=a[c+G];W=2,H=X+a[o+2*(G-(X<0))]}if(V>=_){var K=a[c+V];K<H||(W=1,H=K)}if(Y>=0){var $=a[c+Y];$<H||(W=0,H=$)}switch(W){case 0:f[d+Y--]=J;continue;case 1:f[d+V--]=J;continue;case 2:f[d+G++]=J;continue;default:throw new Error("Assertion failed.")}}for(var Z=M;Z<u;Z++){var rr=a[c+Z],er=a[o+2*(Z-(rr<0))];w.reset();for(var tr=M;tr<u-1;tr++){var nr=a[o+2*tr],ar=a[o+2*tr+1]/(nr-er-rr)*(nr/(nr+er+rr));w.include(a[h+u*Z+tr]=ar)}w.include(a[h+u*Z+u-1]=-1);var or=w.result;if(!(0<or))throw new Error("Assertion failed.");for(var fr=M;fr<u;fr++)a[h+u*Z+fr]/=or}for(var ur=M;ur<u;ur++)for(var cr=ur;++cr<u;){var lr=a[h+u*ur+cr];a[h+u*ur+cr]=a[h+u*cr+ur],a[h+u*cr+ur]=lr}if(_<M){for(var hr=_;hr<M;hr++)a.fill(0,h+u*hr+_,h+u*hr+u),a[h+u*hr+hr]=1;for(var vr=M;vr<u;vr++)a.fill(0,h+u*vr+_,h+u*vr+M);for(var dr=M;dr-- >_;){var pr=f[v+dr];if(pr<u-1){var wr=a[o+2*dr],mr=a[o+2*dr+1];ir(a,u-dr,h+u*dr+dr,h+u*pr+dr,wr,mr)}}}for(var yr=0;yr<u;yr++){a.fill(0,l+_,l+u);for(var br=_;br<u;br++){var gr=t[n+s*yr+f[0+br]];if(0!==gr)for(var xr=_;xr<u;xr++)a[l+xr]+=gr*a[h+u*br+xr]}for(var Er=0;Er<_;Er++){var _r=f[0+Er];a[l+Er]=t[n+s*yr+_r]}for(var Ar=0;Ar<u;Ar++){t[n+s*yr+f[d+Ar]]=a[l+Ar]}}for(var kr=M;kr<u;kr++){var Mr=a[c+kr],Sr=a[o+2*(kr-(Mr<0))];w.reset();for(var Pr=M;Pr<u;Pr++){var Ir=a[o+2*Pr],Nr=a[o+2*Pr+1]/(Ir-Sr-Mr)/(Ir+Sr+Mr);w.include(a[h+u*kr+Pr]=Nr)}var jr=w.result;if(!(0<jr||kr===u-1))throw new Error("Assertion failed.");for(var qr=M;qr<u;qr++)a[h+u*kr+qr]/=jr}if(0===a[o+2*u-1]){for(var Or=M;Or<u-1;Or++)a[h+u*(u-1)+Or]=0;a[h+u*(u-1)+(u-1)]=1}for(var Tr=M;Tr<u;Tr++)for(var Lr=Tr;++Lr<u;){var Fr=a[h+u*Tr+Lr];a[h+u*Tr+Lr]=a[h+u*Lr+Tr],a[h+u*Lr+Tr]=Fr}if(_<M){for(var Rr=_;Rr<M;Rr++)a.fill(0,h+u*Rr+_,h+u*Rr+u),a[h+u*Rr+Rr]=1;for(var Ur=M;Ur<u;Ur++)a.fill(0,h+u*Ur+_,h+u*Ur+M);for(var Qr=M;Qr-- >_;){var Dr=f[v+Qr],Cr=a[o+2*Qr],Br=a[o+2*Qr+1];ir(a,u-Qr,h+u*Qr+Qr,h+u*Dr+Qr,Cr,Br)}}for(var zr=0;zr<e;zr++){a.fill(0,l+_,l+u);for(var Yr=_;Yr<u;Yr++){var Vr=a[i+r*zr+f[0+Yr]];if(0!==Vr)for(var Gr=_;Gr<u;Gr++)a[l+Gr]+=Vr*a[h+u*Yr+Gr]}for(var Jr=0;Jr<_;Jr++){var Hr=f[0+Jr];a[l+Jr]=a[i+r*zr+Hr]}for(var Wr=0;Wr<u;Wr++){var Xr=f[d+Wr];a[i+r*zr+Xr]=a[l+Wr]}}for(var Kr=M;Kr<u;Kr++)a[c+Kr]+=a[o+2*(Kr-(a[c+Kr]<0))];for(var $r=0;$r<u;$r++){var Zr=f[d+$r];a[o+2*Zr]=a[c+$r]*g,a[o+2*Zr+1]=NaN}};function re(r,e,t,n,a,o,i,f,s,u){if(r>e)throw new Error("Assertion failed.");if(s.length<3*r)throw new Error("Assertion failed: Integer work matrix I too small.");if(u.length<r*(r+2)+2*r+(r+1)*(r+1)+(r+1)*e)throw new Error("Assertion failed: Scalar work matrix F too small.");var c=r*(r+2),l=c+2*r,h=l+(r+1)*(r+1);u.fill(0,l,h+e);for(var v=0;v<r;v++)for(var d=0;d<e;d++)u[h+e+e*v+d]=i[f+e*v+d];i.fill(0,f,f+r*e),dr(r,e,t,n,u,0,u,h);for(var p=0;p<r;p++)u[c+2*p]=u[(r+1)*p+p],u[c+2*p+1]=u[(r+1)*p+p+1];!function r(e,t,n,a,o,i,f,s){if(t>e)throw new Error("Assertion failed.");if(1>=t)throw new Error("Assertion failed.");if(2===t)return Kr(e,n,a,o,i,f);if(3===t)return $r(e,n,a,o,i,f);var u=e-1,c=t-1,l=t>>>1,h=l-1;if(s.length<u)throw new Error("Assertion failed: Integer work matrix I too small.");if(o.length<2*u)throw new Error("Assertion failed: Scalar work matrix F too small.");r(e,l,n,a,o,i,f,s),r(e,t-l,n,a+u*l+l,o,i+2*l,f+e*l+l,s),n[a+u*h+h]=1;for(var v=o[i+2*h],d=o[i+2*h+1],p=0;p<h;p++)o[i+2*p+1]=v*o[f+e*h+p];for(var w=l;w<c;w++)o[i+2*w+1]=d*o[f+e*l+w];var m=function(){var r=v*o[f+e*h+h],t=d*o[f+e*l+c],n=Math.hypot(r,t);return[r/n,t/n,n]}(),y=q()(m,3),b=y[0],g=y[1],x=y[2];if(o[i+2*h]=0,o[i+2*h+1]=x,0!==x){for(var E=0;E<l;E++)o[f+e*E+c]=o[f+e*E+h]*-g,o[f+e*E+h]*=b;for(var _=l;_<t;_++)o[f+e*_+h]=o[f+e*_+c]*g,o[f+e*_+c]*=b}s[c-1]=h;for(var A=0,k=l,M=0;M<c-1;M++)s[M]=k>=c||A<h&&o[i+2*A]>=o[i+2*k]?A++:k++;for(var S=0;S<c;S++){var P=s[S];o[2*S]=o[i+2*P],o[2*S+1]=o[i+2*P+1]}for(var I=0;I<c;I++)o[i+2*I]=o[2*I],o[i+2*I+1]=o[2*I+1];Zr(e,t,n,a,o,i,f,s)}(r+1,r+1,i,f,u,c,l,s);for(var w=0;w<r;w++)a[o+w]=u[c+2*w];for(var m=0;m<r;m++){u.fill(0,0,r);for(var y=0;y<r;y++)for(var b=0;b<r;b++)u[b]+=t[n+r*m+y]*i[f+r*y+b];for(var g=0;g<r;g++)t[n+r*m+g]=u[g]}i.fill(0,f,f+r*r);for(var x=0;x<r+1;x++)for(var E=0;E<r;E++)for(var _=0;_<e;_++)i[f+e*E+_]+=u[l+(r+1)*x+E]*u[h+e*x+_]}function ee(r){if((r=z(r)).dtype.startsWith("complex"))throw new Error("svd_dc(A): A.dtype must be float.");var e=r.shape.slice(-2),t=q()(e,2),n=t[0],a=t[1];if(n>a){var o=ee(r.T),i=q()(o,3),f=i[0],s=i[1],u=i[2];return lr(f),[u.T,s,f]}var c=r.shape,l=c.slice(),h=c.slice(0,-1);l[l.length-1]=n;var v="float32"===r.dtype?"float32":"float64",d=A[v],p=(r=r.data).length/(n*a),w=d.from(r);r=void 0;for(var m=new d(p*n*n),y=new d(p*n),b=new d(n*(n+2)+2*n+(n+1)*(n+1)+(n+1)*Math.max(1+n,a)),g=new Int32Array(3*n),x=0,E=0,_=0;E<y.length;x+=n*n,E+=n,_+=n*a)re(n,a,m,x,y,E,w,_,g,b);return[new V(l,m),new V(h,y),new V(c,w)]}function te(r){var e=(r=z(r)).shape[r.ndim-1],t=r.shape.slice(0,-1),n=v.sqrt(k(r.dtype));r=r.data;for(var a=new A.int32(r.length/e),o=0;o<a.length;o++){var i=n*v.abs(r[e*o]);if(0!==a[o])throw new Error("Assertion failed.");for(;a[o]<e;a[o]++){var f=v.abs(r[e*o+a[o]]);if(!isFinite(f))throw new Error("svd_rank(): NaN or Infinity encountered.");if(f<=i)break}}return new V(t,a)}function ne(r,e,t,n){if(r=z(r),e=z(e),t=z(t),r.shape[r.ndim-2]!==t.shape[t.ndim-1])throw new Error("rrqr_solve(Q,R,P, y): System not square.");var a=ae(r,e,t,n),o=v.sqrt(k(e.dtype)),i=e.shape[e.ndim-1];e=e.data;for(var f=0;f<e.length;f+=i)for(var s,u=o*v.abs(e[f]);s<i;s++){var c=v.abs(e[f+s]);if(!isFinite(c))throw new Error("svd_solve(): NaN or Infinity encountered.");if(c<=u)throw new Jr(a)}return a}function ae(r,e,t,n){if(null==n){var a,o;if(null!=t)throw new Error("svd_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.");n=R((a=Q,o=q()(a,3),r=o[0],e=o[1],t=o[2],a))}if((r=z(r)).ndim<2)throw new Error("svd_lstsq(U,sv,V, y): U.ndim must be at least 2.");if((e=z(e)).ndim<1)throw new Error("svd_lstsq(U,sv,V, y): sv.ndim must be at least 1.");if((t=z(t)).ndim<2)throw new Error("svd_lstsq(U,sv,V, y): V.ndim must be at least 2.");if((n=z(n)).ndim<2)throw new Error("svd_lstsq(U,sv,V, y): y.ndim must be at least 2.");var i=r.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1],c=t.shape.slice(-1),l=q()(c,1)[0],h=n.shape.slice(-1),d=q()(h,1)[0];if(s!==n.shape[n.ndim-2])throw new Error("svd_lstsq(U,sv,V, y): U and y don't match.");if(u!==e.shape[e.ndim-1])throw new Error("svd_lstsq(U,sv,V, y): U and sv don't match.");if(u!==t.shape[t.ndim-2])throw new Error("svd_lstsq(U,sv,V, y): V and sv don't match.");var p=Math.max(r.ndim,e.ndim+1,t.ndim,n.ndim),w=Int32Array.from({length:p},(function(){return 1}));w[p-2]=l,w[p-1]=d;for(var m=0,y=[r,t,n];m<y.length;m++)for(var b=y[m],g=p-2,x=b.ndim-2;g-- >0&&x-- >0;)if(1===w[g])w[g]=b.shape[x];else if(w[g]!=b.shape[x]&&1!=b.shape[x])throw new Error("svd_lstsq(U,sv,V, y): U,sv,V,y not broadcast-compatible.");for(var E=p-2,_=e.ndim-1;E-- >0&&_-- >0;)if(1===w[E])w[E]=e.shape[_];else if(w[E]!=e.shape[_]&&1!=e.shape[_])throw new Error("svd_lstsq(U,sv,V, y): U,sv,V,y not broadcast-compatible.");var M=v.sqrt(k(e.dtype)),S=A[[r,e,t,n].every((function(r){return"float32"===r.dtype}))?"float32":"float64"],P=new S(u*d),I=new S(w.reduce((function(r,e){return r*e}),1)),N=r.data,j=e.data,O=t.data,T=n.data,L=0,F=1,U=0,D=1,C=0,B=1,Y=0,G=1,J=0;return function a(o){if(o===p-2){F=s*u,D=u,B=u*l,G=s*d;var i=function(){for(var r=M*v.abs(j[U]),e=0;e<u;e++){var t=v.abs(j[U+e]);if(!isFinite(t))throw new Error("svd_solve(): NaN or Infinity encountered.");if(t<=r)return e}return u}();P.fill(0);for(var f=0;f<s;f++)for(var c=0;c<i;c++)for(var h=0;h<d;h++)P[d*c+h]+=N[L+u*f+c]*T[Y+d*f+h];for(var m=0;m<i;m++)for(var y=0;y<d;y++)P[d*m+y]/=j[U+m];for(var b=0;b<i;b++)for(var g=0;g<l;g++)for(var x=0;x<d;x++)I[J+d*g+x]+=O[C+l*b+g]*P[d*b+x];return L+=F,U+=D,C+=B,Y+=G,void(J+=l*d)}for(var E=w[o];a(o+1),1!=E;E--)r.shape[o-p+r.ndim]>1||(L-=F),e.shape[o-p+1+e.ndim]>1||(U-=D),t.shape[o-p+t.ndim]>1||(C-=B),n.shape[o-p+n.ndim]>1||(Y-=G);F*=r.shape[o-p+r.ndim]||1,D*=e.shape[o-p+1+e.ndim]||1,B*=t.shape[o-p+t.ndim]||1,G*=n.shape[o-p+n.ndim]||1}(0),new V(w,I)}function oe(r,e){var t=ee(r),n=q()(t,3);return ae(n[0],n[1],n[2],e)}function ie(r){r=z(r);var e=A["float32"===r.dtype?"float32":"float64"].from(r.data),t=r.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=new Int32Array(e.length/o);if(a!=o)throw new Error("Last two dimensions must be quadratic.");for(var f=0,s=0;f<e.length;f+=a*a,s+=a){for(var u=0;u<a;u++)i[s+u]=u;for(var c=0;c<a;c++){for(var l=f+c*a,h=c,v=c+1;v<a;v++)Math.abs(e[f+a*v+c])>Math.abs(e[f+a*h+c])&&(h=v);if(c!=h){var d=i[s+c];i[s+c]=i[s+h],i[s+h]=d;for(var p=f+h*a,w=0;w<a;w++){var m=e[l+w];e[l+w]=e[p+w],e[p+w]=m}}for(var y=c+1;y<a;y++){var b=f+y*a,g=e[b+c]/e[l+c];e[b+c]=g;for(var x=c+1;x<a;x++)e[b+x]-=g*e[l+x]}}}return[new V(r.shape,e),new V(r.shape.slice(0,-1),i)]}function fe(r,e,t){if(null==t){t=e;var n=r,a=q()(n,2);r=a[0],e=a[1]}if((r=z(r)).ndim<2)throw new Error("LU must be at least 2D.");if((e=z(e)).ndim<1)throw new Error("P must be at least 1D.");if((t=z(t)).ndim<2)throw new Error("y must be at least 2D.");var o=r.shape.slice(-2),i=q()(o,2),f=i[0],s=i[1],u=t.shape.slice(-2),c=q()(u,2),l=c[0],h=c[1];if(s!=f)throw new Error("Last two dimensions of LU must be quadratic.");if(s!=l)throw new Error("LU and y don't match.");if(s!=e.shape.slice(-1))throw new Error("LU and P don't match.");var v=Math.max(r.ndim,e.ndim+1,t.ndim),d=Int32Array.from({length:v},(function(){return 1}));d[v-2]=l,d[v-1]=h;for(var p=0,w=[r,t];p<w.length;p++)for(var m=w[p],y=v-2,b=m.ndim-2;y-- >0&&b-- >0;)if(1===d[y])d[y]=m.shape[b];else if(d[y]!=m.shape[b]&&1!=m.shape[b])throw new Error("LU and y are not broadcast-compatible.");for(var g=v-2,x=e.ndim-1;g-- >0&&x-- >0;)if(1===d[g])d[g]=e.shape[x];else if(d[g]!=e.shape[x]&&1!=e.shape[x])throw new Error("P is not broadcast-compatible.");var E=new(A[[r,e,t].every((function(r){return"float32"===r.dtype}))?"float32":"float64"])(d.reduce((function(r,e){return r*e}),1)),_=r.data,k=e.data,M=t.data,S=0,P=1,I=0,N=1,j=0,O=1,T=0;return function n(a){if(a===v-2){P=f*f,N=f,O=f*h;for(var o=0;o<l;o++)for(var i=T+h*o,s=j+h*k[I+o],u=0;u<h;u++)E[i+u]=M[s+u];for(var c=0;c<l;c++)for(var p=0;p<h;p++)for(var w=0;w<c;w++)E[T+c*h+p]-=_[S+f*c+w]*E[T+w*h+p];for(var m=l;m-- >0;)for(var y=h;y-- >0;){for(var b=f;--b>m;)E[T+m*h+y]-=_[S+f*m+b]*E[T+b*h+y];E[T+m*h+y]/=_[S+f*m+m]}return S+=P,I+=N,j+=O,void(T+=O)}for(var g=d[a];n(a+1),1!=g;g--)r.shape[a-v+r.ndim]>1||(S-=P),e.shape[a-v+e.ndim+1]>1||(I-=N),t.shape[a-v+t.ndim]>1||(j-=O);P*=r.shape[a-v+r.ndim]||1,N*=e.shape[a-v+e.ndim+1]||1,O*=t.shape[a-v+t.ndim]||1}(0),new V(d,E)}function se(r,e){if((r=z(r)).ndim<2)throw new Error("permute_rows(A,P): A.ndim must be at least 2.");if((e=z(e)).ndim<1)throw new Error("permute_rows(A,P): P.ndim must be at least 1.");if("int32"!==e.dtype)throw new Error('permute_rows(A,P): P.dtype must be "int32".');var t=Math.max(r.ndim,e.ndim+1),n=Int32Array.from({length:t},(function(){return 1})),a=r.shape.slice(-2),o=q()(a,2),i=o[0],f=o[1];if(i!==e.shape[e.ndim-1])throw new Error("permute_rows(A,P): A.shape[-2] and P.shape[-1] must match.");for(var s=t,u=r.ndim;s-- >0&&u-- >0;)n[s]=r.shape[u];for(var c=t-2,l=e.ndim-1;c-- >0&&l-- >0;)if(1===n[c])n[c]=e.shape[l];else if(n[c]!=e.shape[l]&&1!=e.shape[l])throw new Error("permute_rows(A,P): A and P not broadcast-compatible.");var h=new A[r.dtype](n.reduce((function(r,e){return r*e}))),v=r.shape,d=r.ndim,p=e.shape,w=e.ndim;r=r.data,e=e.data;var m=0,y=-1,b=0,g=-1,x=0;return function a(o){if(o===t-2){for(var s=0;s<i;s++){var u=e[b+s];if(!(u>=0))throw new Error("permute_rows(A,P): P.contains invalid indices.");if(!(u<i))throw new Error("permute_rows(A,P): P.contains invalid indices.");for(var c=0;c<f;c++)h[x+f*s+c]=r[m+f*u+c]}return m+=y=i*f,b+=g=i,void(x+=y)}for(var l=n[o];a(o+1),1!==l;l--)v[o-t+d]>1||(m-=y),p[o-t+1+w]>1||(b-=g);y*=v[o-t+d]||1,g*=p[o-t+1+w]||1}(0),new V(n,h)}function ue(r,e){if((r=z(r)).ndim<2)throw new Error("permute_cols(A,P): A.ndim must be at least 2.");if((e=z(e)).ndim<1)throw new Error("permute_cols(A,P): P.ndim must be at least 1.");if("int32"!==e.dtype)throw new Error('permute_cols(A,P): P.dtype must be "int32".');var t=Math.max(r.ndim,e.ndim+1),n=Int32Array.from({length:t},(function(){return 1})),a=r.shape.slice(-2),o=q()(a,2),i=o[0],f=o[1];if(f!==e.shape[e.ndim-1])throw new Error("permute_cols(A,P): A.shape[-1] and P.shape[-1] must match.");for(var s=t,u=r.ndim;s-- >0&&u-- >0;)n[s]=r.shape[u];for(var c=t-2,l=e.ndim-1;c-- >0&&l-- >0;)if(1===n[c])n[c]=e.shape[l];else if(n[c]!=e.shape[l]&&1!=e.shape[l])throw new Error("permute_cols(A,P): A and P not broadcast-compatible.");var h=new A[r.dtype](n.reduce((function(r,e){return r*e}))),v=r.shape,d=r.ndim,p=e.shape,w=e.ndim;r=r.data,e=e.data;var m=0,y=-1,b=0,g=-1,x=0;return function a(o){if(o===t-2){for(var s=0;s<i;s++)for(var u=0;u<f;u++){var c=e[b+u];if(!(c>=0))throw new Error("permute_cols(A,P): P.contains invalid indices.");if(!(c<f))throw new Error("permute_cols(A,P): P.contains invalid indices.");h[x+f*s+u]=r[m+f*s+c]}return m+=y=i*f,b+=g=f,void(x+=y)}for(var l=n[o];a(o+1),1!==l;l--)v[o-t+d]>1||(m-=y),p[o-t+1+w]>1||(b-=g);y*=v[o-t+d]||1,g*=p[o-t+1+w]||1}(0),new V(n,h)}function ce(r,e){if((r=z(r)).ndim<2)throw new Error("unpermute_rows(A,P): A.ndim must be at least 2.");if((e=z(e)).ndim<1)throw new Error("unpermute_rows(A,P): P.ndim must be at least 1.");if("int32"!==e.dtype)throw new Error('unpermute_rows(A,P): P.dtype must be "int32".');var t=Math.max(r.ndim,e.ndim+1),n=Int32Array.from({length:t},(function(){return 1})),a=r.shape.slice(-2),o=q()(a,2),i=o[0],f=o[1];if(i!==e.shape[e.ndim-1])throw new Error("unpermute_rows(A,P): A.shape[-2] and P.shape[-1] must match.");for(var s=t,u=r.ndim;s-- >0&&u-- >0;)n[s]=r.shape[u];for(var c=t-2,l=e.ndim-1;c-- >0&&l-- >0;)if(1===n[c])n[c]=e.shape[l];else if(n[c]!=e.shape[l]&&1!=e.shape[l])throw new Error("unpermute_rows(A,P): A and P not broadcast-compatible.");var h=new A[r.dtype](n.reduce((function(r,e){return r*e}))),v=r.shape,d=r.ndim,p=e.shape,w=e.ndim;r=r.data,e=e.data;var m=0,y=-1,b=0,g=-1,x=0;return function a(o){if(o===t-2){for(var s=0;s<i;s++){var u=e[b+s];if(!(u>=0))throw new Error("unpermute_rows(A,P): P.contains invalid indices.");if(!(u<i))throw new Error("unpermute_rows(A,P): P.contains invalid indices.");for(var c=0;c<f;c++)h[x+f*u+c]=r[m+f*s+c]}return m+=y=i*f,b+=g=i,void(x+=y)}for(var l=n[o];a(o+1),1!==l;l--)v[o-t+d]>1||(m-=y),p[o-t+1+w]>1||(b-=g);y*=v[o-t+d]||1,g*=p[o-t+1+w]||1}(0),new V(n,h)}function le(r,e){if((r=z(r)).ndim<2)throw new Error("unpermute_cols(A,P): A.ndim must be at least 2.");if((e=z(e)).ndim<1)throw new Error("unpermute_cols(A,P): P.ndim must be at least 1.");if("int32"!==e.dtype)throw new Error('unpermute_cols(A,P): P.dtype must be "int32".');var t=Math.max(r.ndim,e.ndim+1),n=Int32Array.from({length:t},(function(){return 1})),a=r.shape.slice(-2),o=q()(a,2),i=o[0],f=o[1];if(f!==e.shape[e.ndim-1])throw new Error("unpermute_cols(A,P): A.shape[-1] and P.shape[-1] must match.");for(var s=t,u=r.ndim;s-- >0&&u-- >0;)n[s]=r.shape[u];for(var c=t-2,l=e.ndim-1;c-- >0&&l-- >0;)if(1===n[c])n[c]=e.shape[l];else if(n[c]!=e.shape[l]&&1!=e.shape[l])throw new Error("unpermute_cols(A,P): A and P not broadcast-compatible.");var h=new A[r.dtype](n.reduce((function(r,e){return r*e}))),v=r.shape,d=r.ndim,p=e.shape,w=e.ndim;r=r.data,e=e.data;var m=0,y=-1,b=0,g=-1,x=0;return function a(o){if(o===t-2){for(var s=0;s<i;s++)for(var u=0;u<f;u++){var c=e[b+u];if(!(c>=0))throw new Error("unpermute_cols(A,P): P.contains invalid indices.");if(!(c<f))throw new Error("unpermute_cols(A,P): P.contains invalid indices.");h[x+f*s+c]=r[m+f*s+u]}return m+=y=i*f,b+=g=f,void(x+=y)}for(var l=n[o];a(o+1),1!==l;l--)v[o-t+d]>1||(m-=y),p[o-t+1+w]>1||(b-=g);y*=v[o-t+d]||1,g*=p[o-t+1+w]||1}(0),new V(n,h)}function he(r){var e=ee(r),t=q()(e,3),n=(t[0],t[1]);t[2];return te(n)}function ve(r,e,t,n){for(t|=0,n<<=1;n<r.length;n=n+2|0){var a=Math.abs(e[t+(n>>>1)]);if(0!==a){if(r[n]<a){var o=r[n]/a;r[n+1]*=o*o,r[n]=a}a/=r[n],r[n+1]+=a*a}}}function de(r,e){var t=r[e<<=1];return isFinite(t)?Math.sqrt(r[e+1])*t:t}function pe(r,e,t,n,a){var o=Math.min(r,e);if(!(a.length>=o))throw new Error("Assertion failed.");for(var i=new sr,f=o;f-- >0;){for(var s=e;s-- >f;)i.include(t[n+e*f+s]);if(a[f]=i.result,!isFinite(a[f]))throw new Error("Infinity or NaN encountered during rank estimation.")}for(var u=a instanceof Float32Array?"float32":"float64",c=Math.sqrt(k(u))*a[0],l=o;l>0&&a[l-1]<=c;)--l;return l}function we(r){if((r=z(r)).ndim<2)throw new Error("A must be at least 2D.");var e=A["float32"===r.dtype?"float32":"float64"],t=r.shape,n=Int32Array.from(t),a=n.slice(0,-1),o=t.slice(-2),i=q()(o,2),f=i[0],s=i[1];n[n.length-1]=f,a[a.length-1]=s;var u=e.from(r.data);r=void 0;for(var c=new Int32Array(u.length/f),l=new e(u.length/s*f),h=new e(s<<1),v=0,d=0,p=0;v<l.length;v+=f*f,d+=f*s,p+=s){for(var w=0;w<s;w++)c[p+w]=w;for(var m=0;m<f;m++)l[v+f*m+m]=1;for(var y=0;y<f;y++)ve(h,u,d+s*y,0);for(var b=0;b<s;b++){for(var g=-1,x=-1/0,E=b;E<s;E++){var _=de(h,E);x<_&&(g=E,x=_)}if(g!==b){for(var k=0;k<f;k++){var M=d+s*k+b,S=d+s*k+g,P=u[M];u[M]=u[S],u[S]=P}var I=c[p+b];c[p+b]=c[p+g],c[p+g]=I}h.fill(0,b<<1);for(var N=d+s*b+b,j=b;++j<f;){var O=d+s*j+b,T=u[O];if(0!==T){var L=u[N],F=Math.hypot(L,T),R=L/F,U=T/F;u[O]=0,0!==U&&(u[N]=F,ir(u,s-1-b,N+1,O+1,R,U),ir(l,1+j,v+f*b,v+f*j,R,U))}ve(h,u,d+s*j,b+1)}if(b<f){var Q=u[d+s*b+b];if(0>Q||Object.is(-0,Q)){for(var D=b;D<s;D++)u[d+s*b+D]*=-1;for(var C=0;C<=b;C++)l[v+f*b+C]*=-1}u[d+s*b+b]=x}}cr(f,l,v)}return[new V(n,l),new V(t,u),new V(a,c)]}function me(r){if((r=z(r)).ndim<2)throw new Error("A must be at least 2D.");var e=A["float32"===r.dtype?"float32":"float64"],t=r.shape,n=Int32Array.from(t),a=t.slice(0,-1),o=t.slice(-2),i=q()(o,2),f=i[0],s=i[1];if(n[n.length-2]=s,a[a.length-1]=s,f<=s)return we(r);var u=e.from(r.data);r=void 0;for(var c=new Int32Array(u.length/f),l=new e(u.length/f*s),h=new e(s<<1),v=0,d=0,p=0;v<u.length;v+=f*s,d+=s*s,p+=s){for(var w=0;w<s;w++)c[p+w]=w;h.fill(0);for(var m=0;m<f;m++)ve(h,u,v+s*m,0);for(var y=0;y<s;y++){for(var b=-1,g=-1/0,x=y;x<s;x++){var E=de(h,x);g<E&&(b=x,g=E)}if(b!==y){for(var _=0;_<f;_++){var k=v+s*_+y,M=v+s*_+b,S=u[k];u[k]=u[M],u[M]=S}var P=c[p+y];c[p+y]=c[p+b],c[p+b]=P}h.fill(0,y+1<<1);for(var I=v+s*y+y,N=y;++N<f;){var j=v+s*N+y,O=u[j];if(0!==O){var T=u[I],L=Math.hypot(T,O),F=T/L,R=O/L;0!==R&&(F<0&&(F*=-1,R*=-1,L*=-1),ir(u,s-1-y,I+1,j+1,F,R),u[I]=L),u[j]=R}ve(h,u,v+s*N,y+1)}u[I]=(u[I]<0||Object.is(u[I],-0)?-1:1)*g}for(var U=0;U<s;U++)for(var Q=l[d+s*U+U],D=Q<0||Object.is(Q,-0)?-1:1,C=U;C<s;C++)l[d+s*U+C]=u[v+s*U+C]*D,u[v+s*U+C]=D*(U===C);for(var B=s;B-- >0;)for(var Y=f;--Y>B;){var G=u[v+s*Y+B];if(0!==G)u[v+s*Y+B]=0,ir(u,s-B,v+s*Y+B,v+s*B+B,Math.sqrt((1-G)*(1+G)),G)}}return[new V(t,u),new V(n,l),new V(a,c)]}function ye(r){var e=(r=z(r)).shape.slice(-2),t=q()(e,2),n=t[0],a=t[1],o=r.shape.slice(0,-2);r=r.data;for(var i=new A.int32(r.length/n/a),f=new A["float32"===r.dtype?"float32":"float64"](Math.min(n,a)),s=0,u=0;s<i.length;s++,u+=n*a)i[s]=pe(n,a,r,u,f);return new V(o,i)}function be(r,e,t,n){r=z(r),e=z(e);var a=r.shape[r.ndim-2];if(a!==e.shape[e.ndim-1])throw new Error("rrqr_solve(Q,R,P, y): Q @ R not square.");for(var o=ge(r,e,t,n),i=new A["float32"===e.dtype?"float32":"float64"](a),f=0;f<e.data.length;f+=a*a){if(pe(a,a,e.data,f,i)<a)throw new Jr(o)}return o}function ge(r,e,t,n){if(null==n){var a,o;if(null!=t)throw new Error("rrqr_lstsq(Q,R,P, y): Either 2 ([Q,R,P], y) or 4 arguments (Q,R,P, y) expected.");n=e((a=r,o=q()(a,3),r=o[0],e=o[1],t=o[2],a))}if((r=z(r)).ndim<2)throw new Error("rrqr_lstsq(Q,R,P, y): Q.ndim must be at least 2.");if((e=z(e)).ndim<2)throw new Error("rrqr_lstsq(Q,R,P, y): R.ndim must be at least 2.");if((t=z(t)).ndim<1)throw new Error("rrqr_lstsq(Q,R,P, y): P.ndim must be at least 1.");if((n=z(n)).ndim<2)throw new Error("rrqr_lstsq(Q,R,P, y): y.ndim must be at least 2.");if("int32"!==t.dtype)throw new Error('rrqr_lstsq(Q,R,P, y): P.dtype must be "int32".');var i=r.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1],c=e.shape.slice(-1),l=q()(c,1)[0],h=n.shape.slice(-1),v=q()(h,1)[0];if(s!=n.shape[n.ndim-2])throw new Error("rrqr_lstsq(Q,R,P,y): Q and y don't match.");if(u!=e.shape[e.ndim-2])throw new Error("rrqr_lstsq(Q,R,P,y): Q and R don't match.");if(l!=t.shape[t.ndim-1])throw new Error("rrqr_lstsq(Q,R,P,y): R and P don't match.");var d=Math.max(r.ndim,e.ndim,t.ndim+1,n.ndim),p=Int32Array.from({length:d},(function(){return 1}));p[d-2]=l,p[d-1]=v;for(var w=0,m=[r,e,n];w<m.length;w++)for(var y=m[w],b=d-2,g=y.ndim-2;b-- >0&&g-- >0;)if(1===p[b])p[b]=y.shape[g];else if(p[b]!=y.shape[g]&&1!=y.shape[g])throw new Error("rrqr_lstsq(Q,R,P,y): Q,R,P,y not broadcast-compatible.");for(var x=d-2,E=t.ndim-1;x-- >0&&E-- >0;)if(1===p[x])p[x]=t.shape[E];else if(p[x]!=t.shape[E]&&1!=t.shape[E])throw new Error("rrqr_lstsq(Q,R,P,y): Q,R,P,y not broadcast-compatible.");var _=A[[r,e,n].every((function(r){return"float32"===r.dtype}))?"float32":"float64"],k=new _(Math.min(u,l)),M=new Int32Array(l),S=new _(p.reduce((function(r,e){return r*e}),1)),P=r.data,I=e.data,N=t.data,j=n.data,O=0,T=1,L=0,F=1,R=0,U=1,Q=0,D=1,C=0;return function a(o){if(o===d-2){T=s*u,F=u*l,U=l,D=s*v;for(var i=pe(u,l,I,L,k),f=0;f<s;f++)for(var c=0;c<i;c++)for(var h=0;h<v;h++)S[C+c*v+h]+=P[O+f*u+c]*j[Q+f*v+h];for(var w=i;w-- >0;)for(var m=v;m-- >0;){for(var y=i;--y>w;)S[C+w*v+m]-=I[L+l*w+y]*S[C+y*v+m];S[C+w*v+m]/=I[L+l*w+w]}for(var b=l;b-- >0;)M[b]=N[R+b];for(var g=l;g-- >0;)for(var x=void 0;(x=M[g])!==g;){if(M[x]===x)throw new Error("rrqr_lstsq(Q,R,P,y): Invalid indices in P.");M[g]=M[x],M[x]=x;for(var E=v;E-- >0;){var _=S[C+v*g+E];S[C+v*g+E]=S[C+v*x+E],S[C+v*x+E]=_}}return O+=T,L+=F,R+=U,Q+=D,void(C+=l*v)}for(var A=p[o];a(o+1),1!=A;A--)r.shape[o-d+r.ndim]>1||(O-=T),e.shape[o-d+e.ndim]>1||(L-=F),t.shape[o-d+1+t.ndim]>1||(R-=U),n.shape[o-d+n.ndim]>1||(Q-=D);T*=r.shape[o-d+r.ndim]||1,F*=e.shape[o-d+e.ndim]||1,U*=t.shape[o-d+1+t.ndim]||1,D*=n.shape[o-d+n.ndim]||1}(0),new V(p,S)}function xe(r,e){var t=me(r),n=q()(t,3);return be(n[0],n[1],n[2],e)}function Ee(r){if((r=z(r)).dtype.startsWith("complex"))throw new Error("svd_jac_1sided(A): A.dtype must be float.");var e=r.shape,t=0|e[e.length-2],n=e[e.length-1];if(t>n){var a=xr(r),o=q()(a,2),i=o[0],f=Ee(o[1]),s=q()(f,3),u=s[0],c=s[1],l=s[2];return[Fr(i,u),c,l]}if(t<n){var h=xr(r.T),v=q()(h,2),d=v[0],p=Ee(v[1]),w=q()(p,3),m=w[0],y=w[1],b=w[2];return lr(b),[b,y,Fr(d,m).T]}var g="float32"===r.dtype?"float32":"float64",x=A[g],E=Math.pow(t*k(g),2),_="float32"===g?16:8,M=x.from(r.data);r=void 0;var S=new x(t*t),P=new x(M.length),I=new x(M.length/t),N=Int32Array.from({length:t},(function(r,e){return e}));if(1>t)throw new Error("Assertion failed.");if(1==t){for(var j=M.length;j-- >0;)M[j]<0?(M[j]*=-1,I[j]=-1):I[j]=1;return[new V(e,I),new V(e.slice(0,-1),M),new V(e,P.fill(1))]}for(var O=0,T=0;T<I.length;O+=t*t,T+=t){for(var L=0;L<t;L++)for(var F=0;F<t;F++)S[t*L+F]=M[O+t*L+F],M[O+t*L+F]=+(L===F);for(var R=0;R<t;R++)for(var U=0;U<t;U++)P[O+t*R+U]=+(R===U);for(var Q=!1;!Q;){Q=!0;for(var D=0;D<t;D+=_)for(var C=0;C<=D;C+=_)for(var B=D;B<D+_&&B<t;B++)for(var Y=C;Y<C+_&&Y<B;Y++){var G=S[t*Y+Y],J=S[t*Y+B],H=S[t*B+Y],W=S[t*B+B];if(J*J+H*H>Math.abs(G*W)*E){Q=!1;var X=Hr(G,J,H,W),K=q()(X,4),$=K[0],Z=K[1],rr=K[2],er=K[3];ir(S,t,t*Y,t*B,$,Z),fr(S,t,Y,B,rr,er),S[t*Y+B]=S[t*B+Y]=0,ir(M,t,O+t*Y,O+t*B,$,Z),ir(P,t,O+t*Y,O+t*B,rr,-er)}}}Wr(t,M,S,P,O,I,T,N)}return[new V(e,M),new V(e.slice(0,-1),I),new V(e,P)]}var _e=4,Ae=_e*_e;function ke(r){if((r=z(r)).dtype.startsWith("complex"))throw new Error("svd_jac_1sided(A): A.dtype must be float.");var e=r.shape,t=0|e[e.length-2],n=e[e.length-1];if(t>n){var a=xr(r),o=q()(a,2),i=o[0],f=ke(o[1]),s=q()(f,3),u=s[0],c=s[1],l=s[2];return[Fr(i,u),c,l]}if(t<n){var h=xr(r.T),v=q()(h,2),d=v[0],p=ke(v[1]),w=q()(p,3),m=w[0],y=w[1],b=w[2];return lr(b),[b,y,Fr(d,m).T]}var g="float32"===r.dtype?"float32":"float64",x=A[g],E=Math.pow(t*k(g),2),_=0|Math.ceil(t/_e),M=x.from(r.data);r=void 0;var S=new x(_*_*_e*_e),P=new x(M.length),I=new x(M.length/t),N=Int32Array.from({length:t},(function(r,e){return e}));if(1>t)throw new Error("Assertion failed.");if(1==t){for(var j=M.length;j-- >0;)M[j]<0?(M[j]*=-1,I[j]=-1):I[j]=1;return[new V(e,I),new V(e.slice(0,-1),M),new V(e,P.fill(1))]}for(var O=0,T=0;T<I.length;O+=t*t,T+=t){for(var L=0;L<t;L++)for(var F=0;F<t;F++){S[Ae*(_*(L/_e|0)+(F/_e|0))+_e*(L%_e)+F%_e|0]=M[O+t*L+F],M[O+t*L+F]=+(L===F)}for(var R=0;R<t;R++)for(var U=0;U<t;U++)P[O+t*R+U]=+(R===U);for(var Q=!1;!Q;){Q=!0;for(var D=_;D-- >0;)for(var C=D;C>=0;C--)for(var B=_e;B-- >0;)for(var Y=C===D?B:_e;Y-- >0;){var G=S[Ae*(_*C+C)+_e*Y+Y],J=S[Ae*(_*C+D)+_e*Y+B],H=S[Ae*(_*D+C)+_e*B+Y],W=S[Ae*(_*D+D)+_e*B+B];if(J*J+H*H>Math.abs(G*W)*E){Q=!1;for(var X=Hr(G,J,H,W),K=q()(X,4),$=K[0],Z=K[1],rr=K[2],er=K[3],tr=C*_*Ae+Y*_e,nr=D*_*Ae+B*_e,ar=tr+_*Ae;tr<ar;tr+=Ae,nr+=Ae)for(var or=0;or<_e;or++){var fr=$*S[or+tr]+Z*S[or+nr];S[or+nr]=-Z*S[or+tr]+$*S[or+nr],S[or+tr]=fr}for(var sr=C*Ae+Y+_*_*_e*_e,ur=D*Ae+B+_*_*_e*_e;(sr-=_*Ae)>=0;){ur-=_*Ae;for(var cr=Ae;(cr-=_e)>=0;){var hr=S[sr+cr]*rr+S[ur+cr]*-er;S[ur+cr]=S[sr+cr]*er+S[ur+cr]*rr,S[sr+cr]=hr}}S[Ae*(_*C+D)+_e*Y+B]=S[Ae*(_*D+C)+_e*B+Y]=0;var vr=O+t*(_e*C+Y),dr=O+t*(_e*D+B);ir(M,t,vr,dr,$,Z),ir(P,t,vr,dr,rr,-er)}}}for(var pr=0;pr<t;pr++){var wr=Ae*(_+1)*(pr/_e|0)+(_e+1)*(pr%_e)|0;I[T+pr]=S[wr]}Xr(t,M,P,O,I,T,N)}return[new V(e,M),new V(e.slice(0,-1),I),new V(e,P)]}function Me(r){if((r=z(r)).dtype.startsWith("complex"))throw new Error("svd_jac_1sided(A): A.dtype must be float.");var e=r.shape,t=e[e.length-2],n=e[e.length-1];if(t>n){var a=xr(r),o=q()(a,2),i=o[0],f=Me(o[1]),s=q()(f,3),u=s[0],c=s[1],l=s[2];return[Fr(i,u),c,l]}if(t<n){var h=xr(r.T),v=q()(h,2),d=v[0],p=Me(v[1]),w=q()(p,3),m=w[0],b=w[1],g=w[2];return lr(g),[g,b,Fr(d,m).T]}var x="float32"===r.dtype?"float32":"float64",E=A[x],_=k(x)*t,M=E.from(r.data);r=void 0;var S=new E(t*t),P=new E(M.length),I=new E(M.length/t),N=(new E(t),Int32Array.from({length:t},(function(r,e){return e})));if(1>t)throw new Error("Assertion failed.");if(1===t){for(var j=M.length;j-- >0;)M[j]<0?(M[j]*=-1,I[j]=-1):I[j]=1;return[new V(e,I),new V(e.slice(0,-1),M),new V(e,P.fill(1))]}for(var O=Int32Array.from(y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=t;case 1:if(!(e>1)){r.next=7;break}return e=e+1>>>1,r.next=5,e;case 5:r.next=1;break;case 7:case"end":return r.stop()}}),r)}))()),T=new E(O.reduce((function(r,e){return r+(e*e+e>>>1)}),0)),L=function(){for(var r=0,e=0,n=0,a=0,o=function(t,o){var f=function(r,e){return i=t,T[t+((r+=n)*r+r>>>1)+(e+=a)]},s=O[o];t-=s*s+s>>>1;var u=f(0,0);if(r=n,e=a,n+1<s){var c=f(1,0);c>u&&(u=c,r=n+1,e=a);var l=f(1,1);l>u&&(u=l,r=n+1,e=a+1)}if(n!=a){var h=f(0,1);h>u&&(u=h,r=n,e=a+1)}n=2*r,a=2*e,i=t},i=T.length,f=O.length;f-- >0;)o(i,f);var s=-1/0,u=function(r,e){var o=S[t*(r+=n)+(e+=a)],i=S[t*e+r];return o*o+i*i};if(n+1<t){var c=u(1,0);c>s&&(s=c,r=n+1,e=a)}if(a+1<t){var l=u(0,1);l>s&&(s=l,r=n,e=a+1)}if(n!=a){var h=u(0,0);if(h>s&&(s=h,r=n,e=a),n+1<t)u(1,1)>s&&(r=n+1,e=a+1)}return[e,r]},F=function(r){for(var e=r=r>>>1<<1;e<r+2&&e<t;e++)for(var n=e>>>1,a=n*n+n>>>1,o=0;o<r+1;o++){var i=S[t*e+o],f=S[t*o+e],s=e===o?-1/0:i*i+f*f,u=a+(o>>>1);T[u]=e%2||o%2?Math.max(T[u],s):s}for(var c=0,l=1;l<O.length;l++){var h=O[l-1],v=c;c+=h*h+h>>>1;for(var d=r=r>>>2<<1;d<r+2&&d<h;d++)for(var p=v+(d*d+d>>>1),w=d>>>1,m=c+(w*w+w>>>1),y=0;y<=d;y++){var b=m+(y>>>1),g=T[p+y];T[b]=d%2||y%2?Math.max(T[b],g):g}}},R=function(r){r=r>>>1<<1;for(var e=Math.min(r+2,t),n=r;n<t;n++)for(var a=n>>>1,o=a*a+a>>>1,i=r;i<e;i++){var f=S[t*n+i],s=S[t*i+n],u=n===i?-1/0:f*f+s*s,c=o+(i>>>1);T[c]=n%2||i%2?Math.max(T[c],u):u}for(var l=0,h=1;h<O.length;h++){r=r>>>2<<1;var v=O[h-1],d=Math.min(r+2,v),p=l;l+=v*v+v>>>1;for(var w=r;w<v;w++)for(var m=p+(w*w+w>>>1),y=w>>>1,b=l+(y*y+y>>>1),g=r;g<d&&g<=w;g++){var x=b+(g>>>1),E=T[m+g];T[x]=w%2||g%2?Math.max(T[x],E):E}}},U=0,Q=0;Q<I.length;U+=t*t,Q+=t){for(var D=0;D<t;D++)for(var C=0;C<t;C++)S[t*D+C]=M[U+t*D+C],M[U+t*D+C]=+(D===C);for(var B=0;B<t;B++)for(var Y=0;Y<t;Y++)P[U+t*B+Y]=+(B===Y);for(var G=0;G<t;G+=2)F(G);for(var J=-1,H=-1;;){var W=L(),X=q()(W,2),K=X[0],$=X[1];if(K>=$)throw new Error("Assertion failed.");if(J==$&&H==K)break;J=$,H=K;var Z=S[t*$+$],rr=S[t*$+K],er=S[t*K+$],tr=S[t*K+K];if(!(Math.max(Math.abs(rr),Math.abs(er))>Math.sqrt(Math.abs(Z*tr))*_))break;var nr=Hr(tr,er,rr,Z),ar=q()(nr,4),or=ar[0],sr=ar[1],ur=ar[2],cr=ar[3];ir(S,t,t*K,t*$,or,sr),fr(S,t,K,$,ur,cr),S[t*$+K]=0,S[t*K+$]=0,F($),F(K),R($),R(K),ir(M,t,U+t*K,U+t*$,or,sr),ir(P,t,U+t*K,U+t*$,ur,-cr)}Wr(t,M,S,P,U,I,Q,N)}return[new V(e,M),new V(e.slice(0,-1),I),new V(e,P)]}function Se(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((r=z(r)).ndim<2)throw new Error("Input must be at least 2D.");return r.mapElems(r.dtype,(function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o=n.slice(-2),i=q()(o,2),f=i[0],s=i[1];return f<s-e?0:r}))}function Pe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((r=z(r)).ndim<2)throw new Error("Input must be at least 2D.");return r.mapElems(r.dtype,(function(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o=n.slice(-2),i=q()(o,2),f=i[0],s=i[1];return f>s-e?0:r}))}function Ie(r,e){if((r=z(r)).ndim<2)throw new Error("tril_solve(L,y): L.ndim must be at least 2.");if((e=z(e)).ndim<2)throw new Error("tril_solve(L,y): y.ndim must be at least 2.");var t=r.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=e.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1];if(a!=o)throw new Error("Last two dimensions of L must be quadratic.");if(s!=o)throw new Error("L and y don't match.");var c=Math.max(r.ndim,e.ndim),l=Int32Array.from({length:c},(function(){return 1}));l[c-2]=s,l[c-1]=u;for(var h=0,v=[r,e];h<v.length;h++)for(var d=v[h],p=c-2,w=d.ndim-2;p-- >0&&w-- >0;)if(1===l[p])l[p]=d.shape[w];else if(l[p]!=d.shape[w]&&1!=d.shape[w])throw new Error("Shapes are not broadcast-compatible.");var m=[r,e].every((function(r){return"float32"===r.dtype}))?"float32":"float64",y=new A[m](l.reduce((function(r,e){return r*e}))),b=r.data,g=e.data,x=0,E=1,_=0,k=1,M=0;return function t(n){if(n===c-2){E=a*a,k=a*u;for(var o=0;o<k;o++)y[M+o]=g[_+o];for(var i=0;i<s;i++)for(var f=0;f<u;f++){for(var h=0;h<i;h++)y[M+i*u+f]-=b[x+a*i+h]*y[M+h*u+f];y[M+i*u+f]/=b[x+a*i+i]}return x+=E,_+=k,void(M+=k)}for(var v=l[n];t(n+1),1!=v;v--)r.shape[n-c+r.ndim]>1||(x-=E),e.shape[n-c+e.ndim]>1||(_-=k);E*=r.shape[n-c+r.ndim]||1,k*=e.shape[n-c+e.ndim]||1}(0),new V(l,y)}function Ne(r,e){if((r=z(r)).ndim<2)throw new Error("triu_solve(U,y): U.ndim must be at least 2.");if((e=z(e)).ndim<2)throw new Error("triu_solve(U,y): y.ndim must be at least 2.");var t=r.shape.slice(-2),n=q()(t,2),a=n[0],o=n[1],i=e.shape.slice(-2),f=q()(i,2),s=f[0],u=f[1];if(a!=o)throw new Error("Last two dimensions of U must be quadratic.");if(s!=o)throw new Error("U and y don't match.");var c=Math.max(r.ndim,e.ndim),l=Int32Array.from({length:c},(function(){return 1}));l[c-2]=s,l[c-1]=u;for(var h=0,v=[r,e];h<v.length;h++)for(var d=v[h],p=c-2,w=d.ndim-2;p-- >0&&w-- >0;)if(1===l[p])l[p]=d.shape[w];else if(l[p]!=d.shape[w]&&1!=d.shape[w])throw new Error("Shapes are not broadcast-compatible.");var m=[r,e].every((function(r){return"float32"===r.dtype}))?"float32":"float64",y=new A[m](l.reduce((function(r,e){return r*e}))),b=r.data,g=e.data,x=0,E=1,_=0,k=1,M=0;return function t(n){if(n===c-2){E=o*o,k=o*u;for(var i=0;i<k;i++)y[M+i]=g[_+i];for(var f=s;f-- >0;)for(var h=u;h-- >0;){for(var v=a;--v>f;)y[M+f*u+h]-=b[x+o*f+v]*y[M+v*u+h];y[M+f*u+h]/=b[x+o*f+f]}return x+=E,_+=k,void(M+=k)}for(var d=l[n];t(n+1),1!=d;d--)r.shape[n-c+r.ndim]>1||(x-=E),e.shape[n-c+e.ndim]>1||(_-=k);E*=r.shape[n-c+r.ndim]||1,k*=e.shape[n-c+e.ndim]||1}(0),new V(l,y)}function je(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];if(r in A||(t.unshift(r),r="float64"),!r.startsWith("float"))throw new Error("Unsupported dtype: '".concat(r,"'."));1===t.length&&t.push(t[0]);for(var a=t.length;a-- >0;)if(t[a]%1!=0||t[a]<1)throw new Error("shape[".concat(a,"] = ").concat(t[a]," not a positive integer."));for(var o=(t=Int32Array.from(t)).slice(-2),i=q()(o,2),f=i[0],s=i[1],u=Math.max(f,s),c=A[r],l=new c(t.reduce((function(r,e){return r*e}))),h=new c(u*u),v=new c(u),d=new c(u),p=new sr,w=0;w<l.length;w+=f*s){for(var m=0;m<u;m++)for(var y=0;y<u;y++)h[u*m+y]=m===y;d[0]=Math.random()<=.5?-1:1;for(var b=u;b-- >1;){p.reset();for(var g=0;;g++){var x=v[g]=G();if(g>=b)break;p.include(x)}d[b]=v[b]>0?-1:1;var E=p.resultIncl(v[b])*d[b];if(0!==E){for(var _=p.resultIncl(v[b]-=E),k=b;k>=0;k--)v[k]/=_;for(var M=u;M-- >0;){for(var S=0,P=b;P>=0;P--)S+=h[u*M+P]*v[P];S*=2;for(var I=b;I>=0;I--)h[u*M+I]-=v[I]*S}}}for(var N=0;N<u;N++)for(var j=0;j<u;j++)h[u*N+j]*=d[N];for(var O=0;O<f;O++)for(var T=0;T<s;T++)l[w+s*O+T]=h[u*O+T]}return new V(t,l)}var qe=y.a.mark(Qe),Oe=y.a.mark(Ce),Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Le=Int32Array.from({length:256},(function(){return-2}));if(64!==Te.length)throw new Error("Assertion failed.");for(var Fe=Te.length;Fe-- >0;)Le[Te.charCodeAt(Fe)]=Fe;for(var Re="\f\n\r\t\v ".length;Re-- >0;)Le["\f\n\r\t\v ".charCodeAt(Re)]=-1;function Ue(r){return Uint8Array.from(Qe(r))}function Qe(r){var e,t,n,a,o,i,f;return y.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=function(){console.warn("_b64_decode(b64_chars): Base64 sequence ended unexpectedly.")},t=function(){for(;;){var t=void 0,n=r.next();if(t=n.value,e=(e=n.done)||"="===t)return NaN;if("string"!=typeof t||1!==t.length)throw new Error("_b64_decode(b64_chars): Invalid token in character sequence: ".concat(t,"."));if(-1!==(t=Le[t.charCodeAt(0)])){if(!(t>=0))throw new Error("_b64_decode(b64_chars): Invalid base64 character '".concat(t,"'."));return t}}},r=r[Symbol.iterator]();case 3:if(a=t(),!e){s.next=7;break}return s.abrupt("return");case 7:if(o=t(),!e){s.next=10;break}return s.abrupt("return",n());case 10:return s.next=12,a<<2|o>>4;case 12:if(i=t(),!e){s.next=15;break}return s.abrupt("return");case 15:return s.next=17,(15&o)<<4|i>>2;case 17:if(f=t(),!e){s.next=20;break}return s.abrupt("return");case 20:return s.next=22,(3&i)<<6|63&f;case 22:s.next=3;break;case 24:case"end":return s.stop()}}),qe)}function De(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="",n=!0,a=!1,o=void 0;try{for(var i,f=Ce(r,e)[Symbol.iterator]();!(n=(i=f.next()).done);n=!0){t+=i.value}}catch(r){a=!0,o=r}finally{try{n||null==f.return||f.return()}finally{if(a)throw o}}return t}function Ce(r){var e,t,n,a,o,i,f,s,u,c,l,h,v,d,p=arguments;return y.a.wrap((function(w){for(;;)switch(w.prev=w.next){case 0:if(e=p.length>1&&void 0!==p[1]?p[1]:{},t=e.pad,n=void 0===t||t,a=e.linewidth,0<(o=void 0===a?128:a)){w.next=3;break}throw new Error("_b64_encode(bytes,{linewidth}): Invalid linewidth: ".concat(o,"."));case 3:i=r[Symbol.iterator](),r=y.a.mark((function r(){var e,t,n,a,o,f;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=!0,t=!1,n=void 0,r.prev=3,a=i[Symbol.iterator]();case 5:if(e=(o=a.next()).done){r.next=15;break}if(f=o.value,0<=(f*=1)&&f<256){r.next=10;break}throw new Error("_b64_encode(bytes): Invalid token in byte sequence: ".concat(f));case 10:return r.next=12,f;case 12:e=!0,r.next=5;break;case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(3),t=!0,n=r.t0;case 21:r.prev=21,r.prev=22,e||null==a.return||a.return();case 24:if(r.prev=24,!t){r.next=27;break}throw n;case 27:return r.finish(24);case 28:return r.finish(21);case 29:case"end":return r.stop()}}),r,null,[[3,17,21,29],[22,,24,28]])}))(),f=y.a.mark((function e(){var t,n,a,o,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,a=r.next(),t=a.value,!a.done){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,t>>2;case 9:if(n=(3&t)<<4,o=r.next(),t=o.value,!o.done){e.next=17;break}return e.next=16,n;case 16:return e.abrupt("return");case 17:return e.next=19,t>>4|n;case 19:if(n=(15&t)<<2,i=r.next(),t=i.value,!i.done){e.next=27;break}return e.next=26,n;case 26:return e.abrupt("return");case 27:return e.next=29,t>>6|n;case 29:return e.next=31,63&t;case 31:e.next=0;break;case 33:case"end":return e.stop()}}),e)}))(),s=0,u=!0,c=!1,l=void 0,w.prev=10,h=f[Symbol.iterator]();case 12:if(u=(v=h.next()).done){w.next=26;break}if("number"==typeof(d=v.value)){w.next=16;break}throw new Error("Assertion failed.");case 16:if(0<=d&&d<64){w.next=18;break}throw new Error("Assertion failed.");case 18:return w.next=20,Te[d];case 20:if(0!=++s%o){w.next=23;break}return w.next=23,"\n";case 23:u=!0,w.next=12;break;case 26:w.next=32;break;case 28:w.prev=28,w.t0=w.catch(10),c=!0,l=w.t0;case 32:w.prev=32,w.prev=33,u||null==h.return||h.return();case 35:if(w.prev=35,!c){w.next=38;break}throw l;case 38:return w.finish(35);case 39:return w.finish(32);case 40:if(!n){w.next=46;break}case 41:if(0==s++%4){w.next=46;break}return w.next=44,"=";case 44:w.next=41;break;case 46:case"end":return w.stop()}}),Oe,null,[[10,28,32,40],[33,,35,39]])}var Be=y.a.mark(Ve);function ze(r){r=r[Symbol.iterator]();for(var e=[];;){var t=r.next(),n=t.value;if(t.done)throw new Error("b64_parse(b64_chars): Invalid b64_chars.");if("["===n)break;e.push(n)}if(""===(e=e.join("").trim()))throw new Error("b64_parse(b64_chars): dtype=object not (yet) supported.");S(e);for(var a=[],o=[];;){var i=r.next(),f=i.value;if(i.done)throw new Error("b64_parse(b64_chars): Invalid b64_chars.");if("]"===f&&0===o.length)break;if("]"!==f&&","!==f)o.push(f);else{var s=o.join("");if(isNaN(s))throw new Error('b64_parse(b64_chars): Invalid shape entry: "'.concat(s,'".'));if(a.push(1*s),"]"===f)break;o=[]}}a=Int32Array.from(a),r=Qe(r);for(var u=A[e],c=new Uint8Array(a.reduce((function(r,e){return r*e}),u.BYTES_PER_ELEMENT)),l=new Uint8Array(u.BYTES_PER_ELEMENT),h=0;h<c.length;){for(var v=0;v<l.length;v++){var d=r.next(),p=d.value;if(d.done)throw new Error("b64_parse(b64_chars): b64_chars too short.");l[v]=p}$e||l.reverse();for(var w=0;w<l.length;w++,h++)c[h]=l[w]}return new V(a,new u(c.buffer))}function Ye(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="",n=!0,a=!1,o=void 0;try{for(var i,f=Ve(r,e)[Symbol.iterator]();!(n=(i=f.next()).done);n=!0){t+=i.value}}catch(r){a=!0,o=r}finally{try{n||null==f.return||f.return()}finally{if(a)throw o}}return t}function Ve(r){var e,t,n=arguments;return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e=n.length>1&&void 0!==n[1]?n[1]:{},r=z(r),t=r.data,"object"!==r.dtype){a.next=5;break}throw new Error("b64_format(A): A.dtype='".concat(r.dtype,"' not supported."));case 5:if($e){a.next=7;break}throw new Error("Big endianness not (yet) supported.");case 7:return a.delegateYield("".concat(r.dtype,"[").concat(r.shape.join(","),"]\n"),"t0",8);case 8:return a.delegateYield(Ce(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e),"t1",9);case 9:case"end":return a.stop()}}),Be)}function Ge(r){var e=function(){var e=!1,t=0,n=r[Symbol.iterator](),a=function(){var r=n.next(),a=r.value,o=r.done;if(++t,o){if(e)throw new Error("pyon_parse: Character sequence ended unexpectedly.");return e=!0,null}return a};return[a,function(){for(var r;;)switch(r=a()){default:return r;case"\f":case"\n":case"\r":case"\t":case"\v":case" ":}},function(r,e){var n=null==e?"Invalid character":"Expected ".concat(e,", but ");throw new Error("pyon_parse: ".concat(n," '").concat(r,"' encountered as ").concat(t,"-th character."))}]}(),t=q()(e,3),n=t[0],a=t[1],o=t[2];function i(){switch(f){default:o(f);case"{":return function(){var r={};if("{"!==f)throw new Error("Assertion failed.");for(;;){if("}"===(f=a()))return f=a(),r;var e=i();switch(":"!==f&&o(f,end),f=a(),r[e]=i(),f){default:o(f,",' or '}");case",":continue;case"}":return f=a(),r}}}();case'"':case"'":return function(){var r=f;switch(r){default:throw new Error("Assertion failed.");case"'":case'"':}for(var e="";;)switch(f=n()){case r:return f=a(),e;case"\\":switch(f=n()){case"u":for(var t=0,i=0;i<4;i++)switch(t<<=8,f=n()){default:o(f,"Hexadecimal digit");case"f":case"F":++t;case"e":case"E":++t;case"d":case"D":++t;case"c":case"C":++t;case"b":case"B":++t;case"a":case"A":++t;case"9":++t;case"8":++t;case"7":++t;case"6":++t;case"5":++t;case"4":++t;case"3":++t;case"2":++t;case"1":++t;case"0":++t}e+=String.fromCodePoint(t);continue;case"b":e+="\b";continue;case"f":e+="\f";continue;case"n":e+="\n";continue;case"r":e+="\r";continue;case"t":e+="\t";continue}default:e+=f}}();case"(":case"[":return function(){for(var r=function(){switch(f){case"(":return")";case"[":return"]";default:throw new Error("Assertion failed.")}}(),e=[];;){switch(f=a()){case r:return f=a(),e}switch(e.push(i()),f){default:o(f,",' or '".concat(r));case",":continue;case r:return f=a(),e}}}();case"T":return function(){if("T"!==f)throw new Error("Assertion failed.");var r=!0,e=!1,t=void 0;try{for(var i,s="rue"[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var u=i.value;f=n(),u!==f&&o(f,u)}}catch(r){e=!0,t=r}finally{try{r||null==s.return||s.return()}finally{if(e)throw t}}return f=a(),!0}();case"F":return function(){if("F"!==f)throw new Error("Assertion failed.");var r=!0,e=!1,t=void 0;try{for(var i,s="alse"[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var u=i.value;f=n(),u!==f&&o(f,u)}}catch(r){e=!0,t=r}finally{try{r||null==s.return||s.return()}finally{if(e)throw t}}return f=a(),!1}();case"N":return function(){if("N"!==f)throw new Error("Assertion failed.");var r=!0,e=!1,t=void 0;try{for(var i,s="one"[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var u=i.value;f=n(),u!==f&&o(f,u)}}catch(r){e=!0,t=r}finally{try{r||null==s.return||s.return()}finally{if(e)throw t}}return f=a(),null}();case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case".":case"8":case"+":case"9":case"-":return function(){var r="";r:for(;;f=n())switch(f){case"\f":case"\n":case"\r":case"\t":case"\v":case" ":f=a();default:break r;case"0":case"1":case"2":case"3":case"a":case"A":case"4":case"b":case"B":case"5":case"c":case"C":case"6":case"d":case"D":case"7":case"e":case"E":case".":case"8":case"f":case"F":case"+":case"9":case"e":case"E":case"-":r+=f}r=1*r.trim(),isNaN(r)&&o(r);return r}()}}var f=a();return i()}var Je=y.a.mark(Xe),He="NUMPY";function We(r){return Uint8Array.from(Xe(r))}function Xe(r){var e,t,n,a,o,i;return y.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:r=z(r),e=function(){switch(r.dtype){default:throw new Error("nd_to_npy: A.dtype=".concat(r.dtype," not yet supported."));case"int32":return"i4";case"float32":return"f4";case"float64":return"f8";case"complex128":return"c16"}}(),t='{"descr": "'.concat(e=$e?"<"+e:">"+e,'", "fortran_order": False, "shape": (').concat(r.shape).concat(r.ndim>0?",":"",")}"),n=0;case 5:if(!(n<He.length)){f.next=11;break}return f.next=8,He.codePointAt(n);case 8:n++,f.next=5;break;case 11:return f.next=13,1;case 13:return f.next=15,0;case 15:if(!((a=t.length+11+63>>>6<<6)>65535)){f.next=18;break}throw new Error("nd_to_npy: Header too large.");case 18:return f.next=20,a-10>>>0&255;case 20:return f.next=22,a-10>>>8&255;case 22:if(a%64==0){f.next=24;break}throw new Error("Assertion failed.");case 24:o=0;case 25:if(!(o<t.length)){f.next=31;break}return f.next=28,t.codePointAt(o);case 28:o++,f.next=25;break;case 31:i=t.length+11;case 32:if(!(i<a)){f.next=38;break}return f.next=35," ".codePointAt(0);case 35:i++,f.next=32;break;case 38:return f.next=40,"\n".codePointAt(0);case 40:return f.delegateYield(new Uint8Array(r.data.buffer,r.data.byteOffset,r.data.byteLength),"t0",41);case 41:case"end":return f.stop()}}),Je)}function Ke(r){var e,t,n=(t=r[Symbol.iterator](),function(){var r=t.next(),e=r.value,n=r.done;if(n)throw new Error("npy_to_nd: byte sequence ended unexpectedly.");return e});r=void 0;for(var a="";a.length<6;)a+=String.fromCodePoint(n());if(a!==He)throw new Error("npy_to_nd: byte sequence does not start with 'NUMPY'.");var o="".concat(n(),".").concat(n());switch(o){default:throw new Error("npy_bytes: npy-file version ".concat(o," not supported."));case"1.0":case"2.0":}var i=function(){var r=1*n()+256*n();if("2.0"===o&&(r+=65536*n()+n()*(1<<24)),r<0)throw new Error("Assertion failed.");return Ge(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r-- >0)){e.next=5;break}return e.next=3,String.fromCodePoint(n());case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)}))())}(),f=function(){switch(i.descr[0]){default:throw new Error("npy_to_nd: dtype '".concat(i.descr,"' not yet supported."));case"<":return!0;case">":return!1}}(),s=function(){switch(i.descr.slice(1)){default:throw new Error("npy_to_nd: dtype '".concat(i.descr,"' not yet supported."));case"i4":return"int32";case"f4":return"float32";case"f8":return"float64";case"c16":return"complex128"}}(),u=A[s],c=Uint8Array.from({length:i.shape.reduce((function(r,e){return r*e}),u.BYTES_PER_ELEMENT)},n);if(f!==$e)for(var l=u.BYTES_PER_ELEMENT>>>s.startsWith("complex"),h=0;h<c.length;h+=l)for(var v=h,d=h+l;v<--d;v++){var p=c[v];c[v]=c[d],c[d]=p}var m=Int32Array.from(i.shape);i.fortran_order&&m.reverse();var b=new V(m,new u(c.buffer));return i.fortran_order&&b.ndim>1&&(b=(e=b).transpose.apply(e,w()(y.a.mark((function r(){var e;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=b.ndim;case 1:if(!(e-- >0)){r.next=6;break}return r.next=4,e;case 4:r.next=1;break;case 6:case"end":return r.stop()}}),r)}))()))),b}var $e=1===new Int16Array(Uint8Array.of(1,0).buffer)[0],Ze="\f\n\r\t\v ";t.d(e,"math",(function(){return h})),t.d(e,"array",(function(){return B})),t.d(e,"asarray",(function(){return z})),t.d(e,"NDArray",(function(){return V})),t.d(e,"rand_normal",(function(){return G})),t.d(e,"tabulate",(function(){return J})),t.d(e,"zip_elems",(function(){return C})),t.d(e,"concat",(function(){return H})),t.d(e,"stack",(function(){return W})),t.d(e,"dt",(function(){return n})),t.d(e,"opt",(function(){return o})),t.d(e,"la",(function(){return i})),t.d(e,"io",(function(){return f}))}])}));